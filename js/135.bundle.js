(self.webpackChunkdemo_app=self.webpackChunkdemo_app||[]).push([[135],{18382:function(__unused_webpack_module,exports,__webpack_require__){"use strict";var numeric=exports;void 0!==__webpack_require__.g&&(__webpack_require__.g.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(t,e){var n,r,i;for(void 0===e&&(e=15),r=.5,n=new Date;;){for(i=r*=2;i>3;i-=4)t(),t(),t(),t();for(;i>0;)t(),i--;if(new Date-n>e)break}for(i=r;i>3;i-=4)t(),t(),t(),t();for(;i>0;)t(),i--;return 1e3*(3*r-1)/(new Date-n)},numeric._myIndexOf=function(t){var e,n=this.length;for(e=0;e<n;++e)if(this[e]===t)return e;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(t){function e(t){if(0===t)return"0";if(isNaN(t))return"NaN";if(t<0)return"-"+e(-t);if(isFinite(t)){var n=Math.floor(Math.log(t)/Math.log(10)),r=t/Math.pow(10,n),i=r.toPrecision(numeric.precision);return 10===parseFloat(i)&&(n++,i=(r=1).toPrecision(numeric.precision)),parseFloat(i).toString()+"e"+n.toString()}return"Infinity"}var n=[];return function t(r){var i;if(void 0===r)return n.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof r)return n.push('"'+r+'"'),!1;if("boolean"==typeof r)return n.push(r.toString()),!1;if("number"==typeof r){var o=e(r),a=r.toPrecision(numeric.precision),s=parseFloat(r.toString()).toString(),u=[o,a,s,parseFloat(a).toString(),parseFloat(s).toString()];for(i=1;i<u.length;i++)u[i].length<o.length&&(o=u[i]);return n.push(Array(numeric.precision+8-o.length).join(" ")+o),!1}if(null===r)return n.push("null"),!1;if("function"==typeof r){n.push(r.toString());var l=!1;for(i in r)r.hasOwnProperty(i)&&(l?n.push(",\n"):n.push("\n{"),l=!0,n.push(i),n.push(": \n"),t(r[i]));return l&&n.push("}\n"),!0}if(r instanceof Array){if(r.length>numeric.largeArray)return n.push("...Large Array..."),!0;l=!1;for(n.push("["),i=0;i<r.length;i++)i>0&&(n.push(","),l&&n.push("\n ")),l=t(r[i]);return n.push("]"),!0}for(i in n.push("{"),l=!1,r)r.hasOwnProperty(i)&&(l&&n.push(",\n"),l=!0,n.push(i),n.push(": \n"),t(r[i]));return n.push("}"),!0}(t),n.join("")},numeric.parseDate=function(t){return function t(e){if("string"==typeof e)return Date.parse(e.replace(/-/g,"/"));if(!(e instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var n,r=[];for(n=0;n<e.length;n++)r[n]=t(e[n]);return r}(t)},numeric.parseFloat=function(t){return function t(e){if("string"==typeof e)return parseFloat(e);if(!(e instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var n,r=[];for(n=0;n<e.length;n++)r[n]=t(e[n]);return r}(t)},numeric.parseCSV=function(t){var e,n,r,i=t.split("\n"),o=[],a=/(([^'",]*)|('[^']*')|("[^"]*")),/g,s=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,u=0;for(n=0;n<i.length;n++){var l,c=(i[n]+",").match(a);if(c.length>0){for(o[u]=[],e=0;e<c.length;e++)l=(r=c[e]).substr(0,r.length-1),s.test(l)?o[u][e]=parseFloat(l):o[u][e]=l;u++}}return o},numeric.toCSV=function(t){var e,n,r,i,o,a=numeric.dim(t);for(r=a[0],a[1],o=[],e=0;e<r;e++){for(i=[],n=0;n<r;n++)i[n]=t[e][n].toString();o[e]=i.join(", ")}return o.join("\n")+"\n"},numeric.getURL=function(t){var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(),e},numeric.imageURL=function(t){function e(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.length);var r,i=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],o=-1;t.length;for(r=e;r<n;r++)o=o>>>8^i[255&(o^t[r])];return-1^o}var n,r,i,o,a,s,u,l,c,h,p=t[0].length,f=t[0][0].length,d=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,f>>24&255,f>>16&255,f>>8&255,255&f,p>>24&255,p>>16&255,p>>8&255,255&p,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(h=e(d,12,29),d[29]=h>>24&255,d[30]=h>>16&255,d[31]=h>>8&255,d[32]=255&h,n=1,r=0,u=0;u<p;u++){for(u<p-1?d.push(0):d.push(1),a=3*f+1+(0===u)&255,s=3*f+1+(0===u)>>8&255,d.push(a),d.push(s),d.push(255&~a),d.push(255&~s),0===u&&d.push(0),l=0;l<f;l++)for(i=0;i<3;i++)r=(r+(n=(n+(a=(a=t[i][u][l])>255?255:a<0?0:Math.round(a)))%65521))%65521,d.push(a);d.push(0)}return c=(r<<16)+n,d.push(c>>24&255),d.push(c>>16&255),d.push(c>>8&255),d.push(255&c),o=d.length-41,d[33]=o>>24&255,d[34]=o>>16&255,d[35]=o>>8&255,d[36]=255&o,h=e(d,37),d.push(h>>24&255),d.push(h>>16&255),d.push(h>>8&255),d.push(255&h),d.push(0),d.push(0),d.push(0),d.push(0),d.push(73),d.push(69),d.push(78),d.push(68),d.push(174),d.push(66),d.push(96),d.push(130),"data:image/png;base64,"+function(t){var e,n,r,i,o,a,s,u=t.length,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="";for(e=0;e<u;e+=3)o=((3&(n=t[e]))<<4)+((r=t[e+1])>>4),a=((15&r)<<2)+((i=t[e+2])>>6),s=63&i,e+1>=u?a=s=64:e+2>=u&&(s=64),c+=l.charAt(n>>2)+l.charAt(o)+l.charAt(a)+l.charAt(s);return c}(d)},numeric._dim=function(t){for(var e=[];"object"==typeof t;)e.push(t.length),t=t[0];return e},numeric.dim=function(t){var e;return"object"==typeof t?"object"==typeof(e=t[0])?"object"==typeof e[0]?numeric._dim(t):[t.length,e.length]:[t.length]:[]},numeric.mapreduce=function(t,e){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+e+';\nif(typeof x === "number") { var xi = x; '+t+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+t+";\n    xi = x[i-1];\n    "+t+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+t+"\n}\nreturn accum;")},numeric.mapreduce2=function(t,e){return Function("x","var n = x.length;\nvar i,xi;\n"+e+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+t+";\n}\nreturn accum;")},numeric.same=function t(e,n){var r,i;if(!(e instanceof Array&&n instanceof Array))return!1;if((i=e.length)!==n.length)return!1;for(r=0;r<i;r++)if(e[r]!==n[r]){if("object"!=typeof e[r])return!1;if(!t(e[r],n[r]))return!1}return!0},numeric.rep=function(t,e,n){void 0===n&&(n=0);var r,i=t[n],o=Array(i);if(n===t.length-1){for(r=i-2;r>=0;r-=2)o[r+1]=e,o[r]=e;return-1===r&&(o[0]=e),o}for(r=i-1;r>=0;r--)o[r]=numeric.rep(t,e,n+1);return o},numeric.dotMMsmall=function(t,e){var n,r,i,o,a,s,u,l,c,h,p;for(o=t.length,a=e.length,s=e[0].length,u=Array(o),n=o-1;n>=0;n--){for(l=Array(s),c=t[n],i=s-1;i>=0;i--){for(h=c[a-1]*e[a-1][i],r=a-2;r>=1;r-=2)p=r-1,h+=c[r]*e[r][i]+c[p]*e[p][i];0===r&&(h+=c[0]*e[0][i]),l[i]=h}u[n]=l}return u},numeric._getCol=function(t,e,n){var r;for(r=t.length-1;r>0;--r)n[r]=t[r][e],n[--r]=t[r][e];0===r&&(n[0]=t[0][e])},numeric.dotMMbig=function(t,e){var n,r,i,o=numeric._getCol,a=e.length,s=Array(a),u=t.length,l=e[0].length,c=new Array(u),h=numeric.dotVV;for(--a,r=--u;-1!==r;--r)c[r]=Array(l);for(r=--l;-1!==r;--r)for(o(e,r,s),i=u;-1!==i;--i)0,n=t[i],c[i][r]=h(n,s);return c},numeric.dotMV=function(t,e){var n,r=t.length,i=(e.length,Array(r)),o=numeric.dotVV;for(n=r-1;n>=0;n--)i[n]=o(t[n],e);return i},numeric.dotVM=function(t,e){var n,r,i,o,a,s,u;for(i=t.length,o=e[0].length,a=Array(o),r=o-1;r>=0;r--){for(s=t[i-1]*e[i-1][r],n=i-2;n>=1;n-=2)u=n-1,s+=t[n]*e[n][r]+t[u]*e[u][r];0===n&&(s+=t[0]*e[0][r]),a[r]=s}return a},numeric.dotVV=function(t,e){var n,r,i=t.length,o=t[i-1]*e[i-1];for(n=i-2;n>=1;n-=2)r=n-1,o+=t[n]*e[n]+t[r]*e[r];return 0===n&&(o+=t[0]*e[0]),o},numeric.dot=function(t,e){var n=numeric.dim;switch(1e3*n(t).length+n(e).length){case 2002:return e.length<10?numeric.dotMMsmall(t,e):numeric.dotMMbig(t,e);case 2001:return numeric.dotMV(t,e);case 1002:return numeric.dotVM(t,e);case 1001:return numeric.dotVV(t,e);case 1e3:return numeric.mulVS(t,e);case 1:return numeric.mulSV(t,e);case 0:return t*e;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(t){var e,n,r,i,o=t.length,a=Array(o);for(e=o-1;e>=0;e--){for(i=Array(o),n=e+2,r=o-1;r>=n;r-=2)i[r]=0,i[r-1]=0;for(r>e&&(i[r]=0),i[e]=t[e],r=e-1;r>=1;r-=2)i[r]=0,i[r-1]=0;0===r&&(i[0]=0),a[e]=i}return a},numeric.getDiag=function(t){var e,n=Math.min(t.length,t[0].length),r=Array(n);for(e=n-1;e>=1;--e)r[e]=t[e][e],r[--e]=t[e][e];return 0===e&&(r[0]=t[0][0]),r},numeric.identity=function(t){return numeric.diag(numeric.rep([t],1))},numeric.pointwise=function(t,e,n){void 0===n&&(n="");var r,i,o=[],a=/\[i\]$/,s="",u=!1;for(r=0;r<t.length;r++)a.test(t[r])?s=i=t[r].substring(0,t[r].length-3):i=t[r],"ret"===i&&(u=!0),o.push(i);return o[t.length]="_s",o[t.length+1]="_k",o[t.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+s+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(u?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+t.join(",")+",_s,_k+1);\n    return ret;\n}\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n    "+e+"\n}\nreturn ret;",Function.apply(null,o)},numeric.pointwise2=function(t,e,n){void 0===n&&(n="");var r,i,o=[],a=/\[i\]$/,s="",u=!1;for(r=0;r<t.length;r++)a.test(t[r])?s=i=t[r].substring(0,t[r].length-3):i=t[r],"ret"===i&&(u=!0),o.push(i);return o[t.length]="var _n = "+s+".length;\nvar i"+(u?"":", ret = Array(_n)")+";\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n"+e+"\n}\nreturn ret;",Function.apply(null,o)},numeric._biforeach=function t(e,n,r,i,o){var a;if(i!==r.length-1)for(a=r[i]-1;a>=0;a--)t("object"==typeof e?e[a]:e,"object"==typeof n?n[a]:n,r,i+1,o);else o(e,n)},numeric._biforeach2=function t(e,n,r,i,o){if(i===r.length-1)return o(e,n);var a,s=r[i],u=Array(s);for(a=s-1;a>=0;--a)u[a]=t("object"==typeof e?e[a]:e,"object"==typeof n?n[a]:n,r,i+1,o);return u},numeric._foreach=function t(e,n,r,i){var o;if(r!==n.length-1)for(o=n[r]-1;o>=0;o--)t(e[o],n,r+1,i);else i(e)},numeric._foreach2=function t(e,n,r,i){if(r===n.length-1)return i(e);var o,a=n[r],s=Array(a);for(o=a-1;o>=0;o--)s[o]=t(e[o],n,r+1,i);return s},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var t,e;for(t=0;t<numeric.mathfuns2.length;++t)e=numeric.mathfuns2[t],numeric.ops2[e]=e;for(t in numeric.ops2)if(numeric.ops2.hasOwnProperty(t)){e=numeric.ops2[t];var n,r,i="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,t)?(i="var "+e+" = Math."+e+";\n",n=function(t,n,r){return t+" = "+e+"("+n+","+r+")"},r=function(t,n){return t+" = "+e+"("+t+","+n+")"}):(n=function(t,n,r){return t+" = "+n+" "+e+" "+r},r=numeric.opseq.hasOwnProperty(t+"eq")?function(t,n){return t+" "+e+"= "+n}:function(t,n){return t+" = "+t+" "+e+" "+n}),numeric[t+"VV"]=numeric.pointwise2(["x[i]","y[i]"],n("ret[i]","x[i]","y[i]"),i),numeric[t+"SV"]=numeric.pointwise2(["x","y[i]"],n("ret[i]","x","y[i]"),i),numeric[t+"VS"]=numeric.pointwise2(["x[i]","y"],n("ret[i]","x[i]","y"),i),numeric[t]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+t+"VV, VS = numeric."+t+"VS, SV = numeric."+t+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+r("x","y")+"\n}\nreturn x;\n"),numeric[e]=numeric[t],numeric[t+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],r("ret[i]","x[i]"),i),numeric[t+"eqS"]=numeric.pointwise2(["ret[i]","x"],r("ret[i]","x"),i),numeric[t+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+t+"eqV, S = numeric."+t+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(t=0;t<numeric.mathfuns2.length;++t)e=numeric.mathfuns2[t],delete numeric.ops2[e];for(t=0;t<numeric.mathfuns.length;++t)e=numeric.mathfuns[t],numeric.ops1[e]=e;for(t in numeric.ops1)numeric.ops1.hasOwnProperty(t)&&(i="",e=numeric.ops1[t],-1!==numeric.myIndexOf.call(numeric.mathfuns,t)&&Math.hasOwnProperty(e)&&(i="var "+e+" = Math."+e+";\n"),numeric[t+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+e+"(ret[i]);",i),numeric[t+"eq"]=Function("x",'if(typeof x !== "object") return '+e+"x\nvar i;\nvar V = numeric."+t+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[t+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+e+"(x[i]);",i),numeric[t]=Function("x",'if(typeof x !== "object") return '+e+"(x)\nvar i;\nvar V = numeric."+t+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(t=0;t<numeric.mathfuns.length;++t)e=numeric.mathfuns[t],delete numeric.ops1[e];for(t in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(t)&&(e=numeric.mapreducers[t],numeric[t+"V"]=numeric.mapreduce2(e[0],e[1]),numeric[t]=Function("x","s","k",e[1]+'if(typeof x !== "object") {    xi = x;\n'+e[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+t+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+e[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(t,e){return"object"==typeof t?"object"==typeof e?numeric.truncVV(t,e):numeric.truncVS(t,e):"object"==typeof e?numeric.truncSV(t,e):Math.round(t/e)*e},numeric.inv=function(t){var e,n,r,i,o,a,s,u=numeric.dim(t),l=Math.abs,c=u[0],h=u[1],p=numeric.clone(t),f=numeric.identity(c);for(a=0;a<h;++a){var d=-1,m=-1;for(o=a;o!==c;++o)(s=l(p[o][a]))>m&&(d=o,m=s);for(n=p[d],p[d]=p[a],p[a]=n,i=f[d],f[d]=f[a],f[a]=i,t=n[a],s=a;s!==h;++s)n[s]/=t;for(s=h-1;-1!==s;--s)i[s]/=t;for(o=c-1;-1!==o;--o)if(o!==a){for(e=p[o],r=f[o],t=e[a],s=a+1;s!==h;++s)e[s]-=n[s]*t;for(s=h-1;s>0;--s)r[s]-=i[s]*t,r[--s]-=i[s]*t;0===s&&(r[0]-=i[0]*t)}}return f},numeric.det=function(t){var e=numeric.dim(t);if(2!==e.length||e[0]!==e[1])throw new Error("numeric: det() only works on square matrices");var n,r,i,o,a,s,u,l,c=e[0],h=1,p=numeric.clone(t);for(r=0;r<c-1;r++){for(i=r,n=r+1;n<c;n++)Math.abs(p[n][r])>Math.abs(p[i][r])&&(i=n);for(i!==r&&(u=p[i],p[i]=p[r],p[r]=u,h*=-1),o=p[r],n=r+1;n<c;n++){for(s=(a=p[n])[r]/o[r],i=r+1;i<c-1;i+=2)l=i+1,a[i]-=o[i]*s,a[l]-=o[l]*s;i!==c&&(a[i]-=o[i]*s)}if(0===o[r])return 0;h*=o[r]}return h*p[r][r]},numeric.transpose=function(t){var e,n,r,i,o,a=t.length,s=t[0].length,u=Array(s);for(n=0;n<s;n++)u[n]=Array(a);for(e=a-1;e>=1;e-=2){for(i=t[e],r=t[e-1],n=s-1;n>=1;--n)(o=u[n])[e]=i[n],o[e-1]=r[n],(o=u[--n])[e]=i[n],o[e-1]=r[n];0===n&&((o=u[0])[e]=i[0],o[e-1]=r[0])}if(0===e){for(r=t[0],n=s-1;n>=1;--n)u[n][0]=r[n],u[--n][0]=r[n];0===n&&(u[0][0]=r[0])}return u},numeric.negtranspose=function(t){var e,n,r,i,o,a=t.length,s=t[0].length,u=Array(s);for(n=0;n<s;n++)u[n]=Array(a);for(e=a-1;e>=1;e-=2){for(i=t[e],r=t[e-1],n=s-1;n>=1;--n)(o=u[n])[e]=-i[n],o[e-1]=-r[n],(o=u[--n])[e]=-i[n],o[e-1]=-r[n];0===n&&((o=u[0])[e]=-i[0],o[e-1]=-r[0])}if(0===e){for(r=t[0],n=s-1;n>=1;--n)u[n][0]=-r[n],u[--n][0]=-r[n];0===n&&(u[0][0]=-r[0])}return u},numeric._random=function t(e,n){var r,i,o=e[n],a=Array(o);if(n===e.length-1){for(i=Math.random,r=o-1;r>=1;r-=2)a[r]=i(),a[r-1]=i();return 0===r&&(a[0]=i()),a}for(r=o-1;r>=0;r--)a[r]=t(e,n+1);return a},numeric.random=function(t){return numeric._random(t,0)},numeric.norm2=function(t){return Math.sqrt(numeric.norm2Squared(t))},numeric.linspace=function(t,e,n){if(void 0===n&&(n=Math.max(Math.round(e-t)+1,1)),n<2)return 1===n?[t]:[];var r,i=Array(n);for(r=--n;r>=0;r--)i[r]=(r*e+(n-r)*t)/n;return i},numeric.getBlock=function(t,e,n){var r=numeric.dim(t);return function t(i,o){var a,s=e[o],u=n[o]-s,l=Array(u);if(o===r.length-1){for(a=u;a>=0;a--)l[a]=i[a+s];return l}for(a=u;a>=0;a--)l[a]=t(i[a+s],o+1);return l}(t,0)},numeric.setBlock=function(t,e,n,r){var i=numeric.dim(t);return function t(r,o,a){var s,u=e[a],l=n[a]-u;if(a===i.length-1)for(s=l;s>=0;s--)r[s+u]=o[s];for(s=l;s>=0;s--)t(r[s+u],o[s],a+1)}(t,r,0),t},numeric.getRange=function(t,e,n){var r,i,o,a,s=e.length,u=n.length,l=Array(s);for(r=s-1;-1!==r;--r)for(l[r]=Array(u),o=l[r],a=t[e[r]],i=u-1;-1!==i;--i)o[i]=a[n[i]];return l},numeric.blockMatrix=function(t){var e=numeric.dim(t);if(e.length<4)return numeric.blockMatrix([t]);var n,r,i,o,a,s=e[0],u=e[1];for(n=0,r=0,i=0;i<s;++i)n+=t[i][0].length;for(o=0;o<u;++o)r+=t[0][o][0].length;var l=Array(n);for(i=0;i<n;++i)l[i]=Array(r);var c,h,p,f,d,m=0;for(i=0;i<s;++i){for(c=r,o=u-1;-1!==o;--o)for(c-=(a=t[i][o])[0].length,p=a.length-1;-1!==p;--p)for(d=a[p],h=l[m+p],f=d.length-1;-1!==f;--f)h[c+f]=d[f];m+=t[i][0].length}return l},numeric.tensor=function(t,e){if("number"==typeof t||"number"==typeof e)return numeric.mul(t,e);var n=numeric.dim(t),r=numeric.dim(e);if(1!==n.length||1!==r.length)throw new Error("numeric: tensor product is only defined for vectors");var i,o,a,s,u=n[0],l=r[0],c=Array(u);for(o=u-1;o>=0;o--){for(i=Array(l),s=t[o],a=l-1;a>=3;--a)i[a]=s*e[a],i[--a]=s*e[a],i[--a]=s*e[a],i[--a]=s*e[a];for(;a>=0;)i[a]=s*e[a],--a;c[o]=i}return c},numeric.T=function(t,e){this.x=t,this.y=e},numeric.t=function(t,e){return new numeric.T(t,e)},numeric.Tbinop=function(t,e,n,r,i){var o;numeric.indexOf;if("string"!=typeof i)for(o in i="",numeric)numeric.hasOwnProperty(o)&&(t.indexOf(o)>=0||e.indexOf(o)>=0||n.indexOf(o)>=0||r.indexOf(o)>=0)&&o.length>1&&(i+="var "+o+" = numeric."+o+";\n");return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+i+"\nif(x.y) {  if(y.y) {    return new numeric.T("+r+");\n  }\n  return new numeric.T("+n+");\n}\nif(y.y) {\n  return new numeric.T("+e+");\n}\nreturn new numeric.T("+t+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var t=numeric.mul,e=numeric.div;if(this.y){var n=numeric.add(t(this.x,this.x),t(this.y,this.y));return new numeric.T(e(this.x,n),e(numeric.neg(this.y),n))}return new T(e(1,this.x))},numeric.T.prototype.div=function(t){if(t instanceof numeric.T||(t=new numeric.T(t)),t.y)return this.mul(t.reciprocal());var e=numeric.div;return this.y?new numeric.T(e(this.x,t.x),e(this.y,t.x)):new numeric.T(e(this.x,t.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var t=numeric.transpose,e=this.x,n=this.y;return n?new numeric.T(t(e),t(n)):new numeric.T(t(e))},numeric.T.prototype.transjugate=function(){var t=numeric.transpose,e=this.x,n=this.y;return n?new numeric.T(t(e),numeric.negtranspose(n)):new numeric.T(t(e))},numeric.Tunop=function(t,e,n){return"string"!=typeof n&&(n=""),Function("var x = this;\n"+n+"\nif(x.y) {  "+e+";\n}\n"+t+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var t=this;if(void 0===t.y)return new numeric.T(numeric.inv(t.x));var e,n,r,i,o,a,s,u,l,c,h,p,f,d,m,g,v,y,x=t.x.length,_=numeric.identity(x),b=numeric.rep([x,x],0),w=numeric.clone(t.x),M=numeric.clone(t.y);for(l=0;l<x;l++){for(p=(d=w[l][l])*d+(m=M[l][l])*m,h=l,c=l+1;c<x;c++)(f=(d=w[c][l])*d+(m=M[c][l])*m)>p&&(h=c,p=f);for(h!==l&&(y=w[l],w[l]=w[h],w[h]=y,y=M[l],M[l]=M[h],M[h]=y,y=_[l],_[l]=_[h],_[h]=y,y=b[l],b[l]=b[h],b[h]=y),e=w[l],n=M[l],o=_[l],a=b[l],d=e[l],m=n[l],c=l+1;c<x;c++)g=e[c],v=n[c],e[c]=(g*d+v*m)/p,n[c]=(v*d-g*m)/p;for(c=0;c<x;c++)g=o[c],v=a[c],o[c]=(g*d+v*m)/p,a[c]=(v*d-g*m)/p;for(c=l+1;c<x;c++){for(r=w[c],i=M[c],s=_[c],u=b[c],d=r[l],m=i[l],h=l+1;h<x;h++)g=e[h],v=n[h],r[h]-=g*d-v*m,i[h]-=v*d+g*m;for(h=0;h<x;h++)g=o[h],v=a[h],s[h]-=g*d-v*m,u[h]-=v*d+g*m}}for(l=x-1;l>0;l--)for(o=_[l],a=b[l],c=l-1;c>=0;c--)for(s=_[c],u=b[c],d=w[c][l],m=M[c][l],h=x-1;h>=0;h--)g=o[h],v=a[h],s[h]-=d*g-m*v,u[h]-=d*v+m*g;return new numeric.T(_,b)},numeric.T.prototype.get=function(t){var e,n=this.x,r=this.y,i=0,o=t.length;if(r){for(;i<o;)n=n[e=t[i]],r=r[e],i++;return new numeric.T(n,r)}for(;i<o;)n=n[e=t[i]],i++;return new numeric.T(n)},numeric.T.prototype.set=function(t,e){var n,r=this.x,i=this.y,o=0,a=t.length,s=e.x,u=e.y;if(0===a)return u?this.y=u:i&&(this.y=void 0),this.x=r,this;if(u){for(i||(i=numeric.rep(numeric.dim(r),0),this.y=i);o<a-1;)r=r[n=t[o]],i=i[n],o++;return r[n=t[o]]=s,i[n]=u,this}if(i){for(;o<a-1;)r=r[n=t[o]],i=i[n],o++;return r[n=t[o]]=s,i[n]=s instanceof Array?numeric.rep(numeric.dim(s),0):0,this}for(;o<a-1;)r=r[n=t[o]],o++;return r[n=t[o]]=s,this},numeric.T.prototype.getRows=function(t,e){var n,r,i=e-t+1,o=Array(i),a=this.x,s=this.y;for(n=t;n<=e;n++)o[n-t]=a[n];if(s){for(r=Array(i),n=t;n<=e;n++)r[n-t]=s[n];return new numeric.T(o,r)}return new numeric.T(o)},numeric.T.prototype.setRows=function(t,e,n){var r,i=this.x,o=this.y,a=n.x,s=n.y;for(r=t;r<=e;r++)i[r]=a[r-t];if(s)for(o||(o=numeric.rep(numeric.dim(i),0),this.y=o),r=t;r<=e;r++)o[r]=s[r-t];else if(o)for(r=t;r<=e;r++)o[r]=numeric.rep([a[r-t].length],0);return this},numeric.T.prototype.getRow=function(t){var e=this.x,n=this.y;return n?new numeric.T(e[t],n[t]):new numeric.T(e[t])},numeric.T.prototype.setRow=function(t,e){var n=this.x,r=this.y,i=e.x,o=e.y;return n[t]=i,o?(r||(r=numeric.rep(numeric.dim(n),0),this.y=r),r[t]=o):r&&(r=numeric.rep([i.length],0)),this},numeric.T.prototype.getBlock=function(t,e){var n=this.x,r=this.y,i=numeric.getBlock;return r?new numeric.T(i(n,t,e),i(r,t,e)):new numeric.T(i(n,t,e))},numeric.T.prototype.setBlock=function(t,e,n){n instanceof numeric.T||(n=new numeric.T(n));var r=this.x,i=this.y,o=numeric.setBlock,a=n.x,s=n.y;if(s)return i||(this.y=numeric.rep(numeric.dim(this),0),i=this.y),o(r,t,e,a),o(i,t,e,s),this;o(r,t,e,a),i&&o(i,t,e,numeric.rep(numeric.dim(a),0))},numeric.T.rep=function(t,e){var n=numeric.T;e instanceof n||(e=new n(e));var r=e.x,i=e.y,o=numeric.rep;return i?new n(o(t,r),o(t,i)):new n(o(t,r))},numeric.T.diag=function(t){t instanceof numeric.T||(t=new numeric.T(t));var e=t.x,n=t.y,r=numeric.diag;return n?new numeric.T(r(e),r(n)):new numeric.T(r(e))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(t){return new numeric.T(numeric.identity(t))},numeric.T.prototype.getDiag=function(){var t=numeric,e=this.x,n=this.y;return n?new t.T(t.getDiag(e),t.getDiag(n)):new t.T(t.getDiag(e))},numeric.house=function(t){var e=numeric.clone(t),n=(t[0]>=0?1:-1)*numeric.norm2(t);e[0]+=n;var r=numeric.norm2(e);if(0===r)throw new Error("eig: internal error");return numeric.div(e,r)},numeric.toUpperHessenberg=function(t){var e=numeric.dim(t);if(2!==e.length||e[0]!==e[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var n,r,i,o,a,s,u,l,c,h,p=e[0],f=numeric.clone(t),d=numeric.identity(p);for(r=0;r<p-2;r++){for(o=Array(p-r-1),n=r+1;n<p;n++)o[n-r-1]=f[n][r];if(numeric.norm2(o)>0){for(a=numeric.house(o),s=numeric.getBlock(f,[r+1,r],[p-1,p-1]),u=numeric.tensor(a,numeric.dot(a,s)),n=r+1;n<p;n++)for(l=f[n],c=u[n-r-1],i=r;i<p;i++)l[i]-=2*c[i-r];for(s=numeric.getBlock(f,[0,r+1],[p-1,p-1]),u=numeric.tensor(numeric.dot(s,a),a),n=0;n<p;n++)for(l=f[n],c=u[n],i=r+1;i<p;i++)l[i]-=2*c[i-r-1];for(s=Array(p-r-1),n=r+1;n<p;n++)s[n-r-1]=d[n];for(u=numeric.tensor(a,numeric.dot(a,s)),n=r+1;n<p;n++)for(h=d[n],c=u[n-r-1],i=0;i<p;i++)h[i]-=2*c[i]}}return{H:f,Q:d}},numeric.epsilon=2220446049250313e-31,numeric.QRFrancis=function(t,e){void 0===e&&(e=1e4),t=numeric.clone(t);numeric.clone(t);var n,r,i,o,a,s,u,l,c,h,p,f,d,m,g,v,y,x,_=numeric.dim(t)[0],b=numeric.identity(_);if(_<3)return{Q:b,B:[[0,_-1]]};var w=numeric.epsilon;for(x=0;x<e;x++){for(v=0;v<_-1;v++)if(Math.abs(t[v+1][v])<w*(Math.abs(t[v][v])+Math.abs(t[v+1][v+1]))){var M=numeric.QRFrancis(numeric.getBlock(t,[0,0],[v,v]),e),S=numeric.QRFrancis(numeric.getBlock(t,[v+1,v+1],[_-1,_-1]),e);for(f=Array(v+1),g=0;g<=v;g++)f[g]=b[g];for(d=numeric.dot(M.Q,f),g=0;g<=v;g++)b[g]=d[g];for(f=Array(_-v-1),g=v+1;g<_;g++)f[g-v-1]=b[g];for(d=numeric.dot(S.Q,f),g=v+1;g<_;g++)b[g]=d[g-v-1];return{Q:b,B:M.B.concat(numeric.add(S.B,v+1))}}var T,E,A;if(i=t[_-2][_-2],o=t[_-2][_-1],a=t[_-1][_-2],l=i+(s=t[_-1][_-1]),u=i*s-o*a,c=numeric.getBlock(t,[0,0],[2,2]),l*l>=4*u)T=.5*(l+Math.sqrt(l*l-4*u)),E=.5*(l-Math.sqrt(l*l-4*u)),c=numeric.add(numeric.sub(numeric.dot(c,c),numeric.mul(c,T+E)),numeric.diag(numeric.rep([3],T*E)));else c=numeric.add(numeric.sub(numeric.dot(c,c),numeric.mul(c,l)),numeric.diag(numeric.rep([3],u)));for(n=[c[0][0],c[1][0],c[2][0]],r=numeric.house(n),f=[t[0],t[1],t[2]],d=numeric.tensor(r,numeric.dot(r,f)),g=0;g<3;g++)for(p=t[g],m=d[g],y=0;y<_;y++)p[y]-=2*m[y];for(f=numeric.getBlock(t,[0,0],[_-1,2]),d=numeric.tensor(numeric.dot(f,r),r),g=0;g<_;g++)for(p=t[g],m=d[g],y=0;y<3;y++)p[y]-=2*m[y];for(f=[b[0],b[1],b[2]],d=numeric.tensor(r,numeric.dot(r,f)),g=0;g<3;g++)for(h=b[g],m=d[g],y=0;y<_;y++)h[y]-=2*m[y];for(v=0;v<_-2;v++){for(y=v;y<=v+1;y++)if(Math.abs(t[y+1][y])<w*(Math.abs(t[y][y])+Math.abs(t[y+1][y+1]))){M=numeric.QRFrancis(numeric.getBlock(t,[0,0],[y,y]),e),S=numeric.QRFrancis(numeric.getBlock(t,[y+1,y+1],[_-1,_-1]),e);for(f=Array(y+1),g=0;g<=y;g++)f[g]=b[g];for(d=numeric.dot(M.Q,f),g=0;g<=y;g++)b[g]=d[g];for(f=Array(_-y-1),g=y+1;g<_;g++)f[g-y-1]=b[g];for(d=numeric.dot(S.Q,f),g=y+1;g<_;g++)b[g]=d[g-y-1];return{Q:b,B:M.B.concat(numeric.add(S.B,y+1))}}for(A=Math.min(_-1,v+3),n=Array(A-v),g=v+1;g<=A;g++)n[g-v-1]=t[g][v];for(r=numeric.house(n),f=numeric.getBlock(t,[v+1,v],[A,_-1]),d=numeric.tensor(r,numeric.dot(r,f)),g=v+1;g<=A;g++)for(p=t[g],m=d[g-v-1],y=v;y<_;y++)p[y]-=2*m[y-v];for(f=numeric.getBlock(t,[0,v+1],[_-1,A]),d=numeric.tensor(numeric.dot(f,r),r),g=0;g<_;g++)for(p=t[g],m=d[g],y=v+1;y<=A;y++)p[y]-=2*m[y-v-1];for(f=Array(A-v),g=v+1;g<=A;g++)f[g-v-1]=b[g];for(d=numeric.tensor(r,numeric.dot(r,f)),g=v+1;g<=A;g++)for(h=b[g],m=d[g-v-1],y=0;y<_;y++)h[y]-=2*m[y]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(t,e){var n,r,i,o,a,s,u,l,c,h,p,f,d,m,g,v,y=numeric.toUpperHessenberg(t),x=numeric.QRFrancis(y.H,e),_=numeric.T,b=t.length,w=x.B,M=numeric.dot(x.Q,numeric.dot(y.H,numeric.transpose(x.Q))),S=new _(numeric.dot(x.Q,y.Q)),T=w.length,E=Math.sqrt;for(r=0;r<T;r++)if((n=w[r][0])===w[r][1]);else{if(o=n+1,a=M[n][n],s=M[n][o],u=M[o][n],l=M[o][o],0===s&&0===u)continue;(h=(c=-a-l)*c-4*(a*l-s*u))>=0?((g=(a-(p=c<0?-.5*(c-E(h)):-.5*(c+E(h))))*(a-p)+s*s)>(v=u*u+(l-p)*(l-p))?(d=(a-p)/(g=E(g)),m=s/g):(d=u/(v=E(v)),m=(l-p)/v),i=new _([[m,-d],[d,m]]),S.setRows(n,o,i.dot(S.getRows(n,o)))):(p=-.5*c,f=.5*E(-h),(g=(a-p)*(a-p)+s*s)>(v=u*u+(l-p)*(l-p))?(d=(a-p)/(g=E(g+f*f)),m=s/g,p=0,f/=g):(d=u/(v=E(v+f*f)),m=(l-p)/v,p=f/v,f=0),i=new _([[m,-d],[d,m]],[[p,f],[f,-p]]),S.setRows(n,o,i.dot(S.getRows(n,o))))}var A=S.dot(t).dot(S.transjugate()),P=(b=t.length,numeric.T.identity(b));for(o=0;o<b;o++)if(o>0)for(r=o-1;r>=0;r--){var C=A.get([r,r]),L=A.get([o,o]);numeric.neq(C.x,L.x)||numeric.neq(C.y,L.y)?(p=A.getRow(r).getBlock([r],[o-1]),f=P.getRow(o).getBlock([r],[o-1]),P.set([o,r],A.get([r,o]).neg().sub(p.dot(f)).div(C.sub(L)))):P.setRow(o,P.getRow(r))}for(o=0;o<b;o++)p=P.getRow(o),P.setRow(o,p.div(p.norm2()));return P=P.transpose(),P=S.transjugate().dot(P),{lambda:A.getDiag(),E:P}},numeric.ccsSparse=function(t){var e,n,r,i=t.length,o=[];for(n=i-1;-1!==n;--n)for(r in e=t[n]){for(r=parseInt(r);r>=o.length;)o[o.length]=0;0!==e[r]&&o[r]++}var a=o.length,s=Array(a+1);for(s[0]=0,n=0;n<a;++n)s[n+1]=s[n]+o[n];var u=Array(s[a]),l=Array(s[a]);for(n=i-1;-1!==n;--n)for(r in e=t[n])0!==e[r]&&(o[r]--,u[s[r]+o[r]]=n,l[s[r]+o[r]]=e[r]);return[s,u,l]},numeric.ccsFull=function(t){var e,n,r,i,o=t[0],a=t[1],s=t[2],u=numeric.ccsDim(t),l=u[0],c=u[1],h=numeric.rep([l,c],0);for(e=0;e<c;e++)for(r=o[e],i=o[e+1],n=r;n<i;++n)h[a[n]][e]=s[n];return h},numeric.ccsTSolve=function(t,e,n,r,i){var o,a,s,u,l,c,h,p=t[0],f=t[1],d=t[2],m=p.length-1,g=Math.max,v=0;function y(t){var e;if(0===n[t]){for(n[t]=1,e=p[t];e<p[t+1];++e)y(f[e]);i[v]=t,++v}}for(void 0===r&&(n=numeric.rep([m],0)),void 0===r&&(r=numeric.linspace(0,n.length-1)),void 0===i&&(i=[]),o=r.length-1;-1!==o;--o)y(r[o]);for(i.length=v,o=i.length-1;-1!==o;--o)n[i[o]]=0;for(o=r.length-1;-1!==o;--o)a=r[o],n[a]=e[a];for(o=i.length-1;-1!==o;--o){for(a=i[o],s=p[a],u=g(p[a+1],s),l=s;l!==u;++l)if(f[l]===a){n[a]/=d[l];break}for(h=n[a],l=s;l!==u;++l)(c=f[l])!==a&&(n[c]-=h*d[l])}return n},numeric.ccsDFS=function(t){this.k=Array(t),this.k1=Array(t),this.j=Array(t)},numeric.ccsDFS.prototype.dfs=function(t,e,n,r,i,o){var a,s,u,l=0,c=i.length,h=this.k,p=this.k1,f=this.j;if(0===r[t])for(r[t]=1,f[0]=t,h[0]=s=e[t],p[0]=u=e[t+1];;)if(s>=u){if(i[c]=f[l],0===l)return;++c,s=h[--l],u=p[l]}else 0===r[a=o[n[s]]]?(r[a]=1,h[l]=s,f[++l]=a,s=e[a],p[l]=u=e[a+1]):++s},numeric.ccsLPSolve=function(t,e,n,r,i,o,a){var s,u,l,c,h,p,f,d,m,g=t[0],v=t[1],y=t[2],x=(g.length,e[0]),_=e[1],b=e[2];for(u=x[i],l=x[i+1],r.length=0,s=u;s<l;++s)a.dfs(o[_[s]],g,v,n,r,o);for(s=r.length-1;-1!==s;--s)n[r[s]]=0;for(s=u;s!==l;++s)n[c=o[_[s]]]=b[s];for(s=r.length-1;-1!==s;--s){for(h=g[c=r[s]],p=g[c+1],f=h;f<p;++f)if(o[v[f]]===c){n[c]/=y[f];break}for(m=n[c],f=h;f<p;++f)(d=o[v[f]])!==c&&(n[d]-=m*y[f])}return n},numeric.ccsLUP1=function(t,e){var n,r,i,o,a,s,u,l=t[0].length-1,c=[numeric.rep([l+1],0),[],[]],h=[numeric.rep([l+1],0),[],[]],p=c[0],f=c[1],d=c[2],m=h[0],g=h[1],v=h[2],y=numeric.rep([l],0),x=numeric.rep([l],0),_=numeric.ccsLPSolve,b=(Math.max,Math.abs),w=numeric.linspace(0,l-1),M=numeric.linspace(0,l-1),S=new numeric.ccsDFS(l);for(void 0===e&&(e=1),n=0;n<l;++n){for(_(c,t,y,x,n,M,S),o=-1,a=-1,r=x.length-1;-1!==r;--r)(i=x[r])<=n||(s=b(y[i]))>o&&(a=i,o=s);for(b(y[n])<e*o&&(r=w[n],o=w[a],w[n]=o,M[o]=n,w[a]=r,M[r]=a,o=y[n],y[n]=y[a],y[a]=o),o=p[n],a=m[n],u=y[n],f[o]=w[n],d[o]=1,++o,r=x.length-1;-1!==r;--r)s=y[i=x[r]],x[r]=0,y[i]=0,i<=n?(g[a]=i,v[a]=s,++a):(f[o]=w[i],d[o]=s/u,++o);p[n+1]=o,m[n+1]=a}for(r=f.length-1;-1!==r;--r)f[r]=M[f[r]];return{L:c,U:h,P:w,Pinv:M}},numeric.ccsDFS0=function(t){this.k=Array(t),this.k1=Array(t),this.j=Array(t)},numeric.ccsDFS0.prototype.dfs=function(t,e,n,r,i,o,a){var s,u,l,c=0,h=i.length,p=this.k,f=this.k1,d=this.j;if(0===r[t])for(r[t]=1,d[0]=t,p[0]=u=e[o[t]],f[0]=l=e[o[t]+1];;){if(isNaN(u))throw new Error("Ow!");if(u>=l){if(i[h]=o[d[c]],0===c)return;++h,u=p[--c],l=f[c]}else 0===r[s=n[u]]?(r[s]=1,p[c]=u,d[++c]=s,u=e[s=o[s]],f[c]=l=e[s+1]):++u}},numeric.ccsLPSolve0=function(t,e,n,r,i,o,a,s){var u,l,c,h,p,f,d,m,g,v=t[0],y=t[1],x=t[2],_=(v.length,e[0]),b=e[1],w=e[2];for(l=_[i],c=_[i+1],r.length=0,u=l;u<c;++u)s.dfs(b[u],v,y,n,r,o,a);for(u=r.length-1;-1!==u;--u)n[a[h=r[u]]]=0;for(u=l;u!==c;++u)n[h=b[u]]=w[u];for(u=r.length-1;-1!==u;--u){for(m=a[h=r[u]],p=v[h],f=v[h+1],d=p;d<f;++d)if(y[d]===m){n[m]/=x[d];break}for(g=n[m],d=p;d<f;++d)n[y[d]]-=g*x[d];n[m]=g}},numeric.ccsLUP0=function(t,e){var n,r,i,o,a,s,u,l=t[0].length-1,c=[numeric.rep([l+1],0),[],[]],h=[numeric.rep([l+1],0),[],[]],p=c[0],f=c[1],d=c[2],m=h[0],g=h[1],v=h[2],y=numeric.rep([l],0),x=numeric.rep([l],0),_=numeric.ccsLPSolve0,b=(Math.max,Math.abs),w=numeric.linspace(0,l-1),M=numeric.linspace(0,l-1),S=new numeric.ccsDFS0(l);for(void 0===e&&(e=1),n=0;n<l;++n){for(_(c,t,y,x,n,M,w,S),o=-1,a=-1,r=x.length-1;-1!==r;--r)(i=x[r])<=n||(s=b(y[w[i]]))>o&&(a=i,o=s);for(b(y[w[n]])<e*o&&(r=w[n],o=w[a],w[n]=o,M[o]=n,w[a]=r,M[r]=a),o=p[n],a=m[n],u=y[w[n]],f[o]=w[n],d[o]=1,++o,r=x.length-1;-1!==r;--r)s=y[w[i=x[r]]],x[r]=0,y[w[i]]=0,i<=n?(g[a]=i,v[a]=s,++a):(f[o]=w[i],d[o]=s/u,++o);p[n+1]=o,m[n+1]=a}for(r=f.length-1;-1!==r;--r)f[r]=M[f[r]];return{L:c,U:h,P:w,Pinv:M}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(t){return[numeric.sup(t[1])+1,t[0].length-1]},numeric.ccsGetBlock=function(t,e,n){var r=numeric.ccsDim(t),i=r[0],o=r[1];void 0===e?e=numeric.linspace(0,i-1):"number"==typeof e&&(e=[e]),void 0===n?n=numeric.linspace(0,o-1):"number"==typeof n&&(n=[n]);var a,s,u,l,c=e.length,h=n.length,p=numeric.rep([o],0),f=[],d=[],m=[p,f,d],g=t[0],v=t[1],y=t[2],x=numeric.rep([i],0),_=0,b=numeric.rep([i],0);for(s=0;s<h;++s){var w=g[l=n[s]],M=g[l+1];for(a=w;a<M;++a)b[u=v[a]]=1,x[u]=y[a];for(a=0;a<c;++a)b[e[a]]&&(f[_]=a,d[_]=x[e[a]],++_);for(a=w;a<M;++a)b[u=v[a]]=0;p[s+1]=_}return m},numeric.ccsDot=function(t,e){var n,r,i,o,a,s,u,l,c,h,p,f=t[0],d=t[1],m=t[2],g=e[0],v=e[1],y=e[2],x=numeric.ccsDim(t),_=numeric.ccsDim(e),b=x[0],w=(x[1],_[1]),M=numeric.rep([b],0),S=numeric.rep([b],0),T=Array(b),E=numeric.rep([w],0),A=[],P=[],C=[E,A,P];for(i=0;i!==w;++i){for(o=g[i],a=g[i+1],c=0,r=o;r<a;++r)for(h=v[r],p=y[r],s=f[h],u=f[h+1],n=s;n<u;++n)0===S[l=d[n]]&&(T[c]=l,S[l]=1,c+=1),M[l]=M[l]+m[n]*p;for(a=(o=E[i])+c,E[i+1]=a,r=c-1;-1!==r;--r)p=o+r,n=T[r],A[p]=n,P[p]=M[n],S[n]=0,M[n]=0;E[i+1]=E[i]+c}return C},numeric.ccsLUPSolve=function(t,e){var n=t.L,r=t.U,i=(t.P,e[0]),o=!1;"object"!=typeof i&&(i=(e=[[0,e.length],numeric.linspace(0,e.length-1),e])[0],o=!0);var a,s,u,l,c,h,p=e[1],f=e[2],d=n[0].length-1,m=i.length-1,g=numeric.rep([d],0),v=Array(d),y=numeric.rep([d],0),x=Array(d),_=numeric.rep([m+1],0),b=[],w=[],M=numeric.ccsTSolve,S=0;for(a=0;a<m;++a){for(c=0,u=i[a],l=i[a+1],s=u;s<l;++s)h=t.Pinv[p[s]],x[c]=h,y[h]=f[s],++c;for(x.length=c,M(n,y,g,x,v),s=x.length-1;-1!==s;--s)y[x[s]]=0;if(M(r,g,y,v,x),o)return y;for(s=v.length-1;-1!==s;--s)g[v[s]]=0;for(s=x.length-1;-1!==s;--s)h=x[s],b[S]=h,w[S]=y[h],y[h]=0,++S;_[a+1]=S}return[_,b,w]},numeric.ccsbinop=function(t,e){return void 0===e&&(e=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+e+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+t+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(t){var e,n=t[0],r=t[1],i=t[2],o=numeric.sup(r)+1,a=n.length,s=numeric.rep([o],0),u=Array(a),l=Array(a),c=numeric.rep([o],0);for(e=0;e<a;++e)c[r[e]]++;for(e=0;e<o;++e)s[e+1]=s[e]+c[e];var h,p,f=s.slice(0);for(e=0;e<a;++e)u[h=f[p=r[e]]]=n[e],l[h]=i[e],f[p]=f[p]+1;return[s,u,l]},numeric.ccsGather=function(t){var e,n,r,i,o,a=t[0],s=t[1],u=t[2],l=a.length-1,c=s.length,h=Array(c),p=Array(c),f=Array(c);for(o=0,e=0;e<l;++e)for(r=a[e],i=a[e+1],n=r;n!==i;++n)p[o]=e,h[o]=s[n],f[o]=u[n],++o;return[h,p,f]},numeric.sdim=function t(e,n,r){if(void 0===n&&(n=[]),"object"!=typeof e)return n;var i;for(i in void 0===r&&(r=0),r in n||(n[r]=0),e.length>n[r]&&(n[r]=e.length),e)e.hasOwnProperty(i)&&t(e[i],n,r+1);return n},numeric.sclone=function t(e,n,r){void 0===n&&(n=0),void 0===r&&(r=numeric.sdim(e).length);var i,o=Array(e.length);if(n===r-1){for(i in e)e.hasOwnProperty(i)&&(o[i]=e[i]);return o}for(i in e)e.hasOwnProperty(i)&&(o[i]=t(e[i],n+1,r));return o},numeric.sdiag=function(t){var e,n,r=t.length,i=Array(r);for(e=r-1;e>=1;e-=2)n=e-1,i[e]=[],i[e][e]=t[e],i[n]=[],i[n][n]=t[n];return 0===e&&(i[0]=[],i[0][0]=t[e]),i},numeric.sidentity=function(t){return numeric.sdiag(numeric.rep([t],1))},numeric.stranspose=function(t){var e,n,r,i=[];t.length;for(e in t)if(t.hasOwnProperty(e))for(n in r=t[e])r.hasOwnProperty(n)&&("object"!=typeof i[n]&&(i[n]=[]),i[n][e]=r[n]);return i},numeric.sLUP=function(t,e){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(t,e){var n,r,i,o,a,s,u,l=t.length,c=(e.length,numeric.stranspose(e)),h=c.length,p=Array(l);for(i=l-1;i>=0;i--){for(u=[],n=t[i],a=h-1;a>=0;a--){for(o in s=0,r=c[a],n)n.hasOwnProperty(o)&&o in r&&(s+=n[o]*r[o]);s&&(u[a]=s)}p[i]=u}return p},numeric.sdotMV=function(t,e){var n,r,i,o,a=t.length,s=Array(a);for(r=a-1;r>=0;r--){for(i in o=0,n=t[r])n.hasOwnProperty(i)&&e[i]&&(o+=n[i]*e[i]);o&&(s[r]=o)}return s},numeric.sdotVM=function(t,e){var n,r,i,o,a=[];for(n in t)if(t.hasOwnProperty(n))for(r in i=e[n],o=t[n],i)i.hasOwnProperty(r)&&(a[r]||(a[r]=0),a[r]+=o*i[r]);return a},numeric.sdotVV=function(t,e){var n,r=0;for(n in t)t[n]&&e[n]&&(r+=t[n]*e[n]);return r},numeric.sdot=function(t,e){var n=numeric.sdim(t).length,r=numeric.sdim(e).length;switch(1e3*n+r){case 0:return t*e;case 1001:return numeric.sdotVV(t,e);case 2001:return numeric.sdotMV(t,e);case 1002:return numeric.sdotVM(t,e);case 2002:return numeric.sdotMM(t,e);default:throw new Error("numeric.sdot not implemented for tensors of order "+n+" and "+r)}},numeric.sscatter=function(t){var e,n,r,i,o=t[0].length,a=t.length,s=[];for(n=o-1;n>=0;--n)if(t[a-1][n]){for(i=s,r=0;r<a-2;r++)i[e=t[r][n]]||(i[e]=[]),i=i[e];i[t[r][n]]=t[r+1][n]}return s},numeric.sgather=function t(e,n,r){var i,o,a;for(o in void 0===n&&(n=[]),void 0===r&&(r=[]),i=r.length,e)if(e.hasOwnProperty(o))if(r[i]=parseInt(o),"number"==typeof(a=e[o])){if(a){if(0===n.length)for(o=i+1;o>=0;--o)n[o]=[];for(o=i;o>=0;--o)n[o].push(r[o]);n[i+1].push(a)}}else t(a,n,r);return r.length>i&&r.pop(),n},numeric.cLU=function(t){var e,n,r,i,o,a,s=t[0],u=t[1],l=t[2],c=s.length,h=0;for(e=0;e<c;e++)s[e]>h&&(h=s[e]);h++;var p,f=Array(h),d=Array(h),m=numeric.rep([h],1/0),g=numeric.rep([h],-1/0);for(r=0;r<c;r++)e=s[r],(n=u[r])<m[e]&&(m[e]=n),n>g[e]&&(g[e]=n);for(e=0;e<h-1;e++)g[e]>g[e+1]&&(g[e+1]=g[e]);for(e=h-1;e>=1;e--)m[e]<m[e-1]&&(m[e-1]=m[e]);for(e=0;e<h;e++)d[e]=numeric.rep([g[e]-m[e]+1],0),f[e]=numeric.rep([e-m[e]],0),e-m[e]+1,g[e]-e+1;for(r=0;r<c;r++)d[e=s[r]][u[r]-m[e]]=l[r];for(e=0;e<h-1;e++)for(i=e-m[e],x=d[e],n=e+1;m[n]<=e&&n<h;n++)if(o=e-m[n],a=g[e]-e,p=(_=d[n])[o]/x[i]){for(r=1;r<=a;r++)_[r+o]-=p*x[r+i];f[n][e-m[n]]=p}var v,y,x=[],_=[],b=[],w=[],M=[],S=[];for(c=0,v=0,e=0;e<h;e++){for(i=m[e],o=g[e],y=d[e],n=e;n<=o;n++)y[n-i]&&(x[c]=e,_[c]=n,b[c]=y[n-i],c++);for(y=f[e],n=i;n<e;n++)y[n-i]&&(w[v]=e,M[v]=n,S[v]=y[n-i],v++);w[v]=e,M[v]=e,S[v]=1,v++}return{U:[x,_,b],L:[w,M,S]}},numeric.cLUsolve=function(t,e){var n,r,i=t.L,o=t.U,a=numeric.clone(e),s=i[0],u=i[1],l=i[2],c=o[0],h=o[1],p=o[2],f=c.length,d=(s.length,a.length);for(r=0,n=0;n<d;n++){for(;u[r]<n;)a[n]-=l[r]*a[u[r]],r++;r++}for(r=f-1,n=d-1;n>=0;n--){for(;h[r]>n;)a[n]-=p[r]*a[h[r]],r--;a[n]/=p[r],r--}return a},numeric.cgrid=function(t,e){"number"==typeof t&&(t=[t,t]);var n,r,i,o=numeric.rep(t,-1);if("function"!=typeof e)if("L"===e)e=function(e,n){return e>=t[0]/2||n<t[1]/2};else e=function(t,e){return!0};for(i=0,n=1;n<t[0]-1;n++)for(r=1;r<t[1]-1;r++)e(n,r)&&(o[n][r]=i,i++);return o},numeric.cdelsq=function(t){var e,n,r,i,o,a=[[-1,0],[0,-1],[0,1],[1,0]],s=numeric.dim(t),u=s[0],l=s[1],c=[],h=[],p=[];for(e=1;e<u-1;e++)for(n=1;n<l-1;n++)if(!(t[e][n]<0)){for(r=0;r<4;r++)i=e+a[r][0],o=n+a[r][1],t[i][o]<0||(c.push(t[e][n]),h.push(t[i][o]),p.push(-1));c.push(t[e][n]),h.push(t[e][n]),p.push(4)}return[c,h,p]},numeric.cdotMV=function(t,e){var n,r,i,o=t[0],a=t[1],s=t[2],u=o.length;for(i=0,r=0;r<u;r++)o[r]>i&&(i=o[r]);for(i++,n=numeric.rep([i],0),r=0;r<u;r++)n[o[r]]+=s[r]*e[a[r]];return n},numeric.Spline=function(t,e,n,r,i){this.x=t,this.yl=e,this.yr=n,this.kl=r,this.kr=i},numeric.Spline.prototype._at=function(t,e){var n,r,i,o=this.x,a=this.yl,s=this.yr,u=this.kl,l=this.kr,c=numeric.add,h=numeric.sub,p=numeric.mul;n=h(p(u[e],o[e+1]-o[e]),h(s[e+1],a[e])),r=c(p(l[e+1],o[e]-o[e+1]),h(s[e+1],a[e]));var f=(i=(t-o[e])/(o[e+1]-o[e]))*(1-i);return c(c(c(p(1-i,a[e]),p(i,s[e+1])),p(n,f*(1-i))),p(r,f*i))},numeric.Spline.prototype.at=function(t){if("number"==typeof t){var e,n,r,i=this.x,o=i.length,a=Math.floor;for(e=0,n=o-1;n-e>1;)i[r=a((e+n)/2)]<=t?e=r:n=r;return this._at(t,e)}o=t.length;var s,u=Array(o);for(s=o-1;-1!==s;--s)u[s]=this.at(t[s]);return u},numeric.Spline.prototype.diff=function(){var t,e,n,r=this.x,i=this.yl,o=this.yr,a=this.kl,s=this.kr,u=i.length,l=a,c=s,h=Array(u),p=Array(u),f=numeric.add,d=numeric.mul,m=numeric.div,g=numeric.sub;for(t=u-1;-1!==t;--t)e=r[t+1]-r[t],n=g(o[t+1],i[t]),h[t]=m(f(d(n,6),d(a[t],-4*e),d(s[t+1],-2*e)),e*e),p[t+1]=m(f(d(n,-6),d(a[t],2*e),d(s[t+1],4*e)),e*e);return new numeric.Spline(r,l,c,h,p)},numeric.Spline.prototype.roots=function(){function t(t){return t*t}var e=[],n=this.x,r=this.yl,i=this.yr,o=this.kl,a=this.kr;"number"==typeof r[0]&&(r=[r],i=[i],o=[o],a=[a]);var s,u,l,c,h,p,f,d,m,g,v,y,x,_,b,w,M,S,T,E,A,P,C,L=r.length,I=n.length-1,O=(e=Array(L),Math.sqrt);for(s=0;s!==L;++s){for(c=r[s],h=i[s],p=o[s],f=a[s],d=[],u=0;u!==I;u++){for(u>0&&h[u]*c[u]<0&&d.push(n[u]),w=n[u+1]-n[u],n[u],v=c[u],y=h[u+1],m=p[u]/w,x=(g=f[u+1]/w)+3*v+2*m-3*y,_=3*(g+m+2*(v-y)),(b=t(m-g+3*(v-y))+12*g*v)<=0?M=(S=x/_)>n[u]&&S<n[u+1]?[n[u],S,n[u+1]]:[n[u],n[u+1]]:(S=(x-O(b))/_,T=(x+O(b))/_,M=[n[u]],S>n[u]&&S<n[u+1]&&M.push(S),T>n[u]&&T<n[u+1]&&M.push(T),M.push(n[u+1])),A=M[0],S=this._at(A,u),l=0;l<M.length-1;l++)if(P=M[l+1],T=this._at(P,u),0!==S)if(0===T||S*T>0)A=P,S=T;else{for(var N=0;!((C=(S*P-T*A)/(S-T))<=A||C>=P);)if((E=this._at(C,u))*T>0)P=C,T=E,-1===N&&(S*=.5),N=-1;else{if(!(E*S>0))break;A=C,S=E,1===N&&(T*=.5),N=1}d.push(C),A=M[l+1],S=this._at(A,u)}else d.push(A),A=P,S=T;0===T&&d.push(P)}e[s]=d}return"number"==typeof this.yl[0]?e[0]:e},numeric.spline=function(t,e,n,r){var i,o=t.length,a=[],s=[],u=[],l=numeric.sub,c=numeric.mul,h=numeric.add;for(i=o-2;i>=0;i--)s[i]=t[i+1]-t[i],u[i]=l(e[i+1],e[i]);"string"!=typeof n&&"string"!=typeof r||(n=r="periodic");var p=[[],[],[]];switch(typeof n){case"undefined":a[0]=c(3/(s[0]*s[0]),u[0]),p[0].push(0,0),p[1].push(0,1),p[2].push(2/s[0],1/s[0]);break;case"string":a[0]=h(c(3/(s[o-2]*s[o-2]),u[o-2]),c(3/(s[0]*s[0]),u[0])),p[0].push(0,0,0),p[1].push(o-2,0,1),p[2].push(1/s[o-2],2/s[o-2]+2/s[0],1/s[0]);break;default:a[0]=n,p[0].push(0),p[1].push(0),p[2].push(1)}for(i=1;i<o-1;i++)a[i]=h(c(3/(s[i-1]*s[i-1]),u[i-1]),c(3/(s[i]*s[i]),u[i])),p[0].push(i,i,i),p[1].push(i-1,i,i+1),p[2].push(1/s[i-1],2/s[i-1]+2/s[i],1/s[i]);switch(typeof r){case"undefined":a[o-1]=c(3/(s[o-2]*s[o-2]),u[o-2]),p[0].push(o-1,o-1),p[1].push(o-2,o-1),p[2].push(1/s[o-2],2/s[o-2]);break;case"string":p[1][p[1].length-1]=0;break;default:a[o-1]=r,p[0].push(o-1),p[1].push(o-1),p[2].push(1)}a="number"!=typeof a[0]?numeric.transpose(a):[a];var f=Array(a.length);if("string"==typeof n)for(i=f.length-1;-1!==i;--i)f[i]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(p)),a[i]),f[i][o-1]=f[i][0];else for(i=f.length-1;-1!==i;--i)f[i]=numeric.cLUsolve(numeric.cLU(p),a[i]);return f="number"==typeof e[0]?f[0]:numeric.transpose(f),new numeric.Spline(t,e,e,f,f)},numeric.fftpow2=function t(e,n){var r=e.length;if(1!==r){var i,o,a=Math.cos,s=Math.sin,u=Array(r/2),l=Array(r/2),c=Array(r/2),h=Array(r/2);for(o=r/2,i=r-1;-1!==i;--i)c[--o]=e[i],h[o]=n[i],--i,u[o]=e[i],l[o]=n[i];t(u,l),t(c,h),o=r/2;var p,f,d,m=-6.283185307179586/r;for(i=r-1;-1!==i;--i)-1===--o&&(o=r/2-1),f=a(p=m*i),d=s(p),e[i]=u[o]+f*c[o]-d*h[o],n[i]=l[o]+f*h[o]+d*c[o]}},numeric._ifftpow2=function t(e,n){var r=e.length;if(1!==r){var i,o,a=Math.cos,s=Math.sin,u=Array(r/2),l=Array(r/2),c=Array(r/2),h=Array(r/2);for(o=r/2,i=r-1;-1!==i;--i)c[--o]=e[i],h[o]=n[i],--i,u[o]=e[i],l[o]=n[i];t(u,l),t(c,h),o=r/2;var p,f,d,m=6.283185307179586/r;for(i=r-1;-1!==i;--i)-1===--o&&(o=r/2-1),f=a(p=m*i),d=s(p),e[i]=u[o]+f*c[o]-d*h[o],n[i]=l[o]+f*h[o]+d*c[o]}},numeric.ifftpow2=function(t,e){numeric._ifftpow2(t,e),numeric.diveq(t,t.length),numeric.diveq(e,e.length)},numeric.convpow2=function(t,e,n,r){var i,o,a,s,u;for(numeric.fftpow2(t,e),numeric.fftpow2(n,r),i=t.length-1;-1!==i;--i)o=t[i],s=e[i],a=n[i],u=r[i],t[i]=o*a-s*u,e[i]=o*u+s*a;numeric.ifftpow2(t,e)},numeric.T.prototype.fft=function(){var t,e,n=this.x,r=this.y,i=n.length,o=Math.log,a=o(2),s=Math.ceil(o(2*i-1)/a),u=Math.pow(2,s),l=numeric.rep([u],0),c=numeric.rep([u],0),h=Math.cos,p=Math.sin,f=-3.141592653589793/i,d=numeric.rep([u],0),m=numeric.rep([u],0);Math.floor(i/2);for(t=0;t<i;t++)d[t]=n[t];if(void 0!==r)for(t=0;t<i;t++)m[t]=r[t];for(l[0]=1,t=1;t<=u/2;t++)e=f*t*t,l[t]=h(e),c[t]=p(e),l[u-t]=h(e),c[u-t]=p(e);var g=new numeric.T(d,m),v=new numeric.T(l,c);return g=g.mul(v),numeric.convpow2(g.x,g.y,numeric.clone(v.x),numeric.neg(v.y)),(g=g.mul(v)).x.length=i,g.y.length=i,g},numeric.T.prototype.ifft=function(){var t,e,n=this.x,r=this.y,i=n.length,o=Math.log,a=o(2),s=Math.ceil(o(2*i-1)/a),u=Math.pow(2,s),l=numeric.rep([u],0),c=numeric.rep([u],0),h=Math.cos,p=Math.sin,f=3.141592653589793/i,d=numeric.rep([u],0),m=numeric.rep([u],0);Math.floor(i/2);for(t=0;t<i;t++)d[t]=n[t];if(void 0!==r)for(t=0;t<i;t++)m[t]=r[t];for(l[0]=1,t=1;t<=u/2;t++)e=f*t*t,l[t]=h(e),c[t]=p(e),l[u-t]=h(e),c[u-t]=p(e);var g=new numeric.T(d,m),v=new numeric.T(l,c);return g=g.mul(v),numeric.convpow2(g.x,g.y,numeric.clone(v.x),numeric.neg(v.y)),(g=g.mul(v)).x.length=i,g.y.length=i,g.div(i)},numeric.gradient=function(t,e){var n=e.length,r=t(e);if(isNaN(r))throw new Error("gradient: f(x) is a NaN!");var i,o,a,s,u,l,c,h,p,f=Math.max,d=numeric.clone(e),m=Array(n),g=(numeric.div,numeric.sub,f=Math.max,Math.abs),v=Math.min,y=0;for(i=0;i<n;i++)for(var x=f(1e-6*r,1e-8);;){if(++y>20)throw new Error("Numerical gradient fails");if(d[i]=e[i]+x,o=t(d),d[i]=e[i]-x,a=t(d),d[i]=e[i],isNaN(o)||isNaN(a))x/=16;else{if(m[i]=(o-a)/(2*x),s=e[i]-x,u=e[i],l=e[i]+x,c=(o-r)/x,h=(r-a)/x,p=f(g(m[i]),g(r),g(o),g(a),g(s),g(u),g(l),1e-8),!(v(f(g(c-m[i]),g(h-m[i]),g(c-h))/p,x/p)>.001))break;x/=16}}return m},numeric.uncmin=function(t,e,n,r,i,o,a){var s=numeric.gradient;void 0===a&&(a={}),void 0===n&&(n=1e-8),void 0===r&&(r=function(e){return s(t,e)}),void 0===i&&(i=1e3);var u,l,c=(e=numeric.clone(e)).length,h=t(e);if(isNaN(h))throw new Error("uncmin: f(x0) is a NaN!");var p=Math.max,f=numeric.norm2;n=p(n,numeric.epsilon);var d,m,g,v,y,x,_,b,w,M,S=a.Hinv||numeric.identity(c),T=numeric.dot,E=(numeric.inv,numeric.sub),A=numeric.add,P=numeric.tensor,C=numeric.div,L=numeric.mul,I=numeric.all,O=numeric.isFinite,N=numeric.neg,R=0,D="";for(m=r(e);R<i;){if("function"==typeof o&&o(R,e,h,m,S)){D="Callback returned true";break}if(!I(O(m))){D="Gradient has Infinity or NaN";break}if(!I(O(d=N(T(S,m))))){D="Search direction has Infinity or NaN";break}if((M=f(d))<n){D="Newton step smaller than tol";break}for(w=1,l=T(m,d),y=e;R<i&&!(w*M<n)&&(y=A(e,v=L(d,w)),(u=t(y))-h>=.1*w*l||isNaN(u));)w*=.5,++R;if(w*M<n){D="Line search step size smaller than tol";break}if(R===i){D="maxit reached during line search";break}b=T(x=E(g=r(y),m),v),_=T(S,x),S=E(A(S,L((b+T(x,_))/(b*b),P(v,v))),C(A(P(_,v),P(v,_)),b)),e=y,h=u,m=g,++R}return{solution:e,f:h,gradient:m,invHessian:S,iterations:R,message:D}},numeric.Dopri=function(t,e,n,r,i,o,a){this.x=t,this.y=e,this.f=n,this.ymid=r,this.iterations=i,this.events=a,this.message=o},numeric.Dopri.prototype._at=function(t,e){function n(t){return t*t}var r,i,o,a,s,u,l,c,h,p=this,f=p.x,d=p.y,m=p.f,g=p.ymid,v=(f.length,Math.floor,numeric.add),y=numeric.mul,x=numeric.sub;return r=f[e],i=f[e+1],a=d[e],s=d[e+1],o=r+.5*(i-r),u=g[e],l=x(m[e],y(a,1/(r-o)+2/(r-i))),c=x(m[e+1],y(s,1/(i-o)+2/(i-r))),v(v(v(v(y(a,(h=[n(t-i)*(t-o)/n(r-i)/(r-o),n(t-r)*n(t-i)/n(r-o)/n(i-o),n(t-r)*(t-o)/n(i-r)/(i-o),(t-r)*n(t-i)*(t-o)/n(r-i)/(r-o),(t-i)*n(t-r)*(t-o)/n(r-i)/(i-o)])[0]),y(u,h[1])),y(s,h[2])),y(l,h[3])),y(c,h[4]))},numeric.Dopri.prototype.at=function(t){var e,n,r,i=Math.floor;if("number"!=typeof t){var o=t.length,a=Array(o);for(e=o-1;-1!==e;--e)a[e]=this.at(t[e]);return a}var s=this.x;for(e=0,n=s.length-1;n-e>1;)s[r=i(.5*(e+n))]<=t?e=r:n=r;return this._at(t,e)},numeric.dopri=function(t,e,n,r,i,o,a){void 0===i&&(i=1e-6),void 0===o&&(o=1e3);var s,u,l,c,h,p,f,d,m,g,v,y,x,_=[t],b=[n],w=[r(t,n)],M=[],S=[3/40,9/40],T=[44/45,-56/15,32/9],E=[19372/6561,-25360/2187,64448/6561,-212/729],A=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],P=[35/384,0,500/1113,125/192,-2187/6784,11/84],C=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,5618549.5/235043384],L=[.2,.3,.8,8/9,1,1],I=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,1/40],O=0,N=(e-t)/10,R=0,D=numeric.add,k=numeric.mul,F=(Math.max,Math.min),B=Math.abs,U=numeric.norminf,z=Math.pow,V=numeric.any,G=numeric.lt,j=numeric.and,W=(numeric.sub,new numeric.Dopri(_,b,w,M,-1,""));for("function"==typeof a&&(v=a(t,n));t<e&&R<o;)if(++R,t+N>e&&(N=e-t),s=r(t+L[0]*N,D(n,k(.2*N,w[O]))),u=r(t+L[1]*N,D(D(n,k(S[0]*N,w[O])),k(S[1]*N,s))),l=r(t+L[2]*N,D(D(D(n,k(T[0]*N,w[O])),k(T[1]*N,s)),k(T[2]*N,u))),c=r(t+L[3]*N,D(D(D(D(n,k(E[0]*N,w[O])),k(E[1]*N,s)),k(E[2]*N,u)),k(E[3]*N,l))),h=r(t+L[4]*N,D(D(D(D(D(n,k(A[0]*N,w[O])),k(A[1]*N,s)),k(A[2]*N,u)),k(A[3]*N,l)),k(A[4]*N,c))),p=r(t+N,m=D(D(D(D(D(n,k(w[O],N*P[0])),k(u,N*P[2])),k(l,N*P[3])),k(c,N*P[4])),k(h,N*P[5]))),(g="number"==typeof(f=D(D(D(D(D(k(w[O],N*I[0]),k(u,N*I[2])),k(l,N*I[3])),k(c,N*I[4])),k(h,N*I[5])),k(p,N*I[6])))?B(f):U(f))>i){if(t+(N=.2*N*z(i/g,.25))===t){W.msg="Step size became too small";break}}else{if(M[O]=D(D(D(D(D(D(n,k(w[O],N*C[0])),k(u,N*C[2])),k(l,N*C[3])),k(c,N*C[4])),k(h,N*C[5])),k(p,N*C[6])),_[++O]=t+N,b[O]=m,w[O]=p,"function"==typeof a){var H,X,Y=t,q=t+.5*N;if(y=a(q,M[O-1]),V(x=j(G(v,0),G(0,y)))||(Y=q,v=y,y=a(q=t+N,m),x=j(G(v,0),G(0,y))),V(x)){for(var Z,J,K=0,Q=1,$=1;;){if("number"==typeof v)X=($*y*Y-Q*v*q)/($*y-Q*v);else for(X=q,d=v.length-1;-1!==d;--d)v[d]<0&&y[d]>0&&(X=F(X,($*y[d]*Y-Q*v[d]*q)/($*y[d]-Q*v[d])));if(X<=Y||X>=q)break;J=a(X,H=W._at(X,O-1)),V(Z=j(G(v,0),G(0,J)))?(q=X,y=J,x=Z,$=1,-1===K?Q*=.5:Q=1,K=-1):(Y=X,v=J,Q=1,1===K?$*=.5:$=1,K=1)}return m=W._at(.5*(t+X),O-1),W.f[O]=r(X,H),W.x[O]=X,W.y[O]=H,W.ymid[O-1]=m,W.events=x,W.iterations=R,W}}t+=N,n=m,v=y,N=F(.8*N*z(i/g,.25),4*N)}return W.iterations=R,W},numeric.LU=function(t,e){e=e||!1;var n,r,i,o,a,s,u,l,c,h=Math.abs,p=t.length,f=p-1,d=new Array(p);for(e||(t=numeric.clone(t)),i=0;i<p;++i){for(u=i,c=h((s=t[i])[i]),r=i+1;r<p;++r)c<(o=h(t[r][i]))&&(c=o,u=r);for(d[i]=u,u!=i&&(t[i]=t[u],t[u]=s,s=t[i]),a=s[i],n=i+1;n<p;++n)t[n][i]/=a;for(n=i+1;n<p;++n){for(l=t[n],r=i+1;r<f;++r)l[r]-=l[i]*s[r],l[++r]-=l[i]*s[r];r===f&&(l[r]-=l[i]*s[r])}}return{LU:t,P:d}},numeric.LUsolve=function(t,e){var n,r,i,o,a,s=t.LU,u=s.length,l=numeric.clone(e),c=t.P;for(n=u-1;-1!==n;--n)l[n]=e[n];for(n=0;n<u;++n)for(i=c[n],c[n]!==n&&(a=l[n],l[n]=l[i],l[i]=a),o=s[n],r=0;r<n;++r)l[n]-=l[r]*o[r];for(n=u-1;n>=0;--n){for(o=s[n],r=n+1;r<u;++r)l[n]-=l[r]*o[r];l[n]/=o[n]}return l},numeric.solve=function(t,e,n){return numeric.LUsolve(numeric.LU(t,n),e)},numeric.echelonize=function(t){var e,n,r,i,o,a,s,u,l=numeric.dim(t),c=l[0],h=l[1],p=numeric.identity(c),f=Array(c),d=Math.abs,m=numeric.diveq;for(t=numeric.clone(t),e=0;e<c;++e){for(r=0,o=t[e],a=p[e],n=1;n<h;++n)d(o[r])<d(o[n])&&(r=n);for(f[e]=r,m(a,o[r]),m(o,o[r]),n=0;n<c;++n)if(n!==e){for(u=(s=t[n])[r],i=h-1;-1!==i;--i)s[i]-=o[i]*u;for(s=p[n],i=c-1;-1!==i;--i)s[i]-=a[i]*u}}return{I:p,A:t,P:f}},numeric.__solveLP=function(t,e,n,r,i,o,a){var s,u,l,c,h=numeric.sum,p=(numeric.log,numeric.mul),f=numeric.sub,d=numeric.dot,m=numeric.div,g=numeric.add,v=t.length,y=n.length,x=!1,_=1,b=(numeric.transpose(e),numeric.svd,numeric.transpose),w=(numeric.leq,Math.sqrt),M=Math.abs,S=(numeric.muleq,numeric.norminf,numeric.any,Math.min),T=numeric.all,E=numeric.gt,A=Array(v),P=Array(y),C=(numeric.rep([y],1),numeric.solve),L=f(n,d(e,o)),I=d(t,t);for(l=0;l<i;++l){var O,N;for(O=y-1;-1!==O;--O)P[O]=m(e[O],L[O]);var R=b(P);for(O=v-1;-1!==O;--O)A[O]=h(R[O]);_=.25*M(I/d(t,A));var D=100*w(I/d(A,A));for((!isFinite(_)||_>D)&&(_=D),c=g(t,p(_,A)),u=d(R,P),O=v-1;-1!==O;--O)u[O][O]+=1;N=C(u,m(c,_),!0);var k=m(L,d(e,N)),F=1;for(O=y-1;-1!==O;--O)k[O]<0&&(F=S(F,-.999*k[O]));if(s=f(o,p(N,F)),!T(E(L=f(n,d(e,s)),0)))return{solution:o,message:"",iterations:l};if(o=s,_<r)return{solution:s,message:"",iterations:l};if(a){var B=d(t,c),U=d(e,c);for(x=!0,O=y-1;-1!==O;--O)if(B*U[O]<0){x=!1;break}}else x=!(o[v-1]>=0);if(x)return{solution:s,message:"Unbounded",iterations:l}}return{solution:o,message:"maximum iteration count exceeded",iterations:l}},numeric._solveLP=function(t,e,n,r,i){var o=t.length,a=n.length,s=(numeric.sum,numeric.log,numeric.mul,numeric.sub),u=numeric.dot,l=(numeric.div,numeric.add,numeric.rep([o],0).concat([1])),c=numeric.rep([a,1],-1),h=numeric.blockMatrix([[e,c]]),p=n,f=numeric.rep([o],0).concat(Math.max(0,numeric.sup(numeric.neg(n)))+1),d=numeric.__solveLP(l,h,p,r,i,f,!1),m=numeric.clone(d.solution);if(m.length=o,numeric.inf(s(n,u(e,m)))<0)return{solution:NaN,message:"Infeasible",iterations:d.iterations};var g=numeric.__solveLP(t,e,n,r,i-d.iterations,m,!0);return g.iterations+=d.iterations,g},numeric.solveLP=function(t,e,n,r,i,o,a){if(void 0===a&&(a=1e3),void 0===o&&(o=numeric.epsilon),void 0===r)return numeric._solveLP(t,e,n,o,a);var s,u=r.length,l=r[0].length,c=e.length,h=numeric.echelonize(r),p=numeric.rep([l],0),f=h.P,d=[];for(s=f.length-1;-1!==s;--s)p[f[s]]=1;for(s=l-1;-1!==s;--s)0===p[s]&&d.push(s);var m=numeric.getRange,g=numeric.linspace(0,u-1),v=numeric.linspace(0,c-1),y=m(r,g,d),x=m(e,v,f),_=m(e,v,d),b=numeric.dot,w=numeric.sub,M=b(x,h.I),S=w(_,b(M,y)),T=w(n,b(M,i)),E=Array(f.length),A=Array(d.length);for(s=f.length-1;-1!==s;--s)E[s]=t[f[s]];for(s=d.length-1;-1!==s;--s)A[s]=t[d[s]];var P=w(A,b(E,b(h.I,y))),C=numeric._solveLP(P,S,T,o,a),L=C.solution;if(L!=L)return C;var I=b(h.I,w(i,b(y,L))),O=Array(t.length);for(s=f.length-1;-1!==s;--s)O[f[s]]=I[s];for(s=d.length-1;-1!==s;--s)O[d[s]]=L[s];return{solution:O,message:C.message,iterations:C.iterations}},numeric.MPStoLP=function(t){t instanceof String&&t.split("\n");var e,n,r,i,o=0,a=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],s=t.length,u=0,l={},c=[],h=0,p={},f=0,d=[],m=[],g=[];function v(n){throw new Error("MPStoLP: "+n+"\nLine "+e+": "+t[e]+"\nCurrent state: "+a[o]+"\n")}for(e=0;e<s;++e){var y=(r=t[e]).match(/\S*/g),x=[];for(n=0;n<y.length;++n)""!==y[n]&&x.push(y[n]);if(0!==x.length){for(n=0;n<a.length&&r.substr(0,a[n].length)!==a[n];++n);if(n<a.length){if(o=n,1===n&&(i=x[1]),6===n)return{name:i,c:d,A:numeric.transpose(m),b:g,rows:l,vars:p}}else switch(o){case 0:case 1:v("Unexpected line");case 2:switch(x[0]){case"N":0===u?u=x[1]:v("Two or more N rows");break;case"L":l[x[1]]=h,c[h]=1,g[h]=0,++h;break;case"G":l[x[1]]=h,c[h]=-1,g[h]=0,++h;break;case"E":l[x[1]]=h,c[h]=0,g[h]=0,++h;break;default:v("Parse error "+numeric.prettyPrint(x))}break;case 3:p.hasOwnProperty(x[0])||(p[x[0]]=f,d[f]=0,m[f]=numeric.rep([h],0),++f);var _=p[x[0]];for(n=1;n<x.length;n+=2)if(x[n]!==u){var b=l[x[n]];m[_][b]=(c[b]<0?-1:1)*parseFloat(x[n+1])}else d[_]=parseFloat(x[n+1]);break;case 4:for(n=1;n<x.length;n+=2)g[l[x[n]]]=(c[l[x[n]]]<0?-1:1)*parseFloat(x[n+1]);break;case 5:break;case 6:v("Internal error")}}}v("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(t,e,n,r,i,o,a){function s(t){var e,r,i=this,o=t.length,a=0,s=i.i=i.j=i.m=0;for(i.S=[],i.c=[],o||(t=[o++]);a<n;)i.S[a]=a++;for(a=0;a<n;a++)s=c(s+(e=i.S[a])+t[a%o]),r=i.S[s],i.S[a]=r,i.S[s]=e;i.g=function(t){var e=i.S,r=c(i.i+1),o=e[r],a=c(i.j+o),s=e[a];e[r]=s,e[a]=o;for(var u=e[c(o+s)];--t;)r=c(r+1),s=e[a=c(a+(o=e[r]))],e[r]=s,e[a]=o,u=u*n+e[c(o+s)];return i.i=r,i.j=a,u},i.g(n)}function u(t,e,n,r,i){if(n=[],i=typeof t,e&&"object"==i)for(r in t)if(r.indexOf("S")<5)try{n.push(u(t[r],e-1))}catch(t){}return n.length?n:t+("string"!=i?"\0":"")}function l(t,e,n,r){for(t+="",n=0,r=0;r<t.length;r++)e[c(r)]=c((n^=19*e[c(r)])+t.charCodeAt(r));for(r in t="",e)t+=String.fromCharCode(e[r]);return t}function c(t){return t&n-1}e.seedrandom=function(c,h){var p,f=[];return c=l(u(h?[c,t]:arguments.length?c:[(new Date).getTime(),t,window],3),f),l((p=new s(f)).S,t),e.random=function(){for(var t=p.g(r),e=a,s=0;t<i;)t=(t+s)*n,e*=n,s=p.g(1);for(;t>=o;)t/=2,e/=2,s>>>=1;return(t+s)/e},c},a=e.pow(n,r),i=e.pow(2,i),o=2*i,l(e.random(),t)}([],numeric.seedrandom,256,6,52),function(t){function e(t){if("object"!=typeof t)return t;var n,r=[],i=t.length;for(n=0;n<i;n++)r[n+1]=e(t[n]);return r}function n(t){if("object"!=typeof t)return t;var e,r=[],i=t.length;for(e=1;e<i;e++)r[e-1]=n(t[e]);return r}function r(t,e,n,r,i,o,a,s,u,l,c,h,p,f,d,m){var g,v,y,x,_,b,w,M,S,T,E,A,P,C,L,I,O,N,R,D,k,F,B,U,z,V,G;P=Math.min(r,l),y=2*r+P*(P+5)/2+2*l+1,U=1e-60;do{z=1+.1*(U+=U),V=1+.2*U}while(z<=1||V<=1);for(g=1;g<=r;g+=1)d[g]=e[g];for(g=r+1;g<=y;g+=1)d[g]=0;for(g=1;g<=l;g+=1)h[g]=0;if(_=[],0===m[1]){if(function(t,e,n,r){var i,o,a,s,u,l;for(o=1;o<=n;o+=1){if(r[1]=o,l=0,(a=o-1)<1){if((l=t[o][o]-l)<=0)break;t[o][o]=Math.sqrt(l)}else{for(s=1;s<=a;s+=1){for(u=t[s][o],i=1;i<s;i+=1)u-=t[i][o]*t[i][s];u/=t[s][s],t[s][o]=u,l+=u*u}if((l=t[o][o]-l)<=0)break;t[o][o]=Math.sqrt(l)}r[1]=0}}(t,0,r,_),0!==_[1])return void(m[1]=2);!function(t,e,n,r){var i,o,a,s;for(o=1;o<=n;o+=1){for(s=0,i=1;i<o;i+=1)s+=t[i][o]*r[i];r[o]=(r[o]-s)/t[o][o]}for(a=1;a<=n;a+=1)for(r[o=n+1-a]=r[o]/t[o][o],s=-r[o],i=1;i<o;i+=1)r[i]=r[i]+s*t[i][o]}(t,0,r,e),function(t,e,n){var r,i,o,a,s;for(o=1;o<=n;o+=1){for(t[o][o]=1/t[o][o],s=-t[o][o],r=1;r<o;r+=1)t[r][o]=s*t[r][o];if(n<(a=o+1))break;for(i=a;i<=n;i+=1)for(s=t[o][i],t[o][i]=0,r=1;r<=o;r+=1)t[r][i]=t[r][i]+s*t[r][o]}}(t,0,r)}else{for(v=1;v<=r;v+=1)for(i[v]=0,g=1;g<=v;g+=1)i[v]=i[v]+t[g][v]*e[g];for(v=1;v<=r;v+=1)for(e[v]=0,g=v;g<=r;g+=1)e[v]=e[v]+t[v][g]*i[g]}for(o[1]=0,v=1;v<=r;v+=1)for(i[v]=e[v],o[1]=o[1]+d[v]*i[v],d[v]=0,g=v+1;g<=r;g+=1)t[g][v]=0;for(o[1]=-o[1]/2,m[1]=0,C=(T=(S=(E=(M=(w=r)+r)+P)+P+1)+P*(P+1)/2)+l,g=1;g<=l;g+=1){for(I=0,v=1;v<=r;v+=1)I+=a[v][g]*a[v][g];d[C+g]=Math.sqrt(I)}function j(){for(f[1]=f[1]+1,y=T,g=1;g<=l;g+=1){for(y+=1,I=-s[g],v=1;v<=r;v+=1)I+=a[v][g]*i[v];if(Math.abs(I)<U&&(I=0),g>c)d[y]=I;else if(d[y]=-Math.abs(I),I>0){for(v=1;v<=r;v+=1)a[v][g]=-a[v][g];s[g]=-s[g]}}for(g=1;g<=p;g+=1)d[T+h[g]]=0;for(A=0,L=0,g=1;g<=l;g+=1)d[T+g]<L*d[C+g]&&(A=g,L=d[T+g]/d[C+g]);return 0===A?999:0}function W(){for(g=1;g<=r;g+=1){for(I=0,v=1;v<=r;v+=1)I+=t[v][g]*a[v][A];d[g]=I}for(x=w,g=1;g<=r;g+=1)d[x+g]=0;for(v=p+1;v<=r;v+=1)for(g=1;g<=r;g+=1)d[x+g]=d[x+g]+t[g][v]*d[v];for(F=!0,g=p;g>=1;g-=1){for(I=d[g],x=(y=S+g*(g+3)/2)-g,v=g+1;v<=p;v+=1)I-=d[y]*d[M+v],y+=v;if(I/=d[x],d[M+g]=I,h[g]<c)break;if(I<0)break;F=!1,b=g}if(!F)for(O=d[E+b]/d[M+b],g=1;g<=p&&!(h[g]<c)&&!(d[M+g]<0);g+=1)(L=d[E+g]/d[M+g])<O&&(O=L,b=g);for(I=0,g=w+1;g<=w+r;g+=1)I+=d[g]*d[g];if(Math.abs(I)<=U){if(F)return m[1]=1,999;for(g=1;g<=p;g+=1)d[E+g]=d[E+g]-O*d[M+g];return d[E+p+1]=d[E+p+1]+O,700}for(I=0,g=1;g<=r;g+=1)I+=d[w+g]*a[g][A];for(N=-d[T+A]/I,B=!0,F||O<N&&(N=O,B=!1),g=1;g<=r;g+=1)i[g]=i[g]+N*d[w+g],Math.abs(i[g])<U&&(i[g]=0);for(o[1]=o[1]+N*I*(N/2+d[E+p+1]),g=1;g<=p;g+=1)d[E+g]=d[E+g]-N*d[M+g];if(d[E+p+1]=d[E+p+1]+N,!B){for(I=-s[A],v=1;v<=r;v+=1)I+=i[v]*a[v][A];if(A>c)d[T+A]=I;else if(d[T+A]=-Math.abs(I),I>0){for(v=1;v<=r;v+=1)a[v][A]=-a[v][A];s[A]=-s[A]}return 700}for(h[p+=1]=A,y=S+(p-1)*p/2+1,g=1;g<=p-1;g+=1)d[y]=d[g],y+=1;if(p===r)d[y]=d[r];else{for(g=r;g>=p+1&&0!==d[g]&&(R=Math.max(Math.abs(d[g-1]),Math.abs(d[g])),D=Math.min(Math.abs(d[g-1]),Math.abs(d[g])),L=d[g-1]>=0?Math.abs(R*Math.sqrt(1+D*D/(R*R))):-Math.abs(R*Math.sqrt(1+D*D/(R*R))),R=d[g-1]/L,D=d[g]/L,1!==R);g-=1)if(0===R)for(d[g-1]=D*L,v=1;v<=r;v+=1)L=t[v][g-1],t[v][g-1]=t[v][g],t[v][g]=L;else for(d[g-1]=L,k=D/(1+R),v=1;v<=r;v+=1)L=R*t[v][g-1]+D*t[v][g],t[v][g]=k*(t[v][g-1]+L)-t[v][g],t[v][g-1]=L;d[y]=d[p]}return 0}function H(){if(0===d[x=(y=S+b*(b+1)/2+1)+b])return 798;if(R=Math.max(Math.abs(d[x-1]),Math.abs(d[x])),D=Math.min(Math.abs(d[x-1]),Math.abs(d[x])),L=d[x-1]>=0?Math.abs(R*Math.sqrt(1+D*D/(R*R))):-Math.abs(R*Math.sqrt(1+D*D/(R*R))),R=d[x-1]/L,D=d[x]/L,1===R)return 798;if(0===R){for(g=b+1;g<=p;g+=1)L=d[x-1],d[x-1]=d[x],d[x]=L,x+=g;for(g=1;g<=r;g+=1)L=t[g][b],t[g][b]=t[g][b+1],t[g][b+1]=L}else{for(k=D/(1+R),g=b+1;g<=p;g+=1)L=R*d[x-1]+D*d[x],d[x]=k*(d[x-1]+L)-d[x],d[x-1]=L,x+=g;for(g=1;g<=r;g+=1)L=R*t[g][b]+D*t[g][b+1],t[g][b+1]=k*(t[g][b]+L)-t[g][b+1],t[g][b]=L}return 0}function X(){for(x=y-b,g=1;g<=b;g+=1)d[x]=d[y],y+=1,x+=1;return d[E+b]=d[E+b+1],h[b]=h[b+1],(b+=1)<p?797:0}function Y(){return d[E+p]=d[E+p+1],d[E+p+1]=0,h[p]=0,p-=1,f[2]=f[2]+1,0}for(p=0,f[1]=0,f[2]=0,G=0;;){if(999===(G=j()))return;for(;0!==(G=W());){if(999===G)return;if(700===G)if(b===p)Y();else{for(;H(),797===(G=X()););Y()}}}}t.solveQP=function(t,i,o,a,s,u){t=e(t),i=e(i),o=e(o);var l,c,h,p,f,d=[],m=[],g=[],v=[],y=[];if(s=s||0,u=u?e(u):[void 0,0],a=a?e(a):[],c=t.length-1,h=o[1].length-1,!a)for(l=1;l<=h;l+=1)a[l]=0;for(l=1;l<=h;l+=1)m[l]=0;for(0,p=Math.min(c,h),l=1;l<=c;l+=1)g[l]=0;for(d[1]=0,l=1;l<=2*c+p*(p+5)/2+2*h+1;l+=1)v[l]=0;for(l=1;l<=2;l+=1)y[l]=0;return r(t,i,0,c,g,d,o,a,0,h,s,m,0,y,v,u),f="",1===u[1]&&(f="constraints are inconsistent, no solution!"),2===u[1]&&(f="matrix D in quadratic function is not positive definite!"),{solution:n(g),value:n(d),unconstrained_solution:n(i),iterations:n(y),iact:n(m),message:f}}}(numeric),numeric.svd=function(t){var e,n=numeric.epsilon,r=1e-64/n,i=0,o=0,a=0,s=0,u=0,l=numeric.clone(t),c=l.length,h=l[0].length;if(c<h)throw"Need more rows than columns";var p=new Array(h),f=new Array(h);for(o=0;o<h;o++)p[o]=f[o]=0;var d=numeric.rep([h,h],0);function m(t,e){return(t=Math.abs(t))>(e=Math.abs(e))?t*Math.sqrt(1+e*e/t/t):0==e?t:e*Math.sqrt(1+t*t/e/e)}var g=0,v=0,y=0,x=0,_=0,b=0,w=0;for(o=0;o<h;o++){for(p[o]=v,w=0,u=o+1,a=o;a<c;a++)w+=l[a][o]*l[a][o];if(w<=r)v=0;else for(g=l[o][o],v=Math.sqrt(w),g>=0&&(v=-v),y=g*v-w,l[o][o]=g-v,a=u;a<h;a++){for(w=0,s=o;s<c;s++)w+=l[s][o]*l[s][a];for(g=w/y,s=o;s<c;s++)l[s][a]+=g*l[s][o]}for(f[o]=v,w=0,a=u;a<h;a++)w+=l[o][a]*l[o][a];if(w<=r)v=0;else{for(g=l[o][o+1],v=Math.sqrt(w),g>=0&&(v=-v),y=g*v-w,l[o][o+1]=g-v,a=u;a<h;a++)p[a]=l[o][a]/y;for(a=u;a<c;a++){for(w=0,s=u;s<h;s++)w+=l[a][s]*l[o][s];for(s=u;s<h;s++)l[a][s]+=w*p[s]}}(_=Math.abs(f[o])+Math.abs(p[o]))>x&&(x=_)}for(o=h-1;-1!=o;o+=-1){if(0!=v){for(y=v*l[o][o+1],a=u;a<h;a++)d[a][o]=l[o][a]/y;for(a=u;a<h;a++){for(w=0,s=u;s<h;s++)w+=l[o][s]*d[s][a];for(s=u;s<h;s++)d[s][a]+=w*d[s][o]}}for(a=u;a<h;a++)d[o][a]=0,d[a][o]=0;d[o][o]=1,v=p[o],u=o}for(o=h-1;-1!=o;o+=-1){for(u=o+1,v=f[o],a=u;a<h;a++)l[o][a]=0;if(0!=v){for(y=l[o][o]*v,a=u;a<h;a++){for(w=0,s=u;s<c;s++)w+=l[s][o]*l[s][a];for(g=w/y,s=o;s<c;s++)l[s][a]+=g*l[s][o]}for(a=o;a<c;a++)l[a][o]=l[a][o]/v}else for(a=o;a<c;a++)l[a][o]=0;l[o][o]+=1}for(n*=x,s=h-1;-1!=s;s+=-1)for(var M=0;M<50;M++){var S=!1;for(u=s;-1!=u;u+=-1){if(Math.abs(p[u])<=n){S=!0;break}if(Math.abs(f[u-1])<=n)break}if(!S){i=0,w=1;var T=u-1;for(o=u;o<s+1&&(g=w*p[o],p[o]=i*p[o],!(Math.abs(g)<=n));o++)for(y=m(g,v=f[o]),f[o]=y,i=v/y,w=-g/y,a=0;a<c;a++)_=l[a][T],b=l[a][o],l[a][T]=_*i+b*w,l[a][o]=-_*w+b*i}if(b=f[s],u==s){if(b<0)for(f[s]=-b,a=0;a<h;a++)d[a][s]=-d[a][s];break}if(M>=49)throw"Error: no convergence.";for(x=f[u],v=m(g=(((_=f[s-1])-b)*(_+b)+((v=p[s-1])-(y=p[s]))*(v+y))/(2*y*_),1),g=g<0?((x-b)*(x+b)+y*(_/(g-v)-y))/x:((x-b)*(x+b)+y*(_/(g+v)-y))/x,i=1,w=1,o=u+1;o<s+1;o++){for(v=p[o],_=f[o],y=w*v,v*=i,b=m(g,y),p[o-1]=b,g=x*(i=g/b)+v*(w=y/b),v=-x*w+v*i,y=_*w,_*=i,a=0;a<h;a++)x=d[a][o-1],b=d[a][o],d[a][o-1]=x*i+b*w,d[a][o]=-x*w+b*i;for(b=m(g,y),f[o-1]=b,g=(i=g/b)*v+(w=y/b)*_,x=-w*v+i*_,a=0;a<c;a++)_=l[a][o-1],b=l[a][o],l[a][o-1]=_*i+b*w,l[a][o]=-_*w+b*i}p[u]=0,p[s]=g,f[s]=x}for(o=0;o<f.length;o++)f[o]<n&&(f[o]=0);for(o=0;o<h;o++)for(a=o-1;a>=0;a--)if(f[a]<f[o]){for(i=f[a],f[a]=f[o],f[o]=i,s=0;s<l.length;s++)e=l[s][o],l[s][o]=l[s][a],l[s][a]=e;for(s=0;s<d.length;s++)e=d[s][o],d[s][o]=d[s][a],d[s][a]=e;o=a}return{U:l,S:f,V:d}}},84376:function(t,e,n){"use strict";function r(t,e){var n=t.__state.conversionName.toString(),r=Math.round(t.r),i=Math.round(t.g),o=Math.round(t.b),a=t.a,s=Math.round(t.h),u=t.s.toFixed(1),l=t.v.toFixed(1);if(e||"THREE_CHAR_HEX"===n||"SIX_CHAR_HEX"===n){for(var c=t.hex.toString(16);c.length<6;)c="0"+c;return"#"+c}return"CSS_RGB"===n?"rgb("+r+","+i+","+o+")":"CSS_RGBA"===n?"rgba("+r+","+i+","+o+","+a+")":"HEX"===n?"0x"+t.hex.toString(16):"RGB_ARRAY"===n?"["+r+","+i+","+o+"]":"RGBA_ARRAY"===n?"["+r+","+i+","+o+","+a+"]":"RGB_OBJ"===n?"{r:"+r+",g:"+i+",b:"+o+"}":"RGBA_OBJ"===n?"{r:"+r+",g:"+i+",b:"+o+",a:"+a+"}":"HSV_OBJ"===n?"{h:"+s+",s:"+u+",v:"+l+"}":"HSVA_OBJ"===n?"{h:"+s+",s:"+u+",v:"+l+",a:"+a+"}":"unknown format"}n.r(e),n.d(e,{GUI:function(){return mt},color:function(){return ht},controllers:function(){return pt},dom:function(){return ft},gui:function(){return dt}});var i=Array.prototype.forEach,o=Array.prototype.slice,a={BREAK:{},extend:function(t){return this.each(o.call(arguments,1),(function(e){(this.isObject(e)?Object.keys(e):[]).forEach(function(n){this.isUndefined(e[n])||(t[n]=e[n])}.bind(this))}),this),t},defaults:function(t){return this.each(o.call(arguments,1),(function(e){(this.isObject(e)?Object.keys(e):[]).forEach(function(n){this.isUndefined(t[n])&&(t[n]=e[n])}.bind(this))}),this),t},compose:function(){var t=o.call(arguments);return function(){for(var e=o.call(arguments),n=t.length-1;n>=0;n--)e=[t[n].apply(this,e)];return e[0]}},each:function(t,e,n){if(t)if(i&&t.forEach&&t.forEach===i)t.forEach(e,n);else if(t.length===t.length+0){var r,o=void 0;for(o=0,r=t.length;o<r;o++)if(o in t&&e.call(n,t[o],o)===this.BREAK)return}else for(var a in t)if(e.call(n,t[a],a)===this.BREAK)return},defer:function(t){setTimeout(t,0)},debounce:function(t,e,n){var r=void 0;return function(){var i=this,o=arguments;var a=n||!r;clearTimeout(r),r=setTimeout((function(){r=null,n||t.apply(i,o)}),e),a&&t.apply(i,o)}},toArray:function(t){return t.toArray?t.toArray():o.call(t)},isUndefined:function(t){return void 0===t},isNull:function(t){return null===t},isNaN:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t){return isNaN(t)})),isArray:Array.isArray||function(t){return t.constructor===Array},isObject:function(t){return t===Object(t)},isNumber:function(t){return t===t+0},isString:function(t){return t===t+""},isBoolean:function(t){return!1===t||!0===t},isFunction:function(t){return t instanceof Function}},s=[{litmus:a.isString,conversions:{THREE_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString()+e[1].toString()+e[2].toString()+e[2].toString()+e[3].toString()+e[3].toString(),0)}},write:r},SIX_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9]{6})$/i);return null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString(),0)}},write:r},CSS_RGB:{read:function(t){var e=t.match(/^rgb\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3])}},write:r},CSS_RGBA:{read:function(t){var e=t.match(/^rgba\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3]),a:parseFloat(e[4])}},write:r}}},{litmus:a.isNumber,conversions:{HEX:{read:function(t){return{space:"HEX",hex:t,conversionName:"HEX"}},write:function(t){return t.hex}}}},{litmus:a.isArray,conversions:{RGB_ARRAY:{read:function(t){return 3===t.length&&{space:"RGB",r:t[0],g:t[1],b:t[2]}},write:function(t){return[t.r,t.g,t.b]}},RGBA_ARRAY:{read:function(t){return 4===t.length&&{space:"RGB",r:t[0],g:t[1],b:t[2],a:t[3]}},write:function(t){return[t.r,t.g,t.b,t.a]}}}},{litmus:a.isObject,conversions:{RGBA_OBJ:{read:function(t){return!!(a.isNumber(t.r)&&a.isNumber(t.g)&&a.isNumber(t.b)&&a.isNumber(t.a))&&{space:"RGB",r:t.r,g:t.g,b:t.b,a:t.a}},write:function(t){return{r:t.r,g:t.g,b:t.b,a:t.a}}},RGB_OBJ:{read:function(t){return!!(a.isNumber(t.r)&&a.isNumber(t.g)&&a.isNumber(t.b))&&{space:"RGB",r:t.r,g:t.g,b:t.b}},write:function(t){return{r:t.r,g:t.g,b:t.b}}},HSVA_OBJ:{read:function(t){return!!(a.isNumber(t.h)&&a.isNumber(t.s)&&a.isNumber(t.v)&&a.isNumber(t.a))&&{space:"HSV",h:t.h,s:t.s,v:t.v,a:t.a}},write:function(t){return{h:t.h,s:t.s,v:t.v,a:t.a}}},HSV_OBJ:{read:function(t){return!!(a.isNumber(t.h)&&a.isNumber(t.s)&&a.isNumber(t.v))&&{space:"HSV",h:t.h,s:t.s,v:t.v}},write:function(t){return{h:t.h,s:t.s,v:t.v}}}}}],u=void 0,l=void 0,c=function(){l=!1;var t=arguments.length>1?a.toArray(arguments):arguments[0];return a.each(s,(function(e){if(e.litmus(t))return a.each(e.conversions,(function(e,n){if(u=e.read(t),!1===l&&!1!==u)return l=u,u.conversionName=n,u.conversion=e,a.BREAK})),a.BREAK})),l},h=void 0,p={hsv_to_rgb:function(t,e,n){var r=Math.floor(t/60)%6,i=t/60-Math.floor(t/60),o=n*(1-e),a=n*(1-i*e),s=n*(1-(1-i)*e),u=[[n,s,o],[a,n,o],[o,n,s],[o,a,n],[s,o,n],[n,o,a]][r];return{r:255*u[0],g:255*u[1],b:255*u[2]}},rgb_to_hsv:function(t,e,n){var r=Math.min(t,e,n),i=Math.max(t,e,n),o=i-r,a=void 0;return 0===i?{h:NaN,s:0,v:0}:(a=t===i?(e-n)/o:e===i?2+(n-t)/o:4+(t-e)/o,(a/=6)<0&&(a+=1),{h:360*a,s:o/i,v:i/255})},rgb_to_hex:function(t,e,n){var r=this.hex_with_component(0,2,t);return r=this.hex_with_component(r,1,e),r=this.hex_with_component(r,0,n)},component_from_hex:function(t,e){return t>>8*e&255},hex_with_component:function(t,e,n){return n<<(h=8*e)|t&~(255<<h)}},f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},m=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),g=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0},v=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},y=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},x=function(){function t(){if(d(this,t),this.__state=c.apply(this,arguments),!1===this.__state)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return m(t,[{key:"toString",value:function(){return r(this)}},{key:"toHexString",value:function(){return r(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),t}();function _(t,e,n){Object.defineProperty(t,e,{get:function(){return"RGB"===this.__state.space||x.recalculateRGB(this,e,n),this.__state[e]},set:function(t){"RGB"!==this.__state.space&&(x.recalculateRGB(this,e,n),this.__state.space="RGB"),this.__state[e]=t}})}function b(t,e){Object.defineProperty(t,e,{get:function(){return"HSV"===this.__state.space||x.recalculateHSV(this),this.__state[e]},set:function(t){"HSV"!==this.__state.space&&(x.recalculateHSV(this),this.__state.space="HSV"),this.__state[e]=t}})}x.recalculateRGB=function(t,e,n){if("HEX"===t.__state.space)t.__state[e]=p.component_from_hex(t.__state.hex,n);else{if("HSV"!==t.__state.space)throw new Error("Corrupted color state");a.extend(t.__state,p.hsv_to_rgb(t.__state.h,t.__state.s,t.__state.v))}},x.recalculateHSV=function(t){var e=p.rgb_to_hsv(t.r,t.g,t.b);a.extend(t.__state,{s:e.s,v:e.v}),a.isNaN(e.h)?a.isUndefined(t.__state.h)&&(t.__state.h=0):t.__state.h=e.h},x.COMPONENTS=["r","g","b","h","s","v","hex","a"],_(x.prototype,"r",2),_(x.prototype,"g",1),_(x.prototype,"b",0),b(x.prototype,"h"),b(x.prototype,"s"),b(x.prototype,"v"),Object.defineProperty(x.prototype,"a",{get:function(){return this.__state.a},set:function(t){this.__state.a=t}}),Object.defineProperty(x.prototype,"hex",{get:function(){return"HEX"!==this.__state.space&&(this.__state.hex=p.rgb_to_hex(this.r,this.g,this.b),this.__state.space="HEX"),this.__state.hex},set:function(t){this.__state.space="HEX",this.__state.hex=t}});var w=function(){function t(e,n){d(this,t),this.initialValue=e[n],this.domElement=document.createElement("div"),this.object=e,this.property=n,this.__onChange=void 0,this.__onFinishChange=void 0}return m(t,[{key:"onChange",value:function(t){return this.__onChange=t,this}},{key:"onFinishChange",value:function(t){return this.__onFinishChange=t,this}},{key:"setValue",value:function(t){return this.object[this.property]=t,this.__onChange&&this.__onChange.call(this,t),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),t}(),M={};a.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},(function(t,e){a.each(t,(function(t){M[t]=e}))}));var S=/(\d+(\.\d+)?)px/;function T(t){if("0"===t||a.isUndefined(t))return 0;var e=t.match(S);return a.isNull(e)?0:parseFloat(e[1])}var E={makeSelectable:function(t,e){void 0!==t&&void 0!==t.style&&(t.onselectstart=e?function(){return!1}:function(){},t.style.MozUserSelect=e?"auto":"none",t.style.KhtmlUserSelect=e?"auto":"none",t.unselectable=e?"on":"off")},makeFullscreen:function(t,e,n){var r=n,i=e;a.isUndefined(i)&&(i=!0),a.isUndefined(r)&&(r=!0),t.style.position="absolute",i&&(t.style.left=0,t.style.right=0),r&&(t.style.top=0,t.style.bottom=0)},fakeEvent:function(t,e,n,r){var i=n||{},o=M[e];if(!o)throw new Error("Event type "+e+" not supported.");var s=document.createEvent(o);switch(o){case"MouseEvents":var u=i.x||i.clientX||0,l=i.y||i.clientY||0;s.initMouseEvent(e,i.bubbles||!1,i.cancelable||!0,window,i.clickCount||1,0,0,u,l,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var c=s.initKeyboardEvent||s.initKeyEvent;a.defaults(i,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),c(e,i.bubbles||!1,i.cancelable,window,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.keyCode,i.charCode);break;default:s.initEvent(e,i.bubbles||!1,i.cancelable||!0)}a.defaults(s,r),t.dispatchEvent(s)},bind:function(t,e,n,r){var i=r||!1;return t.addEventListener?t.addEventListener(e,n,i):t.attachEvent&&t.attachEvent("on"+e,n),E},unbind:function(t,e,n,r){var i=r||!1;return t.removeEventListener?t.removeEventListener(e,n,i):t.detachEvent&&t.detachEvent("on"+e,n),E},addClass:function(t,e){if(void 0===t.className)t.className=e;else if(t.className!==e){var n=t.className.split(/ +/);-1===n.indexOf(e)&&(n.push(e),t.className=n.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return E},removeClass:function(t,e){if(e)if(t.className===e)t.removeAttribute("class");else{var n=t.className.split(/ +/),r=n.indexOf(e);-1!==r&&(n.splice(r,1),t.className=n.join(" "))}else t.className=void 0;return E},hasClass:function(t,e){return new RegExp("(?:^|\\s+)"+e+"(?:\\s+|$)").test(t.className)||!1},getWidth:function(t){var e=getComputedStyle(t);return T(e["border-left-width"])+T(e["border-right-width"])+T(e["padding-left"])+T(e["padding-right"])+T(e.width)},getHeight:function(t){var e=getComputedStyle(t);return T(e["border-top-width"])+T(e["border-bottom-width"])+T(e["padding-top"])+T(e["padding-bottom"])+T(e.height)},getOffset:function(t){var e=t,n={left:0,top:0};if(e.offsetParent)do{n.left+=e.offsetLeft,n.top+=e.offsetTop,e=e.offsetParent}while(e);return n},isActive:function(t){return t===document.activeElement&&(t.type||t.href)}},A=function(t){function e(t,n){d(this,e);var r=y(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),i=r;return r.__prev=r.getValue(),r.__checkbox=document.createElement("input"),r.__checkbox.setAttribute("type","checkbox"),E.bind(r.__checkbox,"change",(function(){i.setValue(!i.__prev)}),!1),r.domElement.appendChild(r.__checkbox),r.updateDisplay(),r}return v(e,t),m(e,[{key:"setValue",value:function(t){var n=g(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,t);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),n}},{key:"updateDisplay",value:function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),g(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(w),P=function(t){function e(t,n,r){d(this,e);var i=y(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),o=r,s=i;if(i.__select=document.createElement("select"),a.isArray(o)){var u={};a.each(o,(function(t){u[t]=t})),o=u}return a.each(o,(function(t,e){var n=document.createElement("option");n.innerHTML=e,n.setAttribute("value",t),s.__select.appendChild(n)})),i.updateDisplay(),E.bind(i.__select,"change",(function(){var t=this.options[this.selectedIndex].value;s.setValue(t)})),i.domElement.appendChild(i.__select),i}return v(e,t),m(e,[{key:"setValue",value:function(t){var n=g(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,t);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),n}},{key:"updateDisplay",value:function(){return E.isActive(this.__select)?this:(this.__select.value=this.getValue(),g(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this))}}]),e}(w),C=function(t){function e(t,n){d(this,e);var r=y(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),i=r;function o(){i.setValue(i.__input.value)}return r.__input=document.createElement("input"),r.__input.setAttribute("type","text"),E.bind(r.__input,"keyup",o),E.bind(r.__input,"change",o),E.bind(r.__input,"blur",(function(){i.__onFinishChange&&i.__onFinishChange.call(i,i.getValue())})),E.bind(r.__input,"keydown",(function(t){13===t.keyCode&&this.blur()})),r.updateDisplay(),r.domElement.appendChild(r.__input),r}return v(e,t),m(e,[{key:"updateDisplay",value:function(){return E.isActive(this.__input)||(this.__input.value=this.getValue()),g(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(w);function L(t){var e=t.toString();return e.indexOf(".")>-1?e.length-e.indexOf(".")-1:0}var I=function(t){function e(t,n,r){d(this,e);var i=y(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),o=r||{};return i.__min=o.min,i.__max=o.max,i.__step=o.step,a.isUndefined(i.__step)?0===i.initialValue?i.__impliedStep=1:i.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(i.initialValue))/Math.LN10))/10:i.__impliedStep=i.__step,i.__precision=L(i.__impliedStep),i}return v(e,t),m(e,[{key:"setValue",value:function(t){var n=t;return void 0!==this.__min&&n<this.__min?n=this.__min:void 0!==this.__max&&n>this.__max&&(n=this.__max),void 0!==this.__step&&n%this.__step!=0&&(n=Math.round(n/this.__step)*this.__step),g(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,n)}},{key:"min",value:function(t){return this.__min=t,this}},{key:"max",value:function(t){return this.__max=t,this}},{key:"step",value:function(t){return this.__step=t,this.__impliedStep=t,this.__precision=L(t),this}}]),e}(w);var O=function(t){function e(t,n,r){d(this,e);var i=y(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,r));i.__truncationSuspended=!1;var o=i,s=void 0;function u(){o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())}function l(t){var e=s-t.clientY;o.setValue(o.getValue()+e*o.__impliedStep),s=t.clientY}function c(){E.unbind(window,"mousemove",l),E.unbind(window,"mouseup",c),u()}return i.__input=document.createElement("input"),i.__input.setAttribute("type","text"),E.bind(i.__input,"change",(function(){var t=parseFloat(o.__input.value);a.isNaN(t)||o.setValue(t)})),E.bind(i.__input,"blur",(function(){u()})),E.bind(i.__input,"mousedown",(function(t){E.bind(window,"mousemove",l),E.bind(window,"mouseup",c),s=t.clientY})),E.bind(i.__input,"keydown",(function(t){13===t.keyCode&&(o.__truncationSuspended=!0,this.blur(),o.__truncationSuspended=!1,u())})),i.updateDisplay(),i.domElement.appendChild(i.__input),i}return v(e,t),m(e,[{key:"updateDisplay",value:function(){var t,n,r;return this.__input.value=this.__truncationSuspended?this.getValue():(t=this.getValue(),n=this.__precision,r=Math.pow(10,n),Math.round(t*r)/r),g(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(I);function N(t,e,n,r,i){return r+(t-e)/(n-e)*(i-r)}var R=function(t){function e(t,n,r,i,o){d(this,e);var a=y(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,{min:r,max:i,step:o})),s=a;function u(t){t.preventDefault();var e=s.__background.getBoundingClientRect();return s.setValue(N(t.clientX,e.left,e.right,s.__min,s.__max)),!1}function l(){E.unbind(window,"mousemove",u),E.unbind(window,"mouseup",l),s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}function c(t){var e=t.touches[0].clientX,n=s.__background.getBoundingClientRect();s.setValue(N(e,n.left,n.right,s.__min,s.__max))}function h(){E.unbind(window,"touchmove",c),E.unbind(window,"touchend",h),s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}return a.__background=document.createElement("div"),a.__foreground=document.createElement("div"),E.bind(a.__background,"mousedown",(function(t){document.activeElement.blur(),E.bind(window,"mousemove",u),E.bind(window,"mouseup",l),u(t)})),E.bind(a.__background,"touchstart",(function(t){if(1!==t.touches.length)return;E.bind(window,"touchmove",c),E.bind(window,"touchend",h),c(t)})),E.addClass(a.__background,"slider"),E.addClass(a.__foreground,"slider-fg"),a.updateDisplay(),a.__background.appendChild(a.__foreground),a.domElement.appendChild(a.__background),a}return v(e,t),m(e,[{key:"updateDisplay",value:function(){var t=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*t+"%",g(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(I),D=function(t){function e(t,n,r){d(this,e);var i=y(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),o=i;return i.__button=document.createElement("div"),i.__button.innerHTML=void 0===r?"Fire":r,E.bind(i.__button,"click",(function(t){return t.preventDefault(),o.fire(),!1})),E.addClass(i.__button,"button"),i.domElement.appendChild(i.__button),i}return v(e,t),m(e,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),e}(w),k=function(t){function e(t,n){d(this,e);var r=y(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));r.__color=new x(r.getValue()),r.__temp=new x(0);var i=r;r.domElement=document.createElement("div"),E.makeSelectable(r.domElement,!1),r.__selector=document.createElement("div"),r.__selector.className="selector",r.__saturation_field=document.createElement("div"),r.__saturation_field.className="saturation-field",r.__field_knob=document.createElement("div"),r.__field_knob.className="field-knob",r.__field_knob_border="2px solid ",r.__hue_knob=document.createElement("div"),r.__hue_knob.className="hue-knob",r.__hue_field=document.createElement("div"),r.__hue_field.className="hue-field",r.__input=document.createElement("input"),r.__input.type="text",r.__input_textShadow="0 1px 1px ",E.bind(r.__input,"keydown",(function(t){13===t.keyCode&&f.call(this)})),E.bind(r.__input,"blur",f),E.bind(r.__selector,"mousedown",(function(){E.addClass(this,"drag").bind(window,"mouseup",(function(){E.removeClass(i.__selector,"drag")}))})),E.bind(r.__selector,"touchstart",(function(){E.addClass(this,"drag").bind(window,"touchend",(function(){E.removeClass(i.__selector,"drag")}))}));var o,s=document.createElement("div");function u(t){g(t),E.bind(window,"mousemove",g),E.bind(window,"touchmove",g),E.bind(window,"mouseup",h),E.bind(window,"touchend",h)}function l(t){v(t),E.bind(window,"mousemove",v),E.bind(window,"touchmove",v),E.bind(window,"mouseup",p),E.bind(window,"touchend",p)}function h(){E.unbind(window,"mousemove",g),E.unbind(window,"touchmove",g),E.unbind(window,"mouseup",h),E.unbind(window,"touchend",h),m()}function p(){E.unbind(window,"mousemove",v),E.unbind(window,"touchmove",v),E.unbind(window,"mouseup",p),E.unbind(window,"touchend",p),m()}function f(){var t=c(this.value);!1!==t?(i.__color.__state=t,i.setValue(i.__color.toOriginal())):this.value=i.__color.toString()}function m(){i.__onFinishChange&&i.__onFinishChange.call(i,i.__color.toOriginal())}function g(t){-1===t.type.indexOf("touch")&&t.preventDefault();var e=i.__saturation_field.getBoundingClientRect(),n=t.touches&&t.touches[0]||t,r=n.clientX,o=n.clientY,a=(r-e.left)/(e.right-e.left),s=1-(o-e.top)/(e.bottom-e.top);return s>1?s=1:s<0&&(s=0),a>1?a=1:a<0&&(a=0),i.__color.v=s,i.__color.s=a,i.setValue(i.__color.toOriginal()),!1}function v(t){-1===t.type.indexOf("touch")&&t.preventDefault();var e=i.__hue_field.getBoundingClientRect(),n=1-((t.touches&&t.touches[0]||t).clientY-e.top)/(e.bottom-e.top);return n>1?n=1:n<0&&(n=0),i.__color.h=360*n,i.setValue(i.__color.toOriginal()),!1}return a.extend(r.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),a.extend(r.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:r.__field_knob_border+(r.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),a.extend(r.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),a.extend(r.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),a.extend(s.style,{width:"100%",height:"100%",background:"none"}),B(s,"top","rgba(0,0,0,0)","#000"),a.extend(r.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),(o=r.__hue_field).style.background="",o.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",o.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",o.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",o.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",o.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",a.extend(r.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:r.__input_textShadow+"rgba(0,0,0,0.7)"}),E.bind(r.__saturation_field,"mousedown",u),E.bind(r.__saturation_field,"touchstart",u),E.bind(r.__field_knob,"mousedown",u),E.bind(r.__field_knob,"touchstart",u),E.bind(r.__hue_field,"mousedown",l),E.bind(r.__hue_field,"touchstart",l),r.__saturation_field.appendChild(s),r.__selector.appendChild(r.__field_knob),r.__selector.appendChild(r.__saturation_field),r.__selector.appendChild(r.__hue_field),r.__hue_field.appendChild(r.__hue_knob),r.domElement.appendChild(r.__input),r.domElement.appendChild(r.__selector),r.updateDisplay(),r}return v(e,t),m(e,[{key:"updateDisplay",value:function(){var t=c(this.getValue());if(!1!==t){var e=!1;a.each(x.COMPONENTS,(function(n){if(!a.isUndefined(t[n])&&!a.isUndefined(this.__color.__state[n])&&t[n]!==this.__color.__state[n])return e=!0,{}}),this),e&&a.extend(this.__color.__state,t)}a.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var n=this.__color.v<.5||this.__color.s>.5?255:0,r=255-n;a.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+n+","+n+","+n+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,B(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),a.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+n+","+n+","+n+")",textShadow:this.__input_textShadow+"rgba("+r+","+r+","+r+",.7)"})}}]),e}(w),F=["-moz-","-o-","-webkit-","-ms-",""];function B(t,e,n,r){t.style.background="",a.each(F,(function(i){t.style.cssText+="background: "+i+"linear-gradient("+e+", "+n+" 0%, "+r+" 100%); "}))}var U=function(t,e){var n=e||document,r=document.createElement("style");r.type="text/css",r.innerHTML=t;var i=n.getElementsByTagName("head")[0];try{i.appendChild(r)}catch(t){}},z='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>',V=function(t,e){var n=t[e];return a.isArray(arguments[2])||a.isObject(arguments[2])?new P(t,e,arguments[2]):a.isNumber(n)?a.isNumber(arguments[2])&&a.isNumber(arguments[3])?a.isNumber(arguments[4])?new R(t,e,arguments[2],arguments[3],arguments[4]):new R(t,e,arguments[2],arguments[3]):a.isNumber(arguments[4])?new O(t,e,{min:arguments[2],max:arguments[3],step:arguments[4]}):new O(t,e,{min:arguments[2],max:arguments[3]}):a.isString(n)?new C(t,e):a.isFunction(n)?new D(t,e,""):a.isBoolean(n)?new A(t,e):null};var G=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){setTimeout(t,1e3/60)},j=function(){function t(){d(this,t),this.backgroundElement=document.createElement("div"),a.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),E.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),a.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var e=this;E.bind(this.backgroundElement,"click",(function(){e.hide()}))}return m(t,[{key:"show",value:function(){var t=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),a.defer((function(){t.backgroundElement.style.opacity=1,t.domElement.style.opacity=1,t.domElement.style.webkitTransform="scale(1)"}))}},{key:"hide",value:function(){var t=this,e=function e(){t.domElement.style.display="none",t.backgroundElement.style.display="none",E.unbind(t.domElement,"webkitTransitionEnd",e),E.unbind(t.domElement,"transitionend",e),E.unbind(t.domElement,"oTransitionEnd",e)};E.bind(this.domElement,"webkitTransitionEnd",e),E.bind(this.domElement,"transitionend",e),E.bind(this.domElement,"oTransitionEnd",e),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-E.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-E.getHeight(this.domElement)/2+"px"}}]),t}(),W=function(t){if(t&&"undefined"!=typeof window){var e=document.createElement("style");return e.setAttribute("type","text/css"),e.innerHTML=t,document.head.appendChild(e),t}}(".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .cr.function .property-name{width:100%}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n");U(W);var H="Default",X=function(){try{return!!window.localStorage}catch(t){return!1}}(),Y=void 0,q=!0,Z=void 0,J=!1,K=[],Q=function t(e){var n=this,r=e||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),E.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],r=a.defaults(r,{closeOnTop:!1,autoPlace:!0,width:t.DEFAULT_WIDTH}),r=a.defaults(r,{resizable:r.autoPlace,hideable:r.autoPlace}),a.isUndefined(r.load)?r.load={preset:H}:r.preset&&(r.load.preset=r.preset),a.isUndefined(r.parent)&&r.hideable&&K.push(this),r.resizable=a.isUndefined(r.parent)&&r.resizable,r.autoPlace&&a.isUndefined(r.scrollable)&&(r.scrollable=!0);var i,o=X&&"true"===localStorage.getItem(it(this,"isLocal")),s=void 0,u=void 0;if(Object.defineProperties(this,{parent:{get:function(){return r.parent}},scrollable:{get:function(){return r.scrollable}},autoPlace:{get:function(){return r.autoPlace}},closeOnTop:{get:function(){return r.closeOnTop}},preset:{get:function(){return n.parent?n.getRoot().preset:r.load.preset},set:function(t){n.parent?n.getRoot().preset=t:r.load.preset=t,function(t){for(var e=0;e<t.__preset_select.length;e++)t.__preset_select[e].value===t.preset&&(t.__preset_select.selectedIndex=e)}(this),n.revert()}},width:{get:function(){return r.width},set:function(t){r.width=t,ut(n,t)}},name:{get:function(){return r.name},set:function(t){r.name=t,u&&(u.innerHTML=r.name)}},closed:{get:function(){return r.closed},set:function(e){r.closed=e,r.closed?E.addClass(n.__ul,t.CLASS_CLOSED):E.removeClass(n.__ul,t.CLASS_CLOSED),this.onResize(),n.__closeButton&&(n.__closeButton.innerHTML=e?t.TEXT_OPEN:t.TEXT_CLOSED)}},load:{get:function(){return r.load}},useLocalStorage:{get:function(){return o},set:function(t){X&&(o=t,t?E.bind(window,"unload",s):E.unbind(window,"unload",s),localStorage.setItem(it(n,"isLocal"),t))}}}),a.isUndefined(r.parent)){if(this.closed=r.closed||!1,E.addClass(this.domElement,t.CLASS_MAIN),E.makeSelectable(this.domElement,!1),X&&o){n.useLocalStorage=!0;var l=localStorage.getItem(it(this,"gui"));l&&(r.load=JSON.parse(l))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=t.TEXT_CLOSED,E.addClass(this.__closeButton,t.CLASS_CLOSE_BUTTON),r.closeOnTop?(E.addClass(this.__closeButton,t.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(E.addClass(this.__closeButton,t.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),E.bind(this.__closeButton,"click",(function(){n.closed=!n.closed}))}else{void 0===r.closed&&(r.closed=!0);var c=document.createTextNode(r.name);E.addClass(c,"controller-name"),u=$(n,c);E.addClass(this.__ul,t.CLASS_CLOSED),E.addClass(u,"title"),E.bind(u,"click",(function(t){return t.preventDefault(),n.closed=!n.closed,!1})),r.closed||(this.closed=!1)}r.autoPlace&&(a.isUndefined(r.parent)&&(q&&(Z=document.createElement("div"),E.addClass(Z,"dg"),E.addClass(Z,t.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(Z),q=!1),Z.appendChild(this.domElement),E.addClass(this.domElement,t.CLASS_AUTO_PLACE)),this.parent||ut(n,r.width)),this.__resizeHandler=function(){n.onResizeDebounced()},E.bind(window,"resize",this.__resizeHandler),E.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),E.bind(this.__ul,"transitionend",this.__resizeHandler),E.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),r.resizable&&st(this),s=function(){X&&"true"===localStorage.getItem(it(n,"isLocal"))&&localStorage.setItem(it(n,"gui"),JSON.stringify(n.getSaveObject()))},this.saveToLocalStorageIfPossible=s,r.parent||((i=n.getRoot()).width+=1,a.defer((function(){i.width-=1})))};function $(t,e,n){var r=document.createElement("li");return e&&r.appendChild(e),n?t.__ul.insertBefore(r,n):t.__ul.appendChild(r),t.onResize(),r}function tt(t){E.unbind(window,"resize",t.__resizeHandler),t.saveToLocalStorageIfPossible&&E.unbind(window,"unload",t.saveToLocalStorageIfPossible)}function et(t,e){var n=t.__preset_select[t.__preset_select.selectedIndex];n.innerHTML=e?n.value+"*":n.value}function nt(t,e){var n=t.getRoot(),r=n.__rememberedObjects.indexOf(e.object);if(-1!==r){var i=n.__rememberedObjectIndecesToControllers[r];if(void 0===i&&(i={},n.__rememberedObjectIndecesToControllers[r]=i),i[e.property]=e,n.load&&n.load.remembered){var o=n.load.remembered,a=void 0;if(o[t.preset])a=o[t.preset];else{if(!o[H])return;a=o[H]}if(a[r]&&void 0!==a[r][e.property]){var s=a[r][e.property];e.initialValue=s,e.setValue(s)}}}}function rt(t,e,n,r){if(void 0===e[n])throw new Error('Object "'+e+'" has no property "'+n+'"');var i=void 0;if(r.color)i=new k(e,n);else{var o=[e,n].concat(r.factoryArgs);i=V.apply(t,o)}r.before instanceof w&&(r.before=r.before.__li),nt(t,i),E.addClass(i.domElement,"c");var s=document.createElement("span");E.addClass(s,"property-name"),s.innerHTML=i.property;var u=document.createElement("div");u.appendChild(s),u.appendChild(i.domElement);var l=$(t,u,r.before);return E.addClass(l,Q.CLASS_CONTROLLER_ROW),i instanceof k?E.addClass(l,"color"):E.addClass(l,f(i.getValue())),function(t,e,n){if(n.__li=e,n.__gui=t,a.extend(n,{options:function(e){if(arguments.length>1){var r=n.__li.nextElementSibling;return n.remove(),rt(t,n.object,n.property,{before:r,factoryArgs:[a.toArray(arguments)]})}if(a.isArray(e)||a.isObject(e)){var i=n.__li.nextElementSibling;return n.remove(),rt(t,n.object,n.property,{before:i,factoryArgs:[e]})}},name:function(t){return n.__li.firstElementChild.firstElementChild.innerHTML=t,n},listen:function(){return n.__gui.listen(n),n},remove:function(){return n.__gui.remove(n),n}}),n instanceof R){var r=new O(n.object,n.property,{min:n.__min,max:n.__max,step:n.__step});a.each(["updateDisplay","onChange","onFinishChange","step","min","max"],(function(t){var e=n[t],i=r[t];n[t]=r[t]=function(){var t=Array.prototype.slice.call(arguments);return i.apply(r,t),e.apply(n,t)}})),E.addClass(e,"has-slider"),n.domElement.insertBefore(r.domElement,n.domElement.firstElementChild)}else if(n instanceof O){var i=function(e){if(a.isNumber(n.__min)&&a.isNumber(n.__max)){var r=n.__li.firstElementChild.firstElementChild.innerHTML,i=n.__gui.__listening.indexOf(n)>-1;n.remove();var o=rt(t,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[n.__min,n.__max,n.__step]});return o.name(r),i&&o.listen(),o}return e};n.min=a.compose(i,n.min),n.max=a.compose(i,n.max)}else n instanceof A?(E.bind(e,"click",(function(){E.fakeEvent(n.__checkbox,"click")})),E.bind(n.__checkbox,"click",(function(t){t.stopPropagation()}))):n instanceof D?(E.bind(e,"click",(function(){E.fakeEvent(n.__button,"click")})),E.bind(e,"mouseover",(function(){E.addClass(n.__button,"hover")})),E.bind(e,"mouseout",(function(){E.removeClass(n.__button,"hover")}))):n instanceof k&&(E.addClass(e,"color"),n.updateDisplay=a.compose((function(t){return e.style.borderLeftColor=n.__color.toString(),t}),n.updateDisplay),n.updateDisplay());n.setValue=a.compose((function(e){return t.getRoot().__preset_select&&n.isModified()&&et(t.getRoot(),!0),e}),n.setValue)}(t,l,i),t.__controllers.push(i),i}function it(t,e){return document.location.href+"."+e}function ot(t,e,n){var r=document.createElement("option");r.innerHTML=e,r.value=e,t.__preset_select.appendChild(r),n&&(t.__preset_select.selectedIndex=t.__preset_select.length-1)}function at(t,e){e.style.display=t.useLocalStorage?"block":"none"}function st(t){var e=void 0;function n(n){return n.preventDefault(),t.width+=e-n.clientX,t.onResize(),e=n.clientX,!1}function r(){E.removeClass(t.__closeButton,Q.CLASS_DRAG),E.unbind(window,"mousemove",n),E.unbind(window,"mouseup",r)}function i(i){return i.preventDefault(),e=i.clientX,E.addClass(t.__closeButton,Q.CLASS_DRAG),E.bind(window,"mousemove",n),E.bind(window,"mouseup",r),!1}t.__resize_handle=document.createElement("div"),a.extend(t.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),E.bind(t.__resize_handle,"mousedown",i),E.bind(t.__closeButton,"mousedown",i),t.domElement.insertBefore(t.__resize_handle,t.domElement.firstElementChild)}function ut(t,e){t.domElement.style.width=e+"px",t.__save_row&&t.autoPlace&&(t.__save_row.style.width=e+"px"),t.__closeButton&&(t.__closeButton.style.width=e+"px")}function lt(t,e){var n={};return a.each(t.__rememberedObjects,(function(r,i){var o={},s=t.__rememberedObjectIndecesToControllers[i];a.each(s,(function(t,n){o[n]=e?t.initialValue:t.getValue()})),n[i]=o})),n}function ct(t){0!==t.length&&G.call(window,(function(){ct(t)})),a.each(t,(function(t){t.updateDisplay()}))}Q.toggleHide=function(){J=!J,a.each(K,(function(t){t.domElement.style.display=J?"none":""}))},Q.CLASS_AUTO_PLACE="a",Q.CLASS_AUTO_PLACE_CONTAINER="ac",Q.CLASS_MAIN="main",Q.CLASS_CONTROLLER_ROW="cr",Q.CLASS_TOO_TALL="taller-than-window",Q.CLASS_CLOSED="closed",Q.CLASS_CLOSE_BUTTON="close-button",Q.CLASS_CLOSE_TOP="close-top",Q.CLASS_CLOSE_BOTTOM="close-bottom",Q.CLASS_DRAG="drag",Q.DEFAULT_WIDTH=245,Q.TEXT_CLOSED="Close Controls",Q.TEXT_OPEN="Open Controls",Q._keydownHandler=function(t){"text"===document.activeElement.type||72!==t.which&&72!==t.keyCode||Q.toggleHide()},E.bind(window,"keydown",Q._keydownHandler,!1),a.extend(Q.prototype,{add:function(t,e){return rt(this,t,e,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(t,e){return rt(this,t,e,{color:!0})},remove:function(t){this.__ul.removeChild(t.__li),this.__controllers.splice(this.__controllers.indexOf(t),1);var e=this;a.defer((function(){e.onResize()}))},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&Z.removeChild(this.domElement);var t=this;a.each(this.__folders,(function(e){t.removeFolder(e)})),E.unbind(window,"keydown",Q._keydownHandler,!1),tt(this)},addFolder:function(t){if(void 0!==this.__folders[t])throw new Error('You already have a folder in this GUI by the name "'+t+'"');var e={name:t,parent:this};e.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[t]&&(e.closed=this.load.folders[t].closed,e.load=this.load.folders[t]);var n=new Q(e);this.__folders[t]=n;var r=$(this,n.domElement);return E.addClass(r,"folder"),n},removeFolder:function(t){this.__ul.removeChild(t.domElement.parentElement),delete this.__folders[t.name],this.load&&this.load.folders&&this.load.folders[t.name]&&delete this.load.folders[t.name],tt(t);var e=this;a.each(t.__folders,(function(e){t.removeFolder(e)})),a.defer((function(){e.onResize()}))},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var t=this.getRoot();if(t.scrollable){var e=E.getOffset(t.__ul).top,n=0;a.each(t.__ul.childNodes,(function(e){t.autoPlace&&e===t.__save_row||(n+=E.getHeight(e))})),window.innerHeight-e-20<n?(E.addClass(t.domElement,Q.CLASS_TOO_TALL),t.__ul.style.height=window.innerHeight-e-20+"px"):(E.removeClass(t.domElement,Q.CLASS_TOO_TALL),t.__ul.style.height="auto")}t.__resize_handle&&a.defer((function(){t.__resize_handle.style.height=t.__ul.offsetHeight+"px"})),t.__closeButton&&(t.__closeButton.style.width=t.width+"px")},onResizeDebounced:a.debounce((function(){this.onResize()}),50),remember:function(){if(a.isUndefined(Y)&&((Y=new j).domElement.innerHTML=z),this.parent)throw new Error("You can only call remember on a top level GUI.");var t=this;a.each(Array.prototype.slice.call(arguments),(function(e){0===t.__rememberedObjects.length&&function(t){var e=t.__save_row=document.createElement("li");E.addClass(t.domElement,"has-save"),t.__ul.insertBefore(e,t.__ul.firstChild),E.addClass(e,"save-row");var n=document.createElement("span");n.innerHTML="&nbsp;",E.addClass(n,"button gears");var r=document.createElement("span");r.innerHTML="Save",E.addClass(r,"button"),E.addClass(r,"save");var i=document.createElement("span");i.innerHTML="New",E.addClass(i,"button"),E.addClass(i,"save-as");var o=document.createElement("span");o.innerHTML="Revert",E.addClass(o,"button"),E.addClass(o,"revert");var s=t.__preset_select=document.createElement("select");t.load&&t.load.remembered?a.each(t.load.remembered,(function(e,n){ot(t,n,n===t.preset)})):ot(t,H,!1);if(E.bind(s,"change",(function(){for(var e=0;e<t.__preset_select.length;e++)t.__preset_select[e].innerHTML=t.__preset_select[e].value;t.preset=this.value})),e.appendChild(s),e.appendChild(n),e.appendChild(r),e.appendChild(i),e.appendChild(o),X){var u=document.getElementById("dg-local-explain"),l=document.getElementById("dg-local-storage");document.getElementById("dg-save-locally").style.display="block","true"===localStorage.getItem(it(t,"isLocal"))&&l.setAttribute("checked","checked"),at(t,u),E.bind(l,"change",(function(){t.useLocalStorage=!t.useLocalStorage,at(t,u)}))}var c=document.getElementById("dg-new-constructor");E.bind(c,"keydown",(function(t){!t.metaKey||67!==t.which&&67!==t.keyCode||Y.hide()})),E.bind(n,"click",(function(){c.innerHTML=JSON.stringify(t.getSaveObject(),void 0,2),Y.show(),c.focus(),c.select()})),E.bind(r,"click",(function(){t.save()})),E.bind(i,"click",(function(){var e=prompt("Enter a new preset name.");e&&t.saveAs(e)})),E.bind(o,"click",(function(){t.revert()}))}(t),-1===t.__rememberedObjects.indexOf(e)&&t.__rememberedObjects.push(e)})),this.autoPlace&&ut(this,this.width)},getRoot:function(){for(var t=this;t.parent;)t=t.parent;return t},getSaveObject:function(){var t=this.load;return t.closed=this.closed,this.__rememberedObjects.length>0&&(t.preset=this.preset,t.remembered||(t.remembered={}),t.remembered[this.preset]=lt(this)),t.folders={},a.each(this.__folders,(function(e,n){t.folders[n]=e.getSaveObject()})),t},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=lt(this),et(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(t){this.load.remembered||(this.load.remembered={},this.load.remembered[H]=lt(this,!0)),this.load.remembered[t]=lt(this),this.preset=t,ot(this,t,!0),this.saveToLocalStorageIfPossible()},revert:function(t){a.each(this.__controllers,(function(e){this.getRoot().load.remembered?nt(t||this.getRoot(),e):e.setValue(e.initialValue),e.__onFinishChange&&e.__onFinishChange.call(e,e.getValue())}),this),a.each(this.__folders,(function(t){t.revert(t)})),t||et(this.getRoot(),!1)},listen:function(t){var e=0===this.__listening.length;this.__listening.push(t),e&&ct(this.__listening)},updateDisplay:function(){a.each(this.__controllers,(function(t){t.updateDisplay()})),a.each(this.__folders,(function(t){t.updateDisplay()}))}});var ht={Color:x,math:p,interpret:c},pt={Controller:w,BooleanController:A,OptionController:P,StringController:C,NumberController:I,NumberControllerBox:O,NumberControllerSlider:R,FunctionController:D,ColorController:k},ft={dom:E},dt={GUI:Q},mt=Q,gt={color:ht,controllers:pt,dom:ft,gui:dt,GUI:mt};e.default=gt},34032:function(__unused_webpack_module,exports,__webpack_require__){"use strict";var numeric=exports;void 0!==__webpack_require__.g&&(__webpack_require__.g.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(t,e){var n,r,i;for(void 0===e&&(e=15),r=.5,n=new Date;;){for(i=r*=2;i>3;i-=4)t(),t(),t(),t();for(;i>0;)t(),i--;if(new Date-n>e)break}for(i=r;i>3;i-=4)t(),t(),t(),t();for(;i>0;)t(),i--;return 1e3*(3*r-1)/(new Date-n)},numeric._myIndexOf=function(t){var e,n=this.length;for(e=0;e<n;++e)if(this[e]===t)return e;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(t){function e(t){if(0===t)return"0";if(isNaN(t))return"NaN";if(t<0)return"-"+e(-t);if(isFinite(t)){var n=Math.floor(Math.log(t)/Math.log(10)),r=t/Math.pow(10,n),i=r.toPrecision(numeric.precision);return 10===parseFloat(i)&&(n++,i=(r=1).toPrecision(numeric.precision)),parseFloat(i).toString()+"e"+n.toString()}return"Infinity"}var n=[];return function t(r){var i;if(void 0===r)return n.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof r)return n.push('"'+r+'"'),!1;if("boolean"==typeof r)return n.push(r.toString()),!1;if("number"==typeof r){var o=e(r),a=r.toPrecision(numeric.precision),s=parseFloat(r.toString()).toString(),u=[o,a,s,parseFloat(a).toString(),parseFloat(s).toString()];for(i=1;i<u.length;i++)u[i].length<o.length&&(o=u[i]);return n.push(Array(numeric.precision+8-o.length).join(" ")+o),!1}if(null===r)return n.push("null"),!1;if("function"==typeof r){n.push(r.toString());var l=!1;for(i in r)r.hasOwnProperty(i)&&(l?n.push(",\n"):n.push("\n{"),l=!0,n.push(i),n.push(": \n"),t(r[i]));return l&&n.push("}\n"),!0}if(r instanceof Array){if(r.length>numeric.largeArray)return n.push("...Large Array..."),!0;l=!1;for(n.push("["),i=0;i<r.length;i++)i>0&&(n.push(","),l&&n.push("\n ")),l=t(r[i]);return n.push("]"),!0}for(i in n.push("{"),l=!1,r)r.hasOwnProperty(i)&&(l&&n.push(",\n"),l=!0,n.push(i),n.push(": \n"),t(r[i]));return n.push("}"),!0}(t),n.join("")},numeric.parseDate=function(t){return function t(e){if("string"==typeof e)return Date.parse(e.replace(/-/g,"/"));if(!(e instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var n,r=[];for(n=0;n<e.length;n++)r[n]=t(e[n]);return r}(t)},numeric.parseFloat=function(t){return function t(e){if("string"==typeof e)return parseFloat(e);if(!(e instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var n,r=[];for(n=0;n<e.length;n++)r[n]=t(e[n]);return r}(t)},numeric.parseCSV=function(t){var e,n,r,i=t.split("\n"),o=[],a=/(([^'",]*)|('[^']*')|("[^"]*")),/g,s=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,u=0;for(n=0;n<i.length;n++){var l,c=(i[n]+",").match(a);if(c.length>0){for(o[u]=[],e=0;e<c.length;e++)l=(r=c[e]).substr(0,r.length-1),s.test(l)?o[u][e]=parseFloat(l):o[u][e]=l;u++}}return o},numeric.toCSV=function(t){var e,n,r,i,o,a=numeric.dim(t);for(r=a[0],a[1],o=[],e=0;e<r;e++){for(i=[],n=0;n<r;n++)i[n]=t[e][n].toString();o[e]=i.join(", ")}return o.join("\n")+"\n"},numeric.getURL=function(t){var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(),e},numeric.imageURL=function(t){function e(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.length);var r,i=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],o=-1;t.length;for(r=e;r<n;r++)o=o>>>8^i[255&(o^t[r])];return-1^o}var n,r,i,o,a,s,u,l,c,h,p=t[0].length,f=t[0][0].length,d=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,f>>24&255,f>>16&255,f>>8&255,255&f,p>>24&255,p>>16&255,p>>8&255,255&p,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(h=e(d,12,29),d[29]=h>>24&255,d[30]=h>>16&255,d[31]=h>>8&255,d[32]=255&h,n=1,r=0,u=0;u<p;u++){for(u<p-1?d.push(0):d.push(1),a=3*f+1+(0===u)&255,s=3*f+1+(0===u)>>8&255,d.push(a),d.push(s),d.push(255&~a),d.push(255&~s),0===u&&d.push(0),l=0;l<f;l++)for(i=0;i<3;i++)r=(r+(n=(n+(a=(a=t[i][u][l])>255?255:a<0?0:Math.round(a)))%65521))%65521,d.push(a);d.push(0)}return c=(r<<16)+n,d.push(c>>24&255),d.push(c>>16&255),d.push(c>>8&255),d.push(255&c),o=d.length-41,d[33]=o>>24&255,d[34]=o>>16&255,d[35]=o>>8&255,d[36]=255&o,h=e(d,37),d.push(h>>24&255),d.push(h>>16&255),d.push(h>>8&255),d.push(255&h),d.push(0),d.push(0),d.push(0),d.push(0),d.push(73),d.push(69),d.push(78),d.push(68),d.push(174),d.push(66),d.push(96),d.push(130),"data:image/png;base64,"+function(t){var e,n,r,i,o,a,s,u=t.length,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="";for(e=0;e<u;e+=3)o=((3&(n=t[e]))<<4)+((r=t[e+1])>>4),a=((15&r)<<2)+((i=t[e+2])>>6),s=63&i,e+1>=u?a=s=64:e+2>=u&&(s=64),c+=l.charAt(n>>2)+l.charAt(o)+l.charAt(a)+l.charAt(s);return c}(d)},numeric._dim=function(t){for(var e=[];"object"==typeof t;)e.push(t.length),t=t[0];return e},numeric.dim=function(t){var e;return"object"==typeof t?"object"==typeof(e=t[0])?"object"==typeof e[0]?numeric._dim(t):[t.length,e.length]:[t.length]:[]},numeric.mapreduce=function(t,e){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+e+';\nif(typeof x === "number") { var xi = x; '+t+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+t+";\n    xi = x[i-1];\n    "+t+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+t+"\n}\nreturn accum;")},numeric.mapreduce2=function(t,e){return Function("x","var n = x.length;\nvar i,xi;\n"+e+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+t+";\n}\nreturn accum;")},numeric.same=function t(e,n){var r,i;if(!(e instanceof Array&&n instanceof Array))return!1;if((i=e.length)!==n.length)return!1;for(r=0;r<i;r++)if(e[r]!==n[r]){if("object"!=typeof e[r])return!1;if(!t(e[r],n[r]))return!1}return!0},numeric.rep=function(t,e,n){void 0===n&&(n=0);var r,i=t[n],o=Array(i);if(n===t.length-1){for(r=i-2;r>=0;r-=2)o[r+1]=e,o[r]=e;return-1===r&&(o[0]=e),o}for(r=i-1;r>=0;r--)o[r]=numeric.rep(t,e,n+1);return o},numeric.dotMMsmall=function(t,e){var n,r,i,o,a,s,u,l,c,h,p;for(o=t.length,a=e.length,s=e[0].length,u=Array(o),n=o-1;n>=0;n--){for(l=Array(s),c=t[n],i=s-1;i>=0;i--){for(h=c[a-1]*e[a-1][i],r=a-2;r>=1;r-=2)p=r-1,h+=c[r]*e[r][i]+c[p]*e[p][i];0===r&&(h+=c[0]*e[0][i]),l[i]=h}u[n]=l}return u},numeric._getCol=function(t,e,n){var r;for(r=t.length-1;r>0;--r)n[r]=t[r][e],n[--r]=t[r][e];0===r&&(n[0]=t[0][e])},numeric.dotMMbig=function(t,e){var n,r,i,o=numeric._getCol,a=e.length,s=Array(a),u=t.length,l=e[0].length,c=new Array(u),h=numeric.dotVV;for(--a,r=--u;-1!==r;--r)c[r]=Array(l);for(r=--l;-1!==r;--r)for(o(e,r,s),i=u;-1!==i;--i)0,n=t[i],c[i][r]=h(n,s);return c},numeric.dotMV=function(t,e){var n,r=t.length,i=(e.length,Array(r)),o=numeric.dotVV;for(n=r-1;n>=0;n--)i[n]=o(t[n],e);return i},numeric.dotVM=function(t,e){var n,r,i,o,a,s,u;for(i=t.length,o=e[0].length,a=Array(o),r=o-1;r>=0;r--){for(s=t[i-1]*e[i-1][r],n=i-2;n>=1;n-=2)u=n-1,s+=t[n]*e[n][r]+t[u]*e[u][r];0===n&&(s+=t[0]*e[0][r]),a[r]=s}return a},numeric.dotVV=function(t,e){var n,r,i=t.length,o=t[i-1]*e[i-1];for(n=i-2;n>=1;n-=2)r=n-1,o+=t[n]*e[n]+t[r]*e[r];return 0===n&&(o+=t[0]*e[0]),o},numeric.dot=function(t,e){var n=numeric.dim;switch(1e3*n(t).length+n(e).length){case 2002:return e.length<10?numeric.dotMMsmall(t,e):numeric.dotMMbig(t,e);case 2001:return numeric.dotMV(t,e);case 1002:return numeric.dotVM(t,e);case 1001:return numeric.dotVV(t,e);case 1e3:return numeric.mulVS(t,e);case 1:return numeric.mulSV(t,e);case 0:return t*e;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(t){var e,n,r,i,o=t.length,a=Array(o);for(e=o-1;e>=0;e--){for(i=Array(o),n=e+2,r=o-1;r>=n;r-=2)i[r]=0,i[r-1]=0;for(r>e&&(i[r]=0),i[e]=t[e],r=e-1;r>=1;r-=2)i[r]=0,i[r-1]=0;0===r&&(i[0]=0),a[e]=i}return a},numeric.getDiag=function(t){var e,n=Math.min(t.length,t[0].length),r=Array(n);for(e=n-1;e>=1;--e)r[e]=t[e][e],r[--e]=t[e][e];return 0===e&&(r[0]=t[0][0]),r},numeric.identity=function(t){return numeric.diag(numeric.rep([t],1))},numeric.pointwise=function(t,e,n){void 0===n&&(n="");var r,i,o=[],a=/\[i\]$/,s="",u=!1;for(r=0;r<t.length;r++)a.test(t[r])?s=i=t[r].substring(0,t[r].length-3):i=t[r],"ret"===i&&(u=!0),o.push(i);return o[t.length]="_s",o[t.length+1]="_k",o[t.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+s+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(u?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+t.join(",")+",_s,_k+1);\n    return ret;\n}\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n    "+e+"\n}\nreturn ret;",Function.apply(null,o)},numeric.pointwise2=function(t,e,n){void 0===n&&(n="");var r,i,o=[],a=/\[i\]$/,s="",u=!1;for(r=0;r<t.length;r++)a.test(t[r])?s=i=t[r].substring(0,t[r].length-3):i=t[r],"ret"===i&&(u=!0),o.push(i);return o[t.length]="var _n = "+s+".length;\nvar i"+(u?"":", ret = Array(_n)")+";\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n"+e+"\n}\nreturn ret;",Function.apply(null,o)},numeric._biforeach=function t(e,n,r,i,o){var a;if(i!==r.length-1)for(a=r[i]-1;a>=0;a--)t("object"==typeof e?e[a]:e,"object"==typeof n?n[a]:n,r,i+1,o);else o(e,n)},numeric._biforeach2=function t(e,n,r,i,o){if(i===r.length-1)return o(e,n);var a,s=r[i],u=Array(s);for(a=s-1;a>=0;--a)u[a]=t("object"==typeof e?e[a]:e,"object"==typeof n?n[a]:n,r,i+1,o);return u},numeric._foreach=function t(e,n,r,i){var o;if(r!==n.length-1)for(o=n[r]-1;o>=0;o--)t(e[o],n,r+1,i);else i(e)},numeric._foreach2=function t(e,n,r,i){if(r===n.length-1)return i(e);var o,a=n[r],s=Array(a);for(o=a-1;o>=0;o--)s[o]=t(e[o],n,r+1,i);return s},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var t,e;for(t=0;t<numeric.mathfuns2.length;++t)e=numeric.mathfuns2[t],numeric.ops2[e]=e;for(t in numeric.ops2)if(numeric.ops2.hasOwnProperty(t)){e=numeric.ops2[t];var n,r,i="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,t)?(i="var "+e+" = Math."+e+";\n",n=function(t,n,r){return t+" = "+e+"("+n+","+r+")"},r=function(t,n){return t+" = "+e+"("+t+","+n+")"}):(n=function(t,n,r){return t+" = "+n+" "+e+" "+r},r=numeric.opseq.hasOwnProperty(t+"eq")?function(t,n){return t+" "+e+"= "+n}:function(t,n){return t+" = "+t+" "+e+" "+n}),numeric[t+"VV"]=numeric.pointwise2(["x[i]","y[i]"],n("ret[i]","x[i]","y[i]"),i),numeric[t+"SV"]=numeric.pointwise2(["x","y[i]"],n("ret[i]","x","y[i]"),i),numeric[t+"VS"]=numeric.pointwise2(["x[i]","y"],n("ret[i]","x[i]","y"),i),numeric[t]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+t+"VV, VS = numeric."+t+"VS, SV = numeric."+t+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+r("x","y")+"\n}\nreturn x;\n"),numeric[e]=numeric[t],numeric[t+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],r("ret[i]","x[i]"),i),numeric[t+"eqS"]=numeric.pointwise2(["ret[i]","x"],r("ret[i]","x"),i),numeric[t+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+t+"eqV, S = numeric."+t+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(t=0;t<numeric.mathfuns2.length;++t)e=numeric.mathfuns2[t],delete numeric.ops2[e];for(t=0;t<numeric.mathfuns.length;++t)e=numeric.mathfuns[t],numeric.ops1[e]=e;for(t in numeric.ops1)numeric.ops1.hasOwnProperty(t)&&(i="",e=numeric.ops1[t],-1!==numeric.myIndexOf.call(numeric.mathfuns,t)&&Math.hasOwnProperty(e)&&(i="var "+e+" = Math."+e+";\n"),numeric[t+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+e+"(ret[i]);",i),numeric[t+"eq"]=Function("x",'if(typeof x !== "object") return '+e+"x\nvar i;\nvar V = numeric."+t+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[t+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+e+"(x[i]);",i),numeric[t]=Function("x",'if(typeof x !== "object") return '+e+"(x)\nvar i;\nvar V = numeric."+t+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(t=0;t<numeric.mathfuns.length;++t)e=numeric.mathfuns[t],delete numeric.ops1[e];for(t in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(t)&&(e=numeric.mapreducers[t],numeric[t+"V"]=numeric.mapreduce2(e[0],e[1]),numeric[t]=Function("x","s","k",e[1]+'if(typeof x !== "object") {    xi = x;\n'+e[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+t+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+e[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(t,e){return"object"==typeof t?"object"==typeof e?numeric.truncVV(t,e):numeric.truncVS(t,e):"object"==typeof e?numeric.truncSV(t,e):Math.round(t/e)*e},numeric.inv=function(t){var e,n,r,i,o,a,s,u=numeric.dim(t),l=Math.abs,c=u[0],h=u[1],p=numeric.clone(t),f=numeric.identity(c);for(a=0;a<h;++a){var d=-1,m=-1;for(o=a;o!==c;++o)(s=l(p[o][a]))>m&&(d=o,m=s);for(n=p[d],p[d]=p[a],p[a]=n,i=f[d],f[d]=f[a],f[a]=i,t=n[a],s=a;s!==h;++s)n[s]/=t;for(s=h-1;-1!==s;--s)i[s]/=t;for(o=c-1;-1!==o;--o)if(o!==a){for(e=p[o],r=f[o],t=e[a],s=a+1;s!==h;++s)e[s]-=n[s]*t;for(s=h-1;s>0;--s)r[s]-=i[s]*t,r[--s]-=i[s]*t;0===s&&(r[0]-=i[0]*t)}}return f},numeric.det=function(t){var e=numeric.dim(t);if(2!==e.length||e[0]!==e[1])throw new Error("numeric: det() only works on square matrices");var n,r,i,o,a,s,u,l,c=e[0],h=1,p=numeric.clone(t);for(r=0;r<c-1;r++){for(i=r,n=r+1;n<c;n++)Math.abs(p[n][r])>Math.abs(p[i][r])&&(i=n);for(i!==r&&(u=p[i],p[i]=p[r],p[r]=u,h*=-1),o=p[r],n=r+1;n<c;n++){for(s=(a=p[n])[r]/o[r],i=r+1;i<c-1;i+=2)l=i+1,a[i]-=o[i]*s,a[l]-=o[l]*s;i!==c&&(a[i]-=o[i]*s)}if(0===o[r])return 0;h*=o[r]}return h*p[r][r]},numeric.transpose=function(t){var e,n,r,i,o,a=t.length,s=t[0].length,u=Array(s);for(n=0;n<s;n++)u[n]=Array(a);for(e=a-1;e>=1;e-=2){for(i=t[e],r=t[e-1],n=s-1;n>=1;--n)(o=u[n])[e]=i[n],o[e-1]=r[n],(o=u[--n])[e]=i[n],o[e-1]=r[n];0===n&&((o=u[0])[e]=i[0],o[e-1]=r[0])}if(0===e){for(r=t[0],n=s-1;n>=1;--n)u[n][0]=r[n],u[--n][0]=r[n];0===n&&(u[0][0]=r[0])}return u},numeric.negtranspose=function(t){var e,n,r,i,o,a=t.length,s=t[0].length,u=Array(s);for(n=0;n<s;n++)u[n]=Array(a);for(e=a-1;e>=1;e-=2){for(i=t[e],r=t[e-1],n=s-1;n>=1;--n)(o=u[n])[e]=-i[n],o[e-1]=-r[n],(o=u[--n])[e]=-i[n],o[e-1]=-r[n];0===n&&((o=u[0])[e]=-i[0],o[e-1]=-r[0])}if(0===e){for(r=t[0],n=s-1;n>=1;--n)u[n][0]=-r[n],u[--n][0]=-r[n];0===n&&(u[0][0]=-r[0])}return u},numeric._random=function t(e,n){var r,i,o=e[n],a=Array(o);if(n===e.length-1){for(i=Math.random,r=o-1;r>=1;r-=2)a[r]=i(),a[r-1]=i();return 0===r&&(a[0]=i()),a}for(r=o-1;r>=0;r--)a[r]=t(e,n+1);return a},numeric.random=function(t){return numeric._random(t,0)},numeric.norm2=function(t){return Math.sqrt(numeric.norm2Squared(t))},numeric.linspace=function(t,e,n){if(void 0===n&&(n=Math.max(Math.round(e-t)+1,1)),n<2)return 1===n?[t]:[];var r,i=Array(n);for(r=--n;r>=0;r--)i[r]=(r*e+(n-r)*t)/n;return i},numeric.getBlock=function(t,e,n){var r=numeric.dim(t);return function t(i,o){var a,s=e[o],u=n[o]-s,l=Array(u);if(o===r.length-1){for(a=u;a>=0;a--)l[a]=i[a+s];return l}for(a=u;a>=0;a--)l[a]=t(i[a+s],o+1);return l}(t,0)},numeric.setBlock=function(t,e,n,r){var i=numeric.dim(t);return function t(r,o,a){var s,u=e[a],l=n[a]-u;if(a===i.length-1)for(s=l;s>=0;s--)r[s+u]=o[s];for(s=l;s>=0;s--)t(r[s+u],o[s],a+1)}(t,r,0),t},numeric.getRange=function(t,e,n){var r,i,o,a,s=e.length,u=n.length,l=Array(s);for(r=s-1;-1!==r;--r)for(l[r]=Array(u),o=l[r],a=t[e[r]],i=u-1;-1!==i;--i)o[i]=a[n[i]];return l},numeric.blockMatrix=function(t){var e=numeric.dim(t);if(e.length<4)return numeric.blockMatrix([t]);var n,r,i,o,a,s=e[0],u=e[1];for(n=0,r=0,i=0;i<s;++i)n+=t[i][0].length;for(o=0;o<u;++o)r+=t[0][o][0].length;var l=Array(n);for(i=0;i<n;++i)l[i]=Array(r);var c,h,p,f,d,m=0;for(i=0;i<s;++i){for(c=r,o=u-1;-1!==o;--o)for(c-=(a=t[i][o])[0].length,p=a.length-1;-1!==p;--p)for(d=a[p],h=l[m+p],f=d.length-1;-1!==f;--f)h[c+f]=d[f];m+=t[i][0].length}return l},numeric.tensor=function(t,e){if("number"==typeof t||"number"==typeof e)return numeric.mul(t,e);var n=numeric.dim(t),r=numeric.dim(e);if(1!==n.length||1!==r.length)throw new Error("numeric: tensor product is only defined for vectors");var i,o,a,s,u=n[0],l=r[0],c=Array(u);for(o=u-1;o>=0;o--){for(i=Array(l),s=t[o],a=l-1;a>=3;--a)i[a]=s*e[a],i[--a]=s*e[a],i[--a]=s*e[a],i[--a]=s*e[a];for(;a>=0;)i[a]=s*e[a],--a;c[o]=i}return c},numeric.T=function(t,e){this.x=t,this.y=e},numeric.t=function(t,e){return new numeric.T(t,e)},numeric.Tbinop=function(t,e,n,r,i){var o;numeric.indexOf;if("string"!=typeof i)for(o in i="",numeric)numeric.hasOwnProperty(o)&&(t.indexOf(o)>=0||e.indexOf(o)>=0||n.indexOf(o)>=0||r.indexOf(o)>=0)&&o.length>1&&(i+="var "+o+" = numeric."+o+";\n");return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+i+"\nif(x.y) {  if(y.y) {    return new numeric.T("+r+");\n  }\n  return new numeric.T("+n+");\n}\nif(y.y) {\n  return new numeric.T("+e+");\n}\nreturn new numeric.T("+t+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var t=numeric.mul,e=numeric.div;if(this.y){var n=numeric.add(t(this.x,this.x),t(this.y,this.y));return new numeric.T(e(this.x,n),e(numeric.neg(this.y),n))}return new T(e(1,this.x))},numeric.T.prototype.div=function(t){if(t instanceof numeric.T||(t=new numeric.T(t)),t.y)return this.mul(t.reciprocal());var e=numeric.div;return this.y?new numeric.T(e(this.x,t.x),e(this.y,t.x)):new numeric.T(e(this.x,t.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var t=numeric.transpose,e=this.x,n=this.y;return n?new numeric.T(t(e),t(n)):new numeric.T(t(e))},numeric.T.prototype.transjugate=function(){var t=numeric.transpose,e=this.x,n=this.y;return n?new numeric.T(t(e),numeric.negtranspose(n)):new numeric.T(t(e))},numeric.Tunop=function(t,e,n){return"string"!=typeof n&&(n=""),Function("var x = this;\n"+n+"\nif(x.y) {  "+e+";\n}\n"+t+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var t=this;if(void 0===t.y)return new numeric.T(numeric.inv(t.x));var e,n,r,i,o,a,s,u,l,c,h,p,f,d,m,g,v,y,x=t.x.length,_=numeric.identity(x),b=numeric.rep([x,x],0),w=numeric.clone(t.x),M=numeric.clone(t.y);for(l=0;l<x;l++){for(p=(d=w[l][l])*d+(m=M[l][l])*m,h=l,c=l+1;c<x;c++)(f=(d=w[c][l])*d+(m=M[c][l])*m)>p&&(h=c,p=f);for(h!==l&&(y=w[l],w[l]=w[h],w[h]=y,y=M[l],M[l]=M[h],M[h]=y,y=_[l],_[l]=_[h],_[h]=y,y=b[l],b[l]=b[h],b[h]=y),e=w[l],n=M[l],o=_[l],a=b[l],d=e[l],m=n[l],c=l+1;c<x;c++)g=e[c],v=n[c],e[c]=(g*d+v*m)/p,n[c]=(v*d-g*m)/p;for(c=0;c<x;c++)g=o[c],v=a[c],o[c]=(g*d+v*m)/p,a[c]=(v*d-g*m)/p;for(c=l+1;c<x;c++){for(r=w[c],i=M[c],s=_[c],u=b[c],d=r[l],m=i[l],h=l+1;h<x;h++)g=e[h],v=n[h],r[h]-=g*d-v*m,i[h]-=v*d+g*m;for(h=0;h<x;h++)g=o[h],v=a[h],s[h]-=g*d-v*m,u[h]-=v*d+g*m}}for(l=x-1;l>0;l--)for(o=_[l],a=b[l],c=l-1;c>=0;c--)for(s=_[c],u=b[c],d=w[c][l],m=M[c][l],h=x-1;h>=0;h--)g=o[h],v=a[h],s[h]-=d*g-m*v,u[h]-=d*v+m*g;return new numeric.T(_,b)},numeric.T.prototype.get=function(t){var e,n=this.x,r=this.y,i=0,o=t.length;if(r){for(;i<o;)n=n[e=t[i]],r=r[e],i++;return new numeric.T(n,r)}for(;i<o;)n=n[e=t[i]],i++;return new numeric.T(n)},numeric.T.prototype.set=function(t,e){var n,r=this.x,i=this.y,o=0,a=t.length,s=e.x,u=e.y;if(0===a)return u?this.y=u:i&&(this.y=void 0),this.x=r,this;if(u){for(i||(i=numeric.rep(numeric.dim(r),0),this.y=i);o<a-1;)r=r[n=t[o]],i=i[n],o++;return r[n=t[o]]=s,i[n]=u,this}if(i){for(;o<a-1;)r=r[n=t[o]],i=i[n],o++;return r[n=t[o]]=s,i[n]=s instanceof Array?numeric.rep(numeric.dim(s),0):0,this}for(;o<a-1;)r=r[n=t[o]],o++;return r[n=t[o]]=s,this},numeric.T.prototype.getRows=function(t,e){var n,r,i=e-t+1,o=Array(i),a=this.x,s=this.y;for(n=t;n<=e;n++)o[n-t]=a[n];if(s){for(r=Array(i),n=t;n<=e;n++)r[n-t]=s[n];return new numeric.T(o,r)}return new numeric.T(o)},numeric.T.prototype.setRows=function(t,e,n){var r,i=this.x,o=this.y,a=n.x,s=n.y;for(r=t;r<=e;r++)i[r]=a[r-t];if(s)for(o||(o=numeric.rep(numeric.dim(i),0),this.y=o),r=t;r<=e;r++)o[r]=s[r-t];else if(o)for(r=t;r<=e;r++)o[r]=numeric.rep([a[r-t].length],0);return this},numeric.T.prototype.getRow=function(t){var e=this.x,n=this.y;return n?new numeric.T(e[t],n[t]):new numeric.T(e[t])},numeric.T.prototype.setRow=function(t,e){var n=this.x,r=this.y,i=e.x,o=e.y;return n[t]=i,o?(r||(r=numeric.rep(numeric.dim(n),0),this.y=r),r[t]=o):r&&(r=numeric.rep([i.length],0)),this},numeric.T.prototype.getBlock=function(t,e){var n=this.x,r=this.y,i=numeric.getBlock;return r?new numeric.T(i(n,t,e),i(r,t,e)):new numeric.T(i(n,t,e))},numeric.T.prototype.setBlock=function(t,e,n){n instanceof numeric.T||(n=new numeric.T(n));var r=this.x,i=this.y,o=numeric.setBlock,a=n.x,s=n.y;if(s)return i||(this.y=numeric.rep(numeric.dim(this),0),i=this.y),o(r,t,e,a),o(i,t,e,s),this;o(r,t,e,a),i&&o(i,t,e,numeric.rep(numeric.dim(a),0))},numeric.T.rep=function(t,e){var n=numeric.T;e instanceof n||(e=new n(e));var r=e.x,i=e.y,o=numeric.rep;return i?new n(o(t,r),o(t,i)):new n(o(t,r))},numeric.T.diag=function(t){t instanceof numeric.T||(t=new numeric.T(t));var e=t.x,n=t.y,r=numeric.diag;return n?new numeric.T(r(e),r(n)):new numeric.T(r(e))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(t){return new numeric.T(numeric.identity(t))},numeric.T.prototype.getDiag=function(){var t=numeric,e=this.x,n=this.y;return n?new t.T(t.getDiag(e),t.getDiag(n)):new t.T(t.getDiag(e))},numeric.house=function(t){var e=numeric.clone(t),n=(t[0]>=0?1:-1)*numeric.norm2(t);e[0]+=n;var r=numeric.norm2(e);if(0===r)throw new Error("eig: internal error");return numeric.div(e,r)},numeric.toUpperHessenberg=function(t){var e=numeric.dim(t);if(2!==e.length||e[0]!==e[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var n,r,i,o,a,s,u,l,c,h,p=e[0],f=numeric.clone(t),d=numeric.identity(p);for(r=0;r<p-2;r++){for(o=Array(p-r-1),n=r+1;n<p;n++)o[n-r-1]=f[n][r];if(numeric.norm2(o)>0){for(a=numeric.house(o),s=numeric.getBlock(f,[r+1,r],[p-1,p-1]),u=numeric.tensor(a,numeric.dot(a,s)),n=r+1;n<p;n++)for(l=f[n],c=u[n-r-1],i=r;i<p;i++)l[i]-=2*c[i-r];for(s=numeric.getBlock(f,[0,r+1],[p-1,p-1]),u=numeric.tensor(numeric.dot(s,a),a),n=0;n<p;n++)for(l=f[n],c=u[n],i=r+1;i<p;i++)l[i]-=2*c[i-r-1];for(s=Array(p-r-1),n=r+1;n<p;n++)s[n-r-1]=d[n];for(u=numeric.tensor(a,numeric.dot(a,s)),n=r+1;n<p;n++)for(h=d[n],c=u[n-r-1],i=0;i<p;i++)h[i]-=2*c[i]}}return{H:f,Q:d}},numeric.epsilon=2220446049250313e-31,numeric.QRFrancis=function(t,e){void 0===e&&(e=1e4),t=numeric.clone(t);numeric.clone(t);var n,r,i,o,a,s,u,l,c,h,p,f,d,m,g,v,y,x,_=numeric.dim(t)[0],b=numeric.identity(_);if(_<3)return{Q:b,B:[[0,_-1]]};var w=numeric.epsilon;for(x=0;x<e;x++){for(v=0;v<_-1;v++)if(Math.abs(t[v+1][v])<w*(Math.abs(t[v][v])+Math.abs(t[v+1][v+1]))){var M=numeric.QRFrancis(numeric.getBlock(t,[0,0],[v,v]),e),S=numeric.QRFrancis(numeric.getBlock(t,[v+1,v+1],[_-1,_-1]),e);for(f=Array(v+1),g=0;g<=v;g++)f[g]=b[g];for(d=numeric.dot(M.Q,f),g=0;g<=v;g++)b[g]=d[g];for(f=Array(_-v-1),g=v+1;g<_;g++)f[g-v-1]=b[g];for(d=numeric.dot(S.Q,f),g=v+1;g<_;g++)b[g]=d[g-v-1];return{Q:b,B:M.B.concat(numeric.add(S.B,v+1))}}var T,E,A;if(i=t[_-2][_-2],o=t[_-2][_-1],a=t[_-1][_-2],l=i+(s=t[_-1][_-1]),u=i*s-o*a,c=numeric.getBlock(t,[0,0],[2,2]),l*l>=4*u)T=.5*(l+Math.sqrt(l*l-4*u)),E=.5*(l-Math.sqrt(l*l-4*u)),c=numeric.add(numeric.sub(numeric.dot(c,c),numeric.mul(c,T+E)),numeric.diag(numeric.rep([3],T*E)));else c=numeric.add(numeric.sub(numeric.dot(c,c),numeric.mul(c,l)),numeric.diag(numeric.rep([3],u)));for(n=[c[0][0],c[1][0],c[2][0]],r=numeric.house(n),f=[t[0],t[1],t[2]],d=numeric.tensor(r,numeric.dot(r,f)),g=0;g<3;g++)for(p=t[g],m=d[g],y=0;y<_;y++)p[y]-=2*m[y];for(f=numeric.getBlock(t,[0,0],[_-1,2]),d=numeric.tensor(numeric.dot(f,r),r),g=0;g<_;g++)for(p=t[g],m=d[g],y=0;y<3;y++)p[y]-=2*m[y];for(f=[b[0],b[1],b[2]],d=numeric.tensor(r,numeric.dot(r,f)),g=0;g<3;g++)for(h=b[g],m=d[g],y=0;y<_;y++)h[y]-=2*m[y];for(v=0;v<_-2;v++){for(y=v;y<=v+1;y++)if(Math.abs(t[y+1][y])<w*(Math.abs(t[y][y])+Math.abs(t[y+1][y+1]))){M=numeric.QRFrancis(numeric.getBlock(t,[0,0],[y,y]),e),S=numeric.QRFrancis(numeric.getBlock(t,[y+1,y+1],[_-1,_-1]),e);for(f=Array(y+1),g=0;g<=y;g++)f[g]=b[g];for(d=numeric.dot(M.Q,f),g=0;g<=y;g++)b[g]=d[g];for(f=Array(_-y-1),g=y+1;g<_;g++)f[g-y-1]=b[g];for(d=numeric.dot(S.Q,f),g=y+1;g<_;g++)b[g]=d[g-y-1];return{Q:b,B:M.B.concat(numeric.add(S.B,y+1))}}for(A=Math.min(_-1,v+3),n=Array(A-v),g=v+1;g<=A;g++)n[g-v-1]=t[g][v];for(r=numeric.house(n),f=numeric.getBlock(t,[v+1,v],[A,_-1]),d=numeric.tensor(r,numeric.dot(r,f)),g=v+1;g<=A;g++)for(p=t[g],m=d[g-v-1],y=v;y<_;y++)p[y]-=2*m[y-v];for(f=numeric.getBlock(t,[0,v+1],[_-1,A]),d=numeric.tensor(numeric.dot(f,r),r),g=0;g<_;g++)for(p=t[g],m=d[g],y=v+1;y<=A;y++)p[y]-=2*m[y-v-1];for(f=Array(A-v),g=v+1;g<=A;g++)f[g-v-1]=b[g];for(d=numeric.tensor(r,numeric.dot(r,f)),g=v+1;g<=A;g++)for(h=b[g],m=d[g-v-1],y=0;y<_;y++)h[y]-=2*m[y]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(t,e){var n,r,i,o,a,s,u,l,c,h,p,f,d,m,g,v,y=numeric.toUpperHessenberg(t),x=numeric.QRFrancis(y.H,e),_=numeric.T,b=t.length,w=x.B,M=numeric.dot(x.Q,numeric.dot(y.H,numeric.transpose(x.Q))),S=new _(numeric.dot(x.Q,y.Q)),T=w.length,E=Math.sqrt;for(r=0;r<T;r++)if((n=w[r][0])===w[r][1]);else{if(o=n+1,a=M[n][n],s=M[n][o],u=M[o][n],l=M[o][o],0===s&&0===u)continue;(h=(c=-a-l)*c-4*(a*l-s*u))>=0?((g=(a-(p=c<0?-.5*(c-E(h)):-.5*(c+E(h))))*(a-p)+s*s)>(v=u*u+(l-p)*(l-p))?(d=(a-p)/(g=E(g)),m=s/g):(d=u/(v=E(v)),m=(l-p)/v),i=new _([[m,-d],[d,m]]),S.setRows(n,o,i.dot(S.getRows(n,o)))):(p=-.5*c,f=.5*E(-h),(g=(a-p)*(a-p)+s*s)>(v=u*u+(l-p)*(l-p))?(d=(a-p)/(g=E(g+f*f)),m=s/g,p=0,f/=g):(d=u/(v=E(v+f*f)),m=(l-p)/v,p=f/v,f=0),i=new _([[m,-d],[d,m]],[[p,f],[f,-p]]),S.setRows(n,o,i.dot(S.getRows(n,o))))}var A=S.dot(t).dot(S.transjugate()),P=(b=t.length,numeric.T.identity(b));for(o=0;o<b;o++)if(o>0)for(r=o-1;r>=0;r--){var C=A.get([r,r]),L=A.get([o,o]);numeric.neq(C.x,L.x)||numeric.neq(C.y,L.y)?(p=A.getRow(r).getBlock([r],[o-1]),f=P.getRow(o).getBlock([r],[o-1]),P.set([o,r],A.get([r,o]).neg().sub(p.dot(f)).div(C.sub(L)))):P.setRow(o,P.getRow(r))}for(o=0;o<b;o++)p=P.getRow(o),P.setRow(o,p.div(p.norm2()));return P=P.transpose(),P=S.transjugate().dot(P),{lambda:A.getDiag(),E:P}},numeric.ccsSparse=function(t){var e,n,r,i=t.length,o=[];for(n=i-1;-1!==n;--n)for(r in e=t[n]){for(r=parseInt(r);r>=o.length;)o[o.length]=0;0!==e[r]&&o[r]++}var a=o.length,s=Array(a+1);for(s[0]=0,n=0;n<a;++n)s[n+1]=s[n]+o[n];var u=Array(s[a]),l=Array(s[a]);for(n=i-1;-1!==n;--n)for(r in e=t[n])0!==e[r]&&(o[r]--,u[s[r]+o[r]]=n,l[s[r]+o[r]]=e[r]);return[s,u,l]},numeric.ccsFull=function(t){var e,n,r,i,o=t[0],a=t[1],s=t[2],u=numeric.ccsDim(t),l=u[0],c=u[1],h=numeric.rep([l,c],0);for(e=0;e<c;e++)for(r=o[e],i=o[e+1],n=r;n<i;++n)h[a[n]][e]=s[n];return h},numeric.ccsTSolve=function(t,e,n,r,i){var o,a,s,u,l,c,h,p=t[0],f=t[1],d=t[2],m=p.length-1,g=Math.max,v=0;function y(t){var e;if(0===n[t]){for(n[t]=1,e=p[t];e<p[t+1];++e)y(f[e]);i[v]=t,++v}}for(void 0===r&&(n=numeric.rep([m],0)),void 0===r&&(r=numeric.linspace(0,n.length-1)),void 0===i&&(i=[]),o=r.length-1;-1!==o;--o)y(r[o]);for(i.length=v,o=i.length-1;-1!==o;--o)n[i[o]]=0;for(o=r.length-1;-1!==o;--o)a=r[o],n[a]=e[a];for(o=i.length-1;-1!==o;--o){for(a=i[o],s=p[a],u=g(p[a+1],s),l=s;l!==u;++l)if(f[l]===a){n[a]/=d[l];break}for(h=n[a],l=s;l!==u;++l)(c=f[l])!==a&&(n[c]-=h*d[l])}return n},numeric.ccsDFS=function(t){this.k=Array(t),this.k1=Array(t),this.j=Array(t)},numeric.ccsDFS.prototype.dfs=function(t,e,n,r,i,o){var a,s,u,l=0,c=i.length,h=this.k,p=this.k1,f=this.j;if(0===r[t])for(r[t]=1,f[0]=t,h[0]=s=e[t],p[0]=u=e[t+1];;)if(s>=u){if(i[c]=f[l],0===l)return;++c,s=h[--l],u=p[l]}else 0===r[a=o[n[s]]]?(r[a]=1,h[l]=s,f[++l]=a,s=e[a],p[l]=u=e[a+1]):++s},numeric.ccsLPSolve=function(t,e,n,r,i,o,a){var s,u,l,c,h,p,f,d,m,g=t[0],v=t[1],y=t[2],x=(g.length,e[0]),_=e[1],b=e[2];for(u=x[i],l=x[i+1],r.length=0,s=u;s<l;++s)a.dfs(o[_[s]],g,v,n,r,o);for(s=r.length-1;-1!==s;--s)n[r[s]]=0;for(s=u;s!==l;++s)n[c=o[_[s]]]=b[s];for(s=r.length-1;-1!==s;--s){for(h=g[c=r[s]],p=g[c+1],f=h;f<p;++f)if(o[v[f]]===c){n[c]/=y[f];break}for(m=n[c],f=h;f<p;++f)(d=o[v[f]])!==c&&(n[d]-=m*y[f])}return n},numeric.ccsLUP1=function(t,e){var n,r,i,o,a,s,u,l=t[0].length-1,c=[numeric.rep([l+1],0),[],[]],h=[numeric.rep([l+1],0),[],[]],p=c[0],f=c[1],d=c[2],m=h[0],g=h[1],v=h[2],y=numeric.rep([l],0),x=numeric.rep([l],0),_=numeric.ccsLPSolve,b=(Math.max,Math.abs),w=numeric.linspace(0,l-1),M=numeric.linspace(0,l-1),S=new numeric.ccsDFS(l);for(void 0===e&&(e=1),n=0;n<l;++n){for(_(c,t,y,x,n,M,S),o=-1,a=-1,r=x.length-1;-1!==r;--r)(i=x[r])<=n||(s=b(y[i]))>o&&(a=i,o=s);for(b(y[n])<e*o&&(r=w[n],o=w[a],w[n]=o,M[o]=n,w[a]=r,M[r]=a,o=y[n],y[n]=y[a],y[a]=o),o=p[n],a=m[n],u=y[n],f[o]=w[n],d[o]=1,++o,r=x.length-1;-1!==r;--r)s=y[i=x[r]],x[r]=0,y[i]=0,i<=n?(g[a]=i,v[a]=s,++a):(f[o]=w[i],d[o]=s/u,++o);p[n+1]=o,m[n+1]=a}for(r=f.length-1;-1!==r;--r)f[r]=M[f[r]];return{L:c,U:h,P:w,Pinv:M}},numeric.ccsDFS0=function(t){this.k=Array(t),this.k1=Array(t),this.j=Array(t)},numeric.ccsDFS0.prototype.dfs=function(t,e,n,r,i,o,a){var s,u,l,c=0,h=i.length,p=this.k,f=this.k1,d=this.j;if(0===r[t])for(r[t]=1,d[0]=t,p[0]=u=e[o[t]],f[0]=l=e[o[t]+1];;){if(isNaN(u))throw new Error("Ow!");if(u>=l){if(i[h]=o[d[c]],0===c)return;++h,u=p[--c],l=f[c]}else 0===r[s=n[u]]?(r[s]=1,p[c]=u,d[++c]=s,u=e[s=o[s]],f[c]=l=e[s+1]):++u}},numeric.ccsLPSolve0=function(t,e,n,r,i,o,a,s){var u,l,c,h,p,f,d,m,g,v=t[0],y=t[1],x=t[2],_=(v.length,e[0]),b=e[1],w=e[2];for(l=_[i],c=_[i+1],r.length=0,u=l;u<c;++u)s.dfs(b[u],v,y,n,r,o,a);for(u=r.length-1;-1!==u;--u)n[a[h=r[u]]]=0;for(u=l;u!==c;++u)n[h=b[u]]=w[u];for(u=r.length-1;-1!==u;--u){for(m=a[h=r[u]],p=v[h],f=v[h+1],d=p;d<f;++d)if(y[d]===m){n[m]/=x[d];break}for(g=n[m],d=p;d<f;++d)n[y[d]]-=g*x[d];n[m]=g}},numeric.ccsLUP0=function(t,e){var n,r,i,o,a,s,u,l=t[0].length-1,c=[numeric.rep([l+1],0),[],[]],h=[numeric.rep([l+1],0),[],[]],p=c[0],f=c[1],d=c[2],m=h[0],g=h[1],v=h[2],y=numeric.rep([l],0),x=numeric.rep([l],0),_=numeric.ccsLPSolve0,b=(Math.max,Math.abs),w=numeric.linspace(0,l-1),M=numeric.linspace(0,l-1),S=new numeric.ccsDFS0(l);for(void 0===e&&(e=1),n=0;n<l;++n){for(_(c,t,y,x,n,M,w,S),o=-1,a=-1,r=x.length-1;-1!==r;--r)(i=x[r])<=n||(s=b(y[w[i]]))>o&&(a=i,o=s);for(b(y[w[n]])<e*o&&(r=w[n],o=w[a],w[n]=o,M[o]=n,w[a]=r,M[r]=a),o=p[n],a=m[n],u=y[w[n]],f[o]=w[n],d[o]=1,++o,r=x.length-1;-1!==r;--r)s=y[w[i=x[r]]],x[r]=0,y[w[i]]=0,i<=n?(g[a]=i,v[a]=s,++a):(f[o]=w[i],d[o]=s/u,++o);p[n+1]=o,m[n+1]=a}for(r=f.length-1;-1!==r;--r)f[r]=M[f[r]];return{L:c,U:h,P:w,Pinv:M}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(t){return[numeric.sup(t[1])+1,t[0].length-1]},numeric.ccsGetBlock=function(t,e,n){var r=numeric.ccsDim(t),i=r[0],o=r[1];void 0===e?e=numeric.linspace(0,i-1):"number"==typeof e&&(e=[e]),void 0===n?n=numeric.linspace(0,o-1):"number"==typeof n&&(n=[n]);var a,s,u,l,c=e.length,h=n.length,p=numeric.rep([o],0),f=[],d=[],m=[p,f,d],g=t[0],v=t[1],y=t[2],x=numeric.rep([i],0),_=0,b=numeric.rep([i],0);for(s=0;s<h;++s){var w=g[l=n[s]],M=g[l+1];for(a=w;a<M;++a)b[u=v[a]]=1,x[u]=y[a];for(a=0;a<c;++a)b[e[a]]&&(f[_]=a,d[_]=x[e[a]],++_);for(a=w;a<M;++a)b[u=v[a]]=0;p[s+1]=_}return m},numeric.ccsDot=function(t,e){var n,r,i,o,a,s,u,l,c,h,p,f=t[0],d=t[1],m=t[2],g=e[0],v=e[1],y=e[2],x=numeric.ccsDim(t),_=numeric.ccsDim(e),b=x[0],w=(x[1],_[1]),M=numeric.rep([b],0),S=numeric.rep([b],0),T=Array(b),E=numeric.rep([w],0),A=[],P=[],C=[E,A,P];for(i=0;i!==w;++i){for(o=g[i],a=g[i+1],c=0,r=o;r<a;++r)for(h=v[r],p=y[r],s=f[h],u=f[h+1],n=s;n<u;++n)0===S[l=d[n]]&&(T[c]=l,S[l]=1,c+=1),M[l]=M[l]+m[n]*p;for(a=(o=E[i])+c,E[i+1]=a,r=c-1;-1!==r;--r)p=o+r,n=T[r],A[p]=n,P[p]=M[n],S[n]=0,M[n]=0;E[i+1]=E[i]+c}return C},numeric.ccsLUPSolve=function(t,e){var n=t.L,r=t.U,i=(t.P,e[0]),o=!1;"object"!=typeof i&&(i=(e=[[0,e.length],numeric.linspace(0,e.length-1),e])[0],o=!0);var a,s,u,l,c,h,p=e[1],f=e[2],d=n[0].length-1,m=i.length-1,g=numeric.rep([d],0),v=Array(d),y=numeric.rep([d],0),x=Array(d),_=numeric.rep([m+1],0),b=[],w=[],M=numeric.ccsTSolve,S=0;for(a=0;a<m;++a){for(c=0,u=i[a],l=i[a+1],s=u;s<l;++s)h=t.Pinv[p[s]],x[c]=h,y[h]=f[s],++c;for(x.length=c,M(n,y,g,x,v),s=x.length-1;-1!==s;--s)y[x[s]]=0;if(M(r,g,y,v,x),o)return y;for(s=v.length-1;-1!==s;--s)g[v[s]]=0;for(s=x.length-1;-1!==s;--s)h=x[s],b[S]=h,w[S]=y[h],y[h]=0,++S;_[a+1]=S}return[_,b,w]},numeric.ccsbinop=function(t,e){return void 0===e&&(e=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+e+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+t+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(t){var e,n=t[0],r=t[1],i=t[2],o=numeric.sup(r)+1,a=n.length,s=numeric.rep([o],0),u=Array(a),l=Array(a),c=numeric.rep([o],0);for(e=0;e<a;++e)c[r[e]]++;for(e=0;e<o;++e)s[e+1]=s[e]+c[e];var h,p,f=s.slice(0);for(e=0;e<a;++e)u[h=f[p=r[e]]]=n[e],l[h]=i[e],f[p]=f[p]+1;return[s,u,l]},numeric.ccsGather=function(t){var e,n,r,i,o,a=t[0],s=t[1],u=t[2],l=a.length-1,c=s.length,h=Array(c),p=Array(c),f=Array(c);for(o=0,e=0;e<l;++e)for(r=a[e],i=a[e+1],n=r;n!==i;++n)p[o]=e,h[o]=s[n],f[o]=u[n],++o;return[h,p,f]},numeric.sdim=function t(e,n,r){if(void 0===n&&(n=[]),"object"!=typeof e)return n;var i;for(i in void 0===r&&(r=0),r in n||(n[r]=0),e.length>n[r]&&(n[r]=e.length),e)e.hasOwnProperty(i)&&t(e[i],n,r+1);return n},numeric.sclone=function t(e,n,r){void 0===n&&(n=0),void 0===r&&(r=numeric.sdim(e).length);var i,o=Array(e.length);if(n===r-1){for(i in e)e.hasOwnProperty(i)&&(o[i]=e[i]);return o}for(i in e)e.hasOwnProperty(i)&&(o[i]=t(e[i],n+1,r));return o},numeric.sdiag=function(t){var e,n,r=t.length,i=Array(r);for(e=r-1;e>=1;e-=2)n=e-1,i[e]=[],i[e][e]=t[e],i[n]=[],i[n][n]=t[n];return 0===e&&(i[0]=[],i[0][0]=t[e]),i},numeric.sidentity=function(t){return numeric.sdiag(numeric.rep([t],1))},numeric.stranspose=function(t){var e,n,r,i=[];t.length;for(e in t)if(t.hasOwnProperty(e))for(n in r=t[e])r.hasOwnProperty(n)&&("object"!=typeof i[n]&&(i[n]=[]),i[n][e]=r[n]);return i},numeric.sLUP=function(t,e){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(t,e){var n,r,i,o,a,s,u,l=t.length,c=(e.length,numeric.stranspose(e)),h=c.length,p=Array(l);for(i=l-1;i>=0;i--){for(u=[],n=t[i],a=h-1;a>=0;a--){for(o in s=0,r=c[a],n)n.hasOwnProperty(o)&&o in r&&(s+=n[o]*r[o]);s&&(u[a]=s)}p[i]=u}return p},numeric.sdotMV=function(t,e){var n,r,i,o,a=t.length,s=Array(a);for(r=a-1;r>=0;r--){for(i in o=0,n=t[r])n.hasOwnProperty(i)&&e[i]&&(o+=n[i]*e[i]);o&&(s[r]=o)}return s},numeric.sdotVM=function(t,e){var n,r,i,o,a=[];for(n in t)if(t.hasOwnProperty(n))for(r in i=e[n],o=t[n],i)i.hasOwnProperty(r)&&(a[r]||(a[r]=0),a[r]+=o*i[r]);return a},numeric.sdotVV=function(t,e){var n,r=0;for(n in t)t[n]&&e[n]&&(r+=t[n]*e[n]);return r},numeric.sdot=function(t,e){var n=numeric.sdim(t).length,r=numeric.sdim(e).length;switch(1e3*n+r){case 0:return t*e;case 1001:return numeric.sdotVV(t,e);case 2001:return numeric.sdotMV(t,e);case 1002:return numeric.sdotVM(t,e);case 2002:return numeric.sdotMM(t,e);default:throw new Error("numeric.sdot not implemented for tensors of order "+n+" and "+r)}},numeric.sscatter=function(t){var e,n,r,i,o=t[0].length,a=t.length,s=[];for(n=o-1;n>=0;--n)if(t[a-1][n]){for(i=s,r=0;r<a-2;r++)i[e=t[r][n]]||(i[e]=[]),i=i[e];i[t[r][n]]=t[r+1][n]}return s},numeric.sgather=function t(e,n,r){var i,o,a;for(o in void 0===n&&(n=[]),void 0===r&&(r=[]),i=r.length,e)if(e.hasOwnProperty(o))if(r[i]=parseInt(o),"number"==typeof(a=e[o])){if(a){if(0===n.length)for(o=i+1;o>=0;--o)n[o]=[];for(o=i;o>=0;--o)n[o].push(r[o]);n[i+1].push(a)}}else t(a,n,r);return r.length>i&&r.pop(),n},numeric.cLU=function(t){var e,n,r,i,o,a,s=t[0],u=t[1],l=t[2],c=s.length,h=0;for(e=0;e<c;e++)s[e]>h&&(h=s[e]);h++;var p,f=Array(h),d=Array(h),m=numeric.rep([h],1/0),g=numeric.rep([h],-1/0);for(r=0;r<c;r++)e=s[r],(n=u[r])<m[e]&&(m[e]=n),n>g[e]&&(g[e]=n);for(e=0;e<h-1;e++)g[e]>g[e+1]&&(g[e+1]=g[e]);for(e=h-1;e>=1;e--)m[e]<m[e-1]&&(m[e-1]=m[e]);for(e=0;e<h;e++)d[e]=numeric.rep([g[e]-m[e]+1],0),f[e]=numeric.rep([e-m[e]],0),e-m[e]+1,g[e]-e+1;for(r=0;r<c;r++)d[e=s[r]][u[r]-m[e]]=l[r];for(e=0;e<h-1;e++)for(i=e-m[e],x=d[e],n=e+1;m[n]<=e&&n<h;n++)if(o=e-m[n],a=g[e]-e,p=(_=d[n])[o]/x[i]){for(r=1;r<=a;r++)_[r+o]-=p*x[r+i];f[n][e-m[n]]=p}var v,y,x=[],_=[],b=[],w=[],M=[],S=[];for(c=0,v=0,e=0;e<h;e++){for(i=m[e],o=g[e],y=d[e],n=e;n<=o;n++)y[n-i]&&(x[c]=e,_[c]=n,b[c]=y[n-i],c++);for(y=f[e],n=i;n<e;n++)y[n-i]&&(w[v]=e,M[v]=n,S[v]=y[n-i],v++);w[v]=e,M[v]=e,S[v]=1,v++}return{U:[x,_,b],L:[w,M,S]}},numeric.cLUsolve=function(t,e){var n,r,i=t.L,o=t.U,a=numeric.clone(e),s=i[0],u=i[1],l=i[2],c=o[0],h=o[1],p=o[2],f=c.length,d=(s.length,a.length);for(r=0,n=0;n<d;n++){for(;u[r]<n;)a[n]-=l[r]*a[u[r]],r++;r++}for(r=f-1,n=d-1;n>=0;n--){for(;h[r]>n;)a[n]-=p[r]*a[h[r]],r--;a[n]/=p[r],r--}return a},numeric.cgrid=function(t,e){"number"==typeof t&&(t=[t,t]);var n,r,i,o=numeric.rep(t,-1);if("function"!=typeof e)if("L"===e)e=function(e,n){return e>=t[0]/2||n<t[1]/2};else e=function(t,e){return!0};for(i=0,n=1;n<t[0]-1;n++)for(r=1;r<t[1]-1;r++)e(n,r)&&(o[n][r]=i,i++);return o},numeric.cdelsq=function(t){var e,n,r,i,o,a=[[-1,0],[0,-1],[0,1],[1,0]],s=numeric.dim(t),u=s[0],l=s[1],c=[],h=[],p=[];for(e=1;e<u-1;e++)for(n=1;n<l-1;n++)if(!(t[e][n]<0)){for(r=0;r<4;r++)i=e+a[r][0],o=n+a[r][1],t[i][o]<0||(c.push(t[e][n]),h.push(t[i][o]),p.push(-1));c.push(t[e][n]),h.push(t[e][n]),p.push(4)}return[c,h,p]},numeric.cdotMV=function(t,e){var n,r,i,o=t[0],a=t[1],s=t[2],u=o.length;for(i=0,r=0;r<u;r++)o[r]>i&&(i=o[r]);for(i++,n=numeric.rep([i],0),r=0;r<u;r++)n[o[r]]+=s[r]*e[a[r]];return n},numeric.Spline=function(t,e,n,r,i){this.x=t,this.yl=e,this.yr=n,this.kl=r,this.kr=i},numeric.Spline.prototype._at=function(t,e){var n,r,i,o=this.x,a=this.yl,s=this.yr,u=this.kl,l=this.kr,c=numeric.add,h=numeric.sub,p=numeric.mul;n=h(p(u[e],o[e+1]-o[e]),h(s[e+1],a[e])),r=c(p(l[e+1],o[e]-o[e+1]),h(s[e+1],a[e]));var f=(i=(t-o[e])/(o[e+1]-o[e]))*(1-i);return c(c(c(p(1-i,a[e]),p(i,s[e+1])),p(n,f*(1-i))),p(r,f*i))},numeric.Spline.prototype.at=function(t){if("number"==typeof t){var e,n,r,i=this.x,o=i.length,a=Math.floor;for(e=0,n=o-1;n-e>1;)i[r=a((e+n)/2)]<=t?e=r:n=r;return this._at(t,e)}o=t.length;var s,u=Array(o);for(s=o-1;-1!==s;--s)u[s]=this.at(t[s]);return u},numeric.Spline.prototype.diff=function(){var t,e,n,r=this.x,i=this.yl,o=this.yr,a=this.kl,s=this.kr,u=i.length,l=a,c=s,h=Array(u),p=Array(u),f=numeric.add,d=numeric.mul,m=numeric.div,g=numeric.sub;for(t=u-1;-1!==t;--t)e=r[t+1]-r[t],n=g(o[t+1],i[t]),h[t]=m(f(d(n,6),d(a[t],-4*e),d(s[t+1],-2*e)),e*e),p[t+1]=m(f(d(n,-6),d(a[t],2*e),d(s[t+1],4*e)),e*e);return new numeric.Spline(r,l,c,h,p)},numeric.Spline.prototype.roots=function(){function t(t){return t*t}var e=[],n=this.x,r=this.yl,i=this.yr,o=this.kl,a=this.kr;"number"==typeof r[0]&&(r=[r],i=[i],o=[o],a=[a]);var s,u,l,c,h,p,f,d,m,g,v,y,x,_,b,w,M,S,T,E,A,P,C,L=r.length,I=n.length-1,O=(e=Array(L),Math.sqrt);for(s=0;s!==L;++s){for(c=r[s],h=i[s],p=o[s],f=a[s],d=[],u=0;u!==I;u++){for(u>0&&h[u]*c[u]<0&&d.push(n[u]),w=n[u+1]-n[u],n[u],v=c[u],y=h[u+1],m=p[u]/w,x=(g=f[u+1]/w)+3*v+2*m-3*y,_=3*(g+m+2*(v-y)),(b=t(m-g+3*(v-y))+12*g*v)<=0?M=(S=x/_)>n[u]&&S<n[u+1]?[n[u],S,n[u+1]]:[n[u],n[u+1]]:(S=(x-O(b))/_,T=(x+O(b))/_,M=[n[u]],S>n[u]&&S<n[u+1]&&M.push(S),T>n[u]&&T<n[u+1]&&M.push(T),M.push(n[u+1])),A=M[0],S=this._at(A,u),l=0;l<M.length-1;l++)if(P=M[l+1],T=this._at(P,u),0!==S)if(0===T||S*T>0)A=P,S=T;else{for(var N=0;!((C=(S*P-T*A)/(S-T))<=A||C>=P);)if((E=this._at(C,u))*T>0)P=C,T=E,-1===N&&(S*=.5),N=-1;else{if(!(E*S>0))break;A=C,S=E,1===N&&(T*=.5),N=1}d.push(C),A=M[l+1],S=this._at(A,u)}else d.push(A),A=P,S=T;0===T&&d.push(P)}e[s]=d}return"number"==typeof this.yl[0]?e[0]:e},numeric.spline=function(t,e,n,r){var i,o=t.length,a=[],s=[],u=[],l=numeric.sub,c=numeric.mul,h=numeric.add;for(i=o-2;i>=0;i--)s[i]=t[i+1]-t[i],u[i]=l(e[i+1],e[i]);"string"!=typeof n&&"string"!=typeof r||(n=r="periodic");var p=[[],[],[]];switch(typeof n){case"undefined":a[0]=c(3/(s[0]*s[0]),u[0]),p[0].push(0,0),p[1].push(0,1),p[2].push(2/s[0],1/s[0]);break;case"string":a[0]=h(c(3/(s[o-2]*s[o-2]),u[o-2]),c(3/(s[0]*s[0]),u[0])),p[0].push(0,0,0),p[1].push(o-2,0,1),p[2].push(1/s[o-2],2/s[o-2]+2/s[0],1/s[0]);break;default:a[0]=n,p[0].push(0),p[1].push(0),p[2].push(1)}for(i=1;i<o-1;i++)a[i]=h(c(3/(s[i-1]*s[i-1]),u[i-1]),c(3/(s[i]*s[i]),u[i])),p[0].push(i,i,i),p[1].push(i-1,i,i+1),p[2].push(1/s[i-1],2/s[i-1]+2/s[i],1/s[i]);switch(typeof r){case"undefined":a[o-1]=c(3/(s[o-2]*s[o-2]),u[o-2]),p[0].push(o-1,o-1),p[1].push(o-2,o-1),p[2].push(1/s[o-2],2/s[o-2]);break;case"string":p[1][p[1].length-1]=0;break;default:a[o-1]=r,p[0].push(o-1),p[1].push(o-1),p[2].push(1)}a="number"!=typeof a[0]?numeric.transpose(a):[a];var f=Array(a.length);if("string"==typeof n)for(i=f.length-1;-1!==i;--i)f[i]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(p)),a[i]),f[i][o-1]=f[i][0];else for(i=f.length-1;-1!==i;--i)f[i]=numeric.cLUsolve(numeric.cLU(p),a[i]);return f="number"==typeof e[0]?f[0]:numeric.transpose(f),new numeric.Spline(t,e,e,f,f)},numeric.fftpow2=function t(e,n){var r=e.length;if(1!==r){var i,o,a=Math.cos,s=Math.sin,u=Array(r/2),l=Array(r/2),c=Array(r/2),h=Array(r/2);for(o=r/2,i=r-1;-1!==i;--i)c[--o]=e[i],h[o]=n[i],--i,u[o]=e[i],l[o]=n[i];t(u,l),t(c,h),o=r/2;var p,f,d,m=-6.283185307179586/r;for(i=r-1;-1!==i;--i)-1===--o&&(o=r/2-1),f=a(p=m*i),d=s(p),e[i]=u[o]+f*c[o]-d*h[o],n[i]=l[o]+f*h[o]+d*c[o]}},numeric._ifftpow2=function t(e,n){var r=e.length;if(1!==r){var i,o,a=Math.cos,s=Math.sin,u=Array(r/2),l=Array(r/2),c=Array(r/2),h=Array(r/2);for(o=r/2,i=r-1;-1!==i;--i)c[--o]=e[i],h[o]=n[i],--i,u[o]=e[i],l[o]=n[i];t(u,l),t(c,h),o=r/2;var p,f,d,m=6.283185307179586/r;for(i=r-1;-1!==i;--i)-1===--o&&(o=r/2-1),f=a(p=m*i),d=s(p),e[i]=u[o]+f*c[o]-d*h[o],n[i]=l[o]+f*h[o]+d*c[o]}},numeric.ifftpow2=function(t,e){numeric._ifftpow2(t,e),numeric.diveq(t,t.length),numeric.diveq(e,e.length)},numeric.convpow2=function(t,e,n,r){var i,o,a,s,u;for(numeric.fftpow2(t,e),numeric.fftpow2(n,r),i=t.length-1;-1!==i;--i)o=t[i],s=e[i],a=n[i],u=r[i],t[i]=o*a-s*u,e[i]=o*u+s*a;numeric.ifftpow2(t,e)},numeric.T.prototype.fft=function(){var t,e,n=this.x,r=this.y,i=n.length,o=Math.log,a=o(2),s=Math.ceil(o(2*i-1)/a),u=Math.pow(2,s),l=numeric.rep([u],0),c=numeric.rep([u],0),h=Math.cos,p=Math.sin,f=-3.141592653589793/i,d=numeric.rep([u],0),m=numeric.rep([u],0);Math.floor(i/2);for(t=0;t<i;t++)d[t]=n[t];if(void 0!==r)for(t=0;t<i;t++)m[t]=r[t];for(l[0]=1,t=1;t<=u/2;t++)e=f*t*t,l[t]=h(e),c[t]=p(e),l[u-t]=h(e),c[u-t]=p(e);var g=new numeric.T(d,m),v=new numeric.T(l,c);return g=g.mul(v),numeric.convpow2(g.x,g.y,numeric.clone(v.x),numeric.neg(v.y)),(g=g.mul(v)).x.length=i,g.y.length=i,g},numeric.T.prototype.ifft=function(){var t,e,n=this.x,r=this.y,i=n.length,o=Math.log,a=o(2),s=Math.ceil(o(2*i-1)/a),u=Math.pow(2,s),l=numeric.rep([u],0),c=numeric.rep([u],0),h=Math.cos,p=Math.sin,f=3.141592653589793/i,d=numeric.rep([u],0),m=numeric.rep([u],0);Math.floor(i/2);for(t=0;t<i;t++)d[t]=n[t];if(void 0!==r)for(t=0;t<i;t++)m[t]=r[t];for(l[0]=1,t=1;t<=u/2;t++)e=f*t*t,l[t]=h(e),c[t]=p(e),l[u-t]=h(e),c[u-t]=p(e);var g=new numeric.T(d,m),v=new numeric.T(l,c);return g=g.mul(v),numeric.convpow2(g.x,g.y,numeric.clone(v.x),numeric.neg(v.y)),(g=g.mul(v)).x.length=i,g.y.length=i,g.div(i)},numeric.gradient=function(t,e){var n=e.length,r=t(e);if(isNaN(r))throw new Error("gradient: f(x) is a NaN!");var i,o,a,s,u,l,c,h,p,f=Math.max,d=numeric.clone(e),m=Array(n),g=(numeric.div,numeric.sub,f=Math.max,Math.abs),v=Math.min,y=0;for(i=0;i<n;i++)for(var x=f(1e-6*r,1e-8);;){if(++y>20)throw new Error("Numerical gradient fails");if(d[i]=e[i]+x,o=t(d),d[i]=e[i]-x,a=t(d),d[i]=e[i],isNaN(o)||isNaN(a))x/=16;else{if(m[i]=(o-a)/(2*x),s=e[i]-x,u=e[i],l=e[i]+x,c=(o-r)/x,h=(r-a)/x,p=f(g(m[i]),g(r),g(o),g(a),g(s),g(u),g(l),1e-8),!(v(f(g(c-m[i]),g(h-m[i]),g(c-h))/p,x/p)>.001))break;x/=16}}return m},numeric.uncmin=function(t,e,n,r,i,o,a){var s=numeric.gradient;void 0===a&&(a={}),void 0===n&&(n=1e-8),void 0===r&&(r=function(e){return s(t,e)}),void 0===i&&(i=1e3);var u,l,c=(e=numeric.clone(e)).length,h=t(e);if(isNaN(h))throw new Error("uncmin: f(x0) is a NaN!");var p=Math.max,f=numeric.norm2;n=p(n,numeric.epsilon);var d,m,g,v,y,x,_,b,w,M,S=a.Hinv||numeric.identity(c),T=numeric.dot,E=(numeric.inv,numeric.sub),A=numeric.add,P=numeric.tensor,C=numeric.div,L=numeric.mul,I=numeric.all,O=numeric.isFinite,N=numeric.neg,R=0,D="";for(m=r(e);R<i;){if("function"==typeof o&&o(R,e,h,m,S)){D="Callback returned true";break}if(!I(O(m))){D="Gradient has Infinity or NaN";break}if(!I(O(d=N(T(S,m))))){D="Search direction has Infinity or NaN";break}if((M=f(d))<n){D="Newton step smaller than tol";break}for(w=1,l=T(m,d),y=e;R<i&&!(w*M<n)&&(y=A(e,v=L(d,w)),(u=t(y))-h>=.1*w*l||isNaN(u));)w*=.5,++R;if(w*M<n){D="Line search step size smaller than tol";break}if(R===i){D="maxit reached during line search";break}b=T(x=E(g=r(y),m),v),_=T(S,x),S=E(A(S,L((b+T(x,_))/(b*b),P(v,v))),C(A(P(_,v),P(v,_)),b)),e=y,h=u,m=g,++R}return{solution:e,f:h,gradient:m,invHessian:S,iterations:R,message:D}},numeric.Dopri=function(t,e,n,r,i,o,a){this.x=t,this.y=e,this.f=n,this.ymid=r,this.iterations=i,this.events=a,this.message=o},numeric.Dopri.prototype._at=function(t,e){function n(t){return t*t}var r,i,o,a,s,u,l,c,h,p=this,f=p.x,d=p.y,m=p.f,g=p.ymid,v=(f.length,Math.floor,numeric.add),y=numeric.mul,x=numeric.sub;return r=f[e],i=f[e+1],a=d[e],s=d[e+1],o=r+.5*(i-r),u=g[e],l=x(m[e],y(a,1/(r-o)+2/(r-i))),c=x(m[e+1],y(s,1/(i-o)+2/(i-r))),v(v(v(v(y(a,(h=[n(t-i)*(t-o)/n(r-i)/(r-o),n(t-r)*n(t-i)/n(r-o)/n(i-o),n(t-r)*(t-o)/n(i-r)/(i-o),(t-r)*n(t-i)*(t-o)/n(r-i)/(r-o),(t-i)*n(t-r)*(t-o)/n(r-i)/(i-o)])[0]),y(u,h[1])),y(s,h[2])),y(l,h[3])),y(c,h[4]))},numeric.Dopri.prototype.at=function(t){var e,n,r,i=Math.floor;if("number"!=typeof t){var o=t.length,a=Array(o);for(e=o-1;-1!==e;--e)a[e]=this.at(t[e]);return a}var s=this.x;for(e=0,n=s.length-1;n-e>1;)s[r=i(.5*(e+n))]<=t?e=r:n=r;return this._at(t,e)},numeric.dopri=function(t,e,n,r,i,o,a){void 0===i&&(i=1e-6),void 0===o&&(o=1e3);var s,u,l,c,h,p,f,d,m,g,v,y,x,_=[t],b=[n],w=[r(t,n)],M=[],S=[3/40,9/40],T=[44/45,-56/15,32/9],E=[19372/6561,-25360/2187,64448/6561,-212/729],A=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],P=[35/384,0,500/1113,125/192,-2187/6784,11/84],C=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,5618549.5/235043384],L=[.2,.3,.8,8/9,1,1],I=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,1/40],O=0,N=(e-t)/10,R=0,D=numeric.add,k=numeric.mul,F=(Math.max,Math.min),B=Math.abs,U=numeric.norminf,z=Math.pow,V=numeric.any,G=numeric.lt,j=numeric.and,W=(numeric.sub,new numeric.Dopri(_,b,w,M,-1,""));for("function"==typeof a&&(v=a(t,n));t<e&&R<o;)if(++R,t+N>e&&(N=e-t),s=r(t+L[0]*N,D(n,k(.2*N,w[O]))),u=r(t+L[1]*N,D(D(n,k(S[0]*N,w[O])),k(S[1]*N,s))),l=r(t+L[2]*N,D(D(D(n,k(T[0]*N,w[O])),k(T[1]*N,s)),k(T[2]*N,u))),c=r(t+L[3]*N,D(D(D(D(n,k(E[0]*N,w[O])),k(E[1]*N,s)),k(E[2]*N,u)),k(E[3]*N,l))),h=r(t+L[4]*N,D(D(D(D(D(n,k(A[0]*N,w[O])),k(A[1]*N,s)),k(A[2]*N,u)),k(A[3]*N,l)),k(A[4]*N,c))),p=r(t+N,m=D(D(D(D(D(n,k(w[O],N*P[0])),k(u,N*P[2])),k(l,N*P[3])),k(c,N*P[4])),k(h,N*P[5]))),(g="number"==typeof(f=D(D(D(D(D(k(w[O],N*I[0]),k(u,N*I[2])),k(l,N*I[3])),k(c,N*I[4])),k(h,N*I[5])),k(p,N*I[6])))?B(f):U(f))>i){if(t+(N=.2*N*z(i/g,.25))===t){W.msg="Step size became too small";break}}else{if(M[O]=D(D(D(D(D(D(n,k(w[O],N*C[0])),k(u,N*C[2])),k(l,N*C[3])),k(c,N*C[4])),k(h,N*C[5])),k(p,N*C[6])),_[++O]=t+N,b[O]=m,w[O]=p,"function"==typeof a){var H,X,Y=t,q=t+.5*N;if(y=a(q,M[O-1]),V(x=j(G(v,0),G(0,y)))||(Y=q,v=y,y=a(q=t+N,m),x=j(G(v,0),G(0,y))),V(x)){for(var Z,J,K=0,Q=1,$=1;;){if("number"==typeof v)X=($*y*Y-Q*v*q)/($*y-Q*v);else for(X=q,d=v.length-1;-1!==d;--d)v[d]<0&&y[d]>0&&(X=F(X,($*y[d]*Y-Q*v[d]*q)/($*y[d]-Q*v[d])));if(X<=Y||X>=q)break;J=a(X,H=W._at(X,O-1)),V(Z=j(G(v,0),G(0,J)))?(q=X,y=J,x=Z,$=1,-1===K?Q*=.5:Q=1,K=-1):(Y=X,v=J,Q=1,1===K?$*=.5:$=1,K=1)}return m=W._at(.5*(t+X),O-1),W.f[O]=r(X,H),W.x[O]=X,W.y[O]=H,W.ymid[O-1]=m,W.events=x,W.iterations=R,W}}t+=N,n=m,v=y,N=F(.8*N*z(i/g,.25),4*N)}return W.iterations=R,W},numeric.LU=function(t,e){e=e||!1;var n,r,i,o,a,s,u,l,c,h=Math.abs,p=t.length,f=p-1,d=new Array(p);for(e||(t=numeric.clone(t)),i=0;i<p;++i){for(u=i,c=h((s=t[i])[i]),r=i+1;r<p;++r)c<(o=h(t[r][i]))&&(c=o,u=r);for(d[i]=u,u!=i&&(t[i]=t[u],t[u]=s,s=t[i]),a=s[i],n=i+1;n<p;++n)t[n][i]/=a;for(n=i+1;n<p;++n){for(l=t[n],r=i+1;r<f;++r)l[r]-=l[i]*s[r],l[++r]-=l[i]*s[r];r===f&&(l[r]-=l[i]*s[r])}}return{LU:t,P:d}},numeric.LUsolve=function(t,e){var n,r,i,o,a,s=t.LU,u=s.length,l=numeric.clone(e),c=t.P;for(n=u-1;-1!==n;--n)l[n]=e[n];for(n=0;n<u;++n)for(i=c[n],c[n]!==n&&(a=l[n],l[n]=l[i],l[i]=a),o=s[n],r=0;r<n;++r)l[n]-=l[r]*o[r];for(n=u-1;n>=0;--n){for(o=s[n],r=n+1;r<u;++r)l[n]-=l[r]*o[r];l[n]/=o[n]}return l},numeric.solve=function(t,e,n){return numeric.LUsolve(numeric.LU(t,n),e)},numeric.echelonize=function(t){var e,n,r,i,o,a,s,u,l=numeric.dim(t),c=l[0],h=l[1],p=numeric.identity(c),f=Array(c),d=Math.abs,m=numeric.diveq;for(t=numeric.clone(t),e=0;e<c;++e){for(r=0,o=t[e],a=p[e],n=1;n<h;++n)d(o[r])<d(o[n])&&(r=n);for(f[e]=r,m(a,o[r]),m(o,o[r]),n=0;n<c;++n)if(n!==e){for(u=(s=t[n])[r],i=h-1;-1!==i;--i)s[i]-=o[i]*u;for(s=p[n],i=c-1;-1!==i;--i)s[i]-=a[i]*u}}return{I:p,A:t,P:f}},numeric.__solveLP=function(t,e,n,r,i,o,a){var s,u,l,c,h=numeric.sum,p=(numeric.log,numeric.mul),f=numeric.sub,d=numeric.dot,m=numeric.div,g=numeric.add,v=t.length,y=n.length,x=!1,_=1,b=(numeric.transpose(e),numeric.svd,numeric.transpose),w=(numeric.leq,Math.sqrt),M=Math.abs,S=(numeric.muleq,numeric.norminf,numeric.any,Math.min),T=numeric.all,E=numeric.gt,A=Array(v),P=Array(y),C=(numeric.rep([y],1),numeric.solve),L=f(n,d(e,o)),I=d(t,t);for(l=0;l<i;++l){var O,N;for(O=y-1;-1!==O;--O)P[O]=m(e[O],L[O]);var R=b(P);for(O=v-1;-1!==O;--O)A[O]=h(R[O]);_=.25*M(I/d(t,A));var D=100*w(I/d(A,A));for((!isFinite(_)||_>D)&&(_=D),c=g(t,p(_,A)),u=d(R,P),O=v-1;-1!==O;--O)u[O][O]+=1;N=C(u,m(c,_),!0);var k=m(L,d(e,N)),F=1;for(O=y-1;-1!==O;--O)k[O]<0&&(F=S(F,-.999*k[O]));if(s=f(o,p(N,F)),!T(E(L=f(n,d(e,s)),0)))return{solution:o,message:"",iterations:l};if(o=s,_<r)return{solution:s,message:"",iterations:l};if(a){var B=d(t,c),U=d(e,c);for(x=!0,O=y-1;-1!==O;--O)if(B*U[O]<0){x=!1;break}}else x=!(o[v-1]>=0);if(x)return{solution:s,message:"Unbounded",iterations:l}}return{solution:o,message:"maximum iteration count exceeded",iterations:l}},numeric._solveLP=function(t,e,n,r,i){var o=t.length,a=n.length,s=(numeric.sum,numeric.log,numeric.mul,numeric.sub),u=numeric.dot,l=(numeric.div,numeric.add,numeric.rep([o],0).concat([1])),c=numeric.rep([a,1],-1),h=numeric.blockMatrix([[e,c]]),p=n,f=numeric.rep([o],0).concat(Math.max(0,numeric.sup(numeric.neg(n)))+1),d=numeric.__solveLP(l,h,p,r,i,f,!1),m=numeric.clone(d.solution);if(m.length=o,numeric.inf(s(n,u(e,m)))<0)return{solution:NaN,message:"Infeasible",iterations:d.iterations};var g=numeric.__solveLP(t,e,n,r,i-d.iterations,m,!0);return g.iterations+=d.iterations,g},numeric.solveLP=function(t,e,n,r,i,o,a){if(void 0===a&&(a=1e3),void 0===o&&(o=numeric.epsilon),void 0===r)return numeric._solveLP(t,e,n,o,a);var s,u=r.length,l=r[0].length,c=e.length,h=numeric.echelonize(r),p=numeric.rep([l],0),f=h.P,d=[];for(s=f.length-1;-1!==s;--s)p[f[s]]=1;for(s=l-1;-1!==s;--s)0===p[s]&&d.push(s);var m=numeric.getRange,g=numeric.linspace(0,u-1),v=numeric.linspace(0,c-1),y=m(r,g,d),x=m(e,v,f),_=m(e,v,d),b=numeric.dot,w=numeric.sub,M=b(x,h.I),S=w(_,b(M,y)),T=w(n,b(M,i)),E=Array(f.length),A=Array(d.length);for(s=f.length-1;-1!==s;--s)E[s]=t[f[s]];for(s=d.length-1;-1!==s;--s)A[s]=t[d[s]];var P=w(A,b(E,b(h.I,y))),C=numeric._solveLP(P,S,T,o,a),L=C.solution;if(L!=L)return C;var I=b(h.I,w(i,b(y,L))),O=Array(t.length);for(s=f.length-1;-1!==s;--s)O[f[s]]=I[s];for(s=d.length-1;-1!==s;--s)O[d[s]]=L[s];return{solution:O,message:C.message,iterations:C.iterations}},numeric.MPStoLP=function(t){t instanceof String&&t.split("\n");var e,n,r,i,o=0,a=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],s=t.length,u=0,l={},c=[],h=0,p={},f=0,d=[],m=[],g=[];function v(n){throw new Error("MPStoLP: "+n+"\nLine "+e+": "+t[e]+"\nCurrent state: "+a[o]+"\n")}for(e=0;e<s;++e){var y=(r=t[e]).match(/\S*/g),x=[];for(n=0;n<y.length;++n)""!==y[n]&&x.push(y[n]);if(0!==x.length){for(n=0;n<a.length&&r.substr(0,a[n].length)!==a[n];++n);if(n<a.length){if(o=n,1===n&&(i=x[1]),6===n)return{name:i,c:d,A:numeric.transpose(m),b:g,rows:l,vars:p}}else switch(o){case 0:case 1:v("Unexpected line");case 2:switch(x[0]){case"N":0===u?u=x[1]:v("Two or more N rows");break;case"L":l[x[1]]=h,c[h]=1,g[h]=0,++h;break;case"G":l[x[1]]=h,c[h]=-1,g[h]=0,++h;break;case"E":l[x[1]]=h,c[h]=0,g[h]=0,++h;break;default:v("Parse error "+numeric.prettyPrint(x))}break;case 3:p.hasOwnProperty(x[0])||(p[x[0]]=f,d[f]=0,m[f]=numeric.rep([h],0),++f);var _=p[x[0]];for(n=1;n<x.length;n+=2)if(x[n]!==u){var b=l[x[n]];m[_][b]=(c[b]<0?-1:1)*parseFloat(x[n+1])}else d[_]=parseFloat(x[n+1]);break;case 4:for(n=1;n<x.length;n+=2)g[l[x[n]]]=(c[l[x[n]]]<0?-1:1)*parseFloat(x[n+1]);break;case 5:break;case 6:v("Internal error")}}}v("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(t,e,n,r,i,o,a){function s(t){var e,r,i=this,o=t.length,a=0,s=i.i=i.j=i.m=0;for(i.S=[],i.c=[],o||(t=[o++]);a<n;)i.S[a]=a++;for(a=0;a<n;a++)s=c(s+(e=i.S[a])+t[a%o]),r=i.S[s],i.S[a]=r,i.S[s]=e;i.g=function(t){var e=i.S,r=c(i.i+1),o=e[r],a=c(i.j+o),s=e[a];e[r]=s,e[a]=o;for(var u=e[c(o+s)];--t;)r=c(r+1),s=e[a=c(a+(o=e[r]))],e[r]=s,e[a]=o,u=u*n+e[c(o+s)];return i.i=r,i.j=a,u},i.g(n)}function u(t,e,n,r,i){if(n=[],i=typeof t,e&&"object"==i)for(r in t)if(r.indexOf("S")<5)try{n.push(u(t[r],e-1))}catch(t){}return n.length?n:t+("string"!=i?"\0":"")}function l(t,e,n,r){for(t+="",n=0,r=0;r<t.length;r++)e[c(r)]=c((n^=19*e[c(r)])+t.charCodeAt(r));for(r in t="",e)t+=String.fromCharCode(e[r]);return t}function c(t){return t&n-1}e.seedrandom=function(c,h){var p,f=[];return c=l(u(h?[c,t]:arguments.length?c:[(new Date).getTime(),t,window],3),f),l((p=new s(f)).S,t),e.random=function(){for(var t=p.g(r),e=a,s=0;t<i;)t=(t+s)*n,e*=n,s=p.g(1);for(;t>=o;)t/=2,e/=2,s>>>=1;return(t+s)/e},c},a=e.pow(n,r),i=e.pow(2,i),o=2*i,l(e.random(),t)}([],numeric.seedrandom,256,6,52),function(t){function e(t){if("object"!=typeof t)return t;var n,r=[],i=t.length;for(n=0;n<i;n++)r[n+1]=e(t[n]);return r}function n(t){if("object"!=typeof t)return t;var e,r=[],i=t.length;for(e=1;e<i;e++)r[e-1]=n(t[e]);return r}function r(t,e,n,r,i,o,a,s,u,l,c,h,p,f,d,m){var g,v,y,x,_,b,w,M,S,T,E,A,P,C,L,I,O,N,R,D,k,F,B,U,z,V,G;P=Math.min(r,l),y=2*r+P*(P+5)/2+2*l+1,U=1e-60;do{z=1+.1*(U+=U),V=1+.2*U}while(z<=1||V<=1);for(g=1;g<=r;g+=1)d[g]=e[g];for(g=r+1;g<=y;g+=1)d[g]=0;for(g=1;g<=l;g+=1)h[g]=0;if(_=[],0===m[1]){if(function(t,e,n,r){var i,o,a,s,u,l;for(o=1;o<=n;o+=1){if(r[1]=o,l=0,(a=o-1)<1){if((l=t[o][o]-l)<=0)break;t[o][o]=Math.sqrt(l)}else{for(s=1;s<=a;s+=1){for(u=t[s][o],i=1;i<s;i+=1)u-=t[i][o]*t[i][s];u/=t[s][s],t[s][o]=u,l+=u*u}if((l=t[o][o]-l)<=0)break;t[o][o]=Math.sqrt(l)}r[1]=0}}(t,0,r,_),0!==_[1])return void(m[1]=2);!function(t,e,n,r){var i,o,a,s;for(o=1;o<=n;o+=1){for(s=0,i=1;i<o;i+=1)s+=t[i][o]*r[i];r[o]=(r[o]-s)/t[o][o]}for(a=1;a<=n;a+=1)for(r[o=n+1-a]=r[o]/t[o][o],s=-r[o],i=1;i<o;i+=1)r[i]=r[i]+s*t[i][o]}(t,0,r,e),function(t,e,n){var r,i,o,a,s;for(o=1;o<=n;o+=1){for(t[o][o]=1/t[o][o],s=-t[o][o],r=1;r<o;r+=1)t[r][o]=s*t[r][o];if(n<(a=o+1))break;for(i=a;i<=n;i+=1)for(s=t[o][i],t[o][i]=0,r=1;r<=o;r+=1)t[r][i]=t[r][i]+s*t[r][o]}}(t,0,r)}else{for(v=1;v<=r;v+=1)for(i[v]=0,g=1;g<=v;g+=1)i[v]=i[v]+t[g][v]*e[g];for(v=1;v<=r;v+=1)for(e[v]=0,g=v;g<=r;g+=1)e[v]=e[v]+t[v][g]*i[g]}for(o[1]=0,v=1;v<=r;v+=1)for(i[v]=e[v],o[1]=o[1]+d[v]*i[v],d[v]=0,g=v+1;g<=r;g+=1)t[g][v]=0;for(o[1]=-o[1]/2,m[1]=0,C=(T=(S=(E=(M=(w=r)+r)+P)+P+1)+P*(P+1)/2)+l,g=1;g<=l;g+=1){for(I=0,v=1;v<=r;v+=1)I+=a[v][g]*a[v][g];d[C+g]=Math.sqrt(I)}function j(){for(f[1]=f[1]+1,y=T,g=1;g<=l;g+=1){for(y+=1,I=-s[g],v=1;v<=r;v+=1)I+=a[v][g]*i[v];if(Math.abs(I)<U&&(I=0),g>c)d[y]=I;else if(d[y]=-Math.abs(I),I>0){for(v=1;v<=r;v+=1)a[v][g]=-a[v][g];s[g]=-s[g]}}for(g=1;g<=p;g+=1)d[T+h[g]]=0;for(A=0,L=0,g=1;g<=l;g+=1)d[T+g]<L*d[C+g]&&(A=g,L=d[T+g]/d[C+g]);return 0===A?999:0}function W(){for(g=1;g<=r;g+=1){for(I=0,v=1;v<=r;v+=1)I+=t[v][g]*a[v][A];d[g]=I}for(x=w,g=1;g<=r;g+=1)d[x+g]=0;for(v=p+1;v<=r;v+=1)for(g=1;g<=r;g+=1)d[x+g]=d[x+g]+t[g][v]*d[v];for(F=!0,g=p;g>=1;g-=1){for(I=d[g],x=(y=S+g*(g+3)/2)-g,v=g+1;v<=p;v+=1)I-=d[y]*d[M+v],y+=v;if(I/=d[x],d[M+g]=I,h[g]<c)break;if(I<0)break;F=!1,b=g}if(!F)for(O=d[E+b]/d[M+b],g=1;g<=p&&!(h[g]<c)&&!(d[M+g]<0);g+=1)(L=d[E+g]/d[M+g])<O&&(O=L,b=g);for(I=0,g=w+1;g<=w+r;g+=1)I+=d[g]*d[g];if(Math.abs(I)<=U){if(F)return m[1]=1,999;for(g=1;g<=p;g+=1)d[E+g]=d[E+g]-O*d[M+g];return d[E+p+1]=d[E+p+1]+O,700}for(I=0,g=1;g<=r;g+=1)I+=d[w+g]*a[g][A];for(N=-d[T+A]/I,B=!0,F||O<N&&(N=O,B=!1),g=1;g<=r;g+=1)i[g]=i[g]+N*d[w+g],Math.abs(i[g])<U&&(i[g]=0);for(o[1]=o[1]+N*I*(N/2+d[E+p+1]),g=1;g<=p;g+=1)d[E+g]=d[E+g]-N*d[M+g];if(d[E+p+1]=d[E+p+1]+N,!B){for(I=-s[A],v=1;v<=r;v+=1)I+=i[v]*a[v][A];if(A>c)d[T+A]=I;else if(d[T+A]=-Math.abs(I),I>0){for(v=1;v<=r;v+=1)a[v][A]=-a[v][A];s[A]=-s[A]}return 700}for(h[p+=1]=A,y=S+(p-1)*p/2+1,g=1;g<=p-1;g+=1)d[y]=d[g],y+=1;if(p===r)d[y]=d[r];else{for(g=r;g>=p+1&&0!==d[g]&&(R=Math.max(Math.abs(d[g-1]),Math.abs(d[g])),D=Math.min(Math.abs(d[g-1]),Math.abs(d[g])),L=d[g-1]>=0?Math.abs(R*Math.sqrt(1+D*D/(R*R))):-Math.abs(R*Math.sqrt(1+D*D/(R*R))),R=d[g-1]/L,D=d[g]/L,1!==R);g-=1)if(0===R)for(d[g-1]=D*L,v=1;v<=r;v+=1)L=t[v][g-1],t[v][g-1]=t[v][g],t[v][g]=L;else for(d[g-1]=L,k=D/(1+R),v=1;v<=r;v+=1)L=R*t[v][g-1]+D*t[v][g],t[v][g]=k*(t[v][g-1]+L)-t[v][g],t[v][g-1]=L;d[y]=d[p]}return 0}function H(){if(0===d[x=(y=S+b*(b+1)/2+1)+b])return 798;if(R=Math.max(Math.abs(d[x-1]),Math.abs(d[x])),D=Math.min(Math.abs(d[x-1]),Math.abs(d[x])),L=d[x-1]>=0?Math.abs(R*Math.sqrt(1+D*D/(R*R))):-Math.abs(R*Math.sqrt(1+D*D/(R*R))),R=d[x-1]/L,D=d[x]/L,1===R)return 798;if(0===R){for(g=b+1;g<=p;g+=1)L=d[x-1],d[x-1]=d[x],d[x]=L,x+=g;for(g=1;g<=r;g+=1)L=t[g][b],t[g][b]=t[g][b+1],t[g][b+1]=L}else{for(k=D/(1+R),g=b+1;g<=p;g+=1)L=R*d[x-1]+D*d[x],d[x]=k*(d[x-1]+L)-d[x],d[x-1]=L,x+=g;for(g=1;g<=r;g+=1)L=R*t[g][b]+D*t[g][b+1],t[g][b+1]=k*(t[g][b]+L)-t[g][b+1],t[g][b]=L}return 0}function X(){for(x=y-b,g=1;g<=b;g+=1)d[x]=d[y],y+=1,x+=1;return d[E+b]=d[E+b+1],h[b]=h[b+1],(b+=1)<p?797:0}function Y(){return d[E+p]=d[E+p+1],d[E+p+1]=0,h[p]=0,p-=1,f[2]=f[2]+1,0}for(p=0,f[1]=0,f[2]=0,G=0;;){if(999===(G=j()))return;for(;0!==(G=W());){if(999===G)return;if(700===G)if(b===p)Y();else{for(;H(),797===(G=X()););Y()}}}}t.solveQP=function(t,i,o,a,s,u){t=e(t),i=e(i),o=e(o);var l,c,h,p,f,d=[],m=[],g=[],v=[],y=[];if(s=s||0,u=u?e(u):[void 0,0],a=a?e(a):[],c=t.length-1,h=o[1].length-1,!a)for(l=1;l<=h;l+=1)a[l]=0;for(l=1;l<=h;l+=1)m[l]=0;for(0,p=Math.min(c,h),l=1;l<=c;l+=1)g[l]=0;for(d[1]=0,l=1;l<=2*c+p*(p+5)/2+2*h+1;l+=1)v[l]=0;for(l=1;l<=2;l+=1)y[l]=0;return r(t,i,0,c,g,d,o,a,0,h,s,m,0,y,v,u),f="",1===u[1]&&(f="constraints are inconsistent, no solution!"),2===u[1]&&(f="matrix D in quadratic function is not positive definite!"),{solution:n(g),value:n(d),unconstrained_solution:n(i),iterations:n(y),iact:n(m),message:f}}}(numeric),numeric.svd=function(t){var e,n=numeric.epsilon,r=1e-64/n,i=0,o=0,a=0,s=0,u=0,l=numeric.clone(t),c=l.length,h=l[0].length;if(c<h)throw"Need more rows than columns";var p=new Array(h),f=new Array(h);for(o=0;o<h;o++)p[o]=f[o]=0;var d=numeric.rep([h,h],0);function m(t,e){return(t=Math.abs(t))>(e=Math.abs(e))?t*Math.sqrt(1+e*e/t/t):0==e?t:e*Math.sqrt(1+t*t/e/e)}var g=0,v=0,y=0,x=0,_=0,b=0,w=0;for(o=0;o<h;o++){for(p[o]=v,w=0,u=o+1,a=o;a<c;a++)w+=l[a][o]*l[a][o];if(w<=r)v=0;else for(g=l[o][o],v=Math.sqrt(w),g>=0&&(v=-v),y=g*v-w,l[o][o]=g-v,a=u;a<h;a++){for(w=0,s=o;s<c;s++)w+=l[s][o]*l[s][a];for(g=w/y,s=o;s<c;s++)l[s][a]+=g*l[s][o]}for(f[o]=v,w=0,a=u;a<h;a++)w+=l[o][a]*l[o][a];if(w<=r)v=0;else{for(g=l[o][o+1],v=Math.sqrt(w),g>=0&&(v=-v),y=g*v-w,l[o][o+1]=g-v,a=u;a<h;a++)p[a]=l[o][a]/y;for(a=u;a<c;a++){for(w=0,s=u;s<h;s++)w+=l[a][s]*l[o][s];for(s=u;s<h;s++)l[a][s]+=w*p[s]}}(_=Math.abs(f[o])+Math.abs(p[o]))>x&&(x=_)}for(o=h-1;-1!=o;o+=-1){if(0!=v){for(y=v*l[o][o+1],a=u;a<h;a++)d[a][o]=l[o][a]/y;for(a=u;a<h;a++){for(w=0,s=u;s<h;s++)w+=l[o][s]*d[s][a];for(s=u;s<h;s++)d[s][a]+=w*d[s][o]}}for(a=u;a<h;a++)d[o][a]=0,d[a][o]=0;d[o][o]=1,v=p[o],u=o}for(o=h-1;-1!=o;o+=-1){for(u=o+1,v=f[o],a=u;a<h;a++)l[o][a]=0;if(0!=v){for(y=l[o][o]*v,a=u;a<h;a++){for(w=0,s=u;s<c;s++)w+=l[s][o]*l[s][a];for(g=w/y,s=o;s<c;s++)l[s][a]+=g*l[s][o]}for(a=o;a<c;a++)l[a][o]=l[a][o]/v}else for(a=o;a<c;a++)l[a][o]=0;l[o][o]+=1}for(n*=x,s=h-1;-1!=s;s+=-1)for(var M=0;M<50;M++){var S=!1;for(u=s;-1!=u;u+=-1){if(Math.abs(p[u])<=n){S=!0;break}if(Math.abs(f[u-1])<=n)break}if(!S){i=0,w=1;var T=u-1;for(o=u;o<s+1&&(g=w*p[o],p[o]=i*p[o],!(Math.abs(g)<=n));o++)for(y=m(g,v=f[o]),f[o]=y,i=v/y,w=-g/y,a=0;a<c;a++)_=l[a][T],b=l[a][o],l[a][T]=_*i+b*w,l[a][o]=-_*w+b*i}if(b=f[s],u==s){if(b<0)for(f[s]=-b,a=0;a<h;a++)d[a][s]=-d[a][s];break}if(M>=49)throw"Error: no convergence.";for(x=f[u],v=m(g=(((_=f[s-1])-b)*(_+b)+((v=p[s-1])-(y=p[s]))*(v+y))/(2*y*_),1),g=g<0?((x-b)*(x+b)+y*(_/(g-v)-y))/x:((x-b)*(x+b)+y*(_/(g+v)-y))/x,i=1,w=1,o=u+1;o<s+1;o++){for(v=p[o],_=f[o],y=w*v,v*=i,b=m(g,y),p[o-1]=b,g=x*(i=g/b)+v*(w=y/b),v=-x*w+v*i,y=_*w,_*=i,a=0;a<h;a++)x=d[a][o-1],b=d[a][o],d[a][o-1]=x*i+b*w,d[a][o]=-x*w+b*i;for(b=m(g,y),f[o-1]=b,g=(i=g/b)*v+(w=y/b)*_,x=-w*v+i*_,a=0;a<c;a++)_=l[a][o-1],b=l[a][o],l[a][o-1]=_*i+b*w,l[a][o]=-_*w+b*i}p[u]=0,p[s]=g,f[s]=x}for(o=0;o<f.length;o++)f[o]<n&&(f[o]=0);for(o=0;o<h;o++)for(a=o-1;a>=0;a--)if(f[a]<f[o]){for(i=f[a],f[a]=f[o],f[o]=i,s=0;s<l.length;s++)e=l[s][o],l[s][o]=l[s][a],l[s][a]=e;for(s=0;s<d.length;s++)e=d[s][o],d[s][o]=d[s][a],d[s][a]=e;o=a}return{U:l,S:f,V:d}}},27418:function(t){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var e=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(t){r[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}}()?Object.assign:function(t,i){for(var o,a,s=function(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),u=1;u<arguments.length;u++){for(var l in o=Object(arguments[u]))n.call(o,l)&&(s[l]=o[l]);if(e){a=e(o);for(var c=0;c<a.length;c++)r.call(o,a[c])&&(s[a[c]]=o[a[c]])}}return s}},64448:function(t,e,n){"use strict";
/** @license React v16.14.0
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=n(67294),i=n(27418),o=n(63840);function a(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!r)throw Error(a(227));function s(t,e,n,r,i,o,a,s,u){var l=Array.prototype.slice.call(arguments,3);try{e.apply(n,l)}catch(t){this.onError(t)}}var u=!1,l=null,c=!1,h=null,p={onError:function(t){u=!0,l=t}};function f(t,e,n,r,i,o,a,c,h){u=!1,l=null,s.apply(p,arguments)}var d=null,m=null,g=null;function v(t,e,n){var r=t.type||"unknown-event";t.currentTarget=g(n),function(t,e,n,r,i,o,s,p,d){if(f.apply(this,arguments),u){if(!u)throw Error(a(198));var m=l;u=!1,l=null,c||(c=!0,h=m)}}(r,e,void 0,t),t.currentTarget=null}var y=null,x={};function _(){if(y)for(var t in x){var e=x[t],n=y.indexOf(t);if(!(-1<n))throw Error(a(96,t));if(!w[n]){if(!e.extractEvents)throw Error(a(97,t));for(var r in w[n]=e,n=e.eventTypes){var i=void 0,o=n[r],s=e,u=r;if(M.hasOwnProperty(u))throw Error(a(99,u));M[u]=o;var l=o.phasedRegistrationNames;if(l){for(i in l)l.hasOwnProperty(i)&&b(l[i],s,u);i=!0}else o.registrationName?(b(o.registrationName,s,u),i=!0):i=!1;if(!i)throw Error(a(98,r,t))}}}}function b(t,e,n){if(S[t])throw Error(a(100,t));S[t]=e,T[t]=e.eventTypes[n].dependencies}var w=[],M={},S={},T={};function E(t){var e,n=!1;for(e in t)if(t.hasOwnProperty(e)){var r=t[e];if(!x.hasOwnProperty(e)||x[e]!==r){if(x[e])throw Error(a(102,e));x[e]=r,n=!0}}n&&_()}var A=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),P=null,C=null,L=null;function I(t){if(t=m(t)){if("function"!=typeof P)throw Error(a(280));var e=t.stateNode;e&&(e=d(e),P(t.stateNode,t.type,e))}}function O(t){C?L?L.push(t):L=[t]:C=t}function N(){if(C){var t=C,e=L;if(L=C=null,I(t),e)for(t=0;t<e.length;t++)I(e[t])}}function R(t,e){return t(e)}function D(t,e,n,r,i){return t(e,n,r,i)}function k(){}var F=R,B=!1,U=!1;function z(){null===C&&null===L||(k(),N())}function V(t,e,n){if(U)return t(e,n);U=!0;try{return F(t,e,n)}finally{U=!1,z()}}var G=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,j=Object.prototype.hasOwnProperty,W={},H={};function X(t,e,n,r,i,o){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o}var Y={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(t){Y[t]=new X(t,0,!1,t,null,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(t){var e=t[0];Y[e]=new X(e,1,!1,t[1],null,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(t){Y[t]=new X(t,2,!1,t.toLowerCase(),null,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(t){Y[t]=new X(t,2,!1,t,null,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(t){Y[t]=new X(t,3,!1,t.toLowerCase(),null,!1)})),["checked","multiple","muted","selected"].forEach((function(t){Y[t]=new X(t,3,!0,t,null,!1)})),["capture","download"].forEach((function(t){Y[t]=new X(t,4,!1,t,null,!1)})),["cols","rows","size","span"].forEach((function(t){Y[t]=new X(t,6,!1,t,null,!1)})),["rowSpan","start"].forEach((function(t){Y[t]=new X(t,5,!1,t.toLowerCase(),null,!1)}));var q=/[\-:]([a-z])/g;function Z(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(t){var e=t.replace(q,Z);Y[e]=new X(e,1,!1,t,null,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(t){var e=t.replace(q,Z);Y[e]=new X(e,1,!1,t,"http://www.w3.org/1999/xlink",!1)})),["xml:base","xml:lang","xml:space"].forEach((function(t){var e=t.replace(q,Z);Y[e]=new X(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1)})),["tabIndex","crossOrigin"].forEach((function(t){Y[t]=new X(t,1,!1,t.toLowerCase(),null,!1)})),Y.xlinkHref=new X("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0),["src","href","action","formAction"].forEach((function(t){Y[t]=new X(t,1,!1,t.toLowerCase(),null,!0)}));var J=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function K(t,e,n,r){var i=Y.hasOwnProperty(e)?Y[e]:null;(null!==i?0===i.type:!r&&(2<e.length&&("o"===e[0]||"O"===e[0])&&("n"===e[1]||"N"===e[1])))||(function(t,e,n,r){if(null==e||function(t,e,n,r){if(null!==n&&0===n.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}(t,e,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,n,i,r)&&(n=null),r||null===i?function(t){return!!j.call(H,t)||!j.call(W,t)&&(G.test(t)?H[t]=!0:(W[t]=!0,!1))}(e)&&(null===n?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=null===n?3!==i.type&&"":n:(e=i.attributeName,r=i.attributeNamespace,null===n?t.removeAttribute(e):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}J.hasOwnProperty("ReactCurrentDispatcher")||(J.ReactCurrentDispatcher={current:null}),J.hasOwnProperty("ReactCurrentBatchConfig")||(J.ReactCurrentBatchConfig={suspense:null});var Q=/^(.*)[\\\/]/,$="function"==typeof Symbol&&Symbol.for,tt=$?Symbol.for("react.element"):60103,et=$?Symbol.for("react.portal"):60106,nt=$?Symbol.for("react.fragment"):60107,rt=$?Symbol.for("react.strict_mode"):60108,it=$?Symbol.for("react.profiler"):60114,ot=$?Symbol.for("react.provider"):60109,at=$?Symbol.for("react.context"):60110,st=$?Symbol.for("react.concurrent_mode"):60111,ut=$?Symbol.for("react.forward_ref"):60112,lt=$?Symbol.for("react.suspense"):60113,ct=$?Symbol.for("react.suspense_list"):60120,ht=$?Symbol.for("react.memo"):60115,pt=$?Symbol.for("react.lazy"):60116,ft=$?Symbol.for("react.block"):60121,dt="function"==typeof Symbol&&Symbol.iterator;function mt(t){return null===t||"object"!=typeof t?null:"function"==typeof(t=dt&&t[dt]||t["@@iterator"])?t:null}function gt(t){if(null==t)return null;if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t;switch(t){case nt:return"Fragment";case et:return"Portal";case it:return"Profiler";case rt:return"StrictMode";case lt:return"Suspense";case ct:return"SuspenseList"}if("object"==typeof t)switch(t.$$typeof){case at:return"Context.Consumer";case ot:return"Context.Provider";case ut:var e=t.render;return e=e.displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case ht:return gt(t.type);case ft:return gt(t.render);case pt:if(t=1===t._status?t._result:null)return gt(t)}return null}function vt(t){var e="";do{t:switch(t.tag){case 3:case 4:case 6:case 7:case 10:case 9:var n="";break t;default:var r=t._debugOwner,i=t._debugSource,o=gt(t.type);n=null,r&&(n=gt(r.type)),r=o,o="",i?o=" (at "+i.fileName.replace(Q,"")+":"+i.lineNumber+")":n&&(o=" (created by "+n+")"),n="\n    in "+(r||"Unknown")+o}e+=n,t=t.return}while(t);return e}function yt(t){switch(typeof t){case"boolean":case"number":case"object":case"string":case"undefined":return t;default:return""}}function xt(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function _t(t){t._valueTracker||(t._valueTracker=function(t){var e=xt(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var i=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(t){r=""+t,o.call(this,t)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(t){r=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}(t))}function bt(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=xt(t)?t.checked?"true":"false":t.value),(t=r)!==n&&(e.setValue(t),!0)}function wt(t,e){var n=e.checked;return i({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:t._wrapperState.initialChecked})}function Mt(t,e){var n=null==e.defaultValue?"":e.defaultValue,r=null!=e.checked?e.checked:e.defaultChecked;n=yt(null!=e.value?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function St(t,e){null!=(e=e.checked)&&K(t,"checked",e,!1)}function Tt(t,e){St(t,e);var n=yt(e.value),r=e.type;if(null!=n)"number"===r?(0===n&&""===t.value||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if("submit"===r||"reset"===r)return void t.removeAttribute("value");e.hasOwnProperty("value")?At(t,e.type,n):e.hasOwnProperty("defaultValue")&&At(t,e.type,yt(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(t.defaultChecked=!!e.defaultChecked)}function Et(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!("submit"!==r&&"reset"!==r||void 0!==e.value&&null!==e.value))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}""!==(n=t.name)&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,""!==n&&(t.name=n)}function At(t,e,n){"number"===e&&t.ownerDocument.activeElement===t||(null==n?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}function Pt(t,e){return t=i({children:void 0},e),(e=function(t){var e="";return r.Children.forEach(t,(function(t){null!=t&&(e+=t)})),e}(e.children))&&(t.children=e),t}function Ct(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+yt(n),e=null,i=0;i<t.length;i++){if(t[i].value===n)return t[i].selected=!0,void(r&&(t[i].defaultSelected=!0));null!==e||t[i].disabled||(e=t[i])}null!==e&&(e.selected=!0)}}function Lt(t,e){if(null!=e.dangerouslySetInnerHTML)throw Error(a(91));return i({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function It(t,e){var n=e.value;if(null==n){if(n=e.children,e=e.defaultValue,null!=n){if(null!=e)throw Error(a(92));if(Array.isArray(n)){if(!(1>=n.length))throw Error(a(93));n=n[0]}e=n}null==e&&(e=""),n=e}t._wrapperState={initialValue:yt(n)}}function Ot(t,e){var n=yt(e.value),r=yt(e.defaultValue);null!=n&&((n=""+n)!==t.value&&(t.value=n),null==e.defaultValue&&t.defaultValue!==n&&(t.defaultValue=n)),null!=r&&(t.defaultValue=""+r)}function Nt(t){var e=t.textContent;e===t._wrapperState.initialValue&&""!==e&&null!==e&&(t.value=e)}var Rt="http://www.w3.org/1999/xhtml",Dt="http://www.w3.org/2000/svg";function kt(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ft(t,e){return null==t||"http://www.w3.org/1999/xhtml"===t?kt(e):"http://www.w3.org/2000/svg"===t&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":t}var Bt,Ut,zt=(Ut=function(t,e){if(t.namespaceURI!==Dt||"innerHTML"in t)t.innerHTML=e;else{for((Bt=Bt||document.createElement("div")).innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Bt.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,e,n,r){MSApp.execUnsafeLocalFunction((function(){return Ut(t,e)}))}:Ut);function Vt(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&3===n.nodeType)return void(n.nodeValue=e)}t.textContent=e}function Gt(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var jt={animationend:Gt("Animation","AnimationEnd"),animationiteration:Gt("Animation","AnimationIteration"),animationstart:Gt("Animation","AnimationStart"),transitionend:Gt("Transition","TransitionEnd")},Wt={},Ht={};function Xt(t){if(Wt[t])return Wt[t];if(!jt[t])return t;var e,n=jt[t];for(e in n)if(n.hasOwnProperty(e)&&e in Ht)return Wt[t]=n[e];return t}A&&(Ht=document.createElement("div").style,"AnimationEvent"in window||(delete jt.animationend.animation,delete jt.animationiteration.animation,delete jt.animationstart.animation),"TransitionEvent"in window||delete jt.transitionend.transition);var Yt=Xt("animationend"),qt=Xt("animationiteration"),Zt=Xt("animationstart"),Jt=Xt("transitionend"),Kt="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Qt=new("function"==typeof WeakMap?WeakMap:Map);function $t(t){var e=Qt.get(t);return void 0===e&&(e=new Map,Qt.set(t,e)),e}function te(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do{0!=(1026&(e=t).effectTag)&&(n=e.return),t=e.return}while(t)}return 3===e.tag?n:null}function ee(t){if(13===t.tag){var e=t.memoizedState;if(null===e&&(null!==(t=t.alternate)&&(e=t.memoizedState)),null!==e)return e.dehydrated}return null}function ne(t){if(te(t)!==t)throw Error(a(188))}function re(t){if(t=function(t){var e=t.alternate;if(!e){if(null===(e=te(t)))throw Error(a(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return ne(i),t;if(o===r)return ne(i),e;o=o.sibling}throw Error(a(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,u=i.child;u;){if(u===n){s=!0,n=i,r=o;break}if(u===r){s=!0,r=i,n=o;break}u=u.sibling}if(!s){for(u=o.child;u;){if(u===n){s=!0,n=o,r=i;break}if(u===r){s=!0,r=o,n=i;break}u=u.sibling}if(!s)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?t:e}(t),!t)return null;for(var e=t;;){if(5===e.tag||6===e.tag)return e;if(e.child)e.child.return=e,e=e.child;else{if(e===t)break;for(;!e.sibling;){if(!e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}}return null}function ie(t,e){if(null==e)throw Error(a(30));return null==t?e:Array.isArray(t)?Array.isArray(e)?(t.push.apply(t,e),t):(t.push(e),t):Array.isArray(e)?[t].concat(e):[t,e]}function oe(t,e,n){Array.isArray(t)?t.forEach(e,n):t&&e.call(n,t)}var ae=null;function se(t){if(t){var e=t._dispatchListeners,n=t._dispatchInstances;if(Array.isArray(e))for(var r=0;r<e.length&&!t.isPropagationStopped();r++)v(t,e[r],n[r]);else e&&v(t,e,n);t._dispatchListeners=null,t._dispatchInstances=null,t.isPersistent()||t.constructor.release(t)}}function ue(t){if(null!==t&&(ae=ie(ae,t)),t=ae,ae=null,t){if(oe(t,se),ae)throw Error(a(95));if(c)throw t=h,c=!1,h=null,t}}function le(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}function ce(t){if(!A)return!1;var e=(t="on"+t)in document;return e||((e=document.createElement("div")).setAttribute(t,"return;"),e="function"==typeof e[t]),e}var he=[];function pe(t){t.topLevelType=null,t.nativeEvent=null,t.targetInst=null,t.ancestors.length=0,10>he.length&&he.push(t)}function fe(t,e,n,r){if(he.length){var i=he.pop();return i.topLevelType=t,i.eventSystemFlags=r,i.nativeEvent=e,i.targetInst=n,i}return{topLevelType:t,eventSystemFlags:r,nativeEvent:e,targetInst:n,ancestors:[]}}function de(t){var e=t.targetInst,n=e;do{if(!n){t.ancestors.push(n);break}var r=n;if(3===r.tag)r=r.stateNode.containerInfo;else{for(;r.return;)r=r.return;r=3!==r.tag?null:r.stateNode.containerInfo}if(!r)break;5!==(e=n.tag)&&6!==e||t.ancestors.push(n),n=Nn(r)}while(n);for(n=0;n<t.ancestors.length;n++){e=t.ancestors[n];var i=le(t.nativeEvent);r=t.topLevelType;var o=t.nativeEvent,a=t.eventSystemFlags;0===n&&(a|=64);for(var s=null,u=0;u<w.length;u++){var l=w[u];l&&(l=l.extractEvents(r,e,o,i,a))&&(s=ie(s,l))}ue(s)}}function me(t,e,n){if(!n.has(t)){switch(t){case"scroll":Ze(e,"scroll",!0);break;case"focus":case"blur":Ze(e,"focus",!0),Ze(e,"blur",!0),n.set("blur",null),n.set("focus",null);break;case"cancel":case"close":ce(t)&&Ze(e,t,!0);break;case"invalid":case"submit":case"reset":break;default:-1===Kt.indexOf(t)&&qe(t,e)}n.set(t,null)}}var ge,ve,ye,xe=!1,_e=[],be=null,we=null,Me=null,Se=new Map,Te=new Map,Ee=[],Ae="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput close cancel copy cut paste click change contextmenu reset submit".split(" "),Pe="focus blur dragenter dragleave mouseover mouseout pointerover pointerout gotpointercapture lostpointercapture".split(" ");function Ce(t,e,n,r,i){return{blockedOn:t,topLevelType:e,eventSystemFlags:32|n,nativeEvent:i,container:r}}function Le(t,e){switch(t){case"focus":case"blur":be=null;break;case"dragenter":case"dragleave":we=null;break;case"mouseover":case"mouseout":Me=null;break;case"pointerover":case"pointerout":Se.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Te.delete(e.pointerId)}}function Ie(t,e,n,r,i,o){return null===t||t.nativeEvent!==o?(t=Ce(e,n,r,i,o),null!==e&&(null!==(e=Rn(e))&&ve(e)),t):(t.eventSystemFlags|=r,t)}function Oe(t){var e=Nn(t.target);if(null!==e){var n=te(e);if(null!==n)if(13===(e=n.tag)){if(null!==(e=ee(n)))return t.blockedOn=e,void o.unstable_runWithPriority(t.priority,(function(){ye(n)}))}else if(3===e&&n.stateNode.hydrate)return void(t.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}t.blockedOn=null}function Ne(t){if(null!==t.blockedOn)return!1;var e=$e(t.topLevelType,t.eventSystemFlags,t.container,t.nativeEvent);if(null!==e){var n=Rn(e);return null!==n&&ve(n),t.blockedOn=e,!1}return!0}function Re(t,e,n){Ne(t)&&n.delete(e)}function De(){for(xe=!1;0<_e.length;){var t=_e[0];if(null!==t.blockedOn){null!==(t=Rn(t.blockedOn))&&ge(t);break}var e=$e(t.topLevelType,t.eventSystemFlags,t.container,t.nativeEvent);null!==e?t.blockedOn=e:_e.shift()}null!==be&&Ne(be)&&(be=null),null!==we&&Ne(we)&&(we=null),null!==Me&&Ne(Me)&&(Me=null),Se.forEach(Re),Te.forEach(Re)}function ke(t,e){t.blockedOn===e&&(t.blockedOn=null,xe||(xe=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,De)))}function Fe(t){function e(e){return ke(e,t)}if(0<_e.length){ke(_e[0],t);for(var n=1;n<_e.length;n++){var r=_e[n];r.blockedOn===t&&(r.blockedOn=null)}}for(null!==be&&ke(be,t),null!==we&&ke(we,t),null!==Me&&ke(Me,t),Se.forEach(e),Te.forEach(e),n=0;n<Ee.length;n++)(r=Ee[n]).blockedOn===t&&(r.blockedOn=null);for(;0<Ee.length&&null===(n=Ee[0]).blockedOn;)Oe(n),null===n.blockedOn&&Ee.shift()}var Be={},Ue=new Map,ze=new Map,Ve=["abort","abort",Yt,"animationEnd",qt,"animationIteration",Zt,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",Jt,"transitionEnd","waiting","waiting"];function Ge(t,e){for(var n=0;n<t.length;n+=2){var r=t[n],i=t[n+1],o="on"+(i[0].toUpperCase()+i.slice(1));o={phasedRegistrationNames:{bubbled:o,captured:o+"Capture"},dependencies:[r],eventPriority:e},ze.set(r,e),Ue.set(r,o),Be[i]=o}}Ge("blur blur cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focus focus input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),Ge("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),Ge(Ve,2);for(var je="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),We=0;We<je.length;We++)ze.set(je[We],0);var He=o.unstable_UserBlockingPriority,Xe=o.unstable_runWithPriority,Ye=!0;function qe(t,e){Ze(e,t,!1)}function Ze(t,e,n){var r=ze.get(e);switch(void 0===r?2:r){case 0:r=Je.bind(null,e,1,t);break;case 1:r=Ke.bind(null,e,1,t);break;default:r=Qe.bind(null,e,1,t)}n?t.addEventListener(e,r,!0):t.addEventListener(e,r,!1)}function Je(t,e,n,r){B||k();var i=Qe,o=B;B=!0;try{D(i,t,e,n,r)}finally{(B=o)||z()}}function Ke(t,e,n,r){Xe(He,Qe.bind(null,t,e,n,r))}function Qe(t,e,n,r){if(Ye)if(0<_e.length&&-1<Ae.indexOf(t))t=Ce(null,t,e,n,r),_e.push(t);else{var i=$e(t,e,n,r);if(null===i)Le(t,r);else if(-1<Ae.indexOf(t))t=Ce(i,t,e,n,r),_e.push(t);else if(!function(t,e,n,r,i){switch(e){case"focus":return be=Ie(be,t,e,n,r,i),!0;case"dragenter":return we=Ie(we,t,e,n,r,i),!0;case"mouseover":return Me=Ie(Me,t,e,n,r,i),!0;case"pointerover":var o=i.pointerId;return Se.set(o,Ie(Se.get(o)||null,t,e,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Te.set(o,Ie(Te.get(o)||null,t,e,n,r,i)),!0}return!1}(i,t,e,n,r)){Le(t,r),t=fe(t,r,null,e);try{V(de,t)}finally{pe(t)}}}}function $e(t,e,n,r){if(null!==(n=Nn(n=le(r)))){var i=te(n);if(null===i)n=null;else{var o=i.tag;if(13===o){if(null!==(n=ee(i)))return n;n=null}else if(3===o){if(i.stateNode.hydrate)return 3===i.tag?i.stateNode.containerInfo:null;n=null}else i!==n&&(n=null)}}t=fe(t,r,n,e);try{V(de,t)}finally{pe(t)}return null}var tn={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},en=["Webkit","ms","Moz","O"];function nn(t,e,n){return null==e||"boolean"==typeof e||""===e?"":n||"number"!=typeof e||0===e||tn.hasOwnProperty(t)&&tn[t]?(""+e).trim():e+"px"}function rn(t,e){for(var n in t=t.style,e)if(e.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=nn(n,e[n],r);"float"===n&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}Object.keys(tn).forEach((function(t){en.forEach((function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),tn[e]=tn[t]}))}));var on=i({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function an(t,e){if(e){if(on[t]&&(null!=e.children||null!=e.dangerouslySetInnerHTML))throw Error(a(137,t,""));if(null!=e.dangerouslySetInnerHTML){if(null!=e.children)throw Error(a(60));if("object"!=typeof e.dangerouslySetInnerHTML||!("__html"in e.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=e.style&&"object"!=typeof e.style)throw Error(a(62,""))}}function sn(t,e){if(-1===t.indexOf("-"))return"string"==typeof e.is;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var un=Rt;function ln(t,e){var n=$t(t=9===t.nodeType||11===t.nodeType?t:t.ownerDocument);e=T[e];for(var r=0;r<e.length;r++)me(e[r],t,n)}function cn(){}function hn(t){if(void 0===(t=t||("undefined"!=typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}function pn(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function fn(t,e){var n,r=pn(t);for(t=0;r;){if(3===r.nodeType){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}t:{for(;r;){if(r.nextSibling){r=r.nextSibling;break t}r=r.parentNode}r=void 0}r=pn(r)}}function dn(t,e){return!(!t||!e)&&(t===e||(!t||3!==t.nodeType)&&(e&&3===e.nodeType?dn(t,e.parentNode):"contains"in t?t.contains(e):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(e))))}function mn(){for(var t=window,e=hn();e instanceof t.HTMLIFrameElement;){try{var n="string"==typeof e.contentWindow.location.href}catch(t){n=!1}if(!n)break;e=hn((t=e.contentWindow).document)}return e}function gn(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&("text"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type||"password"===t.type)||"textarea"===e||"true"===t.contentEditable)}var vn="$",yn="/$",xn="$?",_n="$!",bn=null,wn=null;function Mn(t,e){switch(t){case"button":case"input":case"select":case"textarea":return!!e.autoFocus}return!1}function Sn(t,e){return"textarea"===t||"option"===t||"noscript"===t||"string"==typeof e.children||"number"==typeof e.children||"object"==typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var Tn="function"==typeof setTimeout?setTimeout:void 0,En="function"==typeof clearTimeout?clearTimeout:void 0;function An(t){for(;null!=t;t=t.nextSibling){var e=t.nodeType;if(1===e||3===e)break}return t}function Pn(t){t=t.previousSibling;for(var e=0;t;){if(8===t.nodeType){var n=t.data;if(n===vn||n===_n||n===xn){if(0===e)return t;e--}else n===yn&&e++}t=t.previousSibling}return null}var Cn=Math.random().toString(36).slice(2),Ln="__reactInternalInstance$"+Cn,In="__reactEventHandlers$"+Cn,On="__reactContainere$"+Cn;function Nn(t){var e=t[Ln];if(e)return e;for(var n=t.parentNode;n;){if(e=n[On]||n[Ln]){if(n=e.alternate,null!==e.child||null!==n&&null!==n.child)for(t=Pn(t);null!==t;){if(n=t[Ln])return n;t=Pn(t)}return e}n=(t=n).parentNode}return null}function Rn(t){return!(t=t[Ln]||t[On])||5!==t.tag&&6!==t.tag&&13!==t.tag&&3!==t.tag?null:t}function Dn(t){if(5===t.tag||6===t.tag)return t.stateNode;throw Error(a(33))}function kn(t){return t[In]||null}function Fn(t){do{t=t.return}while(t&&5!==t.tag);return t||null}function Bn(t,e){var n=t.stateNode;if(!n)return null;var r=d(n);if(!r)return null;n=r[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(t=t.type)||"input"===t||"select"===t||"textarea"===t)),t=!r;break t;default:t=!1}if(t)return null;if(n&&"function"!=typeof n)throw Error(a(231,e,typeof n));return n}function Un(t,e,n){(e=Bn(t,n.dispatchConfig.phasedRegistrationNames[e]))&&(n._dispatchListeners=ie(n._dispatchListeners,e),n._dispatchInstances=ie(n._dispatchInstances,t))}function zn(t){if(t&&t.dispatchConfig.phasedRegistrationNames){for(var e=t._targetInst,n=[];e;)n.push(e),e=Fn(e);for(e=n.length;0<e--;)Un(n[e],"captured",t);for(e=0;e<n.length;e++)Un(n[e],"bubbled",t)}}function Vn(t,e,n){t&&n&&n.dispatchConfig.registrationName&&(e=Bn(t,n.dispatchConfig.registrationName))&&(n._dispatchListeners=ie(n._dispatchListeners,e),n._dispatchInstances=ie(n._dispatchInstances,t))}function Gn(t){t&&t.dispatchConfig.registrationName&&Vn(t._targetInst,null,t)}function jn(t){oe(t,zn)}var Wn=null,Hn=null,Xn=null;function Yn(){if(Xn)return Xn;var t,e,n=Hn,r=n.length,i="value"in Wn?Wn.value:Wn.textContent,o=i.length;for(t=0;t<r&&n[t]===i[t];t++);var a=r-t;for(e=1;e<=a&&n[r-e]===i[o-e];e++);return Xn=i.slice(t,1<e?1-e:void 0)}function qn(){return!0}function Zn(){return!1}function Jn(t,e,n,r){for(var i in this.dispatchConfig=t,this._targetInst=e,this.nativeEvent=n,t=this.constructor.Interface)t.hasOwnProperty(i)&&((e=t[i])?this[i]=e(n):"target"===i?this.target=r:this[i]=n[i]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?qn:Zn,this.isPropagationStopped=Zn,this}function Kn(t,e,n,r){if(this.eventPool.length){var i=this.eventPool.pop();return this.call(i,t,e,n,r),i}return new this(t,e,n,r)}function Qn(t){if(!(t instanceof this))throw Error(a(279));t.destructor(),10>this.eventPool.length&&this.eventPool.push(t)}function $n(t){t.eventPool=[],t.getPooled=Kn,t.release=Qn}i(Jn.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!=typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=qn)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!=typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=qn)},persist:function(){this.isPersistent=qn},isPersistent:Zn,destructor:function(){var t,e=this.constructor.Interface;for(t in e)this[t]=null;this.nativeEvent=this._targetInst=this.dispatchConfig=null,this.isPropagationStopped=this.isDefaultPrevented=Zn,this._dispatchInstances=this._dispatchListeners=null}}),Jn.Interface={type:null,target:null,currentTarget:function(){return null},eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null},Jn.extend=function(t){function e(){}function n(){return r.apply(this,arguments)}var r=this;e.prototype=r.prototype;var o=new e;return i(o,n.prototype),n.prototype=o,n.prototype.constructor=n,n.Interface=i({},r.Interface,t),n.extend=r.extend,$n(n),n},$n(Jn);var tr=Jn.extend({data:null}),er=Jn.extend({data:null}),nr=[9,13,27,32],rr=A&&"CompositionEvent"in window,ir=null;A&&"documentMode"in document&&(ir=document.documentMode);var or=A&&"TextEvent"in window&&!ir,ar=A&&(!rr||ir&&8<ir&&11>=ir),sr=String.fromCharCode(32),ur={beforeInput:{phasedRegistrationNames:{bubbled:"onBeforeInput",captured:"onBeforeInputCapture"},dependencies:["compositionend","keypress","textInput","paste"]},compositionEnd:{phasedRegistrationNames:{bubbled:"onCompositionEnd",captured:"onCompositionEndCapture"},dependencies:"blur compositionend keydown keypress keyup mousedown".split(" ")},compositionStart:{phasedRegistrationNames:{bubbled:"onCompositionStart",captured:"onCompositionStartCapture"},dependencies:"blur compositionstart keydown keypress keyup mousedown".split(" ")},compositionUpdate:{phasedRegistrationNames:{bubbled:"onCompositionUpdate",captured:"onCompositionUpdateCapture"},dependencies:"blur compositionupdate keydown keypress keyup mousedown".split(" ")}},lr=!1;function cr(t,e){switch(t){case"keyup":return-1!==nr.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"blur":return!0;default:return!1}}function hr(t){return"object"==typeof(t=t.detail)&&"data"in t?t.data:null}var pr=!1;var fr={eventTypes:ur,extractEvents:function(t,e,n,r){var i;if(rr)t:{switch(t){case"compositionstart":var o=ur.compositionStart;break t;case"compositionend":o=ur.compositionEnd;break t;case"compositionupdate":o=ur.compositionUpdate;break t}o=void 0}else pr?cr(t,n)&&(o=ur.compositionEnd):"keydown"===t&&229===n.keyCode&&(o=ur.compositionStart);return o?(ar&&"ko"!==n.locale&&(pr||o!==ur.compositionStart?o===ur.compositionEnd&&pr&&(i=Yn()):(Hn="value"in(Wn=r)?Wn.value:Wn.textContent,pr=!0)),o=tr.getPooled(o,e,n,r),i?o.data=i:null!==(i=hr(n))&&(o.data=i),jn(o),i=o):i=null,(t=or?function(t,e){switch(t){case"compositionend":return hr(e);case"keypress":return 32!==e.which?null:(lr=!0,sr);case"textInput":return(t=e.data)===sr&&lr?null:t;default:return null}}(t,n):function(t,e){if(pr)return"compositionend"===t||!rr&&cr(t,e)?(t=Yn(),Xn=Hn=Wn=null,pr=!1,t):null;switch(t){case"paste":default:return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return ar&&"ko"!==e.locale?null:e.data}}(t,n))?((e=er.getPooled(ur.beforeInput,e,n,r)).data=t,jn(e)):e=null,null===i?e:null===e?i:[i,e]}},dr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function mr(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!dr[t.type]:"textarea"===e}var gr={change:{phasedRegistrationNames:{bubbled:"onChange",captured:"onChangeCapture"},dependencies:"blur change click focus input keydown keyup selectionchange".split(" ")}};function vr(t,e,n){return(t=Jn.getPooled(gr.change,t,e,n)).type="change",O(n),jn(t),t}var yr=null,xr=null;function _r(t){ue(t)}function br(t){if(bt(Dn(t)))return t}function wr(t,e){if("change"===t)return e}var Mr=!1;function Sr(){yr&&(yr.detachEvent("onpropertychange",Tr),xr=yr=null)}function Tr(t){if("value"===t.propertyName&&br(xr))if(t=vr(xr,t,le(t)),B)ue(t);else{B=!0;try{R(_r,t)}finally{B=!1,z()}}}function Er(t,e,n){"focus"===t?(Sr(),xr=n,(yr=e).attachEvent("onpropertychange",Tr)):"blur"===t&&Sr()}function Ar(t){if("selectionchange"===t||"keyup"===t||"keydown"===t)return br(xr)}function Pr(t,e){if("click"===t)return br(e)}function Cr(t,e){if("input"===t||"change"===t)return br(e)}A&&(Mr=ce("input")&&(!document.documentMode||9<document.documentMode));var Lr={eventTypes:gr,_isInputEventSupported:Mr,extractEvents:function(t,e,n,r){var i=e?Dn(e):window,o=i.nodeName&&i.nodeName.toLowerCase();if("select"===o||"input"===o&&"file"===i.type)var a=wr;else if(mr(i))if(Mr)a=Cr;else{a=Ar;var s=Er}else(o=i.nodeName)&&"input"===o.toLowerCase()&&("checkbox"===i.type||"radio"===i.type)&&(a=Pr);if(a&&(a=a(t,e)))return vr(a,n,r);s&&s(t,i,e),"blur"===t&&(t=i._wrapperState)&&t.controlled&&"number"===i.type&&At(i,"number",i.value)}},Ir=Jn.extend({view:null,detail:null}),Or={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Nr(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=Or[t])&&!!e[t]}function Rr(){return Nr}var Dr=0,kr=0,Fr=!1,Br=!1,Ur=Ir.extend({screenX:null,screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:Rr,button:null,buttons:null,relatedTarget:function(t){return t.relatedTarget||(t.fromElement===t.srcElement?t.toElement:t.fromElement)},movementX:function(t){if("movementX"in t)return t.movementX;var e=Dr;return Dr=t.screenX,Fr?"mousemove"===t.type?t.screenX-e:0:(Fr=!0,0)},movementY:function(t){if("movementY"in t)return t.movementY;var e=kr;return kr=t.screenY,Br?"mousemove"===t.type?t.screenY-e:0:(Br=!0,0)}}),zr=Ur.extend({pointerId:null,width:null,height:null,pressure:null,tangentialPressure:null,tiltX:null,tiltY:null,twist:null,pointerType:null,isPrimary:null}),Vr={mouseEnter:{registrationName:"onMouseEnter",dependencies:["mouseout","mouseover"]},mouseLeave:{registrationName:"onMouseLeave",dependencies:["mouseout","mouseover"]},pointerEnter:{registrationName:"onPointerEnter",dependencies:["pointerout","pointerover"]},pointerLeave:{registrationName:"onPointerLeave",dependencies:["pointerout","pointerover"]}},Gr={eventTypes:Vr,extractEvents:function(t,e,n,r,i){var o="mouseover"===t||"pointerover"===t,a="mouseout"===t||"pointerout"===t;if(o&&0==(32&i)&&(n.relatedTarget||n.fromElement)||!a&&!o)return null;(o=r.window===r?r:(o=r.ownerDocument)?o.defaultView||o.parentWindow:window,a)?(a=e,null!==(e=(e=n.relatedTarget||n.toElement)?Nn(e):null)&&(e!==te(e)||5!==e.tag&&6!==e.tag)&&(e=null)):a=null;if(a===e)return null;if("mouseout"===t||"mouseover"===t)var s=Ur,u=Vr.mouseLeave,l=Vr.mouseEnter,c="mouse";else"pointerout"!==t&&"pointerover"!==t||(s=zr,u=Vr.pointerLeave,l=Vr.pointerEnter,c="pointer");if(t=null==a?o:Dn(a),o=null==e?o:Dn(e),(u=s.getPooled(u,a,n,r)).type=c+"leave",u.target=t,u.relatedTarget=o,(n=s.getPooled(l,e,n,r)).type=c+"enter",n.target=o,n.relatedTarget=t,c=e,(r=a)&&c)t:{for(l=c,a=0,t=s=r;t;t=Fn(t))a++;for(t=0,e=l;e;e=Fn(e))t++;for(;0<a-t;)s=Fn(s),a--;for(;0<t-a;)l=Fn(l),t--;for(;a--;){if(s===l||s===l.alternate)break t;s=Fn(s),l=Fn(l)}s=null}else s=null;for(l=s,s=[];r&&r!==l&&(null===(a=r.alternate)||a!==l);)s.push(r),r=Fn(r);for(r=[];c&&c!==l&&(null===(a=c.alternate)||a!==l);)r.push(c),c=Fn(c);for(c=0;c<s.length;c++)Vn(s[c],"bubbled",u);for(c=r.length;0<c--;)Vn(r[c],"captured",n);return 0==(64&i)?[u]:[u,n]}};var jr="function"==typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t==1/e)||t!=t&&e!=e},Wr=Object.prototype.hasOwnProperty;function Hr(t,e){if(jr(t,e))return!0;if("object"!=typeof t||null===t||"object"!=typeof e||null===e)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!Wr.call(e,n[r])||!jr(t[n[r]],e[n[r]]))return!1;return!0}var Xr=A&&"documentMode"in document&&11>=document.documentMode,Yr={select:{phasedRegistrationNames:{bubbled:"onSelect",captured:"onSelectCapture"},dependencies:"blur contextmenu dragend focus keydown keyup mousedown mouseup selectionchange".split(" ")}},qr=null,Zr=null,Jr=null,Kr=!1;function Qr(t,e){var n=e.window===e?e.document:9===e.nodeType?e:e.ownerDocument;return Kr||null==qr||qr!==hn(n)?null:("selectionStart"in(n=qr)&&gn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},Jr&&Hr(Jr,n)?null:(Jr=n,(t=Jn.getPooled(Yr.select,Zr,t,e)).type="select",t.target=qr,jn(t),t))}var $r={eventTypes:Yr,extractEvents:function(t,e,n,r,i,o){if(!(o=!(i=o||(r.window===r?r.document:9===r.nodeType?r:r.ownerDocument)))){t:{i=$t(i),o=T.onSelect;for(var a=0;a<o.length;a++)if(!i.has(o[a])){i=!1;break t}i=!0}o=!i}if(o)return null;switch(i=e?Dn(e):window,t){case"focus":(mr(i)||"true"===i.contentEditable)&&(qr=i,Zr=e,Jr=null);break;case"blur":Jr=Zr=qr=null;break;case"mousedown":Kr=!0;break;case"contextmenu":case"mouseup":case"dragend":return Kr=!1,Qr(n,r);case"selectionchange":if(Xr)break;case"keydown":case"keyup":return Qr(n,r)}return null}},ti=Jn.extend({animationName:null,elapsedTime:null,pseudoElement:null}),ei=Jn.extend({clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),ni=Ir.extend({relatedTarget:null});function ri(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}var ii={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},oi={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ai=Ir.extend({key:function(t){if(t.key){var e=ii[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=ri(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?oi[t.keyCode]||"Unidentified":""},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:Rr,charCode:function(t){return"keypress"===t.type?ri(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?ri(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}}),si=Ur.extend({dataTransfer:null}),ui=Ir.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:Rr}),li=Jn.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),ci=Ur.extend({deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:null,deltaMode:null}),hi={eventTypes:Be,extractEvents:function(t,e,n,r){var i=Ue.get(t);if(!i)return null;switch(t){case"keypress":if(0===ri(n))return null;case"keydown":case"keyup":t=ai;break;case"blur":case"focus":t=ni;break;case"click":if(2===n.button)return null;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":t=Ur;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":t=si;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":t=ui;break;case Yt:case qt:case Zt:t=ti;break;case Jt:t=li;break;case"scroll":t=Ir;break;case"wheel":t=ci;break;case"copy":case"cut":case"paste":t=ei;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":t=zr;break;default:t=Jn}return jn(e=t.getPooled(i,e,n,r)),e}};if(y)throw Error(a(101));y=Array.prototype.slice.call("ResponderEventPlugin SimpleEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" ")),_(),d=kn,m=Rn,g=Dn,E({SimpleEventPlugin:hi,EnterLeaveEventPlugin:Gr,ChangeEventPlugin:Lr,SelectEventPlugin:$r,BeforeInputEventPlugin:fr});var pi=[],fi=-1;function di(t){0>fi||(t.current=pi[fi],pi[fi]=null,fi--)}function mi(t,e){fi++,pi[fi]=t.current,t.current=e}var gi={},vi={current:gi},yi={current:!1},xi=gi;function _i(t,e){var n=t.type.contextTypes;if(!n)return gi;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in n)o[i]=e[i];return r&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=o),o}function bi(t){return null!=(t=t.childContextTypes)}function wi(){di(yi),di(vi)}function Mi(t,e,n){if(vi.current!==gi)throw Error(a(168));mi(vi,e),mi(yi,n)}function Si(t,e,n){var r=t.stateNode;if(t=e.childContextTypes,"function"!=typeof r.getChildContext)return n;for(var o in r=r.getChildContext())if(!(o in t))throw Error(a(108,gt(e)||"Unknown",o));return i({},n,{},r)}function Ti(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||gi,xi=vi.current,mi(vi,t),mi(yi,yi.current),!0}function Ei(t,e,n){var r=t.stateNode;if(!r)throw Error(a(169));n?(t=Si(t,e,xi),r.__reactInternalMemoizedMergedChildContext=t,di(yi),di(vi),mi(vi,t)):di(yi),mi(yi,n)}var Ai=o.unstable_runWithPriority,Pi=o.unstable_scheduleCallback,Ci=o.unstable_cancelCallback,Li=o.unstable_requestPaint,Ii=o.unstable_now,Oi=o.unstable_getCurrentPriorityLevel,Ni=o.unstable_ImmediatePriority,Ri=o.unstable_UserBlockingPriority,Di=o.unstable_NormalPriority,ki=o.unstable_LowPriority,Fi=o.unstable_IdlePriority,Bi={},Ui=o.unstable_shouldYield,zi=void 0!==Li?Li:function(){},Vi=null,Gi=null,ji=!1,Wi=Ii(),Hi=1e4>Wi?Ii:function(){return Ii()-Wi};function Xi(){switch(Oi()){case Ni:return 99;case Ri:return 98;case Di:return 97;case ki:return 96;case Fi:return 95;default:throw Error(a(332))}}function Yi(t){switch(t){case 99:return Ni;case 98:return Ri;case 97:return Di;case 96:return ki;case 95:return Fi;default:throw Error(a(332))}}function qi(t,e){return t=Yi(t),Ai(t,e)}function Zi(t,e,n){return t=Yi(t),Pi(t,e,n)}function Ji(t){return null===Vi?(Vi=[t],Gi=Pi(Ni,Qi)):Vi.push(t),Bi}function Ki(){if(null!==Gi){var t=Gi;Gi=null,Ci(t)}Qi()}function Qi(){if(!ji&&null!==Vi){ji=!0;var t=0;try{var e=Vi;qi(99,(function(){for(;t<e.length;t++){var n=e[t];do{n=n(!0)}while(null!==n)}})),Vi=null}catch(e){throw null!==Vi&&(Vi=Vi.slice(t+1)),Pi(Ni,Ki),e}finally{ji=!1}}}function $i(t,e,n){return 1073741821-(1+((1073741821-t+e/10)/(n/=10)|0))*n}function to(t,e){if(t&&t.defaultProps)for(var n in e=i({},e),t=t.defaultProps)void 0===e[n]&&(e[n]=t[n]);return e}var eo={current:null},no=null,ro=null,io=null;function oo(){io=ro=no=null}function ao(t){var e=eo.current;di(eo),t.type._context._currentValue=e}function so(t,e){for(;null!==t;){var n=t.alternate;if(t.childExpirationTime<e)t.childExpirationTime=e,null!==n&&n.childExpirationTime<e&&(n.childExpirationTime=e);else{if(!(null!==n&&n.childExpirationTime<e))break;n.childExpirationTime=e}t=t.return}}function uo(t,e){no=t,io=ro=null,null!==(t=t.dependencies)&&null!==t.firstContext&&(t.expirationTime>=e&&(ka=!0),t.firstContext=null)}function lo(t,e){if(io!==t&&!1!==e&&0!==e)if("number"==typeof e&&1073741823!==e||(io=t,e=1073741823),e={context:t,observedBits:e,next:null},null===ro){if(null===no)throw Error(a(308));ro=e,no.dependencies={expirationTime:0,firstContext:e,responders:null}}else ro=ro.next=e;return t._currentValue}var co=!1;function ho(t){t.updateQueue={baseState:t.memoizedState,baseQueue:null,shared:{pending:null},effects:null}}function po(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,baseQueue:t.baseQueue,shared:t.shared,effects:t.effects})}function fo(t,e){return(t={expirationTime:t,suspenseConfig:e,tag:0,payload:null,callback:null,next:null}).next=t}function mo(t,e){if(null!==(t=t.updateQueue)){var n=(t=t.shared).pending;null===n?e.next=e:(e.next=n.next,n.next=e),t.pending=e}}function go(t,e){var n=t.alternate;null!==n&&po(n,t),null===(n=(t=t.updateQueue).baseQueue)?(t.baseQueue=e.next=e,e.next=e):(e.next=n.next,n.next=e)}function vo(t,e,n,r){var o=t.updateQueue;co=!1;var a=o.baseQueue,s=o.shared.pending;if(null!==s){if(null!==a){var u=a.next;a.next=s.next,s.next=u}a=s,o.shared.pending=null,null!==(u=t.alternate)&&(null!==(u=u.updateQueue)&&(u.baseQueue=s))}if(null!==a){u=a.next;var l=o.baseState,c=0,h=null,p=null,f=null;if(null!==u)for(var d=u;;){if((s=d.expirationTime)<r){var m={expirationTime:d.expirationTime,suspenseConfig:d.suspenseConfig,tag:d.tag,payload:d.payload,callback:d.callback,next:null};null===f?(p=f=m,h=l):f=f.next=m,s>c&&(c=s)}else{null!==f&&(f=f.next={expirationTime:1073741823,suspenseConfig:d.suspenseConfig,tag:d.tag,payload:d.payload,callback:d.callback,next:null}),wu(s,d.suspenseConfig);t:{var g=t,v=d;switch(s=e,m=n,v.tag){case 1:if("function"==typeof(g=v.payload)){l=g.call(m,l,s);break t}l=g;break t;case 3:g.effectTag=-4097&g.effectTag|64;case 0:if(null==(s="function"==typeof(g=v.payload)?g.call(m,l,s):g))break t;l=i({},l,s);break t;case 2:co=!0}}null!==d.callback&&(t.effectTag|=32,null===(s=o.effects)?o.effects=[d]:s.push(d))}if(null===(d=d.next)||d===u){if(null===(s=o.shared.pending))break;d=a.next=s.next,s.next=u,o.baseQueue=a=s,o.shared.pending=null}}null===f?h=l:f.next=p,o.baseState=h,o.baseQueue=f,Mu(c),t.expirationTime=c,t.memoizedState=l}}function yo(t,e,n){if(t=e.effects,e.effects=null,null!==t)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(null!==i){if(r.callback=null,r=i,i=n,"function"!=typeof r)throw Error(a(191,r));r.call(i)}}}var xo=J.ReactCurrentBatchConfig,_o=(new r.Component).refs;function bo(t,e,n,r){n=null==(n=n(r,e=t.memoizedState))?e:i({},e,n),t.memoizedState=n,0===t.expirationTime&&(t.updateQueue.baseState=n)}var wo={isMounted:function(t){return!!(t=t._reactInternalFiber)&&te(t)===t},enqueueSetState:function(t,e,n){t=t._reactInternalFiber;var r=lu(),i=xo.suspense;(i=fo(r=cu(r,t,i),i)).payload=e,null!=n&&(i.callback=n),mo(t,i),hu(t,r)},enqueueReplaceState:function(t,e,n){t=t._reactInternalFiber;var r=lu(),i=xo.suspense;(i=fo(r=cu(r,t,i),i)).tag=1,i.payload=e,null!=n&&(i.callback=n),mo(t,i),hu(t,r)},enqueueForceUpdate:function(t,e){t=t._reactInternalFiber;var n=lu(),r=xo.suspense;(r=fo(n=cu(n,t,r),r)).tag=2,null!=e&&(r.callback=e),mo(t,r),hu(t,n)}};function Mo(t,e,n,r,i,o,a){return"function"==typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(r,o,a):!e.prototype||!e.prototype.isPureReactComponent||(!Hr(n,r)||!Hr(i,o))}function So(t,e,n){var r=!1,i=gi,o=e.contextType;return"object"==typeof o&&null!==o?o=lo(o):(i=bi(e)?xi:vi.current,o=(r=null!=(r=e.contextTypes))?_i(t,i):gi),e=new e(n,o),t.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=wo,t.stateNode=e,e._reactInternalFiber=t,r&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=o),e}function To(t,e,n,r){t=e.state,"function"==typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(n,r),"function"==typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&wo.enqueueReplaceState(e,e.state,null)}function Eo(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=_o,ho(t);var o=e.contextType;"object"==typeof o&&null!==o?i.context=lo(o):(o=bi(e)?xi:vi.current,i.context=_i(t,o)),vo(t,n,i,r),i.state=t.memoizedState,"function"==typeof(o=e.getDerivedStateFromProps)&&(bo(t,e,o,n),i.state=t.memoizedState),"function"==typeof e.getDerivedStateFromProps||"function"==typeof i.getSnapshotBeforeUpdate||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||(e=i.state,"function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),e!==i.state&&wo.enqueueReplaceState(i,i.state,null),vo(t,n,i,r),i.state=t.memoizedState),"function"==typeof i.componentDidMount&&(t.effectTag|=4)}var Ao=Array.isArray;function Po(t,e,n){if(null!==(t=n.ref)&&"function"!=typeof t&&"object"!=typeof t){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var r=n.stateNode}if(!r)throw Error(a(147,t));var i=""+t;return null!==e&&null!==e.ref&&"function"==typeof e.ref&&e.ref._stringRef===i?e.ref:(e=function(t){var e=r.refs;e===_o&&(e=r.refs={}),null===t?delete e[i]:e[i]=t},e._stringRef=i,e)}if("string"!=typeof t)throw Error(a(284));if(!n._owner)throw Error(a(290,t))}return t}function Co(t,e){if("textarea"!==t.type)throw Error(a(31,"[object Object]"===Object.prototype.toString.call(e)?"object with keys {"+Object.keys(e).join(", ")+"}":e,""))}function Lo(t){function e(e,n){if(t){var r=e.lastEffect;null!==r?(r.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n,n.nextEffect=null,n.effectTag=8}}function n(n,r){if(!t)return null;for(;null!==r;)e(n,r),r=r.sibling;return null}function r(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function i(t,e){return(t=ju(t,e)).index=0,t.sibling=null,t}function o(e,n,r){return e.index=r,t?null!==(r=e.alternate)?(r=r.index)<n?(e.effectTag=2,n):r:(e.effectTag=2,n):n}function s(e){return t&&null===e.alternate&&(e.effectTag=2),e}function u(t,e,n,r){return null===e||6!==e.tag?((e=Xu(n,t.mode,r)).return=t,e):((e=i(e,n)).return=t,e)}function l(t,e,n,r){return null!==e&&e.elementType===n.type?((r=i(e,n.props)).ref=Po(t,e,n),r.return=t,r):((r=Wu(n.type,n.key,n.props,null,t.mode,r)).ref=Po(t,e,n),r.return=t,r)}function c(t,e,n,r){return null===e||4!==e.tag||e.stateNode.containerInfo!==n.containerInfo||e.stateNode.implementation!==n.implementation?((e=Yu(n,t.mode,r)).return=t,e):((e=i(e,n.children||[])).return=t,e)}function h(t,e,n,r,o){return null===e||7!==e.tag?((e=Hu(n,t.mode,r,o)).return=t,e):((e=i(e,n)).return=t,e)}function p(t,e,n){if("string"==typeof e||"number"==typeof e)return(e=Xu(""+e,t.mode,n)).return=t,e;if("object"==typeof e&&null!==e){switch(e.$$typeof){case tt:return(n=Wu(e.type,e.key,e.props,null,t.mode,n)).ref=Po(t,null,e),n.return=t,n;case et:return(e=Yu(e,t.mode,n)).return=t,e}if(Ao(e)||mt(e))return(e=Hu(e,t.mode,n,null)).return=t,e;Co(t,e)}return null}function f(t,e,n,r){var i=null!==e?e.key:null;if("string"==typeof n||"number"==typeof n)return null!==i?null:u(t,e,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case tt:return n.key===i?n.type===nt?h(t,e,n.props.children,r,i):l(t,e,n,r):null;case et:return n.key===i?c(t,e,n,r):null}if(Ao(n)||mt(n))return null!==i?null:h(t,e,n,r,null);Co(t,n)}return null}function d(t,e,n,r,i){if("string"==typeof r||"number"==typeof r)return u(e,t=t.get(n)||null,""+r,i);if("object"==typeof r&&null!==r){switch(r.$$typeof){case tt:return t=t.get(null===r.key?n:r.key)||null,r.type===nt?h(e,t,r.props.children,i,r.key):l(e,t,r,i);case et:return c(e,t=t.get(null===r.key?n:r.key)||null,r,i)}if(Ao(r)||mt(r))return h(e,t=t.get(n)||null,r,i,null);Co(e,r)}return null}function m(i,a,s,u){for(var l=null,c=null,h=a,m=a=0,g=null;null!==h&&m<s.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var v=f(i,h,s[m],u);if(null===v){null===h&&(h=g);break}t&&h&&null===v.alternate&&e(i,h),a=o(v,a,m),null===c?l=v:c.sibling=v,c=v,h=g}if(m===s.length)return n(i,h),l;if(null===h){for(;m<s.length;m++)null!==(h=p(i,s[m],u))&&(a=o(h,a,m),null===c?l=h:c.sibling=h,c=h);return l}for(h=r(i,h);m<s.length;m++)null!==(g=d(h,i,m,s[m],u))&&(t&&null!==g.alternate&&h.delete(null===g.key?m:g.key),a=o(g,a,m),null===c?l=g:c.sibling=g,c=g);return t&&h.forEach((function(t){return e(i,t)})),l}function g(i,s,u,l){var c=mt(u);if("function"!=typeof c)throw Error(a(150));if(null==(u=c.call(u)))throw Error(a(151));for(var h=c=null,m=s,g=s=0,v=null,y=u.next();null!==m&&!y.done;g++,y=u.next()){m.index>g?(v=m,m=null):v=m.sibling;var x=f(i,m,y.value,l);if(null===x){null===m&&(m=v);break}t&&m&&null===x.alternate&&e(i,m),s=o(x,s,g),null===h?c=x:h.sibling=x,h=x,m=v}if(y.done)return n(i,m),c;if(null===m){for(;!y.done;g++,y=u.next())null!==(y=p(i,y.value,l))&&(s=o(y,s,g),null===h?c=y:h.sibling=y,h=y);return c}for(m=r(i,m);!y.done;g++,y=u.next())null!==(y=d(m,i,g,y.value,l))&&(t&&null!==y.alternate&&m.delete(null===y.key?g:y.key),s=o(y,s,g),null===h?c=y:h.sibling=y,h=y);return t&&m.forEach((function(t){return e(i,t)})),c}return function(t,r,o,u){var l="object"==typeof o&&null!==o&&o.type===nt&&null===o.key;l&&(o=o.props.children);var c="object"==typeof o&&null!==o;if(c)switch(o.$$typeof){case tt:t:{for(c=o.key,l=r;null!==l;){if(l.key===c){if(7===l.tag){if(o.type===nt){n(t,l.sibling),(r=i(l,o.props.children)).return=t,t=r;break t}}else if(l.elementType===o.type){n(t,l.sibling),(r=i(l,o.props)).ref=Po(t,l,o),r.return=t,t=r;break t}n(t,l);break}e(t,l),l=l.sibling}o.type===nt?((r=Hu(o.props.children,t.mode,u,o.key)).return=t,t=r):((u=Wu(o.type,o.key,o.props,null,t.mode,u)).ref=Po(t,r,o),u.return=t,t=u)}return s(t);case et:t:{for(l=o.key;null!==r;){if(r.key===l){if(4===r.tag&&r.stateNode.containerInfo===o.containerInfo&&r.stateNode.implementation===o.implementation){n(t,r.sibling),(r=i(r,o.children||[])).return=t,t=r;break t}n(t,r);break}e(t,r),r=r.sibling}(r=Yu(o,t.mode,u)).return=t,t=r}return s(t)}if("string"==typeof o||"number"==typeof o)return o=""+o,null!==r&&6===r.tag?(n(t,r.sibling),(r=i(r,o)).return=t,t=r):(n(t,r),(r=Xu(o,t.mode,u)).return=t,t=r),s(t);if(Ao(o))return m(t,r,o,u);if(mt(o))return g(t,r,o,u);if(c&&Co(t,o),void 0===o&&!l)switch(t.tag){case 1:case 0:throw t=t.type,Error(a(152,t.displayName||t.name||"Component"))}return n(t,r)}}var Io=Lo(!0),Oo=Lo(!1),No={},Ro={current:No},Do={current:No},ko={current:No};function Fo(t){if(t===No)throw Error(a(174));return t}function Bo(t,e){switch(mi(ko,e),mi(Do,t),mi(Ro,No),t=e.nodeType){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Ft(null,"");break;default:e=Ft(e=(t=8===t?e.parentNode:e).namespaceURI||null,t=t.tagName)}di(Ro),mi(Ro,e)}function Uo(){di(Ro),di(Do),di(ko)}function zo(t){Fo(ko.current);var e=Fo(Ro.current),n=Ft(e,t.type);e!==n&&(mi(Do,t),mi(Ro,n))}function Vo(t){Do.current===t&&(di(Ro),di(Do))}var Go={current:0};function jo(t){for(var e=t;null!==e;){if(13===e.tag){var n=e.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||n.data===xn||n.data===_n))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!=(64&e.effectTag))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}function Wo(t,e){return{responder:t,props:e}}var Ho=J.ReactCurrentDispatcher,Xo=J.ReactCurrentBatchConfig,Yo=0,qo=null,Zo=null,Jo=null,Ko=!1;function Qo(){throw Error(a(321))}function $o(t,e){if(null===e)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!jr(t[n],e[n]))return!1;return!0}function ta(t,e,n,r,i,o){if(Yo=o,qo=e,e.memoizedState=null,e.updateQueue=null,e.expirationTime=0,Ho.current=null===t||null===t.memoizedState?Ma:Sa,t=n(r,i),e.expirationTime===Yo){o=0;do{if(e.expirationTime=0,!(25>o))throw Error(a(301));o+=1,Jo=Zo=null,e.updateQueue=null,Ho.current=Ta,t=n(r,i)}while(e.expirationTime===Yo)}if(Ho.current=wa,e=null!==Zo&&null!==Zo.next,Yo=0,Jo=Zo=qo=null,Ko=!1,e)throw Error(a(300));return t}function ea(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Jo?qo.memoizedState=Jo=t:Jo=Jo.next=t,Jo}function na(){if(null===Zo){var t=qo.alternate;t=null!==t?t.memoizedState:null}else t=Zo.next;var e=null===Jo?qo.memoizedState:Jo.next;if(null!==e)Jo=e,Zo=t;else{if(null===t)throw Error(a(310));t={memoizedState:(Zo=t).memoizedState,baseState:Zo.baseState,baseQueue:Zo.baseQueue,queue:Zo.queue,next:null},null===Jo?qo.memoizedState=Jo=t:Jo=Jo.next=t}return Jo}function ra(t,e){return"function"==typeof e?e(t):e}function ia(t){var e=na(),n=e.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=t;var r=Zo,i=r.baseQueue,o=n.pending;if(null!==o){if(null!==i){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(null!==i){i=i.next,r=r.baseState;var u=s=o=null,l=i;do{var c=l.expirationTime;if(c<Yo){var h={expirationTime:l.expirationTime,suspenseConfig:l.suspenseConfig,action:l.action,eagerReducer:l.eagerReducer,eagerState:l.eagerState,next:null};null===u?(s=u=h,o=r):u=u.next=h,c>qo.expirationTime&&(qo.expirationTime=c,Mu(c))}else null!==u&&(u=u.next={expirationTime:1073741823,suspenseConfig:l.suspenseConfig,action:l.action,eagerReducer:l.eagerReducer,eagerState:l.eagerState,next:null}),wu(c,l.suspenseConfig),r=l.eagerReducer===t?l.eagerState:t(r,l.action);l=l.next}while(null!==l&&l!==i);null===u?o=r:u.next=s,jr(r,e.memoizedState)||(ka=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,n.lastRenderedState=r}return[e.memoizedState,n.dispatch]}function oa(t){var e=na(),n=e.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,o=e.memoizedState;if(null!==i){n.pending=null;var s=i=i.next;do{o=t(o,s.action),s=s.next}while(s!==i);jr(o,e.memoizedState)||(ka=!0),e.memoizedState=o,null===e.baseQueue&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function aa(t){var e=ea();return"function"==typeof t&&(t=t()),e.memoizedState=e.baseState=t,t=(t=e.queue={pending:null,dispatch:null,lastRenderedReducer:ra,lastRenderedState:t}).dispatch=ba.bind(null,qo,t),[e.memoizedState,t]}function sa(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},null===(e=qo.updateQueue)?(e={lastEffect:null},qo.updateQueue=e,e.lastEffect=t.next=t):null===(n=e.lastEffect)?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t),t}function ua(){return na().memoizedState}function la(t,e,n,r){var i=ea();qo.effectTag|=t,i.memoizedState=sa(1|e,n,void 0,void 0===r?null:r)}function ca(t,e,n,r){var i=na();r=void 0===r?null:r;var o=void 0;if(null!==Zo){var a=Zo.memoizedState;if(o=a.destroy,null!==r&&$o(r,a.deps))return void sa(e,n,o,r)}qo.effectTag|=t,i.memoizedState=sa(1|e,n,o,r)}function ha(t,e){return la(516,4,t,e)}function pa(t,e){return ca(516,4,t,e)}function fa(t,e){return ca(4,2,t,e)}function da(t,e){return"function"==typeof e?(t=t(),e(t),function(){e(null)}):null!=e?(t=t(),e.current=t,function(){e.current=null}):void 0}function ma(t,e,n){return n=null!=n?n.concat([t]):null,ca(4,2,da.bind(null,e,t),n)}function ga(){}function va(t,e){return ea().memoizedState=[t,void 0===e?null:e],t}function ya(t,e){var n=na();e=void 0===e?null:e;var r=n.memoizedState;return null!==r&&null!==e&&$o(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function xa(t,e){var n=na();e=void 0===e?null:e;var r=n.memoizedState;return null!==r&&null!==e&&$o(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function _a(t,e,n){var r=Xi();qi(98>r?98:r,(function(){t(!0)})),qi(97<r?97:r,(function(){var r=Xo.suspense;Xo.suspense=void 0===e?null:e;try{t(!1),n()}finally{Xo.suspense=r}}))}function ba(t,e,n){var r=lu(),i=xo.suspense;i={expirationTime:r=cu(r,t,i),suspenseConfig:i,action:n,eagerReducer:null,eagerState:null,next:null};var o=e.pending;if(null===o?i.next=i:(i.next=o.next,o.next=i),e.pending=i,o=t.alternate,t===qo||null!==o&&o===qo)Ko=!0,i.expirationTime=Yo,qo.expirationTime=Yo;else{if(0===t.expirationTime&&(null===o||0===o.expirationTime)&&null!==(o=e.lastRenderedReducer))try{var a=e.lastRenderedState,s=o(a,n);if(i.eagerReducer=o,i.eagerState=s,jr(s,a))return}catch(t){}hu(t,r)}}var wa={readContext:lo,useCallback:Qo,useContext:Qo,useEffect:Qo,useImperativeHandle:Qo,useLayoutEffect:Qo,useMemo:Qo,useReducer:Qo,useRef:Qo,useState:Qo,useDebugValue:Qo,useResponder:Qo,useDeferredValue:Qo,useTransition:Qo},Ma={readContext:lo,useCallback:va,useContext:lo,useEffect:ha,useImperativeHandle:function(t,e,n){return n=null!=n?n.concat([t]):null,la(4,2,da.bind(null,e,t),n)},useLayoutEffect:function(t,e){return la(4,2,t,e)},useMemo:function(t,e){var n=ea();return e=void 0===e?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=ea();return e=void 0!==n?n(e):e,r.memoizedState=r.baseState=e,t=(t=r.queue={pending:null,dispatch:null,lastRenderedReducer:t,lastRenderedState:e}).dispatch=ba.bind(null,qo,t),[r.memoizedState,t]},useRef:function(t){return t={current:t},ea().memoizedState=t},useState:aa,useDebugValue:ga,useResponder:Wo,useDeferredValue:function(t,e){var n=aa(t),r=n[0],i=n[1];return ha((function(){var n=Xo.suspense;Xo.suspense=void 0===e?null:e;try{i(t)}finally{Xo.suspense=n}}),[t,e]),r},useTransition:function(t){var e=aa(!1),n=e[0];return e=e[1],[va(_a.bind(null,e,t),[e,t]),n]}},Sa={readContext:lo,useCallback:ya,useContext:lo,useEffect:pa,useImperativeHandle:ma,useLayoutEffect:fa,useMemo:xa,useReducer:ia,useRef:ua,useState:function(){return ia(ra)},useDebugValue:ga,useResponder:Wo,useDeferredValue:function(t,e){var n=ia(ra),r=n[0],i=n[1];return pa((function(){var n=Xo.suspense;Xo.suspense=void 0===e?null:e;try{i(t)}finally{Xo.suspense=n}}),[t,e]),r},useTransition:function(t){var e=ia(ra),n=e[0];return e=e[1],[ya(_a.bind(null,e,t),[e,t]),n]}},Ta={readContext:lo,useCallback:ya,useContext:lo,useEffect:pa,useImperativeHandle:ma,useLayoutEffect:fa,useMemo:xa,useReducer:oa,useRef:ua,useState:function(){return oa(ra)},useDebugValue:ga,useResponder:Wo,useDeferredValue:function(t,e){var n=oa(ra),r=n[0],i=n[1];return pa((function(){var n=Xo.suspense;Xo.suspense=void 0===e?null:e;try{i(t)}finally{Xo.suspense=n}}),[t,e]),r},useTransition:function(t){var e=oa(ra),n=e[0];return e=e[1],[ya(_a.bind(null,e,t),[e,t]),n]}},Ea=null,Aa=null,Pa=!1;function Ca(t,e){var n=Vu(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=e,n.return=t,n.effectTag=8,null!==t.lastEffect?(t.lastEffect.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n}function La(t,e){switch(t.tag){case 5:var n=t.type;return null!==(e=1!==e.nodeType||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(t.stateNode=e,!0);case 6:return null!==(e=""===t.pendingProps||3!==e.nodeType?null:e)&&(t.stateNode=e,!0);default:return!1}}function Ia(t){if(Pa){var e=Aa;if(e){var n=e;if(!La(t,e)){if(!(e=An(n.nextSibling))||!La(t,e))return t.effectTag=-1025&t.effectTag|2,Pa=!1,void(Ea=t);Ca(Ea,n)}Ea=t,Aa=An(e.firstChild)}else t.effectTag=-1025&t.effectTag|2,Pa=!1,Ea=t}}function Oa(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag&&13!==t.tag;)t=t.return;Ea=t}function Na(t){if(t!==Ea)return!1;if(!Pa)return Oa(t),Pa=!0,!1;var e=t.type;if(5!==t.tag||"head"!==e&&"body"!==e&&!Sn(e,t.memoizedProps))for(e=Aa;e;)Ca(t,e),e=An(e.nextSibling);if(Oa(t),13===t.tag){if(!(t=null!==(t=t.memoizedState)?t.dehydrated:null))throw Error(a(317));t:{for(t=t.nextSibling,e=0;t;){if(8===t.nodeType){var n=t.data;if(n===yn){if(0===e){Aa=An(t.nextSibling);break t}e--}else n!==vn&&n!==_n&&n!==xn||e++}t=t.nextSibling}Aa=null}}else Aa=Ea?An(t.stateNode.nextSibling):null;return!0}function Ra(){Aa=Ea=null,Pa=!1}var Da=J.ReactCurrentOwner,ka=!1;function Fa(t,e,n,r){e.child=null===t?Oo(e,null,n,r):Io(e,t.child,n,r)}function Ba(t,e,n,r,i){n=n.render;var o=e.ref;return uo(e,i),r=ta(t,e,n,r,o,i),null===t||ka?(e.effectTag|=1,Fa(t,e,r,i),e.child):(e.updateQueue=t.updateQueue,e.effectTag&=-517,t.expirationTime<=i&&(t.expirationTime=0),es(t,e,i))}function Ua(t,e,n,r,i,o){if(null===t){var a=n.type;return"function"!=typeof a||Gu(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((t=Wu(n.type,null,r,null,e.mode,o)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=a,za(t,e,a,r,i,o))}return a=t.child,i<o&&(i=a.memoizedProps,(n=null!==(n=n.compare)?n:Hr)(i,r)&&t.ref===e.ref)?es(t,e,o):(e.effectTag|=1,(t=ju(a,r)).ref=e.ref,t.return=e,e.child=t)}function za(t,e,n,r,i,o){return null!==t&&Hr(t.memoizedProps,r)&&t.ref===e.ref&&(ka=!1,i<o)?(e.expirationTime=t.expirationTime,es(t,e,o)):Ga(t,e,n,r,o)}function Va(t,e){var n=e.ref;(null===t&&null!==n||null!==t&&t.ref!==n)&&(e.effectTag|=128)}function Ga(t,e,n,r,i){var o=bi(n)?xi:vi.current;return o=_i(e,o),uo(e,i),n=ta(t,e,n,r,o,i),null===t||ka?(e.effectTag|=1,Fa(t,e,n,i),e.child):(e.updateQueue=t.updateQueue,e.effectTag&=-517,t.expirationTime<=i&&(t.expirationTime=0),es(t,e,i))}function ja(t,e,n,r,i){if(bi(n)){var o=!0;Ti(e)}else o=!1;if(uo(e,i),null===e.stateNode)null!==t&&(t.alternate=null,e.alternate=null,e.effectTag|=2),So(e,n,r),Eo(e,n,r,i),r=!0;else if(null===t){var a=e.stateNode,s=e.memoizedProps;a.props=s;var u=a.context,l=n.contextType;"object"==typeof l&&null!==l?l=lo(l):l=_i(e,l=bi(n)?xi:vi.current);var c=n.getDerivedStateFromProps,h="function"==typeof c||"function"==typeof a.getSnapshotBeforeUpdate;h||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(s!==r||u!==l)&&To(e,a,r,l),co=!1;var p=e.memoizedState;a.state=p,vo(e,r,a,i),u=e.memoizedState,s!==r||p!==u||yi.current||co?("function"==typeof c&&(bo(e,n,c,r),u=e.memoizedState),(s=co||Mo(e,n,s,r,p,u,l))?(h||"function"!=typeof a.UNSAFE_componentWillMount&&"function"!=typeof a.componentWillMount||("function"==typeof a.componentWillMount&&a.componentWillMount(),"function"==typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"==typeof a.componentDidMount&&(e.effectTag|=4)):("function"==typeof a.componentDidMount&&(e.effectTag|=4),e.memoizedProps=r,e.memoizedState=u),a.props=r,a.state=u,a.context=l,r=s):("function"==typeof a.componentDidMount&&(e.effectTag|=4),r=!1)}else a=e.stateNode,po(t,e),s=e.memoizedProps,a.props=e.type===e.elementType?s:to(e.type,s),u=a.context,"object"==typeof(l=n.contextType)&&null!==l?l=lo(l):l=_i(e,l=bi(n)?xi:vi.current),(h="function"==typeof(c=n.getDerivedStateFromProps)||"function"==typeof a.getSnapshotBeforeUpdate)||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(s!==r||u!==l)&&To(e,a,r,l),co=!1,u=e.memoizedState,a.state=u,vo(e,r,a,i),p=e.memoizedState,s!==r||u!==p||yi.current||co?("function"==typeof c&&(bo(e,n,c,r),p=e.memoizedState),(c=co||Mo(e,n,s,r,u,p,l))?(h||"function"!=typeof a.UNSAFE_componentWillUpdate&&"function"!=typeof a.componentWillUpdate||("function"==typeof a.componentWillUpdate&&a.componentWillUpdate(r,p,l),"function"==typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,p,l)),"function"==typeof a.componentDidUpdate&&(e.effectTag|=4),"function"==typeof a.getSnapshotBeforeUpdate&&(e.effectTag|=256)):("function"!=typeof a.componentDidUpdate||s===t.memoizedProps&&u===t.memoizedState||(e.effectTag|=4),"function"!=typeof a.getSnapshotBeforeUpdate||s===t.memoizedProps&&u===t.memoizedState||(e.effectTag|=256),e.memoizedProps=r,e.memoizedState=p),a.props=r,a.state=p,a.context=l,r=c):("function"!=typeof a.componentDidUpdate||s===t.memoizedProps&&u===t.memoizedState||(e.effectTag|=4),"function"!=typeof a.getSnapshotBeforeUpdate||s===t.memoizedProps&&u===t.memoizedState||(e.effectTag|=256),r=!1);return Wa(t,e,n,r,o,i)}function Wa(t,e,n,r,i,o){Va(t,e);var a=0!=(64&e.effectTag);if(!r&&!a)return i&&Ei(e,n,!1),es(t,e,o);r=e.stateNode,Da.current=e;var s=a&&"function"!=typeof n.getDerivedStateFromError?null:r.render();return e.effectTag|=1,null!==t&&a?(e.child=Io(e,t.child,null,o),e.child=Io(e,null,s,o)):Fa(t,e,s,o),e.memoizedState=r.state,i&&Ei(e,n,!0),e.child}function Ha(t){var e=t.stateNode;e.pendingContext?Mi(0,e.pendingContext,e.pendingContext!==e.context):e.context&&Mi(0,e.context,!1),Bo(t,e.containerInfo)}var Xa,Ya,qa,Za,Ja={dehydrated:null,retryTime:0};function Ka(t,e,n){var r,i=e.mode,o=e.pendingProps,a=Go.current,s=!1;if((r=0!=(64&e.effectTag))||(r=0!=(2&a)&&(null===t||null!==t.memoizedState)),r?(s=!0,e.effectTag&=-65):null!==t&&null===t.memoizedState||void 0===o.fallback||!0===o.unstable_avoidThisFallback||(a|=1),mi(Go,1&a),null===t){if(void 0!==o.fallback&&Ia(e),s){if(s=o.fallback,(o=Hu(null,i,0,null)).return=e,0==(2&e.mode))for(t=null!==e.memoizedState?e.child.child:e.child,o.child=t;null!==t;)t.return=o,t=t.sibling;return(n=Hu(s,i,n,null)).return=e,o.sibling=n,e.memoizedState=Ja,e.child=o,n}return i=o.children,e.memoizedState=null,e.child=Oo(e,null,i,n)}if(null!==t.memoizedState){if(i=(t=t.child).sibling,s){if(o=o.fallback,(n=ju(t,t.pendingProps)).return=e,0==(2&e.mode)&&(s=null!==e.memoizedState?e.child.child:e.child)!==t.child)for(n.child=s;null!==s;)s.return=n,s=s.sibling;return(i=ju(i,o)).return=e,n.sibling=i,n.childExpirationTime=0,e.memoizedState=Ja,e.child=n,i}return n=Io(e,t.child,o.children,n),e.memoizedState=null,e.child=n}if(t=t.child,s){if(s=o.fallback,(o=Hu(null,i,0,null)).return=e,o.child=t,null!==t&&(t.return=o),0==(2&e.mode))for(t=null!==e.memoizedState?e.child.child:e.child,o.child=t;null!==t;)t.return=o,t=t.sibling;return(n=Hu(s,i,n,null)).return=e,o.sibling=n,n.effectTag|=2,o.childExpirationTime=0,e.memoizedState=Ja,e.child=o,n}return e.memoizedState=null,e.child=Io(e,t,o.children,n)}function Qa(t,e){t.expirationTime<e&&(t.expirationTime=e);var n=t.alternate;null!==n&&n.expirationTime<e&&(n.expirationTime=e),so(t.return,e)}function $a(t,e,n,r,i,o){var a=t.memoizedState;null===a?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailExpiration:0,tailMode:i,lastEffect:o}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailExpiration=0,a.tailMode=i,a.lastEffect=o)}function ts(t,e,n){var r=e.pendingProps,i=r.revealOrder,o=r.tail;if(Fa(t,e,r.children,n),0!=(2&(r=Go.current)))r=1&r|2,e.effectTag|=64;else{if(null!==t&&0!=(64&t.effectTag))t:for(t=e.child;null!==t;){if(13===t.tag)null!==t.memoizedState&&Qa(t,n);else if(19===t.tag)Qa(t,n);else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;null===t.sibling;){if(null===t.return||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(mi(Go,r),0==(2&e.mode))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;null!==n;)null!==(t=n.alternate)&&null===jo(t)&&(i=n),n=n.sibling;null===(n=i)?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),$a(e,!1,i,n,o,e.lastEffect);break;case"backwards":for(n=null,i=e.child,e.child=null;null!==i;){if(null!==(t=i.alternate)&&null===jo(t)){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}$a(e,!0,n,null,o,e.lastEffect);break;case"together":$a(e,!1,null,null,void 0,e.lastEffect);break;default:e.memoizedState=null}return e.child}function es(t,e,n){null!==t&&(e.dependencies=t.dependencies);var r=e.expirationTime;if(0!==r&&Mu(r),e.childExpirationTime<n)return null;if(null!==t&&e.child!==t.child)throw Error(a(153));if(null!==e.child){for(n=ju(t=e.child,t.pendingProps),e.child=n,n.return=e;null!==t.sibling;)t=t.sibling,(n=n.sibling=ju(t,t.pendingProps)).return=e;n.sibling=null}return e.child}function ns(t,e){switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;null!==e;)null!==e.alternate&&(n=e),e=e.sibling;null===n?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?e||null===t.tail?t.tail=null:t.tail.sibling=null:r.sibling=null}}function rs(t,e,n){var r=e.pendingProps;switch(e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:case 17:return bi(e.type)&&wi(),null;case 3:return Uo(),di(yi),di(vi),(n=e.stateNode).pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==t&&null!==t.child||!Na(e)||(e.effectTag|=4),Ya(e),null;case 5:Vo(e),n=Fo(ko.current);var o=e.type;if(null!==t&&null!=e.stateNode)qa(t,e,o,r,n),t.ref!==e.ref&&(e.effectTag|=128);else{if(!r){if(null===e.stateNode)throw Error(a(166));return null}if(t=Fo(Ro.current),Na(e)){r=e.stateNode,o=e.type;var s=e.memoizedProps;switch(r[Ln]=e,r[In]=s,o){case"iframe":case"object":case"embed":qe("load",r);break;case"video":case"audio":for(t=0;t<Kt.length;t++)qe(Kt[t],r);break;case"source":qe("error",r);break;case"img":case"image":case"link":qe("error",r),qe("load",r);break;case"form":qe("reset",r),qe("submit",r);break;case"details":qe("toggle",r);break;case"input":Mt(r,s),qe("invalid",r),ln(n,"onChange");break;case"select":r._wrapperState={wasMultiple:!!s.multiple},qe("invalid",r),ln(n,"onChange");break;case"textarea":It(r,s),qe("invalid",r),ln(n,"onChange")}for(var u in an(o,s),t=null,s)if(s.hasOwnProperty(u)){var l=s[u];"children"===u?"string"==typeof l?r.textContent!==l&&(t=["children",l]):"number"==typeof l&&r.textContent!==""+l&&(t=["children",""+l]):S.hasOwnProperty(u)&&null!=l&&ln(n,u)}switch(o){case"input":_t(r),Et(r,s,!0);break;case"textarea":_t(r),Nt(r);break;case"select":case"option":break;default:"function"==typeof s.onClick&&(r.onclick=cn)}n=t,e.updateQueue=n,null!==n&&(e.effectTag|=4)}else{switch(u=9===n.nodeType?n:n.ownerDocument,t===un&&(t=kt(o)),t===un?"script"===o?((t=u.createElement("div")).innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):"string"==typeof r.is?t=u.createElement(o,{is:r.is}):(t=u.createElement(o),"select"===o&&(u=t,r.multiple?u.multiple=!0:r.size&&(u.size=r.size))):t=u.createElementNS(t,o),t[Ln]=e,t[In]=r,Xa(t,e,!1,!1),e.stateNode=t,u=sn(o,r),o){case"iframe":case"object":case"embed":qe("load",t),l=r;break;case"video":case"audio":for(l=0;l<Kt.length;l++)qe(Kt[l],t);l=r;break;case"source":qe("error",t),l=r;break;case"img":case"image":case"link":qe("error",t),qe("load",t),l=r;break;case"form":qe("reset",t),qe("submit",t),l=r;break;case"details":qe("toggle",t),l=r;break;case"input":Mt(t,r),l=wt(t,r),qe("invalid",t),ln(n,"onChange");break;case"option":l=Pt(t,r);break;case"select":t._wrapperState={wasMultiple:!!r.multiple},l=i({},r,{value:void 0}),qe("invalid",t),ln(n,"onChange");break;case"textarea":It(t,r),l=Lt(t,r),qe("invalid",t),ln(n,"onChange");break;default:l=r}an(o,l);var c=l;for(s in c)if(c.hasOwnProperty(s)){var h=c[s];"style"===s?rn(t,h):"dangerouslySetInnerHTML"===s?null!=(h=h?h.__html:void 0)&&zt(t,h):"children"===s?"string"==typeof h?("textarea"!==o||""!==h)&&Vt(t,h):"number"==typeof h&&Vt(t,""+h):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(S.hasOwnProperty(s)?null!=h&&ln(n,s):null!=h&&K(t,s,h,u))}switch(o){case"input":_t(t),Et(t,r,!1);break;case"textarea":_t(t),Nt(t);break;case"option":null!=r.value&&t.setAttribute("value",""+yt(r.value));break;case"select":t.multiple=!!r.multiple,null!=(n=r.value)?Ct(t,!!r.multiple,n,!1):null!=r.defaultValue&&Ct(t,!!r.multiple,r.defaultValue,!0);break;default:"function"==typeof l.onClick&&(t.onclick=cn)}Mn(o,r)&&(e.effectTag|=4)}null!==e.ref&&(e.effectTag|=128)}return null;case 6:if(t&&null!=e.stateNode)Za(t,e,t.memoizedProps,r);else{if("string"!=typeof r&&null===e.stateNode)throw Error(a(166));n=Fo(ko.current),Fo(Ro.current),Na(e)?(n=e.stateNode,r=e.memoizedProps,n[Ln]=e,n.nodeValue!==r&&(e.effectTag|=4)):((n=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[Ln]=e,e.stateNode=n)}return null;case 13:return di(Go),r=e.memoizedState,0!=(64&e.effectTag)?(e.expirationTime=n,e):(n=null!==r,r=!1,null===t?void 0!==e.memoizedProps.fallback&&Na(e):(r=null!==(o=t.memoizedState),n||null===o||null!==(o=t.child.sibling)&&(null!==(s=e.firstEffect)?(e.firstEffect=o,o.nextEffect=s):(e.firstEffect=e.lastEffect=o,o.nextEffect=null),o.effectTag=8)),n&&!r&&0!=(2&e.mode)&&(null===t&&!0!==e.memoizedProps.unstable_avoidThisFallback||0!=(1&Go.current)?js===Ns&&(js=ks):(js!==Ns&&js!==ks||(js=Fs),0!==qs&&null!==zs&&(Ju(zs,Gs),Ku(zs,qs)))),(n||r)&&(e.effectTag|=4),null);case 4:return Uo(),Ya(e),null;case 10:return ao(e),null;case 19:if(di(Go),null===(r=e.memoizedState))return null;if(o=0!=(64&e.effectTag),null===(s=r.rendering)){if(o)ns(r,!1);else if(js!==Ns||null!==t&&0!=(64&t.effectTag))for(s=e.child;null!==s;){if(null!==(t=jo(s))){for(e.effectTag|=64,ns(r,!1),null!==(o=t.updateQueue)&&(e.updateQueue=o,e.effectTag|=4),null===r.lastEffect&&(e.firstEffect=null),e.lastEffect=r.lastEffect,r=e.child;null!==r;)s=n,(o=r).effectTag&=2,o.nextEffect=null,o.firstEffect=null,o.lastEffect=null,null===(t=o.alternate)?(o.childExpirationTime=0,o.expirationTime=s,o.child=null,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null):(o.childExpirationTime=t.childExpirationTime,o.expirationTime=t.expirationTime,o.child=t.child,o.memoizedProps=t.memoizedProps,o.memoizedState=t.memoizedState,o.updateQueue=t.updateQueue,s=t.dependencies,o.dependencies=null===s?null:{expirationTime:s.expirationTime,firstContext:s.firstContext,responders:s.responders}),r=r.sibling;return mi(Go,1&Go.current|2),e.child}s=s.sibling}}else{if(!o)if(null!==(t=jo(s))){if(e.effectTag|=64,o=!0,null!==(n=t.updateQueue)&&(e.updateQueue=n,e.effectTag|=4),ns(r,!0),null===r.tail&&"hidden"===r.tailMode&&!s.alternate)return null!==(e=e.lastEffect=r.lastEffect)&&(e.nextEffect=null),null}else 2*Hi()-r.renderingStartTime>r.tailExpiration&&1<n&&(e.effectTag|=64,o=!0,ns(r,!1),e.expirationTime=e.childExpirationTime=n-1);r.isBackwards?(s.sibling=e.child,e.child=s):(null!==(n=r.last)?n.sibling=s:e.child=s,r.last=s)}return null!==r.tail?(0===r.tailExpiration&&(r.tailExpiration=Hi()+500),n=r.tail,r.rendering=n,r.tail=n.sibling,r.lastEffect=e.lastEffect,r.renderingStartTime=Hi(),n.sibling=null,e=Go.current,mi(Go,o?1&e|2:1&e),n):null}throw Error(a(156,e.tag))}function is(t){switch(t.tag){case 1:bi(t.type)&&wi();var e=t.effectTag;return 4096&e?(t.effectTag=-4097&e|64,t):null;case 3:if(Uo(),di(yi),di(vi),0!=(64&(e=t.effectTag)))throw Error(a(285));return t.effectTag=-4097&e|64,t;case 5:return Vo(t),null;case 13:return di(Go),4096&(e=t.effectTag)?(t.effectTag=-4097&e|64,t):null;case 19:return di(Go),null;case 4:return Uo(),null;case 10:return ao(t),null;default:return null}}function os(t,e){return{value:t,source:e,stack:vt(e)}}Xa=function(t,e){for(var n=e.child;null!==n;){if(5===n.tag||6===n.tag)t.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ya=function(){},qa=function(t,e,n,r,o){var a=t.memoizedProps;if(a!==r){var s,u,l=e.stateNode;switch(Fo(Ro.current),t=null,n){case"input":a=wt(l,a),r=wt(l,r),t=[];break;case"option":a=Pt(l,a),r=Pt(l,r),t=[];break;case"select":a=i({},a,{value:void 0}),r=i({},r,{value:void 0}),t=[];break;case"textarea":a=Lt(l,a),r=Lt(l,r),t=[];break;default:"function"!=typeof a.onClick&&"function"==typeof r.onClick&&(l.onclick=cn)}for(s in an(n,r),n=null,a)if(!r.hasOwnProperty(s)&&a.hasOwnProperty(s)&&null!=a[s])if("style"===s)for(u in l=a[s])l.hasOwnProperty(u)&&(n||(n={}),n[u]="");else"dangerouslySetInnerHTML"!==s&&"children"!==s&&"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(S.hasOwnProperty(s)?t||(t=[]):(t=t||[]).push(s,null));for(s in r){var c=r[s];if(l=null!=a?a[s]:void 0,r.hasOwnProperty(s)&&c!==l&&(null!=c||null!=l))if("style"===s)if(l){for(u in l)!l.hasOwnProperty(u)||c&&c.hasOwnProperty(u)||(n||(n={}),n[u]="");for(u in c)c.hasOwnProperty(u)&&l[u]!==c[u]&&(n||(n={}),n[u]=c[u])}else n||(t||(t=[]),t.push(s,n)),n=c;else"dangerouslySetInnerHTML"===s?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(t=t||[]).push(s,c)):"children"===s?l===c||"string"!=typeof c&&"number"!=typeof c||(t=t||[]).push(s,""+c):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&(S.hasOwnProperty(s)?(null!=c&&ln(o,s),t||l===c||(t=[])):(t=t||[]).push(s,c))}n&&(t=t||[]).push("style",n),o=t,(e.updateQueue=o)&&(e.effectTag|=4)}},Za=function(t,e,n,r){n!==r&&(e.effectTag|=4)};var as="function"==typeof WeakSet?WeakSet:Set;function ss(t,e){var n=e.source,r=e.stack;null===r&&null!==n&&(r=vt(n)),null!==n&&gt(n.type),e=e.value,null!==t&&1===t.tag&&gt(t.type)}function us(t){var e=t.ref;if(null!==e)if("function"==typeof e)try{e(null)}catch(e){Du(t,e)}else e.current=null}function ls(t,e){switch(e.tag){case 0:case 11:case 15:case 22:case 3:case 5:case 6:case 4:case 17:return;case 1:if(256&e.effectTag&&null!==t){var n=t.memoizedProps,r=t.memoizedState;e=(t=e.stateNode).getSnapshotBeforeUpdate(e.elementType===e.type?n:to(e.type,n),r),t.__reactInternalSnapshotBeforeUpdate=e}return}throw Error(a(163))}function cs(t,e){if(null!==(e=null!==(e=e.updateQueue)?e.lastEffect:null)){var n=e=e.next;do{if((n.tag&t)===t){var r=n.destroy;n.destroy=void 0,void 0!==r&&r()}n=n.next}while(n!==e)}}function hs(t,e){if(null!==(e=null!==(e=e.updateQueue)?e.lastEffect:null)){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function ps(t,e,n){switch(n.tag){case 0:case 11:case 15:case 22:return void hs(3,n);case 1:if(t=n.stateNode,4&n.effectTag)if(null===e)t.componentDidMount();else{var r=n.elementType===n.type?e.memoizedProps:to(n.type,e.memoizedProps);t.componentDidUpdate(r,e.memoizedState,t.__reactInternalSnapshotBeforeUpdate)}return void(null!==(e=n.updateQueue)&&yo(n,e,t));case 3:if(null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 5:case 1:t=n.child.stateNode}yo(n,e,t)}return;case 5:return t=n.stateNode,void(null===e&&4&n.effectTag&&Mn(n.type,n.memoizedProps)&&t.focus());case 6:case 4:case 12:case 19:case 17:case 20:case 21:return;case 13:return void(null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&Fe(n)))))}throw Error(a(163))}function fs(t,e,n){switch("function"==typeof Uu&&Uu(e),e.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(t=e.updateQueue)&&null!==(t=t.lastEffect)){var r=t.next;qi(97<n?97:n,(function(){var t=r;do{var n=t.destroy;if(void 0!==n){var i=e;try{n()}catch(t){Du(i,t)}}t=t.next}while(t!==r)}))}break;case 1:us(e),"function"==typeof(n=e.stateNode).componentWillUnmount&&function(t,e){try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(e){Du(t,e)}}(e,n);break;case 5:us(e);break;case 4:xs(t,e,n)}}function ds(t){var e=t.alternate;t.return=null,t.child=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.alternate=null,t.firstEffect=null,t.lastEffect=null,t.pendingProps=null,t.memoizedProps=null,t.stateNode=null,null!==e&&ds(e)}function ms(t){return 5===t.tag||3===t.tag||4===t.tag}function gs(t){t:{for(var e=t.return;null!==e;){if(ms(e)){var n=e;break t}e=e.return}throw Error(a(160))}switch(e=n.stateNode,n.tag){case 5:var r=!1;break;case 3:case 4:e=e.containerInfo,r=!0;break;default:throw Error(a(161))}16&n.effectTag&&(Vt(e,""),n.effectTag&=-17);t:e:for(n=t;;){for(;null===n.sibling;){if(null===n.return||ms(n.return)){n=null;break t}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.effectTag)continue e;if(null===n.child||4===n.tag)continue e;n.child.return=n,n=n.child}if(!(2&n.effectTag)){n=n.stateNode;break t}}r?vs(t,n,e):ys(t,n,e)}function vs(t,e,n){var r=t.tag,i=5===r||6===r;if(i)t=i?t.stateNode:t.stateNode.instance,e?8===n.nodeType?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(8===n.nodeType?(e=n.parentNode).insertBefore(t,n):(e=n).appendChild(t),null!=(n=n._reactRootContainer)||null!==e.onclick||(e.onclick=cn));else if(4!==r&&null!==(t=t.child))for(vs(t,e,n),t=t.sibling;null!==t;)vs(t,e,n),t=t.sibling}function ys(t,e,n){var r=t.tag,i=5===r||6===r;if(i)t=i?t.stateNode:t.stateNode.instance,e?n.insertBefore(t,e):n.appendChild(t);else if(4!==r&&null!==(t=t.child))for(ys(t,e,n),t=t.sibling;null!==t;)ys(t,e,n),t=t.sibling}function xs(t,e,n){for(var r,i,o=e,s=!1;;){if(!s){s=o.return;t:for(;;){if(null===s)throw Error(a(160));switch(r=s.stateNode,s.tag){case 5:i=!1;break t;case 3:case 4:r=r.containerInfo,i=!0;break t}s=s.return}s=!0}if(5===o.tag||6===o.tag){t:for(var u=t,l=o,c=n,h=l;;)if(fs(u,h,c),null!==h.child&&4!==h.tag)h.child.return=h,h=h.child;else{if(h===l)break t;for(;null===h.sibling;){if(null===h.return||h.return===l)break t;h=h.return}h.sibling.return=h.return,h=h.sibling}i?(u=r,l=o.stateNode,8===u.nodeType?u.parentNode.removeChild(l):u.removeChild(l)):r.removeChild(o.stateNode)}else if(4===o.tag){if(null!==o.child){r=o.stateNode.containerInfo,i=!0,o.child.return=o,o=o.child;continue}}else if(fs(t,o,n),null!==o.child){o.child.return=o,o=o.child;continue}if(o===e)break;for(;null===o.sibling;){if(null===o.return||o.return===e)return;4===(o=o.return).tag&&(s=!1)}o.sibling.return=o.return,o=o.sibling}}function _s(t,e){switch(e.tag){case 0:case 11:case 14:case 15:case 22:return void cs(3,e);case 1:case 12:case 17:return;case 5:var n=e.stateNode;if(null!=n){var r=e.memoizedProps,i=null!==t?t.memoizedProps:r;t=e.type;var o=e.updateQueue;if(e.updateQueue=null,null!==o){for(n[In]=r,"input"===t&&"radio"===r.type&&null!=r.name&&St(n,r),sn(t,i),e=sn(t,r),i=0;i<o.length;i+=2){var s=o[i],u=o[i+1];"style"===s?rn(n,u):"dangerouslySetInnerHTML"===s?zt(n,u):"children"===s?Vt(n,u):K(n,s,u,e)}switch(t){case"input":Tt(n,r);break;case"textarea":Ot(n,r);break;case"select":e=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!r.multiple,null!=(t=r.value)?Ct(n,!!r.multiple,t,!1):e!==!!r.multiple&&(null!=r.defaultValue?Ct(n,!!r.multiple,r.defaultValue,!0):Ct(n,!!r.multiple,r.multiple?[]:"",!1))}}}return;case 6:if(null===e.stateNode)throw Error(a(162));return void(e.stateNode.nodeValue=e.memoizedProps);case 3:return void((e=e.stateNode).hydrate&&(e.hydrate=!1,Fe(e.containerInfo)));case 13:if(n=e,null===e.memoizedState?r=!1:(r=!0,n=e.child,Js=Hi()),null!==n)t:for(t=n;;){if(5===t.tag)o=t.stateNode,r?"function"==typeof(o=o.style).setProperty?o.setProperty("display","none","important"):o.display="none":(o=t.stateNode,i=null!=(i=t.memoizedProps.style)&&i.hasOwnProperty("display")?i.display:null,o.style.display=nn("display",i));else if(6===t.tag)t.stateNode.nodeValue=r?"":t.memoizedProps;else{if(13===t.tag&&null!==t.memoizedState&&null===t.memoizedState.dehydrated){(o=t.child.sibling).return=t,t=o;continue}if(null!==t.child){t.child.return=t,t=t.child;continue}}if(t===n)break;for(;null===t.sibling;){if(null===t.return||t.return===n)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}return void bs(e);case 19:return void bs(e)}throw Error(a(163))}function bs(t){var e=t.updateQueue;if(null!==e){t.updateQueue=null;var n=t.stateNode;null===n&&(n=t.stateNode=new as),e.forEach((function(e){var r=Fu.bind(null,t,e);n.has(e)||(n.add(e),e.then(r,r))}))}}var ws="function"==typeof WeakMap?WeakMap:Map;function Ms(t,e,n){(n=fo(n,null)).tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){$s||($s=!0,tu=r),ss(t,e)},n}function Ss(t,e,n){(n=fo(n,null)).tag=3;var r=t.type.getDerivedStateFromError;if("function"==typeof r){var i=e.value;n.payload=function(){return ss(t,e),r(i)}}var o=t.stateNode;return null!==o&&"function"==typeof o.componentDidCatch&&(n.callback=function(){"function"!=typeof r&&(null===eu?eu=new Set([this]):eu.add(this),ss(t,e));var n=e.stack;this.componentDidCatch(e.value,{componentStack:null!==n?n:""})}),n}var Ts,Es=Math.ceil,As=J.ReactCurrentDispatcher,Ps=J.ReactCurrentOwner,Cs=0,Ls=8,Is=16,Os=32,Ns=0,Rs=1,Ds=2,ks=3,Fs=4,Bs=5,Us=Cs,zs=null,Vs=null,Gs=0,js=Ns,Ws=null,Hs=1073741823,Xs=1073741823,Ys=null,qs=0,Zs=!1,Js=0,Ks=500,Qs=null,$s=!1,tu=null,eu=null,nu=!1,ru=null,iu=90,ou=null,au=0,su=null,uu=0;function lu(){return(Us&(Is|Os))!==Cs?1073741821-(Hi()/10|0):0!==uu?uu:uu=1073741821-(Hi()/10|0)}function cu(t,e,n){if(0==(2&(e=e.mode)))return 1073741823;var r=Xi();if(0==(4&e))return 99===r?1073741823:1073741822;if((Us&Is)!==Cs)return Gs;if(null!==n)t=$i(t,0|n.timeoutMs||5e3,250);else switch(r){case 99:t=1073741823;break;case 98:t=$i(t,150,100);break;case 97:case 96:t=$i(t,5e3,250);break;case 95:t=2;break;default:throw Error(a(326))}return null!==zs&&t===Gs&&--t,t}function hu(t,e){if(50<au)throw au=0,su=null,Error(a(185));if(null!==(t=pu(t,e))){var n=Xi();1073741823===e?(Us&Ls)!==Cs&&(Us&(Is|Os))===Cs?gu(t):(du(t),Us===Cs&&Ki()):du(t),(4&Us)===Cs||98!==n&&99!==n||(null===ou?ou=new Map([[t,e]]):(void 0===(n=ou.get(t))||n>e)&&ou.set(t,e))}}function pu(t,e){t.expirationTime<e&&(t.expirationTime=e);var n=t.alternate;null!==n&&n.expirationTime<e&&(n.expirationTime=e);var r=t.return,i=null;if(null===r&&3===t.tag)i=t.stateNode;else for(;null!==r;){if(n=r.alternate,r.childExpirationTime<e&&(r.childExpirationTime=e),null!==n&&n.childExpirationTime<e&&(n.childExpirationTime=e),null===r.return&&3===r.tag){i=r.stateNode;break}r=r.return}return null!==i&&(zs===i&&(Mu(e),js===Fs&&Ju(i,Gs)),Ku(i,e)),i}function fu(t){var e=t.lastExpiredTime;if(0!==e)return e;if(!Zu(t,e=t.firstPendingTime))return e;var n=t.lastPingedTime;return 2>=(t=n>(t=t.nextKnownPendingLevel)?n:t)&&e!==t?0:t}function du(t){if(0!==t.lastExpiredTime)t.callbackExpirationTime=1073741823,t.callbackPriority=99,t.callbackNode=Ji(gu.bind(null,t));else{var e=fu(t),n=t.callbackNode;if(0===e)null!==n&&(t.callbackNode=null,t.callbackExpirationTime=0,t.callbackPriority=90);else{var r=lu();if(1073741823===e?r=99:1===e||2===e?r=95:r=0>=(r=10*(1073741821-e)-10*(1073741821-r))?99:250>=r?98:5250>=r?97:95,null!==n){var i=t.callbackPriority;if(t.callbackExpirationTime===e&&i>=r)return;n!==Bi&&Ci(n)}t.callbackExpirationTime=e,t.callbackPriority=r,e=1073741823===e?Ji(gu.bind(null,t)):Zi(r,mu.bind(null,t),{timeout:10*(1073741821-e)-Hi()}),t.callbackNode=e}}}function mu(t,e){if(uu=0,e)return Qu(t,e=lu()),du(t),null;var n=fu(t);if(0!==n){if(e=t.callbackNode,(Us&(Is|Os))!==Cs)throw Error(a(327));if(Ou(),t===zs&&n===Gs||xu(t,n),null!==Vs){var r=Us;Us|=Is;for(var i=bu();;)try{Tu();break}catch(e){_u(t,e)}if(oo(),Us=r,As.current=i,js===Rs)throw e=Ws,xu(t,n),Ju(t,n),du(t),e;if(null===Vs)switch(i=t.finishedWork=t.current.alternate,t.finishedExpirationTime=n,r=js,zs=null,r){case Ns:case Rs:throw Error(a(345));case Ds:Qu(t,2<n?2:n);break;case ks:if(Ju(t,n),n===(r=t.lastSuspendedTime)&&(t.nextKnownPendingLevel=Pu(i)),1073741823===Hs&&10<(i=Js+Ks-Hi())){if(Zs){var o=t.lastPingedTime;if(0===o||o>=n){t.lastPingedTime=n,xu(t,n);break}}if(0!==(o=fu(t))&&o!==n)break;if(0!==r&&r!==n){t.lastPingedTime=r;break}t.timeoutHandle=Tn(Cu.bind(null,t),i);break}Cu(t);break;case Fs:if(Ju(t,n),n===(r=t.lastSuspendedTime)&&(t.nextKnownPendingLevel=Pu(i)),Zs&&(0===(i=t.lastPingedTime)||i>=n)){t.lastPingedTime=n,xu(t,n);break}if(0!==(i=fu(t))&&i!==n)break;if(0!==r&&r!==n){t.lastPingedTime=r;break}if(1073741823!==Xs?r=10*(1073741821-Xs)-Hi():1073741823===Hs?r=0:(r=10*(1073741821-Hs)-5e3,0>(r=(i=Hi())-r)&&(r=0),(n=10*(1073741821-n)-i)<(r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Es(r/1960))-r)&&(r=n)),10<r){t.timeoutHandle=Tn(Cu.bind(null,t),r);break}Cu(t);break;case Bs:if(1073741823!==Hs&&null!==Ys){o=Hs;var s=Ys;if(0>=(r=0|s.busyMinDurationMs)?r=0:(i=0|s.busyDelayMs,r=(o=Hi()-(10*(1073741821-o)-(0|s.timeoutMs||5e3)))<=i?0:i+r-o),10<r){Ju(t,n),t.timeoutHandle=Tn(Cu.bind(null,t),r);break}}Cu(t);break;default:throw Error(a(329))}if(du(t),t.callbackNode===e)return mu.bind(null,t)}}return null}function gu(t){var e=t.lastExpiredTime;if(e=0!==e?e:1073741823,(Us&(Is|Os))!==Cs)throw Error(a(327));if(Ou(),t===zs&&e===Gs||xu(t,e),null!==Vs){var n=Us;Us|=Is;for(var r=bu();;)try{Su();break}catch(e){_u(t,e)}if(oo(),Us=n,As.current=r,js===Rs)throw n=Ws,xu(t,e),Ju(t,e),du(t),n;if(null!==Vs)throw Error(a(261));t.finishedWork=t.current.alternate,t.finishedExpirationTime=e,zs=null,Cu(t),du(t)}return null}function vu(t,e){var n=Us;Us|=1;try{return t(e)}finally{(Us=n)===Cs&&Ki()}}function yu(t,e){var n=Us;Us&=-2,Us|=Ls;try{return t(e)}finally{(Us=n)===Cs&&Ki()}}function xu(t,e){t.finishedWork=null,t.finishedExpirationTime=0;var n=t.timeoutHandle;if(-1!==n&&(t.timeoutHandle=-1,En(n)),null!==Vs)for(n=Vs.return;null!==n;){var r=n;switch(r.tag){case 1:null!=(r=r.type.childContextTypes)&&wi();break;case 3:Uo(),di(yi),di(vi);break;case 5:Vo(r);break;case 4:Uo();break;case 13:case 19:di(Go);break;case 10:ao(r)}n=n.return}zs=t,Vs=ju(t.current,null),Gs=e,js=Ns,Ws=null,Xs=Hs=1073741823,Ys=null,qs=0,Zs=!1}function _u(t,e){for(;;){try{if(oo(),Ho.current=wa,Ko)for(var n=qo.memoizedState;null!==n;){var r=n.queue;null!==r&&(r.pending=null),n=n.next}if(Yo=0,Jo=Zo=qo=null,Ko=!1,null===Vs||null===Vs.return)return js=Rs,Ws=e,Vs=null;t:{var i=t,o=Vs.return,a=Vs,s=e;if(e=Gs,a.effectTag|=2048,a.firstEffect=a.lastEffect=null,null!==s&&"object"==typeof s&&"function"==typeof s.then){var u=s;if(0==(2&a.mode)){var l=a.alternate;l?(a.updateQueue=l.updateQueue,a.memoizedState=l.memoizedState,a.expirationTime=l.expirationTime):(a.updateQueue=null,a.memoizedState=null)}var c=0!=(1&Go.current),h=o;do{var p;if(p=13===h.tag){var f=h.memoizedState;if(null!==f)p=null!==f.dehydrated;else{var d=h.memoizedProps;p=void 0!==d.fallback&&(!0!==d.unstable_avoidThisFallback||!c)}}if(p){var m=h.updateQueue;if(null===m){var g=new Set;g.add(u),h.updateQueue=g}else m.add(u);if(0==(2&h.mode)){if(h.effectTag|=64,a.effectTag&=-2981,1===a.tag)if(null===a.alternate)a.tag=17;else{var v=fo(1073741823,null);v.tag=2,mo(a,v)}a.expirationTime=1073741823;break t}s=void 0,a=e;var y=i.pingCache;if(null===y?(y=i.pingCache=new ws,s=new Set,y.set(u,s)):void 0===(s=y.get(u))&&(s=new Set,y.set(u,s)),!s.has(a)){s.add(a);var x=ku.bind(null,i,u,a);u.then(x,x)}h.effectTag|=4096,h.expirationTime=e;break t}h=h.return}while(null!==h);s=Error((gt(a.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display."+vt(a))}js!==Bs&&(js=Ds),s=os(s,a),h=o;do{switch(h.tag){case 3:u=s,h.effectTag|=4096,h.expirationTime=e,go(h,Ms(h,u,e));break t;case 1:u=s;var _=h.type,b=h.stateNode;if(0==(64&h.effectTag)&&("function"==typeof _.getDerivedStateFromError||null!==b&&"function"==typeof b.componentDidCatch&&(null===eu||!eu.has(b)))){h.effectTag|=4096,h.expirationTime=e,go(h,Ss(h,u,e));break t}}h=h.return}while(null!==h)}Vs=Au(Vs)}catch(t){e=t;continue}break}}function bu(){var t=As.current;return As.current=wa,null===t?wa:t}function wu(t,e){t<Hs&&2<t&&(Hs=t),null!==e&&t<Xs&&2<t&&(Xs=t,Ys=e)}function Mu(t){t>qs&&(qs=t)}function Su(){for(;null!==Vs;)Vs=Eu(Vs)}function Tu(){for(;null!==Vs&&!Ui();)Vs=Eu(Vs)}function Eu(t){var e=Ts(t.alternate,t,Gs);return t.memoizedProps=t.pendingProps,null===e&&(e=Au(t)),Ps.current=null,e}function Au(t){Vs=t;do{var e=Vs.alternate;if(t=Vs.return,0==(2048&Vs.effectTag)){if(e=rs(e,Vs,Gs),1===Gs||1!==Vs.childExpirationTime){for(var n=0,r=Vs.child;null!==r;){var i=r.expirationTime,o=r.childExpirationTime;i>n&&(n=i),o>n&&(n=o),r=r.sibling}Vs.childExpirationTime=n}if(null!==e)return e;null!==t&&0==(2048&t.effectTag)&&(null===t.firstEffect&&(t.firstEffect=Vs.firstEffect),null!==Vs.lastEffect&&(null!==t.lastEffect&&(t.lastEffect.nextEffect=Vs.firstEffect),t.lastEffect=Vs.lastEffect),1<Vs.effectTag&&(null!==t.lastEffect?t.lastEffect.nextEffect=Vs:t.firstEffect=Vs,t.lastEffect=Vs))}else{if(null!==(e=is(Vs)))return e.effectTag&=2047,e;null!==t&&(t.firstEffect=t.lastEffect=null,t.effectTag|=2048)}if(null!==(e=Vs.sibling))return e;Vs=t}while(null!==Vs);return js===Ns&&(js=Bs),null}function Pu(t){var e=t.expirationTime;return e>(t=t.childExpirationTime)?e:t}function Cu(t){var e=Xi();return qi(99,Lu.bind(null,t,e)),null}function Lu(t,e){do{Ou()}while(null!==ru);if((Us&(Is|Os))!==Cs)throw Error(a(327));var n=t.finishedWork,r=t.finishedExpirationTime;if(null===n)return null;if(t.finishedWork=null,t.finishedExpirationTime=0,n===t.current)throw Error(a(177));t.callbackNode=null,t.callbackExpirationTime=0,t.callbackPriority=90,t.nextKnownPendingLevel=0;var i=Pu(n);if(t.firstPendingTime=i,r<=t.lastSuspendedTime?t.firstSuspendedTime=t.lastSuspendedTime=t.nextKnownPendingLevel=0:r<=t.firstSuspendedTime&&(t.firstSuspendedTime=r-1),r<=t.lastPingedTime&&(t.lastPingedTime=0),r<=t.lastExpiredTime&&(t.lastExpiredTime=0),t===zs&&(Vs=zs=null,Gs=0),1<n.effectTag?null!==n.lastEffect?(n.lastEffect.nextEffect=n,i=n.firstEffect):i=n:i=n.firstEffect,null!==i){var o=Us;Us|=Os,Ps.current=null,bn=Ye;var s=mn();if(gn(s)){if("selectionStart"in s)var u={start:s.selectionStart,end:s.selectionEnd};else t:{var l=(u=(u=s.ownerDocument)&&u.defaultView||window).getSelection&&u.getSelection();if(l&&0!==l.rangeCount){u=l.anchorNode;var c=l.anchorOffset,h=l.focusNode;l=l.focusOffset;try{u.nodeType,h.nodeType}catch(t){u=null;break t}var p=0,f=-1,d=-1,m=0,g=0,v=s,y=null;e:for(;;){for(var x;v!==u||0!==c&&3!==v.nodeType||(f=p+c),v!==h||0!==l&&3!==v.nodeType||(d=p+l),3===v.nodeType&&(p+=v.nodeValue.length),null!==(x=v.firstChild);)y=v,v=x;for(;;){if(v===s)break e;if(y===u&&++m===c&&(f=p),y===h&&++g===l&&(d=p),null!==(x=v.nextSibling))break;y=(v=y).parentNode}v=x}u=-1===f||-1===d?null:{start:f,end:d}}else u=null}u=u||{start:0,end:0}}else u=null;wn={activeElementDetached:null,focusedElem:s,selectionRange:u},Ye=!1,Qs=i;do{try{Iu()}catch(t){if(null===Qs)throw Error(a(330));Du(Qs,t),Qs=Qs.nextEffect}}while(null!==Qs);Qs=i;do{try{for(s=t,u=e;null!==Qs;){var _=Qs.effectTag;if(16&_&&Vt(Qs.stateNode,""),128&_){var b=Qs.alternate;if(null!==b){var w=b.ref;null!==w&&("function"==typeof w?w(null):w.current=null)}}switch(1038&_){case 2:gs(Qs),Qs.effectTag&=-3;break;case 6:gs(Qs),Qs.effectTag&=-3,_s(Qs.alternate,Qs);break;case 1024:Qs.effectTag&=-1025;break;case 1028:Qs.effectTag&=-1025,_s(Qs.alternate,Qs);break;case 4:_s(Qs.alternate,Qs);break;case 8:xs(s,c=Qs,u),ds(c)}Qs=Qs.nextEffect}}catch(t){if(null===Qs)throw Error(a(330));Du(Qs,t),Qs=Qs.nextEffect}}while(null!==Qs);if(w=wn,b=mn(),_=w.focusedElem,u=w.selectionRange,b!==_&&_&&_.ownerDocument&&dn(_.ownerDocument.documentElement,_)){null!==u&&gn(_)&&(b=u.start,void 0===(w=u.end)&&(w=b),"selectionStart"in _?(_.selectionStart=b,_.selectionEnd=Math.min(w,_.value.length)):(w=(b=_.ownerDocument||document)&&b.defaultView||window).getSelection&&(w=w.getSelection(),c=_.textContent.length,s=Math.min(u.start,c),u=void 0===u.end?s:Math.min(u.end,c),!w.extend&&s>u&&(c=u,u=s,s=c),c=fn(_,s),h=fn(_,u),c&&h&&(1!==w.rangeCount||w.anchorNode!==c.node||w.anchorOffset!==c.offset||w.focusNode!==h.node||w.focusOffset!==h.offset)&&((b=b.createRange()).setStart(c.node,c.offset),w.removeAllRanges(),s>u?(w.addRange(b),w.extend(h.node,h.offset)):(b.setEnd(h.node,h.offset),w.addRange(b))))),b=[];for(w=_;w=w.parentNode;)1===w.nodeType&&b.push({element:w,left:w.scrollLeft,top:w.scrollTop});for("function"==typeof _.focus&&_.focus(),_=0;_<b.length;_++)(w=b[_]).element.scrollLeft=w.left,w.element.scrollTop=w.top}Ye=!!bn,wn=bn=null,t.current=n,Qs=i;do{try{for(_=t;null!==Qs;){var M=Qs.effectTag;if(36&M&&ps(_,Qs.alternate,Qs),128&M){b=void 0;var S=Qs.ref;if(null!==S){var T=Qs.stateNode;Qs.tag,b=T,"function"==typeof S?S(b):S.current=b}}Qs=Qs.nextEffect}}catch(t){if(null===Qs)throw Error(a(330));Du(Qs,t),Qs=Qs.nextEffect}}while(null!==Qs);Qs=null,zi(),Us=o}else t.current=n;if(nu)nu=!1,ru=t,iu=e;else for(Qs=i;null!==Qs;)e=Qs.nextEffect,Qs.nextEffect=null,Qs=e;if(0===(e=t.firstPendingTime)&&(eu=null),1073741823===e?t===su?au++:(au=0,su=t):au=0,"function"==typeof Bu&&Bu(n.stateNode,r),du(t),$s)throw $s=!1,t=tu,tu=null,t;return(Us&Ls)!==Cs||Ki(),null}function Iu(){for(;null!==Qs;){var t=Qs.effectTag;0!=(256&t)&&ls(Qs.alternate,Qs),0==(512&t)||nu||(nu=!0,Zi(97,(function(){return Ou(),null}))),Qs=Qs.nextEffect}}function Ou(){if(90!==iu){var t=97<iu?97:iu;return iu=90,qi(t,Nu)}}function Nu(){if(null===ru)return!1;var t=ru;if(ru=null,(Us&(Is|Os))!==Cs)throw Error(a(331));var e=Us;for(Us|=Os,t=t.current.firstEffect;null!==t;){try{var n=t;if(0!=(512&n.effectTag))switch(n.tag){case 0:case 11:case 15:case 22:cs(5,n),hs(5,n)}}catch(e){if(null===t)throw Error(a(330));Du(t,e)}n=t.nextEffect,t.nextEffect=null,t=n}return Us=e,Ki(),!0}function Ru(t,e,n){mo(t,e=Ms(t,e=os(n,e),1073741823)),null!==(t=pu(t,1073741823))&&du(t)}function Du(t,e){if(3===t.tag)Ru(t,t,e);else for(var n=t.return;null!==n;){if(3===n.tag){Ru(n,t,e);break}if(1===n.tag){var r=n.stateNode;if("function"==typeof n.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===eu||!eu.has(r))){mo(n,t=Ss(n,t=os(e,t),1073741823)),null!==(n=pu(n,1073741823))&&du(n);break}}n=n.return}}function ku(t,e,n){var r=t.pingCache;null!==r&&r.delete(e),zs===t&&Gs===n?js===Fs||js===ks&&1073741823===Hs&&Hi()-Js<Ks?xu(t,Gs):Zs=!0:Zu(t,n)&&(0!==(e=t.lastPingedTime)&&e<n||(t.lastPingedTime=n,du(t)))}function Fu(t,e){var n=t.stateNode;null!==n&&n.delete(e),0===(e=0)&&(e=cu(e=lu(),t,null)),null!==(t=pu(t,e))&&du(t)}Ts=function(t,e,n){var r=e.expirationTime;if(null!==t){var i=e.pendingProps;if(t.memoizedProps!==i||yi.current)ka=!0;else{if(r<n){switch(ka=!1,e.tag){case 3:Ha(e),Ra();break;case 5:if(zo(e),4&e.mode&&1!==n&&i.hidden)return e.expirationTime=e.childExpirationTime=1,null;break;case 1:bi(e.type)&&Ti(e);break;case 4:Bo(e,e.stateNode.containerInfo);break;case 10:r=e.memoizedProps.value,i=e.type._context,mi(eo,i._currentValue),i._currentValue=r;break;case 13:if(null!==e.memoizedState)return 0!==(r=e.child.childExpirationTime)&&r>=n?Ka(t,e,n):(mi(Go,1&Go.current),null!==(e=es(t,e,n))?e.sibling:null);mi(Go,1&Go.current);break;case 19:if(r=e.childExpirationTime>=n,0!=(64&t.effectTag)){if(r)return ts(t,e,n);e.effectTag|=64}if(null!==(i=e.memoizedState)&&(i.rendering=null,i.tail=null),mi(Go,Go.current),!r)return null}return es(t,e,n)}ka=!1}}else ka=!1;switch(e.expirationTime=0,e.tag){case 2:if(r=e.type,null!==t&&(t.alternate=null,e.alternate=null,e.effectTag|=2),t=e.pendingProps,i=_i(e,vi.current),uo(e,n),i=ta(null,e,r,t,i,n),e.effectTag|=1,"object"==typeof i&&null!==i&&"function"==typeof i.render&&void 0===i.$$typeof){if(e.tag=1,e.memoizedState=null,e.updateQueue=null,bi(r)){var o=!0;Ti(e)}else o=!1;e.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,ho(e);var s=r.getDerivedStateFromProps;"function"==typeof s&&bo(e,r,s,t),i.updater=wo,e.stateNode=i,i._reactInternalFiber=e,Eo(e,r,t,n),e=Wa(null,e,r,!0,o,n)}else e.tag=0,Fa(null,e,i,n),e=e.child;return e;case 16:t:{if(i=e.elementType,null!==t&&(t.alternate=null,e.alternate=null,e.effectTag|=2),t=e.pendingProps,function(t){if(-1===t._status){t._status=0;var e=t._ctor;e=e(),t._result=e,e.then((function(e){0===t._status&&(e=e.default,t._status=1,t._result=e)}),(function(e){0===t._status&&(t._status=2,t._result=e)}))}}(i),1!==i._status)throw i._result;switch(i=i._result,e.type=i,o=e.tag=function(t){if("function"==typeof t)return Gu(t)?1:0;if(null!=t){if((t=t.$$typeof)===ut)return 11;if(t===ht)return 14}return 2}(i),t=to(i,t),o){case 0:e=Ga(null,e,i,t,n);break t;case 1:e=ja(null,e,i,t,n);break t;case 11:e=Ba(null,e,i,t,n);break t;case 14:e=Ua(null,e,i,to(i.type,t),r,n);break t}throw Error(a(306,i,""))}return e;case 0:return r=e.type,i=e.pendingProps,Ga(t,e,r,i=e.elementType===r?i:to(r,i),n);case 1:return r=e.type,i=e.pendingProps,ja(t,e,r,i=e.elementType===r?i:to(r,i),n);case 3:if(Ha(e),r=e.updateQueue,null===t||null===r)throw Error(a(282));if(r=e.pendingProps,i=null!==(i=e.memoizedState)?i.element:null,po(t,e),vo(e,r,null,n),(r=e.memoizedState.element)===i)Ra(),e=es(t,e,n);else{if((i=e.stateNode.hydrate)&&(Aa=An(e.stateNode.containerInfo.firstChild),Ea=e,i=Pa=!0),i)for(n=Oo(e,null,r,n),e.child=n;n;)n.effectTag=-3&n.effectTag|1024,n=n.sibling;else Fa(t,e,r,n),Ra();e=e.child}return e;case 5:return zo(e),null===t&&Ia(e),r=e.type,i=e.pendingProps,o=null!==t?t.memoizedProps:null,s=i.children,Sn(r,i)?s=null:null!==o&&Sn(r,o)&&(e.effectTag|=16),Va(t,e),4&e.mode&&1!==n&&i.hidden?(e.expirationTime=e.childExpirationTime=1,e=null):(Fa(t,e,s,n),e=e.child),e;case 6:return null===t&&Ia(e),null;case 13:return Ka(t,e,n);case 4:return Bo(e,e.stateNode.containerInfo),r=e.pendingProps,null===t?e.child=Io(e,null,r,n):Fa(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,Ba(t,e,r,i=e.elementType===r?i:to(r,i),n);case 7:return Fa(t,e,e.pendingProps,n),e.child;case 8:case 12:return Fa(t,e,e.pendingProps.children,n),e.child;case 10:t:{r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value;var u=e.type._context;if(mi(eo,u._currentValue),u._currentValue=o,null!==s)if(u=s.value,0===(o=jr(u,o)?0:0|("function"==typeof r._calculateChangedBits?r._calculateChangedBits(u,o):1073741823))){if(s.children===i.children&&!yi.current){e=es(t,e,n);break t}}else for(null!==(u=e.child)&&(u.return=e);null!==u;){var l=u.dependencies;if(null!==l){s=u.child;for(var c=l.firstContext;null!==c;){if(c.context===r&&0!=(c.observedBits&o)){1===u.tag&&((c=fo(n,null)).tag=2,mo(u,c)),u.expirationTime<n&&(u.expirationTime=n),null!==(c=u.alternate)&&c.expirationTime<n&&(c.expirationTime=n),so(u.return,n),l.expirationTime<n&&(l.expirationTime=n);break}c=c.next}}else s=10===u.tag&&u.type===e.type?null:u.child;if(null!==s)s.return=u;else for(s=u;null!==s;){if(s===e){s=null;break}if(null!==(u=s.sibling)){u.return=s.return,s=u;break}s=s.return}u=s}Fa(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=(o=e.pendingProps).children,uo(e,n),r=r(i=lo(i,o.unstable_observedBits)),e.effectTag|=1,Fa(t,e,r,n),e.child;case 14:return o=to(i=e.type,e.pendingProps),Ua(t,e,i,o=to(i.type,o),r,n);case 15:return za(t,e,e.type,e.pendingProps,r,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:to(r,i),null!==t&&(t.alternate=null,e.alternate=null,e.effectTag|=2),e.tag=1,bi(r)?(t=!0,Ti(e)):t=!1,uo(e,n),So(e,r,i),Eo(e,r,i,n),Wa(null,e,r,!0,t,n);case 19:return ts(t,e,n)}throw Error(a(156,e.tag))};var Bu=null,Uu=null;function zu(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.effectTag=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childExpirationTime=this.expirationTime=0,this.alternate=null}function Vu(t,e,n,r){return new zu(t,e,n,r)}function Gu(t){return!(!(t=t.prototype)||!t.isReactComponent)}function ju(t,e){var n=t.alternate;return null===n?((n=Vu(t.tag,e,t.key,t.mode)).elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.effectTag=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childExpirationTime=t.childExpirationTime,n.expirationTime=t.expirationTime,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=null===e?null:{expirationTime:e.expirationTime,firstContext:e.firstContext,responders:e.responders},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Wu(t,e,n,r,i,o){var s=2;if(r=t,"function"==typeof t)Gu(t)&&(s=1);else if("string"==typeof t)s=5;else t:switch(t){case nt:return Hu(n.children,i,o,e);case st:s=8,i|=7;break;case rt:s=8,i|=1;break;case it:return(t=Vu(12,n,e,8|i)).elementType=it,t.type=it,t.expirationTime=o,t;case lt:return(t=Vu(13,n,e,i)).type=lt,t.elementType=lt,t.expirationTime=o,t;case ct:return(t=Vu(19,n,e,i)).elementType=ct,t.expirationTime=o,t;default:if("object"==typeof t&&null!==t)switch(t.$$typeof){case ot:s=10;break t;case at:s=9;break t;case ut:s=11;break t;case ht:s=14;break t;case pt:s=16,r=null;break t;case ft:s=22;break t}throw Error(a(130,null==t?t:typeof t,""))}return(e=Vu(s,n,e,i)).elementType=t,e.type=r,e.expirationTime=o,e}function Hu(t,e,n,r){return(t=Vu(7,t,r,e)).expirationTime=n,t}function Xu(t,e,n){return(t=Vu(6,t,null,e)).expirationTime=n,t}function Yu(t,e,n){return(e=Vu(4,null!==t.children?t.children:[],t.key,e)).expirationTime=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function qu(t,e,n){this.tag=e,this.current=null,this.containerInfo=t,this.pingCache=this.pendingChildren=null,this.finishedExpirationTime=0,this.finishedWork=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=90,this.lastExpiredTime=this.lastPingedTime=this.nextKnownPendingLevel=this.lastSuspendedTime=this.firstSuspendedTime=this.firstPendingTime=0}function Zu(t,e){var n=t.firstSuspendedTime;return t=t.lastSuspendedTime,0!==n&&n>=e&&t<=e}function Ju(t,e){var n=t.firstSuspendedTime,r=t.lastSuspendedTime;n<e&&(t.firstSuspendedTime=e),(r>e||0===n)&&(t.lastSuspendedTime=e),e<=t.lastPingedTime&&(t.lastPingedTime=0),e<=t.lastExpiredTime&&(t.lastExpiredTime=0)}function Ku(t,e){e>t.firstPendingTime&&(t.firstPendingTime=e);var n=t.firstSuspendedTime;0!==n&&(e>=n?t.firstSuspendedTime=t.lastSuspendedTime=t.nextKnownPendingLevel=0:e>=t.lastSuspendedTime&&(t.lastSuspendedTime=e+1),e>t.nextKnownPendingLevel&&(t.nextKnownPendingLevel=e))}function Qu(t,e){var n=t.lastExpiredTime;(0===n||n>e)&&(t.lastExpiredTime=e)}function $u(t,e,n,r){var i=e.current,o=lu(),s=xo.suspense;o=cu(o,i,s);t:if(n){e:{if(te(n=n._reactInternalFiber)!==n||1!==n.tag)throw Error(a(170));var u=n;do{switch(u.tag){case 3:u=u.stateNode.context;break e;case 1:if(bi(u.type)){u=u.stateNode.__reactInternalMemoizedMergedChildContext;break e}}u=u.return}while(null!==u);throw Error(a(171))}if(1===n.tag){var l=n.type;if(bi(l)){n=Si(n,l,u);break t}}n=u}else n=gi;return null===e.context?e.context=n:e.pendingContext=n,(e=fo(o,s)).payload={element:t},null!==(r=void 0===r?null:r)&&(e.callback=r),mo(i,e),hu(i,o),o}function tl(t){return(t=t.current).child?(t.child.tag,t.child.stateNode):null}function el(t,e){null!==(t=t.memoizedState)&&null!==t.dehydrated&&t.retryTime<e&&(t.retryTime=e)}function nl(t,e){el(t,e),(t=t.alternate)&&el(t,e)}function rl(t,e,n){var r=new qu(t,e,n=null!=n&&!0===n.hydrate),i=Vu(3,null,null,2===e?7:1===e?3:0);r.current=i,i.stateNode=r,ho(i),t[On]=r.current,n&&0!==e&&function(t,e){var n=$t(e);Ae.forEach((function(t){me(t,e,n)})),Pe.forEach((function(t){me(t,e,n)}))}(0,9===t.nodeType?t:t.ownerDocument),this._internalRoot=r}function il(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType&&(8!==t.nodeType||" react-mount-point-unstable "!==t.nodeValue))}function ol(t,e,n,r,i){var o=n._reactRootContainer;if(o){var a=o._internalRoot;if("function"==typeof i){var s=i;i=function(){var t=tl(a);s.call(t)}}$u(e,a,t,i)}else{if(o=n._reactRootContainer=function(t,e){if(e||(e=!(!(e=t?9===t.nodeType?t.documentElement:t.firstChild:null)||1!==e.nodeType||!e.hasAttribute("data-reactroot"))),!e)for(var n;n=t.lastChild;)t.removeChild(n);return new rl(t,0,e?{hydrate:!0}:void 0)}(n,r),a=o._internalRoot,"function"==typeof i){var u=i;i=function(){var t=tl(a);u.call(t)}}yu((function(){$u(e,a,t,i)}))}return tl(a)}function al(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!il(e))throw Error(a(200));return function(t,e,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:et,key:null==r?null:""+r,children:t,containerInfo:e,implementation:n}}(t,e,null,n)}rl.prototype.render=function(t){$u(t,this._internalRoot,null,null)},rl.prototype.unmount=function(){var t=this._internalRoot,e=t.containerInfo;$u(null,t,null,(function(){e[On]=null}))},ge=function(t){if(13===t.tag){var e=$i(lu(),150,100);hu(t,e),nl(t,e)}},ve=function(t){13===t.tag&&(hu(t,3),nl(t,3))},ye=function(t){if(13===t.tag){var e=lu();hu(t,e=cu(e,t,null)),nl(t,e)}},P=function(t,e,n){switch(e){case"input":if(Tt(t,n),e=n.name,"radio"===n.type&&null!=e){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=kn(r);if(!i)throw Error(a(90));bt(r),Tt(r,i)}}}break;case"textarea":Ot(t,n);break;case"select":null!=(e=n.value)&&Ct(t,!!n.multiple,e,!1)}},R=vu,D=function(t,e,n,r,i){var o=Us;Us|=4;try{return qi(98,t.bind(null,e,n,r,i))}finally{(Us=o)===Cs&&Ki()}},k=function(){(Us&(1|Is|Os))===Cs&&(function(){if(null!==ou){var t=ou;ou=null,t.forEach((function(t,e){Qu(e,t),du(e)})),Ki()}}(),Ou())},F=function(t,e){var n=Us;Us|=2;try{return t(e)}finally{(Us=n)===Cs&&Ki()}};var sl={Events:[Rn,Dn,kn,E,M,jn,function(t){oe(t,Gn)},O,N,Qe,ue,Ou,{current:!1}]};!function(t){var e=t.findFiberByHostInstance;(function(t){if("undefined"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var e=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(e.isDisabled||!e.supportsFiber)return!0;try{var n=e.inject(t);Bu=function(t){try{e.onCommitFiberRoot(n,t,void 0,64==(64&t.current.effectTag))}catch(t){}},Uu=function(t){try{e.onCommitFiberUnmount(n,t)}catch(t){}}}catch(t){}})(i({},t,{overrideHookState:null,overrideProps:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:J.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return null===(t=re(t))?null:t.stateNode},findFiberByHostInstance:function(t){return e?e(t):null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null}))}({findFiberByHostInstance:Nn,bundleType:0,version:"16.14.0",rendererPackageName:"react-dom"}),e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sl,e.createPortal=al,e.findDOMNode=function(t){if(null==t)return null;if(1===t.nodeType)return t;var e=t._reactInternalFiber;if(void 0===e){if("function"==typeof t.render)throw Error(a(188));throw Error(a(268,Object.keys(t)))}return t=null===(t=re(e))?null:t.stateNode},e.flushSync=function(t,e){if((Us&(Is|Os))!==Cs)throw Error(a(187));var n=Us;Us|=1;try{return qi(99,t.bind(null,e))}finally{Us=n,Ki()}},e.hydrate=function(t,e,n){if(!il(e))throw Error(a(200));return ol(null,t,e,!0,n)},e.render=function(t,e,n){if(!il(e))throw Error(a(200));return ol(null,t,e,!1,n)},e.unmountComponentAtNode=function(t){if(!il(t))throw Error(a(40));return!!t._reactRootContainer&&(yu((function(){ol(null,null,t,!1,(function(){t._reactRootContainer=null,t[On]=null}))})),!0)},e.unstable_batchedUpdates=vu,e.unstable_createPortal=function(t,e){return al(t,e,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},e.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!il(n))throw Error(a(200));if(null==t||void 0===t._reactInternalFiber)throw Error(a(38));return ol(t,e,n,!1,r)},e.version="16.14.0"},73935:function(t,e,n){"use strict";!function t(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(t){}}(),t.exports=n(64448)},72408:function(t,e,n){"use strict";
/** @license React v16.14.0
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=n(27418),i="function"==typeof Symbol&&Symbol.for,o=i?Symbol.for("react.element"):60103,a=i?Symbol.for("react.portal"):60106,s=i?Symbol.for("react.fragment"):60107,u=i?Symbol.for("react.strict_mode"):60108,l=i?Symbol.for("react.profiler"):60114,c=i?Symbol.for("react.provider"):60109,h=i?Symbol.for("react.context"):60110,p=i?Symbol.for("react.forward_ref"):60112,f=i?Symbol.for("react.suspense"):60113,d=i?Symbol.for("react.memo"):60115,m=i?Symbol.for("react.lazy"):60116,g="function"==typeof Symbol&&Symbol.iterator;function v(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x={};function _(t,e,n){this.props=t,this.context=e,this.refs=x,this.updater=n||y}function b(){}function w(t,e,n){this.props=t,this.context=e,this.refs=x,this.updater=n||y}_.prototype.isReactComponent={},_.prototype.setState=function(t,e){if("object"!=typeof t&&"function"!=typeof t&&null!=t)throw Error(v(85));this.updater.enqueueSetState(this,t,e,"setState")},_.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},b.prototype=_.prototype;var M=w.prototype=new b;M.constructor=w,r(M,_.prototype),M.isPureReactComponent=!0;var S={current:null},T=Object.prototype.hasOwnProperty,E={key:!0,ref:!0,__self:!0,__source:!0};function A(t,e,n){var r,i={},a=null,s=null;if(null!=e)for(r in void 0!==e.ref&&(s=e.ref),void 0!==e.key&&(a=""+e.key),e)T.call(e,r)&&!E.hasOwnProperty(r)&&(i[r]=e[r]);var u=arguments.length-2;if(1===u)i.children=n;else if(1<u){for(var l=Array(u),c=0;c<u;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(r in u=t.defaultProps)void 0===i[r]&&(i[r]=u[r]);return{$$typeof:o,type:t,key:a,ref:s,props:i,_owner:S.current}}function P(t){return"object"==typeof t&&null!==t&&t.$$typeof===o}var C=/\/+/g,L=[];function I(t,e,n,r){if(L.length){var i=L.pop();return i.result=t,i.keyPrefix=e,i.func=n,i.context=r,i.count=0,i}return{result:t,keyPrefix:e,func:n,context:r,count:0}}function O(t){t.result=null,t.keyPrefix=null,t.func=null,t.context=null,t.count=0,10>L.length&&L.push(t)}function N(t,e,n,r){var i=typeof t;"undefined"!==i&&"boolean"!==i||(t=null);var s=!1;if(null===t)s=!0;else switch(i){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case o:case a:s=!0}}if(s)return n(r,t,""===e?"."+D(t,0):e),1;if(s=0,e=""===e?".":e+":",Array.isArray(t))for(var u=0;u<t.length;u++){var l=e+D(i=t[u],u);s+=N(i,l,n,r)}else if(null===t||"object"!=typeof t?l=null:l="function"==typeof(l=g&&t[g]||t["@@iterator"])?l:null,"function"==typeof l)for(t=l.call(t),u=0;!(i=t.next()).done;)s+=N(i=i.value,l=e+D(i,u++),n,r);else if("object"===i)throw n=""+t,Error(v(31,"[object Object]"===n?"object with keys {"+Object.keys(t).join(", ")+"}":n,""));return s}function R(t,e,n){return null==t?0:N(t,"",e,n)}function D(t,e){return"object"==typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+(""+t).replace(/[=:]/g,(function(t){return e[t]}))}(t.key):e.toString(36)}function k(t,e){t.func.call(t.context,e,t.count++)}function F(t,e,n){var r=t.result,i=t.keyPrefix;t=t.func.call(t.context,e,t.count++),Array.isArray(t)?B(t,r,n,(function(t){return t})):null!=t&&(P(t)&&(t=function(t,e){return{$$typeof:o,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(t,i+(!t.key||e&&e.key===t.key?"":(""+t.key).replace(C,"$&/")+"/")+n)),r.push(t))}function B(t,e,n,r,i){var o="";null!=n&&(o=(""+n).replace(C,"$&/")+"/"),R(t,F,e=I(e,o,r,i)),O(e)}var U={current:null};function z(){var t=U.current;if(null===t)throw Error(v(321));return t}var V={ReactCurrentDispatcher:U,ReactCurrentBatchConfig:{suspense:null},ReactCurrentOwner:S,IsSomeRendererActing:{current:!1},assign:r};e.Children={map:function(t,e,n){if(null==t)return t;var r=[];return B(t,r,null,e,n),r},forEach:function(t,e,n){if(null==t)return t;R(t,k,e=I(null,null,e,n)),O(e)},count:function(t){return R(t,(function(){return null}),null)},toArray:function(t){var e=[];return B(t,e,null,(function(t){return t})),e},only:function(t){if(!P(t))throw Error(v(143));return t}},e.Component=_,e.Fragment=s,e.Profiler=l,e.PureComponent=w,e.StrictMode=u,e.Suspense=f,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=V,e.cloneElement=function(t,e,n){if(null==t)throw Error(v(267,t));var i=r({},t.props),a=t.key,s=t.ref,u=t._owner;if(null!=e){if(void 0!==e.ref&&(s=e.ref,u=S.current),void 0!==e.key&&(a=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)T.call(e,c)&&!E.hasOwnProperty(c)&&(i[c]=void 0===e[c]&&void 0!==l?l[c]:e[c])}var c=arguments.length-2;if(1===c)i.children=n;else if(1<c){l=Array(c);for(var h=0;h<c;h++)l[h]=arguments[h+2];i.children=l}return{$$typeof:o,type:t.type,key:a,ref:s,props:i,_owner:u}},e.createContext=function(t,e){return void 0===e&&(e=null),(t={$$typeof:h,_calculateChangedBits:e,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:c,_context:t},t.Consumer=t},e.createElement=A,e.createFactory=function(t){var e=A.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:p,render:t}},e.isValidElement=P,e.lazy=function(t){return{$$typeof:m,_ctor:t,_status:-1,_result:null}},e.memo=function(t,e){return{$$typeof:d,type:t,compare:void 0===e?null:e}},e.useCallback=function(t,e){return z().useCallback(t,e)},e.useContext=function(t,e){return z().useContext(t,e)},e.useDebugValue=function(){},e.useEffect=function(t,e){return z().useEffect(t,e)},e.useImperativeHandle=function(t,e,n){return z().useImperativeHandle(t,e,n)},e.useLayoutEffect=function(t,e){return z().useLayoutEffect(t,e)},e.useMemo=function(t,e){return z().useMemo(t,e)},e.useReducer=function(t,e,n){return z().useReducer(t,e,n)},e.useRef=function(t){return z().useRef(t)},e.useState=function(t){return z().useState(t)},e.version="16.14.0"},67294:function(t,e,n){"use strict";t.exports=n(72408)},60053:function(t,e){"use strict";
/** @license React v0.19.1
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n,r,i,o,a;if("undefined"==typeof window||"function"!=typeof MessageChannel){var s=null,u=null,l=function(){if(null!==s)try{var t=e.unstable_now();s(!0,t),s=null}catch(t){throw setTimeout(l,0),t}},c=Date.now();e.unstable_now=function(){return Date.now()-c},n=function(t){null!==s?setTimeout(n,0,t):(s=t,setTimeout(l,0))},r=function(t,e){u=setTimeout(t,e)},i=function(){clearTimeout(u)},o=function(){return!1},a=e.unstable_forceFrameRate=function(){}}else{var h=window.performance,p=window.Date,f=window.setTimeout,d=window.clearTimeout;if("undefined"!=typeof console){window.cancelAnimationFrame;window.requestAnimationFrame}if("object"==typeof h&&"function"==typeof h.now)e.unstable_now=function(){return h.now()};else{var m=p.now();e.unstable_now=function(){return p.now()-m}}var g=!1,v=null,y=-1,x=5,_=0;o=function(){return e.unstable_now()>=_},a=function(){},e.unstable_forceFrameRate=function(t){0>t||125<t||(x=0<t?Math.floor(1e3/t):5)};var b=new MessageChannel,w=b.port2;b.port1.onmessage=function(){if(null!==v){var t=e.unstable_now();_=t+x;try{v(!0,t)?w.postMessage(null):(g=!1,v=null)}catch(t){throw w.postMessage(null),t}}else g=!1},n=function(t){v=t,g||(g=!0,w.postMessage(null))},r=function(t,n){y=f((function(){t(e.unstable_now())}),n)},i=function(){d(y),y=-1}}function M(t,e){var n=t.length;t.push(e);t:for(;;){var r=n-1>>>1,i=t[r];if(!(void 0!==i&&0<E(i,e)))break t;t[r]=e,t[n]=i,n=r}}function S(t){return void 0===(t=t[0])?null:t}function T(t){var e=t[0];if(void 0!==e){var n=t.pop();if(n!==e){t[0]=n;t:for(var r=0,i=t.length;r<i;){var o=2*(r+1)-1,a=t[o],s=o+1,u=t[s];if(void 0!==a&&0>E(a,n))void 0!==u&&0>E(u,a)?(t[r]=u,t[s]=n,r=s):(t[r]=a,t[o]=n,r=o);else{if(!(void 0!==u&&0>E(u,n)))break t;t[r]=u,t[s]=n,r=s}}}return e}return null}function E(t,e){var n=t.sortIndex-e.sortIndex;return 0!==n?n:t.id-e.id}var A=[],P=[],C=1,L=null,I=3,O=!1,N=!1,R=!1;function D(t){for(var e=S(P);null!==e;){if(null===e.callback)T(P);else{if(!(e.startTime<=t))break;T(P),e.sortIndex=e.expirationTime,M(A,e)}e=S(P)}}function k(t){if(R=!1,D(t),!N)if(null!==S(A))N=!0,n(F);else{var e=S(P);null!==e&&r(k,e.startTime-t)}}function F(t,n){N=!1,R&&(R=!1,i()),O=!0;var a=I;try{for(D(n),L=S(A);null!==L&&(!(L.expirationTime>n)||t&&!o());){var s=L.callback;if(null!==s){L.callback=null,I=L.priorityLevel;var u=s(L.expirationTime<=n);n=e.unstable_now(),"function"==typeof u?L.callback=u:L===S(A)&&T(A),D(n)}else T(A);L=S(A)}if(null!==L)var l=!0;else{var c=S(P);null!==c&&r(k,c.startTime-n),l=!1}return l}finally{L=null,I=a,O=!1}}function B(t){switch(t){case 1:return-1;case 2:return 250;case 5:return 1073741823;case 4:return 1e4;default:return 5e3}}var U=a;e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_continueExecution=function(){N||O||(N=!0,n(F))},e.unstable_getCurrentPriorityLevel=function(){return I},e.unstable_getFirstCallbackNode=function(){return S(A)},e.unstable_next=function(t){switch(I){case 1:case 2:case 3:var e=3;break;default:e=I}var n=I;I=e;try{return t()}finally{I=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=U,e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var n=I;I=t;try{return e()}finally{I=n}},e.unstable_scheduleCallback=function(t,o,a){var s=e.unstable_now();if("object"==typeof a&&null!==a){var u=a.delay;u="number"==typeof u&&0<u?s+u:s,a="number"==typeof a.timeout?a.timeout:B(t)}else a=B(t),u=s;return t={id:C++,callback:o,priorityLevel:t,startTime:u,expirationTime:a=u+a,sortIndex:-1},u>s?(t.sortIndex=u,M(P,t),null===S(A)&&t===S(P)&&(R?i():R=!0,r(k,u-s))):(t.sortIndex=a,M(A,t),N||O||(N=!0,n(F))),t},e.unstable_shouldYield=function(){var t=e.unstable_now();D(t);var n=S(A);return n!==L&&null!==L&&null!==n&&null!==n.callback&&n.startTime<=t&&n.expirationTime<L.expirationTime||o()},e.unstable_wrapCallback=function(t){var e=I;return function(){var n=I;I=e;try{return t.apply(this,arguments)}finally{I=n}}}},63840:function(t,e,n){"use strict";t.exports=n(60053)},20666:function(t,e,n){var r,i;!function(){"use strict";var o,a={version:"6.4.2.2",use_lines:!0,use_xyz:!1},s=!1;if(t.exports?(t.exports=a,s=!0):(void 0===(i="function"==typeof(r=a)?r.call(e,n,e,t):r)||(t.exports=i),"undefined"!=typeof document?window.ClipperLib=a:self.ClipperLib=a),s){u="chrome";o="Netscape"}else{var u=navigator.userAgent.toString().toLowerCase();o=navigator.appName}var l,c={};-1!=u.indexOf("chrome")&&-1==u.indexOf("chromium")?c.chrome=1:c.chrome=0,-1!=u.indexOf("chromium")?c.chromium=1:c.chromium=0,-1!=u.indexOf("safari")&&-1==u.indexOf("chrome")&&-1==u.indexOf("chromium")?c.safari=1:c.safari=0,-1!=u.indexOf("firefox")?c.firefox=1:c.firefox=0,-1!=u.indexOf("firefox/17")?c.firefox17=1:c.firefox17=0,-1!=u.indexOf("firefox/15")?c.firefox15=1:c.firefox15=0,-1!=u.indexOf("firefox/3")?c.firefox3=1:c.firefox3=0,-1!=u.indexOf("opera")?c.opera=1:c.opera=0,-1!=u.indexOf("msie 10")?c.msie10=1:c.msie10=0,-1!=u.indexOf("msie 9")?c.msie9=1:c.msie9=0,-1!=u.indexOf("msie 8")?c.msie8=1:c.msie8=0,-1!=u.indexOf("msie 7")?c.msie7=1:c.msie7=0,-1!=u.indexOf("msie ")?c.msie=1:c.msie=0,a.biginteger_used=null;function h(t,e,n){a.biginteger_used=1,null!=t&&("number"==typeof t&&void 0===e?this.fromInt(t):"number"==typeof t?this.fromNumber(t,e,n):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}function p(){return new h(null,void 0,void 0)}"Microsoft Internet Explorer"==o?(h.prototype.am=function(t,e,n,r,i,o){for(var a=32767&e,s=e>>15;--o>=0;){var u=32767&this[t],l=this[t++]>>15,c=s*u+l*a;i=((u=a*u+((32767&c)<<15)+n[r]+(1073741823&i))>>>30)+(c>>>15)+s*l+(i>>>30),n[r++]=1073741823&u}return i},l=30):"Netscape"!=o?(h.prototype.am=function(t,e,n,r,i,o){for(;--o>=0;){var a=e*this[t++]+n[r]+i;i=Math.floor(a/67108864),n[r++]=67108863&a}return i},l=26):(h.prototype.am=function(t,e,n,r,i,o){for(var a=16383&e,s=e>>14;--o>=0;){var u=16383&this[t],l=this[t++]>>14,c=s*u+l*a;i=((u=a*u+((16383&c)<<14)+n[r]+i)>>28)+(c>>14)+s*l,n[r++]=268435455&u}return i},l=28),h.prototype.DB=l,h.prototype.DM=(1<<l)-1,h.prototype.DV=1<<l;h.prototype.FV=Math.pow(2,52),h.prototype.F1=52-l,h.prototype.F2=2*l-52;var f,d,m="0123456789abcdefghijklmnopqrstuvwxyz",g=new Array;for(f="0".charCodeAt(0),d=0;d<=9;++d)g[f++]=d;for(f="a".charCodeAt(0),d=10;d<36;++d)g[f++]=d;for(f="A".charCodeAt(0),d=10;d<36;++d)g[f++]=d;function v(t){return m.charAt(t)}function y(t,e){var n=g[t.charCodeAt(e)];return null==n?-1:n}function x(t){var e=p();return e.fromInt(t),e}function _(t){var e,n=1;return 0!=(e=t>>>16)&&(t=e,n+=16),0!=(e=t>>8)&&(t=e,n+=8),0!=(e=t>>4)&&(t=e,n+=4),0!=(e=t>>2)&&(t=e,n+=2),0!=(e=t>>1)&&(t=e,n+=1),n}function b(t){this.m=t}function w(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function M(t,e){return t&e}function S(t,e){return t|e}function T(t,e){return t^e}function E(t,e){return t&~e}function A(t){if(0==t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}function P(t){for(var e=0;0!=t;)t&=t-1,++e;return e}function C(){}function L(t){return t}function I(t){this.r2=p(),this.q3=p(),h.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}b.prototype.convert=function(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t},b.prototype.revert=function(t){return t},b.prototype.reduce=function(t){t.divRemTo(this.m,null,t)},b.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n),this.reduce(n)},b.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},w.prototype.convert=function(t){var e=p();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(h.ZERO)>0&&this.m.subTo(e,e),e},w.prototype.revert=function(t){var e=p();return t.copyTo(e),this.reduce(e),e},w.prototype.reduce=function(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var n=32767&t[e],r=n*this.mpl+((n*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(t[n=e+this.m.t]+=this.m.am(0,r,t,e,0,this.m.t);t[n]>=t.DV;)t[n]-=t.DV,t[++n]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)},w.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n),this.reduce(n)},w.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},h.prototype.copyTo=function(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s},h.prototype.fromInt=function(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+this.DV:this.t=0},h.prototype.fromString=function(t,e){var n;if(16==e)n=4;else if(8==e)n=3;else if(256==e)n=8;else if(2==e)n=1;else if(32==e)n=5;else{if(4!=e)return void this.fromRadix(t,e);n=2}this.t=0,this.s=0;for(var r=t.length,i=!1,o=0;--r>=0;){var a=8==n?255&t[r]:y(t,r);a<0?"-"==t.charAt(r)&&(i=!0):(i=!1,0==o?this[this.t++]=a:o+n>this.DB?(this[this.t-1]|=(a&(1<<this.DB-o)-1)<<o,this[this.t++]=a>>this.DB-o):this[this.t-1]|=a<<o,(o+=n)>=this.DB&&(o-=this.DB))}8==n&&0!=(128&t[0])&&(this.s=-1,o>0&&(this[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),i&&h.ZERO.subTo(this,this)},h.prototype.clamp=function(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t},h.prototype.dlShiftTo=function(t,e){var n;for(n=this.t-1;n>=0;--n)e[n+t]=this[n];for(n=t-1;n>=0;--n)e[n]=0;e.t=this.t+t,e.s=this.s},h.prototype.drShiftTo=function(t,e){for(var n=t;n<this.t;++n)e[n-t]=this[n];e.t=Math.max(this.t-t,0),e.s=this.s},h.prototype.lShiftTo=function(t,e){var n,r=t%this.DB,i=this.DB-r,o=(1<<i)-1,a=Math.floor(t/this.DB),s=this.s<<r&this.DM;for(n=this.t-1;n>=0;--n)e[n+a+1]=this[n]>>i|s,s=(this[n]&o)<<r;for(n=a-1;n>=0;--n)e[n]=0;e[a]=s,e.t=this.t+a+1,e.s=this.s,e.clamp()},h.prototype.rShiftTo=function(t,e){e.s=this.s;var n=Math.floor(t/this.DB);if(n>=this.t)e.t=0;else{var r=t%this.DB,i=this.DB-r,o=(1<<r)-1;e[0]=this[n]>>r;for(var a=n+1;a<this.t;++a)e[a-n-1]|=(this[a]&o)<<i,e[a-n]=this[a]>>r;r>0&&(e[this.t-n-1]|=(this.s&o)<<i),e.t=this.t-n,e.clamp()}},h.prototype.subTo=function(t,e){for(var n=0,r=0,i=Math.min(t.t,this.t);n<i;)r+=this[n]-t[n],e[n++]=r&this.DM,r>>=this.DB;if(t.t<this.t){for(r-=t.s;n<this.t;)r+=this[n],e[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;n<t.t;)r-=t[n],e[n++]=r&this.DM,r>>=this.DB;r-=t.s}e.s=r<0?-1:0,r<-1?e[n++]=this.DV+r:r>0&&(e[n++]=r),e.t=n,e.clamp()},h.prototype.multiplyTo=function(t,e){var n=this.abs(),r=t.abs(),i=n.t;for(e.t=i+r.t;--i>=0;)e[i]=0;for(i=0;i<r.t;++i)e[i+n.t]=n.am(0,r[i],e,i,0,n.t);e.s=0,e.clamp(),this.s!=t.s&&h.ZERO.subTo(e,e)},h.prototype.squareTo=function(t){for(var e=this.abs(),n=t.t=2*e.t;--n>=0;)t[n]=0;for(n=0;n<e.t-1;++n){var r=e.am(n,e[n],t,2*n,0,1);(t[n+e.t]+=e.am(n+1,2*e[n],t,2*n+1,r,e.t-n-1))>=e.DV&&(t[n+e.t]-=e.DV,t[n+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(n,e[n],t,2*n,0,1)),t.s=0,t.clamp()},h.prototype.divRemTo=function(t,e,n){var r=t.abs();if(!(r.t<=0)){var i=this.abs();if(i.t<r.t)return null!=e&&e.fromInt(0),void(null!=n&&this.copyTo(n));null==n&&(n=p());var o=p(),a=this.s,s=t.s,u=this.DB-_(r[r.t-1]);u>0?(r.lShiftTo(u,o),i.lShiftTo(u,n)):(r.copyTo(o),i.copyTo(n));var l=o.t,c=o[l-1];if(0!=c){var f=c*(1<<this.F1)+(l>1?o[l-2]>>this.F2:0),d=this.FV/f,m=(1<<this.F1)/f,g=1<<this.F2,v=n.t,y=v-l,x=null==e?p():e;for(o.dlShiftTo(y,x),n.compareTo(x)>=0&&(n[n.t++]=1,n.subTo(x,n)),h.ONE.dlShiftTo(l,x),x.subTo(o,o);o.t<l;)o[o.t++]=0;for(;--y>=0;){var b=n[--v]==c?this.DM:Math.floor(n[v]*d+(n[v-1]+g)*m);if((n[v]+=o.am(0,b,n,y,0,l))<b)for(o.dlShiftTo(y,x),n.subTo(x,n);n[v]<--b;)n.subTo(x,n)}null!=e&&(n.drShiftTo(l,e),a!=s&&h.ZERO.subTo(e,e)),n.t=l,n.clamp(),u>0&&n.rShiftTo(u,n),a<0&&h.ZERO.subTo(n,n)}}},h.prototype.invDigit=function(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return(e=(e=(e=(e=e*(2-(15&t)*e)&15)*(2-(255&t)*e)&255)*(2-((65535&t)*e&65535))&65535)*(2-t*e%this.DV)%this.DV)>0?this.DV-e:-e},h.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},h.prototype.exp=function(t,e){if(t>4294967295||t<1)return h.ONE;var n=p(),r=p(),i=e.convert(this),o=_(t)-1;for(i.copyTo(n);--o>=0;)if(e.sqrTo(n,r),(t&1<<o)>0)e.mulTo(r,i,n);else{var a=n;n=r,r=a}return e.revert(n)},h.prototype.toString=function(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var n,r=(1<<e)-1,i=!1,o="",a=this.t,s=this.DB-a*this.DB%e;if(a-- >0)for(s<this.DB&&(n=this[a]>>s)>0&&(i=!0,o=v(n));a>=0;)s<e?(n=(this[a]&(1<<s)-1)<<e-s,n|=this[--a]>>(s+=this.DB-e)):(n=this[a]>>(s-=e)&r,s<=0&&(s+=this.DB,--a)),n>0&&(i=!0),i&&(o+=v(n));return i?o:"0"},h.prototype.negate=function(){var t=p();return h.ZERO.subTo(this,t),t},h.prototype.abs=function(){return this.s<0?this.negate():this},h.prototype.compareTo=function(t){var e=this.s-t.s;if(0!=e)return e;var n=this.t;if(0!=(e=n-t.t))return this.s<0?-e:e;for(;--n>=0;)if(0!=(e=this[n]-t[n]))return e;return 0},h.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+_(this[this.t-1]^this.s&this.DM)},h.prototype.mod=function(t){var e=p();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(h.ZERO)>0&&t.subTo(e,e),e},h.prototype.modPowInt=function(t,e){var n;return n=t<256||e.isEven()?new b(e):new w(e),this.exp(t,n)},h.ZERO=x(0),h.ONE=x(1),C.prototype.convert=L,C.prototype.revert=L,C.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n)},C.prototype.sqrTo=function(t,e){t.squareTo(e)},I.prototype.convert=function(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=p();return t.copyTo(e),this.reduce(e),e},I.prototype.revert=function(t){return t},I.prototype.reduce=function(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)},I.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n),this.reduce(n)},I.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)};var O=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],N=(1<<26)/O[O.length-1];h.prototype.chunkSize=function(t){return Math.floor(Math.LN2*this.DB/Math.log(t))},h.prototype.toRadix=function(t){if(null==t&&(t=10),0==this.signum()||t<2||t>36)return"0";var e=this.chunkSize(t),n=Math.pow(t,e),r=x(n),i=p(),o=p(),a="";for(this.divRemTo(r,i,o);i.signum()>0;)a=(n+o.intValue()).toString(t).substr(1)+a,i.divRemTo(r,i,o);return o.intValue().toString(t)+a},h.prototype.fromRadix=function(t,e){this.fromInt(0),null==e&&(e=10);for(var n=this.chunkSize(e),r=Math.pow(e,n),i=!1,o=0,a=0,s=0;s<t.length;++s){var u=y(t,s);u<0?"-"==t.charAt(s)&&0==this.signum()&&(i=!0):(a=e*a+u,++o>=n&&(this.dMultiply(r),this.dAddOffset(a,0),o=0,a=0))}o>0&&(this.dMultiply(Math.pow(e,o)),this.dAddOffset(a,0)),i&&h.ZERO.subTo(this,this)},h.prototype.fromNumber=function(t,e,n){if("number"==typeof e)if(t<2)this.fromInt(1);else for(this.fromNumber(t,n),this.testBit(t-1)||this.bitwiseTo(h.ONE.shiftLeft(t-1),S,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(h.ONE.shiftLeft(t-1),this);else{var r=new Array,i=7&t;r.length=1+(t>>3),e.nextBytes(r),i>0?r[0]&=(1<<i)-1:r[0]=0,this.fromString(r,256)}},h.prototype.bitwiseTo=function(t,e,n){var r,i,o=Math.min(t.t,this.t);for(r=0;r<o;++r)n[r]=e(this[r],t[r]);if(t.t<this.t){for(i=t.s&this.DM,r=o;r<this.t;++r)n[r]=e(this[r],i);n.t=this.t}else{for(i=this.s&this.DM,r=o;r<t.t;++r)n[r]=e(i,t[r]);n.t=t.t}n.s=e(this.s,t.s),n.clamp()},h.prototype.changeBit=function(t,e){var n=h.ONE.shiftLeft(t);return this.bitwiseTo(n,e,n),n},h.prototype.addTo=function(t,e){for(var n=0,r=0,i=Math.min(t.t,this.t);n<i;)r+=this[n]+t[n],e[n++]=r&this.DM,r>>=this.DB;if(t.t<this.t){for(r+=t.s;n<this.t;)r+=this[n],e[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;n<t.t;)r+=t[n],e[n++]=r&this.DM,r>>=this.DB;r+=t.s}e.s=r<0?-1:0,r>0?e[n++]=r:r<-1&&(e[n++]=this.DV+r),e.t=n,e.clamp()},h.prototype.dMultiply=function(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()},h.prototype.dAddOffset=function(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}},h.prototype.multiplyLowerTo=function(t,e,n){var r,i=Math.min(this.t+t.t,e);for(n.s=0,n.t=i;i>0;)n[--i]=0;for(r=n.t-this.t;i<r;++i)n[i+this.t]=this.am(0,t[i],n,i,0,this.t);for(r=Math.min(t.t,e);i<r;++i)this.am(0,t[i],n,i,0,e-i);n.clamp()},h.prototype.multiplyUpperTo=function(t,e,n){--e;var r=n.t=this.t+t.t-e;for(n.s=0;--r>=0;)n[r]=0;for(r=Math.max(e-this.t,0);r<t.t;++r)n[this.t+r-e]=this.am(e-r,t[r],n,0,0,this.t+r-e);n.clamp(),n.drShiftTo(1,n)},h.prototype.modInt=function(t){if(t<=0)return 0;var e=this.DV%t,n=this.s<0?t-1:0;if(this.t>0)if(0==e)n=this[0]%t;else for(var r=this.t-1;r>=0;--r)n=(e*n+this[r])%t;return n},h.prototype.millerRabin=function(t){var e=this.subtract(h.ONE),n=e.getLowestSetBit();if(n<=0)return!1;var r=e.shiftRight(n);(t=t+1>>1)>O.length&&(t=O.length);for(var i=p(),o=0;o<t;++o){i.fromInt(O[Math.floor(Math.random()*O.length)]);var a=i.modPow(r,this);if(0!=a.compareTo(h.ONE)&&0!=a.compareTo(e)){for(var s=1;s++<n&&0!=a.compareTo(e);)if(0==(a=a.modPowInt(2,this)).compareTo(h.ONE))return!1;if(0!=a.compareTo(e))return!1}}return!0},h.prototype.clone=function(){var t=p();return this.copyTo(t),t},h.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},h.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},h.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},h.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},h.prototype.toByteArray=function(){var t=this.t,e=new Array;e[0]=this.s;var n,r=this.DB-t*this.DB%8,i=0;if(t-- >0)for(r<this.DB&&(n=this[t]>>r)!=(this.s&this.DM)>>r&&(e[i++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this[t]&(1<<r)-1)<<8-r,n|=this[--t]>>(r+=this.DB-8)):(n=this[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),0!=(128&n)&&(n|=-256),0==i&&(128&this.s)!=(128&n)&&++i,(i>0||n!=this.s)&&(e[i++]=n);return e},h.prototype.equals=function(t){return 0==this.compareTo(t)},h.prototype.min=function(t){return this.compareTo(t)<0?this:t},h.prototype.max=function(t){return this.compareTo(t)>0?this:t},h.prototype.and=function(t){var e=p();return this.bitwiseTo(t,M,e),e},h.prototype.or=function(t){var e=p();return this.bitwiseTo(t,S,e),e},h.prototype.xor=function(t){var e=p();return this.bitwiseTo(t,T,e),e},h.prototype.andNot=function(t){var e=p();return this.bitwiseTo(t,E,e),e},h.prototype.not=function(){for(var t=p(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t},h.prototype.shiftLeft=function(t){var e=p();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e},h.prototype.shiftRight=function(t){var e=p();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e},h.prototype.getLowestSetBit=function(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+A(this[t]);return this.s<0?this.t*this.DB:-1},h.prototype.bitCount=function(){for(var t=0,e=this.s&this.DM,n=0;n<this.t;++n)t+=P(this[n]^e);return t},h.prototype.testBit=function(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<t%this.DB)},h.prototype.setBit=function(t){return this.changeBit(t,S)},h.prototype.clearBit=function(t){return this.changeBit(t,E)},h.prototype.flipBit=function(t){return this.changeBit(t,T)},h.prototype.add=function(t){var e=p();return this.addTo(t,e),e},h.prototype.subtract=function(t){var e=p();return this.subTo(t,e),e},h.prototype.multiply=function(t){var e=p();return this.multiplyTo(t,e),e},h.prototype.divide=function(t){var e=p();return this.divRemTo(t,e,null),e},h.prototype.remainder=function(t){var e=p();return this.divRemTo(t,null,e),e},h.prototype.divideAndRemainder=function(t){var e=p(),n=p();return this.divRemTo(t,e,n),new Array(e,n)},h.prototype.modPow=function(t,e){var n,r,i=t.bitLength(),o=x(1);if(i<=0)return o;n=i<18?1:i<48?3:i<144?4:i<768?5:6,r=i<8?new b(e):e.isEven()?new I(e):new w(e);var a=new Array,s=3,u=n-1,l=(1<<n)-1;if(a[1]=r.convert(this),n>1){var c=p();for(r.sqrTo(a[1],c);s<=l;)a[s]=p(),r.mulTo(c,a[s-2],a[s]),s+=2}var h,f,d=t.t-1,m=!0,g=p();for(i=_(t[d])-1;d>=0;){for(i>=u?h=t[d]>>i-u&l:(h=(t[d]&(1<<i+1)-1)<<u-i,d>0&&(h|=t[d-1]>>this.DB+i-u)),s=n;0==(1&h);)h>>=1,--s;if((i-=s)<0&&(i+=this.DB,--d),m)a[h].copyTo(o),m=!1;else{for(;s>1;)r.sqrTo(o,g),r.sqrTo(g,o),s-=2;s>0?r.sqrTo(o,g):(f=o,o=g,g=f),r.mulTo(g,a[h],o)}for(;d>=0&&0==(t[d]&1<<i);)r.sqrTo(o,g),f=o,o=g,g=f,--i<0&&(i=this.DB-1,--d)}return r.revert(o)},h.prototype.modInverse=function(t){var e=t.isEven();if(this.isEven()&&e||0==t.signum())return h.ZERO;for(var n=t.clone(),r=this.clone(),i=x(1),o=x(0),a=x(0),s=x(1);0!=n.signum();){for(;n.isEven();)n.rShiftTo(1,n),e?(i.isEven()&&o.isEven()||(i.addTo(this,i),o.subTo(t,o)),i.rShiftTo(1,i)):o.isEven()||o.subTo(t,o),o.rShiftTo(1,o);for(;r.isEven();)r.rShiftTo(1,r),e?(a.isEven()&&s.isEven()||(a.addTo(this,a),s.subTo(t,s)),a.rShiftTo(1,a)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);n.compareTo(r)>=0?(n.subTo(r,n),e&&i.subTo(a,i),o.subTo(s,o)):(r.subTo(n,r),e&&a.subTo(i,a),s.subTo(o,s))}return 0!=r.compareTo(h.ONE)?h.ZERO:s.compareTo(t)>=0?s.subtract(t):s.signum()<0?(s.addTo(t,s),s.signum()<0?s.add(t):s):s},h.prototype.pow=function(t){return this.exp(t,new C)},h.prototype.gcd=function(t){var e=this.s<0?this.negate():this.clone(),n=t.s<0?t.negate():t.clone();if(e.compareTo(n)<0){var r=e;e=n,n=r}var i=e.getLowestSetBit(),o=n.getLowestSetBit();if(o<0)return e;for(i<o&&(o=i),o>0&&(e.rShiftTo(o,e),n.rShiftTo(o,n));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=n.getLowestSetBit())>0&&n.rShiftTo(i,n),e.compareTo(n)>=0?(e.subTo(n,e),e.rShiftTo(1,e)):(n.subTo(e,n),n.rShiftTo(1,n));return o>0&&n.lShiftTo(o,n),n},h.prototype.isProbablePrime=function(t){var e,n=this.abs();if(1==n.t&&n[0]<=O[O.length-1]){for(e=0;e<O.length;++e)if(n[0]==O[e])return!0;return!1}if(n.isEven())return!1;for(e=1;e<O.length;){for(var r=O[e],i=e+1;i<O.length&&r<N;)r*=O[i++];for(r=n.modInt(r);e<i;)if(r%O[e++]==0)return!1}return n.millerRabin(t)},h.prototype.square=function(){var t=p();return this.squareTo(t),t};var R=h;R.prototype.IsNegative=function(){return-1==this.compareTo(R.ZERO)},R.op_Equality=function(t,e){return 0==t.compareTo(e)},R.op_Inequality=function(t,e){return 0!=t.compareTo(e)},R.op_GreaterThan=function(t,e){return t.compareTo(e)>0},R.op_LessThan=function(t,e){return t.compareTo(e)<0},R.op_Addition=function(t,e){return new R(t,void 0,void 0).add(new R(e,void 0,void 0))},R.op_Subtraction=function(t,e){return new R(t,void 0,void 0).subtract(new R(e,void 0,void 0))},R.Int128Mul=function(t,e){return new R(t,void 0,void 0).multiply(new R(e,void 0,void 0))},R.op_Division=function(t,e){return t.divide(e)},R.prototype.ToDouble=function(){return parseFloat(this.toString())};var D=function(t,e){var n;if(void 0===Object.getOwnPropertyNames){for(n in e.prototype)void 0!==t.prototype[n]&&t.prototype[n]!==Object.prototype[n]||(t.prototype[n]=e.prototype[n]);for(n in e)void 0===t[n]&&(t[n]=e[n]);t.$baseCtor=e}else{for(var r=Object.getOwnPropertyNames(e.prototype),i=0;i<r.length;i++)void 0===Object.getOwnPropertyDescriptor(t.prototype,r[i])&&Object.defineProperty(t.prototype,r[i],Object.getOwnPropertyDescriptor(e.prototype,r[i]));for(n in e)void 0===t[n]&&(t[n]=e[n]);t.$baseCtor=e}};a.Path=function(){return[]},a.Path.prototype.push=Array.prototype.push,a.Paths=function(){return[]},a.Paths.prototype.push=Array.prototype.push,a.DoublePoint=function(){var t=arguments;this.X=0,this.Y=0,1===t.length?(this.X=t[0].X,this.Y=t[0].Y):2===t.length&&(this.X=t[0],this.Y=t[1])},a.DoublePoint0=function(){this.X=0,this.Y=0},a.DoublePoint0.prototype=a.DoublePoint.prototype,a.DoublePoint1=function(t){this.X=t.X,this.Y=t.Y},a.DoublePoint1.prototype=a.DoublePoint.prototype,a.DoublePoint2=function(t,e){this.X=t,this.Y=e},a.DoublePoint2.prototype=a.DoublePoint.prototype,a.PolyNode=function(){this.m_Parent=null,this.m_polygon=new a.Path,this.m_Index=0,this.m_jointype=0,this.m_endtype=0,this.m_Childs=[],this.IsOpen=!1},a.PolyNode.prototype.IsHoleNode=function(){for(var t=!0,e=this.m_Parent;null!==e;)t=!t,e=e.m_Parent;return t},a.PolyNode.prototype.ChildCount=function(){return this.m_Childs.length},a.PolyNode.prototype.Contour=function(){return this.m_polygon},a.PolyNode.prototype.AddChild=function(t){var e=this.m_Childs.length;this.m_Childs.push(t),t.m_Parent=this,t.m_Index=e},a.PolyNode.prototype.GetNext=function(){return this.m_Childs.length>0?this.m_Childs[0]:this.GetNextSiblingUp()},a.PolyNode.prototype.GetNextSiblingUp=function(){return null===this.m_Parent?null:this.m_Index===this.m_Parent.m_Childs.length-1?this.m_Parent.GetNextSiblingUp():this.m_Parent.m_Childs[this.m_Index+1]},a.PolyNode.prototype.Childs=function(){return this.m_Childs},a.PolyNode.prototype.Parent=function(){return this.m_Parent},a.PolyNode.prototype.IsHole=function(){return this.IsHoleNode()},a.PolyTree=function(){this.m_AllPolys=[],a.PolyNode.call(this)},a.PolyTree.prototype.Clear=function(){for(var t=0,e=this.m_AllPolys.length;t<e;t++)this.m_AllPolys[t]=null;this.m_AllPolys.length=0,this.m_Childs.length=0},a.PolyTree.prototype.GetFirst=function(){return this.m_Childs.length>0?this.m_Childs[0]:null},a.PolyTree.prototype.Total=function(){var t=this.m_AllPolys.length;return t>0&&this.m_Childs[0]!==this.m_AllPolys[0]&&t--,t},D(a.PolyTree,a.PolyNode),a.Math_Abs_Int64=a.Math_Abs_Int32=a.Math_Abs_Double=function(t){return Math.abs(t)},a.Math_Max_Int32_Int32=function(t,e){return Math.max(t,e)},c.msie||c.opera||c.safari?a.Cast_Int32=function(t){return 0|t}:a.Cast_Int32=function(t){return~~t},void 0===Number.toInteger&&(Number.toInteger=null),c.chrome?a.Cast_Int64=function(t){return t<-2147483648||t>2147483647?t<0?Math.ceil(t):Math.floor(t):~~t}:c.firefox&&"function"==typeof Number.toInteger?a.Cast_Int64=function(t){return Number.toInteger(t)}:c.msie7||c.msie8?a.Cast_Int64=function(t){return parseInt(t,10)}:c.msie?a.Cast_Int64=function(t){return t<-2147483648||t>2147483647?t<0?Math.ceil(t):Math.floor(t):0|t}:a.Cast_Int64=function(t){return t<0?Math.ceil(t):Math.floor(t)},a.Clear=function(t){t.length=0},a.PI=3.141592653589793,a.PI2=6.283185307179586,a.IntPoint=function(){var t=arguments,e=t.length;if(this.X=0,this.Y=0,a.use_xyz)if(this.Z=0,3===e)this.X=t[0],this.Y=t[1],this.Z=t[2];else if(2===e)this.X=t[0],this.Y=t[1],this.Z=0;else if(1===e)if(t[0]instanceof a.DoublePoint){var n=t[0];this.X=a.Clipper.Round(n.X),this.Y=a.Clipper.Round(n.Y),this.Z=0}else{void 0===(r=t[0]).Z&&(r.Z=0),this.X=r.X,this.Y=r.Y,this.Z=r.Z}else this.X=0,this.Y=0,this.Z=0;else if(2===e)this.X=t[0],this.Y=t[1];else if(1===e)if(t[0]instanceof a.DoublePoint){n=t[0];this.X=a.Clipper.Round(n.X),this.Y=a.Clipper.Round(n.Y)}else{var r=t[0];this.X=r.X,this.Y=r.Y}else this.X=0,this.Y=0},a.IntPoint.op_Equality=function(t,e){return t.X===e.X&&t.Y===e.Y},a.IntPoint.op_Inequality=function(t,e){return t.X!==e.X||t.Y!==e.Y},a.IntPoint0=function(){this.X=0,this.Y=0,a.use_xyz&&(this.Z=0)},a.IntPoint0.prototype=a.IntPoint.prototype,a.IntPoint1=function(t){this.X=t.X,this.Y=t.Y,a.use_xyz&&(void 0===t.Z?this.Z=0:this.Z=t.Z)},a.IntPoint1.prototype=a.IntPoint.prototype,a.IntPoint1dp=function(t){this.X=a.Clipper.Round(t.X),this.Y=a.Clipper.Round(t.Y),a.use_xyz&&(this.Z=0)},a.IntPoint1dp.prototype=a.IntPoint.prototype,a.IntPoint2=function(t,e,n){this.X=t,this.Y=e,a.use_xyz&&(this.Z=void 0===n?0:n)},a.IntPoint2.prototype=a.IntPoint.prototype,a.IntRect=function(){var t=arguments,e=t.length;if(4===e)this.left=t[0],this.top=t[1],this.right=t[2],this.bottom=t[3];else if(1===e){var n=t[0];this.left=n.left,this.top=n.top,this.right=n.right,this.bottom=n.bottom}else this.left=0,this.top=0,this.right=0,this.bottom=0},a.IntRect0=function(){this.left=0,this.top=0,this.right=0,this.bottom=0},a.IntRect0.prototype=a.IntRect.prototype,a.IntRect1=function(t){this.left=t.left,this.top=t.top,this.right=t.right,this.bottom=t.bottom},a.IntRect1.prototype=a.IntRect.prototype,a.IntRect4=function(t,e,n,r){this.left=t,this.top=e,this.right=n,this.bottom=r},a.IntRect4.prototype=a.IntRect.prototype,a.ClipType={ctIntersection:0,ctUnion:1,ctDifference:2,ctXor:3},a.PolyType={ptSubject:0,ptClip:1},a.PolyFillType={pftEvenOdd:0,pftNonZero:1,pftPositive:2,pftNegative:3},a.JoinType={jtSquare:0,jtRound:1,jtMiter:2},a.EndType={etOpenSquare:0,etOpenRound:1,etOpenButt:2,etClosedLine:3,etClosedPolygon:4},a.EdgeSide={esLeft:0,esRight:1},a.Direction={dRightToLeft:0,dLeftToRight:1},a.TEdge=function(){this.Bot=new a.IntPoint0,this.Curr=new a.IntPoint0,this.Top=new a.IntPoint0,this.Delta=new a.IntPoint0,this.Dx=0,this.PolyTyp=a.PolyType.ptSubject,this.Side=a.EdgeSide.esLeft,this.WindDelta=0,this.WindCnt=0,this.WindCnt2=0,this.OutIdx=0,this.Next=null,this.Prev=null,this.NextInLML=null,this.NextInAEL=null,this.PrevInAEL=null,this.NextInSEL=null,this.PrevInSEL=null},a.IntersectNode=function(){this.Edge1=null,this.Edge2=null,this.Pt=new a.IntPoint0},a.MyIntersectNodeSort=function(){},a.MyIntersectNodeSort.Compare=function(t,e){var n=e.Pt.Y-t.Pt.Y;return n>0?1:n<0?-1:0},a.LocalMinima=function(){this.Y=0,this.LeftBound=null,this.RightBound=null,this.Next=null},a.Scanbeam=function(){this.Y=0,this.Next=null},a.Maxima=function(){this.X=0,this.Next=null,this.Prev=null},a.OutRec=function(){this.Idx=0,this.IsHole=!1,this.IsOpen=!1,this.FirstLeft=null,this.Pts=null,this.BottomPt=null,this.PolyNode=null},a.OutPt=function(){this.Idx=0,this.Pt=new a.IntPoint0,this.Next=null,this.Prev=null},a.Join=function(){this.OutPt1=null,this.OutPt2=null,this.OffPt=new a.IntPoint0},a.ClipperBase=function(){this.m_MinimaList=null,this.m_CurrentLM=null,this.m_edges=new Array,this.m_UseFullRange=!1,this.m_HasOpenPaths=!1,this.PreserveCollinear=!1,this.m_Scanbeam=null,this.m_PolyOuts=null,this.m_ActiveEdges=null},a.ClipperBase.horizontal=-9007199254740992,a.ClipperBase.Skip=-2,a.ClipperBase.Unassigned=-1,a.ClipperBase.tolerance=1e-20,a.ClipperBase.loRange=47453132,a.ClipperBase.hiRange=0xfffffffffffff,a.ClipperBase.near_zero=function(t){return t>-a.ClipperBase.tolerance&&t<a.ClipperBase.tolerance},a.ClipperBase.IsHorizontal=function(t){return 0===t.Delta.Y},a.ClipperBase.prototype.PointIsVertex=function(t,e){var n=e;do{if(a.IntPoint.op_Equality(n.Pt,t))return!0;n=n.Next}while(n!==e);return!1},a.ClipperBase.prototype.PointOnLineSegment=function(t,e,n,r){return r?t.X===e.X&&t.Y===e.Y||t.X===n.X&&t.Y===n.Y||t.X>e.X==t.X<n.X&&t.Y>e.Y==t.Y<n.Y&&R.op_Equality(R.Int128Mul(t.X-e.X,n.Y-e.Y),R.Int128Mul(n.X-e.X,t.Y-e.Y)):t.X===e.X&&t.Y===e.Y||t.X===n.X&&t.Y===n.Y||t.X>e.X==t.X<n.X&&t.Y>e.Y==t.Y<n.Y&&(t.X-e.X)*(n.Y-e.Y)==(n.X-e.X)*(t.Y-e.Y)},a.ClipperBase.prototype.PointOnPolygon=function(t,e,n){for(var r=e;;){if(this.PointOnLineSegment(t,r.Pt,r.Next.Pt,n))return!0;if((r=r.Next)===e)break}return!1},a.ClipperBase.prototype.SlopesEqual=a.ClipperBase.SlopesEqual=function(){var t,e,n,r,i,o,s=arguments,u=s.length;return 3===u?(t=s[0],e=s[1],s[2]?R.op_Equality(R.Int128Mul(t.Delta.Y,e.Delta.X),R.Int128Mul(t.Delta.X,e.Delta.Y)):a.Cast_Int64(t.Delta.Y*e.Delta.X)===a.Cast_Int64(t.Delta.X*e.Delta.Y)):4===u?(n=s[0],r=s[1],i=s[2],s[3]?R.op_Equality(R.Int128Mul(n.Y-r.Y,r.X-i.X),R.Int128Mul(n.X-r.X,r.Y-i.Y)):a.Cast_Int64((n.Y-r.Y)*(r.X-i.X))-a.Cast_Int64((n.X-r.X)*(r.Y-i.Y))==0):(n=s[0],r=s[1],i=s[2],o=s[3],s[4]?R.op_Equality(R.Int128Mul(n.Y-r.Y,i.X-o.X),R.Int128Mul(n.X-r.X,i.Y-o.Y)):a.Cast_Int64((n.Y-r.Y)*(i.X-o.X))-a.Cast_Int64((n.X-r.X)*(i.Y-o.Y))==0)},a.ClipperBase.SlopesEqual3=function(t,e,n){return n?R.op_Equality(R.Int128Mul(t.Delta.Y,e.Delta.X),R.Int128Mul(t.Delta.X,e.Delta.Y)):a.Cast_Int64(t.Delta.Y*e.Delta.X)===a.Cast_Int64(t.Delta.X*e.Delta.Y)},a.ClipperBase.SlopesEqual4=function(t,e,n,r){return r?R.op_Equality(R.Int128Mul(t.Y-e.Y,e.X-n.X),R.Int128Mul(t.X-e.X,e.Y-n.Y)):a.Cast_Int64((t.Y-e.Y)*(e.X-n.X))-a.Cast_Int64((t.X-e.X)*(e.Y-n.Y))==0},a.ClipperBase.SlopesEqual5=function(t,e,n,r,i){return i?R.op_Equality(R.Int128Mul(t.Y-e.Y,n.X-r.X),R.Int128Mul(t.X-e.X,n.Y-r.Y)):a.Cast_Int64((t.Y-e.Y)*(n.X-r.X))-a.Cast_Int64((t.X-e.X)*(n.Y-r.Y))==0},a.ClipperBase.prototype.Clear=function(){this.DisposeLocalMinimaList();for(var t=0,e=this.m_edges.length;t<e;++t){for(var n=0,r=this.m_edges[t].length;n<r;++n)this.m_edges[t][n]=null;a.Clear(this.m_edges[t])}a.Clear(this.m_edges),this.m_UseFullRange=!1,this.m_HasOpenPaths=!1},a.ClipperBase.prototype.DisposeLocalMinimaList=function(){for(;null!==this.m_MinimaList;){var t=this.m_MinimaList.Next;this.m_MinimaList=null,this.m_MinimaList=t}this.m_CurrentLM=null},a.ClipperBase.prototype.RangeTest=function(t,e){e.Value?(t.X>a.ClipperBase.hiRange||t.Y>a.ClipperBase.hiRange||-t.X>a.ClipperBase.hiRange||-t.Y>a.ClipperBase.hiRange)&&a.Error("Coordinate outside allowed range in RangeTest()."):(t.X>a.ClipperBase.loRange||t.Y>a.ClipperBase.loRange||-t.X>a.ClipperBase.loRange||-t.Y>a.ClipperBase.loRange)&&(e.Value=!0,this.RangeTest(t,e))},a.ClipperBase.prototype.InitEdge=function(t,e,n,r){t.Next=e,t.Prev=n,t.Curr.X=r.X,t.Curr.Y=r.Y,a.use_xyz&&(t.Curr.Z=r.Z),t.OutIdx=-1},a.ClipperBase.prototype.InitEdge2=function(t,e){t.Curr.Y>=t.Next.Curr.Y?(t.Bot.X=t.Curr.X,t.Bot.Y=t.Curr.Y,a.use_xyz&&(t.Bot.Z=t.Curr.Z),t.Top.X=t.Next.Curr.X,t.Top.Y=t.Next.Curr.Y,a.use_xyz&&(t.Top.Z=t.Next.Curr.Z)):(t.Top.X=t.Curr.X,t.Top.Y=t.Curr.Y,a.use_xyz&&(t.Top.Z=t.Curr.Z),t.Bot.X=t.Next.Curr.X,t.Bot.Y=t.Next.Curr.Y,a.use_xyz&&(t.Bot.Z=t.Next.Curr.Z)),this.SetDx(t),t.PolyTyp=e},a.ClipperBase.prototype.FindNextLocMin=function(t){for(var e;;){for(;a.IntPoint.op_Inequality(t.Bot,t.Prev.Bot)||a.IntPoint.op_Equality(t.Curr,t.Top);)t=t.Next;if(t.Dx!==a.ClipperBase.horizontal&&t.Prev.Dx!==a.ClipperBase.horizontal)break;for(;t.Prev.Dx===a.ClipperBase.horizontal;)t=t.Prev;for(e=t;t.Dx===a.ClipperBase.horizontal;)t=t.Next;if(t.Top.Y!==t.Prev.Bot.Y){e.Prev.Bot.X<t.Bot.X&&(t=e);break}}return t},a.ClipperBase.prototype.ProcessBound=function(t,e){var n,r,i=t;if(i.OutIdx===a.ClipperBase.Skip){if(t=i,e){for(;t.Top.Y===t.Next.Bot.Y;)t=t.Next;for(;t!==i&&t.Dx===a.ClipperBase.horizontal;)t=t.Prev}else{for(;t.Top.Y===t.Prev.Bot.Y;)t=t.Prev;for(;t!==i&&t.Dx===a.ClipperBase.horizontal;)t=t.Next}if(t===i)i=e?t.Next:t.Prev;else{t=e?i.Next:i.Prev;var o=new a.LocalMinima;o.Next=null,o.Y=t.Bot.Y,o.LeftBound=null,o.RightBound=t,t.WindDelta=0,i=this.ProcessBound(t,e),this.InsertLocalMinima(o)}return i}if(t.Dx===a.ClipperBase.horizontal&&((n=e?t.Prev:t.Next).Dx===a.ClipperBase.horizontal?n.Bot.X!==t.Bot.X&&n.Top.X!==t.Bot.X&&this.ReverseHorizontal(t):n.Bot.X!==t.Bot.X&&this.ReverseHorizontal(t)),n=t,e){for(;i.Top.Y===i.Next.Bot.Y&&i.Next.OutIdx!==a.ClipperBase.Skip;)i=i.Next;if(i.Dx===a.ClipperBase.horizontal&&i.Next.OutIdx!==a.ClipperBase.Skip){for(r=i;r.Prev.Dx===a.ClipperBase.horizontal;)r=r.Prev;r.Prev.Top.X>i.Next.Top.X&&(i=r.Prev)}for(;t!==i;)t.NextInLML=t.Next,t.Dx===a.ClipperBase.horizontal&&t!==n&&t.Bot.X!==t.Prev.Top.X&&this.ReverseHorizontal(t),t=t.Next;t.Dx===a.ClipperBase.horizontal&&t!==n&&t.Bot.X!==t.Prev.Top.X&&this.ReverseHorizontal(t),i=i.Next}else{for(;i.Top.Y===i.Prev.Bot.Y&&i.Prev.OutIdx!==a.ClipperBase.Skip;)i=i.Prev;if(i.Dx===a.ClipperBase.horizontal&&i.Prev.OutIdx!==a.ClipperBase.Skip){for(r=i;r.Next.Dx===a.ClipperBase.horizontal;)r=r.Next;(r.Next.Top.X===i.Prev.Top.X||r.Next.Top.X>i.Prev.Top.X)&&(i=r.Next)}for(;t!==i;)t.NextInLML=t.Prev,t.Dx===a.ClipperBase.horizontal&&t!==n&&t.Bot.X!==t.Next.Top.X&&this.ReverseHorizontal(t),t=t.Prev;t.Dx===a.ClipperBase.horizontal&&t!==n&&t.Bot.X!==t.Next.Top.X&&this.ReverseHorizontal(t),i=i.Prev}return i},a.ClipperBase.prototype.AddPath=function(t,e,n){a.use_lines?n||e!==a.PolyType.ptClip||a.Error("AddPath: Open paths must be subject."):n||a.Error("AddPath: Open paths have been disabled.");var r=t.length-1;if(n)for(;r>0&&a.IntPoint.op_Equality(t[r],t[0]);)--r;for(;r>0&&a.IntPoint.op_Equality(t[r],t[r-1]);)--r;if(n&&r<2||!n&&r<1)return!1;for(var i=new Array,o=0;o<=r;o++)i.push(new a.TEdge);var s=!0;i[1].Curr.X=t[1].X,i[1].Curr.Y=t[1].Y,a.use_xyz&&(i[1].Curr.Z=t[1].Z);var u={Value:this.m_UseFullRange};this.RangeTest(t[0],u),this.m_UseFullRange=u.Value,u.Value=this.m_UseFullRange,this.RangeTest(t[r],u),this.m_UseFullRange=u.Value,this.InitEdge(i[0],i[1],i[r],t[0]),this.InitEdge(i[r],i[0],i[r-1],t[r]);for(o=r-1;o>=1;--o)u.Value=this.m_UseFullRange,this.RangeTest(t[o],u),this.m_UseFullRange=u.Value,this.InitEdge(i[o],i[o+1],i[o-1],t[o]);for(var l,c=i[0],h=c,p=c;;)if(h.Curr!==h.Next.Curr||!n&&h.Next===c){if(h.Prev===h.Next)break;if(!n||!a.ClipperBase.SlopesEqual4(h.Prev.Curr,h.Curr,h.Next.Curr,this.m_UseFullRange)||this.PreserveCollinear&&this.Pt2IsBetweenPt1AndPt3(h.Prev.Curr,h.Curr,h.Next.Curr)){if((h=h.Next)===p||!n&&h.Next===c)break}else h===c&&(c=h.Next),p=h=(h=this.RemoveEdge(h)).Prev}else{if(h===h.Next)break;h===c&&(c=h.Next),p=h=this.RemoveEdge(h)}if(!n&&h===h.Next||n&&h.Prev===h.Next)return!1;n||(this.m_HasOpenPaths=!0,c.Prev.OutIdx=a.ClipperBase.Skip),h=c;do{this.InitEdge2(h,e),h=h.Next,s&&h.Curr.Y!==c.Curr.Y&&(s=!1)}while(h!==c);if(s){if(n)return!1;for(h.Prev.OutIdx=a.ClipperBase.Skip,(d=new a.LocalMinima).Next=null,d.Y=h.Bot.Y,d.LeftBound=null,d.RightBound=h,d.RightBound.Side=a.EdgeSide.esRight,d.RightBound.WindDelta=0;h.Bot.X!==h.Prev.Top.X&&this.ReverseHorizontal(h),h.Next.OutIdx!==a.ClipperBase.Skip;)h.NextInLML=h.Next,h=h.Next;return this.InsertLocalMinima(d),this.m_edges.push(i),!0}this.m_edges.push(i);var f=null;for(a.IntPoint.op_Equality(h.Prev.Bot,h.Prev.Top)&&(h=h.Next);(h=this.FindNextLocMin(h))!==f;){var d;null===f&&(f=h),(d=new a.LocalMinima).Next=null,d.Y=h.Bot.Y,h.Dx<h.Prev.Dx?(d.LeftBound=h.Prev,d.RightBound=h,l=!1):(d.LeftBound=h,d.RightBound=h.Prev,l=!0),d.LeftBound.Side=a.EdgeSide.esLeft,d.RightBound.Side=a.EdgeSide.esRight,n?d.LeftBound.Next===d.RightBound?d.LeftBound.WindDelta=-1:d.LeftBound.WindDelta=1:d.LeftBound.WindDelta=0,d.RightBound.WindDelta=-d.LeftBound.WindDelta,(h=this.ProcessBound(d.LeftBound,l)).OutIdx===a.ClipperBase.Skip&&(h=this.ProcessBound(h,l));var m=this.ProcessBound(d.RightBound,!l);m.OutIdx===a.ClipperBase.Skip&&(m=this.ProcessBound(m,!l)),d.LeftBound.OutIdx===a.ClipperBase.Skip?d.LeftBound=null:d.RightBound.OutIdx===a.ClipperBase.Skip&&(d.RightBound=null),this.InsertLocalMinima(d),l||(h=m)}return!0},a.ClipperBase.prototype.AddPaths=function(t,e,n){for(var r=!1,i=0,o=t.length;i<o;++i)this.AddPath(t[i],e,n)&&(r=!0);return r},a.ClipperBase.prototype.Pt2IsBetweenPt1AndPt3=function(t,e,n){return!(a.IntPoint.op_Equality(t,n)||a.IntPoint.op_Equality(t,e)||a.IntPoint.op_Equality(n,e))&&(t.X!==n.X?e.X>t.X==e.X<n.X:e.Y>t.Y==e.Y<n.Y)},a.ClipperBase.prototype.RemoveEdge=function(t){t.Prev.Next=t.Next,t.Next.Prev=t.Prev;var e=t.Next;return t.Prev=null,e},a.ClipperBase.prototype.SetDx=function(t){t.Delta.X=t.Top.X-t.Bot.X,t.Delta.Y=t.Top.Y-t.Bot.Y,0===t.Delta.Y?t.Dx=a.ClipperBase.horizontal:t.Dx=t.Delta.X/t.Delta.Y},a.ClipperBase.prototype.InsertLocalMinima=function(t){if(null===this.m_MinimaList)this.m_MinimaList=t;else if(t.Y>=this.m_MinimaList.Y)t.Next=this.m_MinimaList,this.m_MinimaList=t;else{for(var e=this.m_MinimaList;null!==e.Next&&t.Y<e.Next.Y;)e=e.Next;t.Next=e.Next,e.Next=t}},a.ClipperBase.prototype.PopLocalMinima=function(t,e){return e.v=this.m_CurrentLM,null!==this.m_CurrentLM&&this.m_CurrentLM.Y===t&&(this.m_CurrentLM=this.m_CurrentLM.Next,!0)},a.ClipperBase.prototype.ReverseHorizontal=function(t){var e=t.Top.X;t.Top.X=t.Bot.X,t.Bot.X=e,a.use_xyz&&(e=t.Top.Z,t.Top.Z=t.Bot.Z,t.Bot.Z=e)},a.ClipperBase.prototype.Reset=function(){if(this.m_CurrentLM=this.m_MinimaList,null!==this.m_CurrentLM){this.m_Scanbeam=null;for(var t=this.m_MinimaList;null!==t;){this.InsertScanbeam(t.Y);var e=t.LeftBound;null!==e&&(e.Curr.X=e.Bot.X,e.Curr.Y=e.Bot.Y,a.use_xyz&&(e.Curr.Z=e.Bot.Z),e.OutIdx=a.ClipperBase.Unassigned),null!==(e=t.RightBound)&&(e.Curr.X=e.Bot.X,e.Curr.Y=e.Bot.Y,a.use_xyz&&(e.Curr.Z=e.Bot.Z),e.OutIdx=a.ClipperBase.Unassigned),t=t.Next}this.m_ActiveEdges=null}},a.ClipperBase.prototype.InsertScanbeam=function(t){if(null===this.m_Scanbeam)this.m_Scanbeam=new a.Scanbeam,this.m_Scanbeam.Next=null,this.m_Scanbeam.Y=t;else if(t>this.m_Scanbeam.Y){var e=new a.Scanbeam;e.Y=t,e.Next=this.m_Scanbeam,this.m_Scanbeam=e}else{for(var n=this.m_Scanbeam;null!==n.Next&&t<=n.Next.Y;)n=n.Next;if(t===n.Y)return;var r=new a.Scanbeam;r.Y=t,r.Next=n.Next,n.Next=r}},a.ClipperBase.prototype.PopScanbeam=function(t){return null===this.m_Scanbeam?(t.v=0,!1):(t.v=this.m_Scanbeam.Y,this.m_Scanbeam=this.m_Scanbeam.Next,!0)},a.ClipperBase.prototype.LocalMinimaPending=function(){return null!==this.m_CurrentLM},a.ClipperBase.prototype.CreateOutRec=function(){var t=new a.OutRec;return t.Idx=a.ClipperBase.Unassigned,t.IsHole=!1,t.IsOpen=!1,t.FirstLeft=null,t.Pts=null,t.BottomPt=null,t.PolyNode=null,this.m_PolyOuts.push(t),t.Idx=this.m_PolyOuts.length-1,t},a.ClipperBase.prototype.DisposeOutRec=function(t){var e=this.m_PolyOuts[t];e.Pts=null,e=null,this.m_PolyOuts[t]=null},a.ClipperBase.prototype.UpdateEdgeIntoAEL=function(t){null===t.NextInLML&&a.Error("UpdateEdgeIntoAEL: invalid call");var e=t.PrevInAEL,n=t.NextInAEL;return t.NextInLML.OutIdx=t.OutIdx,null!==e?e.NextInAEL=t.NextInLML:this.m_ActiveEdges=t.NextInLML,null!==n&&(n.PrevInAEL=t.NextInLML),t.NextInLML.Side=t.Side,t.NextInLML.WindDelta=t.WindDelta,t.NextInLML.WindCnt=t.WindCnt,t.NextInLML.WindCnt2=t.WindCnt2,(t=t.NextInLML).Curr.X=t.Bot.X,t.Curr.Y=t.Bot.Y,t.PrevInAEL=e,t.NextInAEL=n,a.ClipperBase.IsHorizontal(t)||this.InsertScanbeam(t.Top.Y),t},a.ClipperBase.prototype.SwapPositionsInAEL=function(t,e){if(t.NextInAEL!==t.PrevInAEL&&e.NextInAEL!==e.PrevInAEL){if(t.NextInAEL===e){var n=e.NextInAEL;null!==n&&(n.PrevInAEL=t);var r=t.PrevInAEL;null!==r&&(r.NextInAEL=e),e.PrevInAEL=r,e.NextInAEL=t,t.PrevInAEL=e,t.NextInAEL=n}else if(e.NextInAEL===t){var i=t.NextInAEL;null!==i&&(i.PrevInAEL=e);var o=e.PrevInAEL;null!==o&&(o.NextInAEL=t),t.PrevInAEL=o,t.NextInAEL=e,e.PrevInAEL=t,e.NextInAEL=i}else{var a=t.NextInAEL,s=t.PrevInAEL;t.NextInAEL=e.NextInAEL,null!==t.NextInAEL&&(t.NextInAEL.PrevInAEL=t),t.PrevInAEL=e.PrevInAEL,null!==t.PrevInAEL&&(t.PrevInAEL.NextInAEL=t),e.NextInAEL=a,null!==e.NextInAEL&&(e.NextInAEL.PrevInAEL=e),e.PrevInAEL=s,null!==e.PrevInAEL&&(e.PrevInAEL.NextInAEL=e)}null===t.PrevInAEL?this.m_ActiveEdges=t:null===e.PrevInAEL&&(this.m_ActiveEdges=e)}},a.ClipperBase.prototype.DeleteFromAEL=function(t){var e=t.PrevInAEL,n=t.NextInAEL;null===e&&null===n&&t!==this.m_ActiveEdges||(null!==e?e.NextInAEL=n:this.m_ActiveEdges=n,null!==n&&(n.PrevInAEL=e),t.NextInAEL=null,t.PrevInAEL=null)},a.Clipper=function(t){void 0===t&&(t=0),this.m_PolyOuts=null,this.m_ClipType=a.ClipType.ctIntersection,this.m_Scanbeam=null,this.m_Maxima=null,this.m_ActiveEdges=null,this.m_SortedEdges=null,this.m_IntersectList=null,this.m_IntersectNodeComparer=null,this.m_ExecuteLocked=!1,this.m_ClipFillType=a.PolyFillType.pftEvenOdd,this.m_SubjFillType=a.PolyFillType.pftEvenOdd,this.m_Joins=null,this.m_GhostJoins=null,this.m_UsingPolyTree=!1,this.ReverseSolution=!1,this.StrictlySimple=!1,a.ClipperBase.call(this),this.m_Scanbeam=null,this.m_Maxima=null,this.m_ActiveEdges=null,this.m_SortedEdges=null,this.m_IntersectList=new Array,this.m_IntersectNodeComparer=a.MyIntersectNodeSort.Compare,this.m_ExecuteLocked=!1,this.m_UsingPolyTree=!1,this.m_PolyOuts=new Array,this.m_Joins=new Array,this.m_GhostJoins=new Array,this.ReverseSolution=0!=(1&t),this.StrictlySimple=0!=(2&t),this.PreserveCollinear=0!=(4&t),a.use_xyz&&(this.ZFillFunction=null)},a.Clipper.ioReverseSolution=1,a.Clipper.ioStrictlySimple=2,a.Clipper.ioPreserveCollinear=4,a.Clipper.prototype.Clear=function(){0!==this.m_edges.length&&(this.DisposeAllPolyPts(),a.ClipperBase.prototype.Clear.call(this))},a.Clipper.prototype.InsertMaxima=function(t){var e=new a.Maxima;if(e.X=t,null===this.m_Maxima)this.m_Maxima=e,this.m_Maxima.Next=null,this.m_Maxima.Prev=null;else if(t<this.m_Maxima.X)e.Next=this.m_Maxima,e.Prev=null,this.m_Maxima=e;else{for(var n=this.m_Maxima;null!==n.Next&&t>=n.Next.X;)n=n.Next;if(t===n.X)return;e.Next=n.Next,e.Prev=n,null!==n.Next&&(n.Next.Prev=e),n.Next=e}},a.Clipper.prototype.Execute=function(){var t=arguments,e=t.length,n=t[1]instanceof a.PolyTree;if(4===e&&!n){var r=t[0],i=t[1],o=t[2],s=t[3];if(this.m_ExecuteLocked)return!1;this.m_HasOpenPaths&&a.Error("Error: PolyTree struct is needed for open path clipping."),this.m_ExecuteLocked=!0,a.Clear(i),this.m_SubjFillType=o,this.m_ClipFillType=s,this.m_ClipType=r,this.m_UsingPolyTree=!1;try{(l=this.ExecuteInternal())&&this.BuildResult(i)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return l}if(4===e&&n){r=t[0];var u=t[1];o=t[2],s=t[3];if(this.m_ExecuteLocked)return!1;this.m_ExecuteLocked=!0,this.m_SubjFillType=o,this.m_ClipFillType=s,this.m_ClipType=r,this.m_UsingPolyTree=!0;try{var l;(l=this.ExecuteInternal())&&this.BuildResult2(u)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return l}if(2===e&&!n){r=t[0],i=t[1];return this.Execute(r,i,a.PolyFillType.pftEvenOdd,a.PolyFillType.pftEvenOdd)}if(2===e&&n){r=t[0],u=t[1];return this.Execute(r,u,a.PolyFillType.pftEvenOdd,a.PolyFillType.pftEvenOdd)}},a.Clipper.prototype.FixHoleLinkage=function(t){if(null!==t.FirstLeft&&(t.IsHole===t.FirstLeft.IsHole||null===t.FirstLeft.Pts)){for(var e=t.FirstLeft;null!==e&&(e.IsHole===t.IsHole||null===e.Pts);)e=e.FirstLeft;t.FirstLeft=e}},a.Clipper.prototype.ExecuteInternal=function(){try{this.Reset(),this.m_SortedEdges=null,this.m_Maxima=null;var t,e,n,r={},i={};if(!this.PopScanbeam(r))return!1;for(this.InsertLocalMinimaIntoAEL(r.v);this.PopScanbeam(i)||this.LocalMinimaPending();){if(this.ProcessHorizontals(),this.m_GhostJoins.length=0,!this.ProcessIntersections(i.v))return!1;this.ProcessEdgesAtTopOfScanbeam(i.v),r.v=i.v,this.InsertLocalMinimaIntoAEL(r.v)}for(e=0,n=this.m_PolyOuts.length;e<n;e++)null===(t=this.m_PolyOuts[e]).Pts||t.IsOpen||(t.IsHole^this.ReverseSolution)==this.Area$1(t)>0&&this.ReversePolyPtLinks(t.Pts);for(this.JoinCommonEdges(),e=0,n=this.m_PolyOuts.length;e<n;e++)null!==(t=this.m_PolyOuts[e]).Pts&&(t.IsOpen?this.FixupOutPolyline(t):this.FixupOutPolygon(t));return this.StrictlySimple&&this.DoSimplePolygons(),!0}finally{this.m_Joins.length=0,this.m_GhostJoins.length=0}},a.Clipper.prototype.DisposeAllPolyPts=function(){for(var t=0,e=this.m_PolyOuts.length;t<e;++t)this.DisposeOutRec(t);a.Clear(this.m_PolyOuts)},a.Clipper.prototype.AddJoin=function(t,e,n){var r=new a.Join;r.OutPt1=t,r.OutPt2=e,r.OffPt.X=n.X,r.OffPt.Y=n.Y,a.use_xyz&&(r.OffPt.Z=n.Z),this.m_Joins.push(r)},a.Clipper.prototype.AddGhostJoin=function(t,e){var n=new a.Join;n.OutPt1=t,n.OffPt.X=e.X,n.OffPt.Y=e.Y,a.use_xyz&&(n.OffPt.Z=e.Z),this.m_GhostJoins.push(n)},a.Clipper.prototype.SetZ=function(t,e,n){if(null!==this.ZFillFunction){if(0!==t.Z||null===this.ZFillFunction)return;a.IntPoint.op_Equality(t,e.Bot)?t.Z=e.Bot.Z:a.IntPoint.op_Equality(t,e.Top)?t.Z=e.Top.Z:a.IntPoint.op_Equality(t,n.Bot)?t.Z=n.Bot.Z:a.IntPoint.op_Equality(t,n.Top)?t.Z=n.Top.Z:this.ZFillFunction(e.Bot,e.Top,n.Bot,n.Top,t)}},a.Clipper.prototype.InsertLocalMinimaIntoAEL=function(t){for(var e,n,r={};this.PopLocalMinima(t,r);){e=r.v.LeftBound,n=r.v.RightBound;var i=null;if(null===e?(this.InsertEdgeIntoAEL(n,null),this.SetWindingCount(n),this.IsContributing(n)&&(i=this.AddOutPt(n,n.Bot))):null===n?(this.InsertEdgeIntoAEL(e,null),this.SetWindingCount(e),this.IsContributing(e)&&(i=this.AddOutPt(e,e.Bot)),this.InsertScanbeam(e.Top.Y)):(this.InsertEdgeIntoAEL(e,null),this.InsertEdgeIntoAEL(n,e),this.SetWindingCount(e),n.WindCnt=e.WindCnt,n.WindCnt2=e.WindCnt2,this.IsContributing(e)&&(i=this.AddLocalMinPoly(e,n,e.Bot)),this.InsertScanbeam(e.Top.Y)),null!==n&&(a.ClipperBase.IsHorizontal(n)?(null!==n.NextInLML&&this.InsertScanbeam(n.NextInLML.Top.Y),this.AddEdgeToSEL(n)):this.InsertScanbeam(n.Top.Y)),null!==e&&null!==n){if(null!==i&&a.ClipperBase.IsHorizontal(n)&&this.m_GhostJoins.length>0&&0!==n.WindDelta)for(var o=0,s=this.m_GhostJoins.length;o<s;o++){var u=this.m_GhostJoins[o];this.HorzSegmentsOverlap(u.OutPt1.Pt.X,u.OffPt.X,n.Bot.X,n.Top.X)&&this.AddJoin(u.OutPt1,i,u.OffPt)}if(e.OutIdx>=0&&null!==e.PrevInAEL&&e.PrevInAEL.Curr.X===e.Bot.X&&e.PrevInAEL.OutIdx>=0&&a.ClipperBase.SlopesEqual5(e.PrevInAEL.Curr,e.PrevInAEL.Top,e.Curr,e.Top,this.m_UseFullRange)&&0!==e.WindDelta&&0!==e.PrevInAEL.WindDelta){var l=this.AddOutPt(e.PrevInAEL,e.Bot);this.AddJoin(i,l,e.Top)}if(e.NextInAEL!==n){if(n.OutIdx>=0&&n.PrevInAEL.OutIdx>=0&&a.ClipperBase.SlopesEqual5(n.PrevInAEL.Curr,n.PrevInAEL.Top,n.Curr,n.Top,this.m_UseFullRange)&&0!==n.WindDelta&&0!==n.PrevInAEL.WindDelta){l=this.AddOutPt(n.PrevInAEL,n.Bot);this.AddJoin(i,l,n.Top)}var c=e.NextInAEL;if(null!==c)for(;c!==n;)this.IntersectEdges(n,c,e.Curr),c=c.NextInAEL}}}},a.Clipper.prototype.InsertEdgeIntoAEL=function(t,e){if(null===this.m_ActiveEdges)t.PrevInAEL=null,t.NextInAEL=null,this.m_ActiveEdges=t;else if(null===e&&this.E2InsertsBeforeE1(this.m_ActiveEdges,t))t.PrevInAEL=null,t.NextInAEL=this.m_ActiveEdges,this.m_ActiveEdges.PrevInAEL=t,this.m_ActiveEdges=t;else{for(null===e&&(e=this.m_ActiveEdges);null!==e.NextInAEL&&!this.E2InsertsBeforeE1(e.NextInAEL,t);)e=e.NextInAEL;t.NextInAEL=e.NextInAEL,null!==e.NextInAEL&&(e.NextInAEL.PrevInAEL=t),t.PrevInAEL=e,e.NextInAEL=t}},a.Clipper.prototype.E2InsertsBeforeE1=function(t,e){return e.Curr.X===t.Curr.X?e.Top.Y>t.Top.Y?e.Top.X<a.Clipper.TopX(t,e.Top.Y):t.Top.X>a.Clipper.TopX(e,t.Top.Y):e.Curr.X<t.Curr.X},a.Clipper.prototype.IsEvenOddFillType=function(t){return t.PolyTyp===a.PolyType.ptSubject?this.m_SubjFillType===a.PolyFillType.pftEvenOdd:this.m_ClipFillType===a.PolyFillType.pftEvenOdd},a.Clipper.prototype.IsEvenOddAltFillType=function(t){return t.PolyTyp===a.PolyType.ptSubject?this.m_ClipFillType===a.PolyFillType.pftEvenOdd:this.m_SubjFillType===a.PolyFillType.pftEvenOdd},a.Clipper.prototype.IsContributing=function(t){var e,n;switch(t.PolyTyp===a.PolyType.ptSubject?(e=this.m_SubjFillType,n=this.m_ClipFillType):(e=this.m_ClipFillType,n=this.m_SubjFillType),e){case a.PolyFillType.pftEvenOdd:if(0===t.WindDelta&&1!==t.WindCnt)return!1;break;case a.PolyFillType.pftNonZero:if(1!==Math.abs(t.WindCnt))return!1;break;case a.PolyFillType.pftPositive:if(1!==t.WindCnt)return!1;break;default:if(-1!==t.WindCnt)return!1}switch(this.m_ClipType){case a.ClipType.ctIntersection:switch(n){case a.PolyFillType.pftEvenOdd:case a.PolyFillType.pftNonZero:return 0!==t.WindCnt2;case a.PolyFillType.pftPositive:return t.WindCnt2>0;default:return t.WindCnt2<0}case a.ClipType.ctUnion:switch(n){case a.PolyFillType.pftEvenOdd:case a.PolyFillType.pftNonZero:return 0===t.WindCnt2;case a.PolyFillType.pftPositive:return t.WindCnt2<=0;default:return t.WindCnt2>=0}case a.ClipType.ctDifference:if(t.PolyTyp===a.PolyType.ptSubject)switch(n){case a.PolyFillType.pftEvenOdd:case a.PolyFillType.pftNonZero:return 0===t.WindCnt2;case a.PolyFillType.pftPositive:return t.WindCnt2<=0;default:return t.WindCnt2>=0}else switch(n){case a.PolyFillType.pftEvenOdd:case a.PolyFillType.pftNonZero:return 0!==t.WindCnt2;case a.PolyFillType.pftPositive:return t.WindCnt2>0;default:return t.WindCnt2<0}case a.ClipType.ctXor:if(0!==t.WindDelta)return!0;switch(n){case a.PolyFillType.pftEvenOdd:case a.PolyFillType.pftNonZero:return 0===t.WindCnt2;case a.PolyFillType.pftPositive:return t.WindCnt2<=0;default:return t.WindCnt2>=0}}return!0},a.Clipper.prototype.SetWindingCount=function(t){for(var e=t.PrevInAEL;null!==e&&(e.PolyTyp!==t.PolyTyp||0===e.WindDelta);)e=e.PrevInAEL;if(null===e){var n=t.PolyTyp===a.PolyType.ptSubject?this.m_SubjFillType:this.m_ClipFillType;0===t.WindDelta?t.WindCnt=n===a.PolyFillType.pftNegative?-1:1:t.WindCnt=t.WindDelta,t.WindCnt2=0,e=this.m_ActiveEdges}else if(0===t.WindDelta&&this.m_ClipType!==a.ClipType.ctUnion)t.WindCnt=1,t.WindCnt2=e.WindCnt2,e=e.NextInAEL;else if(this.IsEvenOddFillType(t)){if(0===t.WindDelta){for(var r=!0,i=e.PrevInAEL;null!==i;)i.PolyTyp===e.PolyTyp&&0!==i.WindDelta&&(r=!r),i=i.PrevInAEL;t.WindCnt=r?0:1}else t.WindCnt=t.WindDelta;t.WindCnt2=e.WindCnt2,e=e.NextInAEL}else e.WindCnt*e.WindDelta<0?Math.abs(e.WindCnt)>1?e.WindDelta*t.WindDelta<0?t.WindCnt=e.WindCnt:t.WindCnt=e.WindCnt+t.WindDelta:t.WindCnt=0===t.WindDelta?1:t.WindDelta:0===t.WindDelta?t.WindCnt=e.WindCnt<0?e.WindCnt-1:e.WindCnt+1:e.WindDelta*t.WindDelta<0?t.WindCnt=e.WindCnt:t.WindCnt=e.WindCnt+t.WindDelta,t.WindCnt2=e.WindCnt2,e=e.NextInAEL;if(this.IsEvenOddAltFillType(t))for(;e!==t;)0!==e.WindDelta&&(t.WindCnt2=0===t.WindCnt2?1:0),e=e.NextInAEL;else for(;e!==t;)t.WindCnt2+=e.WindDelta,e=e.NextInAEL},a.Clipper.prototype.AddEdgeToSEL=function(t){null===this.m_SortedEdges?(this.m_SortedEdges=t,t.PrevInSEL=null,t.NextInSEL=null):(t.NextInSEL=this.m_SortedEdges,t.PrevInSEL=null,this.m_SortedEdges.PrevInSEL=t,this.m_SortedEdges=t)},a.Clipper.prototype.PopEdgeFromSEL=function(t){if(t.v=this.m_SortedEdges,null===t.v)return!1;var e=t.v;return this.m_SortedEdges=t.v.NextInSEL,null!==this.m_SortedEdges&&(this.m_SortedEdges.PrevInSEL=null),e.NextInSEL=null,e.PrevInSEL=null,!0},a.Clipper.prototype.CopyAELToSEL=function(){var t=this.m_ActiveEdges;for(this.m_SortedEdges=t;null!==t;)t.PrevInSEL=t.PrevInAEL,t.NextInSEL=t.NextInAEL,t=t.NextInAEL},a.Clipper.prototype.SwapPositionsInSEL=function(t,e){if(!(null===t.NextInSEL&&null===t.PrevInSEL||null===e.NextInSEL&&null===e.PrevInSEL)){if(t.NextInSEL===e)null!==(n=e.NextInSEL)&&(n.PrevInSEL=t),null!==(r=t.PrevInSEL)&&(r.NextInSEL=e),e.PrevInSEL=r,e.NextInSEL=t,t.PrevInSEL=e,t.NextInSEL=n;else if(e.NextInSEL===t){null!==(n=t.NextInSEL)&&(n.PrevInSEL=e),null!==(r=e.PrevInSEL)&&(r.NextInSEL=t),t.PrevInSEL=r,t.NextInSEL=e,e.PrevInSEL=t,e.NextInSEL=n}else{var n=t.NextInSEL,r=t.PrevInSEL;t.NextInSEL=e.NextInSEL,null!==t.NextInSEL&&(t.NextInSEL.PrevInSEL=t),t.PrevInSEL=e.PrevInSEL,null!==t.PrevInSEL&&(t.PrevInSEL.NextInSEL=t),e.NextInSEL=n,null!==e.NextInSEL&&(e.NextInSEL.PrevInSEL=e),e.PrevInSEL=r,null!==e.PrevInSEL&&(e.PrevInSEL.NextInSEL=e)}null===t.PrevInSEL?this.m_SortedEdges=t:null===e.PrevInSEL&&(this.m_SortedEdges=e)}},a.Clipper.prototype.AddLocalMaxPoly=function(t,e,n){this.AddOutPt(t,n),0===e.WindDelta&&this.AddOutPt(e,n),t.OutIdx===e.OutIdx?(t.OutIdx=-1,e.OutIdx=-1):t.OutIdx<e.OutIdx?this.AppendPolygon(t,e):this.AppendPolygon(e,t)},a.Clipper.prototype.AddLocalMinPoly=function(t,e,n){var r,i,o;if(a.ClipperBase.IsHorizontal(e)||t.Dx>e.Dx?(r=this.AddOutPt(t,n),e.OutIdx=t.OutIdx,t.Side=a.EdgeSide.esLeft,e.Side=a.EdgeSide.esRight,o=(i=t).PrevInAEL===e?e.PrevInAEL:i.PrevInAEL):(r=this.AddOutPt(e,n),t.OutIdx=e.OutIdx,t.Side=a.EdgeSide.esRight,e.Side=a.EdgeSide.esLeft,o=(i=e).PrevInAEL===t?t.PrevInAEL:i.PrevInAEL),null!==o&&o.OutIdx>=0&&o.Top.Y<n.Y&&i.Top.Y<n.Y){var s=a.Clipper.TopX(o,n.Y),u=a.Clipper.TopX(i,n.Y);if(s===u&&0!==i.WindDelta&&0!==o.WindDelta&&a.ClipperBase.SlopesEqual5(new a.IntPoint2(s,n.Y),o.Top,new a.IntPoint2(u,n.Y),i.Top,this.m_UseFullRange)){var l=this.AddOutPt(o,n);this.AddJoin(r,l,i.Top)}}return r},a.Clipper.prototype.AddOutPt=function(t,e){if(t.OutIdx<0){(r=this.CreateOutRec()).IsOpen=0===t.WindDelta;var n=new a.OutPt;return r.Pts=n,n.Idx=r.Idx,n.Pt.X=e.X,n.Pt.Y=e.Y,a.use_xyz&&(n.Pt.Z=e.Z),n.Next=n,n.Prev=n,r.IsOpen||this.SetHoleState(t,r),t.OutIdx=r.Idx,n}var r,i=(r=this.m_PolyOuts[t.OutIdx]).Pts,o=t.Side===a.EdgeSide.esLeft;return o&&a.IntPoint.op_Equality(e,i.Pt)?i:!o&&a.IntPoint.op_Equality(e,i.Prev.Pt)?i.Prev:((n=new a.OutPt).Idx=r.Idx,n.Pt.X=e.X,n.Pt.Y=e.Y,a.use_xyz&&(n.Pt.Z=e.Z),n.Next=i,n.Prev=i.Prev,n.Prev.Next=n,i.Prev=n,o&&(r.Pts=n),n)},a.Clipper.prototype.GetLastOutPt=function(t){var e=this.m_PolyOuts[t.OutIdx];return t.Side===a.EdgeSide.esLeft?e.Pts:e.Pts.Prev},a.Clipper.prototype.SwapPoints=function(t,e){var n=new a.IntPoint1(t.Value);t.Value.X=e.Value.X,t.Value.Y=e.Value.Y,a.use_xyz&&(t.Value.Z=e.Value.Z),e.Value.X=n.X,e.Value.Y=n.Y,a.use_xyz&&(e.Value.Z=n.Z)},a.Clipper.prototype.HorzSegmentsOverlap=function(t,e,n,r){var i;return t>e&&(i=t,t=e,e=i),n>r&&(i=n,n=r,r=i),t<r&&n<e},a.Clipper.prototype.SetHoleState=function(t,e){for(var n=t.PrevInAEL,r=null;null!==n;)n.OutIdx>=0&&0!==n.WindDelta&&(null===r?r=n:r.OutIdx===n.OutIdx&&(r=null)),n=n.PrevInAEL;null===r?(e.FirstLeft=null,e.IsHole=!1):(e.FirstLeft=this.m_PolyOuts[r.OutIdx],e.IsHole=!e.FirstLeft.IsHole)},a.Clipper.prototype.GetDx=function(t,e){return t.Y===e.Y?a.ClipperBase.horizontal:(e.X-t.X)/(e.Y-t.Y)},a.Clipper.prototype.FirstIsBottomPt=function(t,e){for(var n=t.Prev;a.IntPoint.op_Equality(n.Pt,t.Pt)&&n!==t;)n=n.Prev;var r=Math.abs(this.GetDx(t.Pt,n.Pt));for(n=t.Next;a.IntPoint.op_Equality(n.Pt,t.Pt)&&n!==t;)n=n.Next;var i=Math.abs(this.GetDx(t.Pt,n.Pt));for(n=e.Prev;a.IntPoint.op_Equality(n.Pt,e.Pt)&&n!==e;)n=n.Prev;var o=Math.abs(this.GetDx(e.Pt,n.Pt));for(n=e.Next;a.IntPoint.op_Equality(n.Pt,e.Pt)&&n!==e;)n=n.Next;var s=Math.abs(this.GetDx(e.Pt,n.Pt));return Math.max(r,i)===Math.max(o,s)&&Math.min(r,i)===Math.min(o,s)?this.Area(t)>0:r>=o&&r>=s||i>=o&&i>=s},a.Clipper.prototype.GetBottomPt=function(t){for(var e=null,n=t.Next;n!==t;)n.Pt.Y>t.Pt.Y?(t=n,e=null):n.Pt.Y===t.Pt.Y&&n.Pt.X<=t.Pt.X&&(n.Pt.X<t.Pt.X?(e=null,t=n):n.Next!==t&&n.Prev!==t&&(e=n)),n=n.Next;if(null!==e)for(;e!==n;)for(this.FirstIsBottomPt(n,e)||(t=e),e=e.Next;a.IntPoint.op_Inequality(e.Pt,t.Pt);)e=e.Next;return t},a.Clipper.prototype.GetLowermostRec=function(t,e){null===t.BottomPt&&(t.BottomPt=this.GetBottomPt(t.Pts)),null===e.BottomPt&&(e.BottomPt=this.GetBottomPt(e.Pts));var n=t.BottomPt,r=e.BottomPt;return n.Pt.Y>r.Pt.Y?t:n.Pt.Y<r.Pt.Y?e:n.Pt.X<r.Pt.X?t:n.Pt.X>r.Pt.X||n.Next===n?e:r.Next===r||this.FirstIsBottomPt(n,r)?t:e},a.Clipper.prototype.OutRec1RightOfOutRec2=function(t,e){do{if((t=t.FirstLeft)===e)return!0}while(null!==t);return!1},a.Clipper.prototype.GetOutRec=function(t){for(var e=this.m_PolyOuts[t];e!==this.m_PolyOuts[e.Idx];)e=this.m_PolyOuts[e.Idx];return e},a.Clipper.prototype.AppendPolygon=function(t,e){var n,r=this.m_PolyOuts[t.OutIdx],i=this.m_PolyOuts[e.OutIdx];n=this.OutRec1RightOfOutRec2(r,i)?i:this.OutRec1RightOfOutRec2(i,r)?r:this.GetLowermostRec(r,i);var o=r.Pts,s=o.Prev,u=i.Pts,l=u.Prev;t.Side===a.EdgeSide.esLeft?e.Side===a.EdgeSide.esLeft?(this.ReversePolyPtLinks(u),u.Next=o,o.Prev=u,s.Next=l,l.Prev=s,r.Pts=l):(l.Next=o,o.Prev=l,u.Prev=s,s.Next=u,r.Pts=u):e.Side===a.EdgeSide.esRight?(this.ReversePolyPtLinks(u),s.Next=l,l.Prev=s,u.Next=o,o.Prev=u):(s.Next=u,u.Prev=s,o.Prev=l,l.Next=o),r.BottomPt=null,n===i&&(i.FirstLeft!==r&&(r.FirstLeft=i.FirstLeft),r.IsHole=i.IsHole),i.Pts=null,i.BottomPt=null,i.FirstLeft=r;var c=t.OutIdx,h=e.OutIdx;t.OutIdx=-1,e.OutIdx=-1;for(var p=this.m_ActiveEdges;null!==p;){if(p.OutIdx===h){p.OutIdx=c,p.Side=t.Side;break}p=p.NextInAEL}i.Idx=r.Idx},a.Clipper.prototype.ReversePolyPtLinks=function(t){if(null!==t){var e,n;e=t;do{n=e.Next,e.Next=e.Prev,e.Prev=n,e=n}while(e!==t)}},a.Clipper.SwapSides=function(t,e){var n=t.Side;t.Side=e.Side,e.Side=n},a.Clipper.SwapPolyIndexes=function(t,e){var n=t.OutIdx;t.OutIdx=e.OutIdx,e.OutIdx=n},a.Clipper.prototype.IntersectEdges=function(t,e,n){var r=t.OutIdx>=0,i=e.OutIdx>=0;if(a.use_xyz&&this.SetZ(n,t,e),!a.use_lines||0!==t.WindDelta&&0!==e.WindDelta){if(t.PolyTyp===e.PolyTyp)if(this.IsEvenOddFillType(t)){var o=t.WindCnt;t.WindCnt=e.WindCnt,e.WindCnt=o}else t.WindCnt+e.WindDelta===0?t.WindCnt=-t.WindCnt:t.WindCnt+=e.WindDelta,e.WindCnt-t.WindDelta==0?e.WindCnt=-e.WindCnt:e.WindCnt-=t.WindDelta;else this.IsEvenOddFillType(e)?t.WindCnt2=0===t.WindCnt2?1:0:t.WindCnt2+=e.WindDelta,this.IsEvenOddFillType(t)?e.WindCnt2=0===e.WindCnt2?1:0:e.WindCnt2-=t.WindDelta;var s,u,l,c,h,p;switch(t.PolyTyp===a.PolyType.ptSubject?(s=this.m_SubjFillType,l=this.m_ClipFillType):(s=this.m_ClipFillType,l=this.m_SubjFillType),e.PolyTyp===a.PolyType.ptSubject?(u=this.m_SubjFillType,c=this.m_ClipFillType):(u=this.m_ClipFillType,c=this.m_SubjFillType),s){case a.PolyFillType.pftPositive:h=t.WindCnt;break;case a.PolyFillType.pftNegative:h=-t.WindCnt;break;default:h=Math.abs(t.WindCnt)}switch(u){case a.PolyFillType.pftPositive:p=e.WindCnt;break;case a.PolyFillType.pftNegative:p=-e.WindCnt;break;default:p=Math.abs(e.WindCnt)}if(r&&i)0!==h&&1!==h||0!==p&&1!==p||t.PolyTyp!==e.PolyTyp&&this.m_ClipType!==a.ClipType.ctXor?this.AddLocalMaxPoly(t,e,n):(this.AddOutPt(t,n),this.AddOutPt(e,n),a.Clipper.SwapSides(t,e),a.Clipper.SwapPolyIndexes(t,e));else if(r)0!==p&&1!==p||(this.AddOutPt(t,n),a.Clipper.SwapSides(t,e),a.Clipper.SwapPolyIndexes(t,e));else if(i)0!==h&&1!==h||(this.AddOutPt(e,n),a.Clipper.SwapSides(t,e),a.Clipper.SwapPolyIndexes(t,e));else if(!(0!==h&&1!==h||0!==p&&1!==p)){var f,d;switch(l){case a.PolyFillType.pftPositive:f=t.WindCnt2;break;case a.PolyFillType.pftNegative:f=-t.WindCnt2;break;default:f=Math.abs(t.WindCnt2)}switch(c){case a.PolyFillType.pftPositive:d=e.WindCnt2;break;case a.PolyFillType.pftNegative:d=-e.WindCnt2;break;default:d=Math.abs(e.WindCnt2)}if(t.PolyTyp!==e.PolyTyp)this.AddLocalMinPoly(t,e,n);else if(1===h&&1===p)switch(this.m_ClipType){case a.ClipType.ctIntersection:f>0&&d>0&&this.AddLocalMinPoly(t,e,n);break;case a.ClipType.ctUnion:f<=0&&d<=0&&this.AddLocalMinPoly(t,e,n);break;case a.ClipType.ctDifference:(t.PolyTyp===a.PolyType.ptClip&&f>0&&d>0||t.PolyTyp===a.PolyType.ptSubject&&f<=0&&d<=0)&&this.AddLocalMinPoly(t,e,n);break;case a.ClipType.ctXor:this.AddLocalMinPoly(t,e,n)}else a.Clipper.SwapSides(t,e)}}else{if(0===t.WindDelta&&0===e.WindDelta)return;t.PolyTyp===e.PolyTyp&&t.WindDelta!==e.WindDelta&&this.m_ClipType===a.ClipType.ctUnion?0===t.WindDelta?i&&(this.AddOutPt(t,n),r&&(t.OutIdx=-1)):r&&(this.AddOutPt(e,n),i&&(e.OutIdx=-1)):t.PolyTyp!==e.PolyTyp&&(0!==t.WindDelta||1!==Math.abs(e.WindCnt)||this.m_ClipType===a.ClipType.ctUnion&&0!==e.WindCnt2?0!==e.WindDelta||1!==Math.abs(t.WindCnt)||this.m_ClipType===a.ClipType.ctUnion&&0!==t.WindCnt2||(this.AddOutPt(e,n),i&&(e.OutIdx=-1)):(this.AddOutPt(t,n),r&&(t.OutIdx=-1)))}},a.Clipper.prototype.DeleteFromSEL=function(t){var e=t.PrevInSEL,n=t.NextInSEL;null===e&&null===n&&t!==this.m_SortedEdges||(null!==e?e.NextInSEL=n:this.m_SortedEdges=n,null!==n&&(n.PrevInSEL=e),t.NextInSEL=null,t.PrevInSEL=null)},a.Clipper.prototype.ProcessHorizontals=function(){for(var t={};this.PopEdgeFromSEL(t);)this.ProcessHorizontal(t.v)},a.Clipper.prototype.GetHorzDirection=function(t,e){t.Bot.X<t.Top.X?(e.Left=t.Bot.X,e.Right=t.Top.X,e.Dir=a.Direction.dLeftToRight):(e.Left=t.Top.X,e.Right=t.Bot.X,e.Dir=a.Direction.dRightToLeft)},a.Clipper.prototype.ProcessHorizontal=function(t){var e={Dir:null,Left:null,Right:null};this.GetHorzDirection(t,e);for(var n=e.Dir,r=e.Left,i=e.Right,o=0===t.WindDelta,s=t,u=null;null!==s.NextInLML&&a.ClipperBase.IsHorizontal(s.NextInLML);)s=s.NextInLML;null===s.NextInLML&&(u=this.GetMaximaPair(s));var l=this.m_Maxima;if(null!==l)if(n===a.Direction.dLeftToRight){for(;null!==l&&l.X<=t.Bot.X;)l=l.Next;null!==l&&l.X>=s.Top.X&&(l=null)}else{for(;null!==l.Next&&l.Next.X<t.Bot.X;)l=l.Next;l.X<=s.Top.X&&(l=null)}for(var c=null;;){for(var h=t===s,p=this.GetNextInAEL(t,n);null!==p;){if(null!==l)if(n===a.Direction.dLeftToRight)for(;null!==l&&l.X<p.Curr.X;)t.OutIdx>=0&&!o&&this.AddOutPt(t,new a.IntPoint2(l.X,t.Bot.Y)),l=l.Next;else for(;null!==l&&l.X>p.Curr.X;)t.OutIdx>=0&&!o&&this.AddOutPt(t,new a.IntPoint2(l.X,t.Bot.Y)),l=l.Prev;if(n===a.Direction.dLeftToRight&&p.Curr.X>i||n===a.Direction.dRightToLeft&&p.Curr.X<r)break;if(p.Curr.X===t.Top.X&&null!==t.NextInLML&&p.Dx<t.NextInLML.Dx)break;if(t.OutIdx>=0&&!o){a.use_xyz&&(n===a.Direction.dLeftToRight?this.SetZ(p.Curr,t,p):this.SetZ(p.Curr,p,t)),c=this.AddOutPt(t,p.Curr);for(var f=this.m_SortedEdges;null!==f;){if(f.OutIdx>=0&&this.HorzSegmentsOverlap(t.Bot.X,t.Top.X,f.Bot.X,f.Top.X)){var d=this.GetLastOutPt(f);this.AddJoin(d,c,f.Top)}f=f.NextInSEL}this.AddGhostJoin(c,t.Bot)}if(p===u&&h)return t.OutIdx>=0&&this.AddLocalMaxPoly(t,u,t.Top),this.DeleteFromAEL(t),void this.DeleteFromAEL(u);if(n===a.Direction.dLeftToRight){var m=new a.IntPoint2(p.Curr.X,t.Curr.Y);this.IntersectEdges(t,p,m)}else{m=new a.IntPoint2(p.Curr.X,t.Curr.Y);this.IntersectEdges(p,t,m)}var g=this.GetNextInAEL(p,n);this.SwapPositionsInAEL(t,p),p=g}if(null===t.NextInLML||!a.ClipperBase.IsHorizontal(t.NextInLML))break;(t=this.UpdateEdgeIntoAEL(t)).OutIdx>=0&&this.AddOutPt(t,t.Bot),e={Dir:n,Left:r,Right:i},this.GetHorzDirection(t,e),n=e.Dir,r=e.Left,i=e.Right}if(t.OutIdx>=0&&null===c){c=this.GetLastOutPt(t);for(f=this.m_SortedEdges;null!==f;){if(f.OutIdx>=0&&this.HorzSegmentsOverlap(t.Bot.X,t.Top.X,f.Bot.X,f.Top.X)){d=this.GetLastOutPt(f);this.AddJoin(d,c,f.Top)}f=f.NextInSEL}this.AddGhostJoin(c,t.Top)}if(null!==t.NextInLML)if(t.OutIdx>=0){if(c=this.AddOutPt(t,t.Top),0===(t=this.UpdateEdgeIntoAEL(t)).WindDelta)return;var v=t.PrevInAEL;g=t.NextInAEL;if(null!==v&&v.Curr.X===t.Bot.X&&v.Curr.Y===t.Bot.Y&&0===v.WindDelta&&v.OutIdx>=0&&v.Curr.Y>v.Top.Y&&a.ClipperBase.SlopesEqual3(t,v,this.m_UseFullRange)){d=this.AddOutPt(v,t.Bot);this.AddJoin(c,d,t.Top)}else if(null!==g&&g.Curr.X===t.Bot.X&&g.Curr.Y===t.Bot.Y&&0!==g.WindDelta&&g.OutIdx>=0&&g.Curr.Y>g.Top.Y&&a.ClipperBase.SlopesEqual3(t,g,this.m_UseFullRange)){d=this.AddOutPt(g,t.Bot);this.AddJoin(c,d,t.Top)}}else t=this.UpdateEdgeIntoAEL(t);else t.OutIdx>=0&&this.AddOutPt(t,t.Top),this.DeleteFromAEL(t)},a.Clipper.prototype.GetNextInAEL=function(t,e){return e===a.Direction.dLeftToRight?t.NextInAEL:t.PrevInAEL},a.Clipper.prototype.IsMinima=function(t){return null!==t&&t.Prev.NextInLML!==t&&t.Next.NextInLML!==t},a.Clipper.prototype.IsMaxima=function(t,e){return null!==t&&t.Top.Y===e&&null===t.NextInLML},a.Clipper.prototype.IsIntermediate=function(t,e){return t.Top.Y===e&&null!==t.NextInLML},a.Clipper.prototype.GetMaximaPair=function(t){return a.IntPoint.op_Equality(t.Next.Top,t.Top)&&null===t.Next.NextInLML?t.Next:a.IntPoint.op_Equality(t.Prev.Top,t.Top)&&null===t.Prev.NextInLML?t.Prev:null},a.Clipper.prototype.GetMaximaPairEx=function(t){var e=this.GetMaximaPair(t);return null===e||e.OutIdx===a.ClipperBase.Skip||e.NextInAEL===e.PrevInAEL&&!a.ClipperBase.IsHorizontal(e)?null:e},a.Clipper.prototype.ProcessIntersections=function(t){if(null===this.m_ActiveEdges)return!0;try{if(this.BuildIntersectList(t),0===this.m_IntersectList.length)return!0;if(1!==this.m_IntersectList.length&&!this.FixupIntersectionOrder())return!1;this.ProcessIntersectList()}catch(t){this.m_SortedEdges=null,this.m_IntersectList.length=0,a.Error("ProcessIntersections error")}return this.m_SortedEdges=null,!0},a.Clipper.prototype.BuildIntersectList=function(t){if(null!==this.m_ActiveEdges){var e=this.m_ActiveEdges;for(this.m_SortedEdges=e;null!==e;)e.PrevInSEL=e.PrevInAEL,e.NextInSEL=e.NextInAEL,e.Curr.X=a.Clipper.TopX(e,t),e=e.NextInAEL;for(var n=!0;n&&null!==this.m_SortedEdges;){for(n=!1,e=this.m_SortedEdges;null!==e.NextInSEL;){var r=e.NextInSEL,i=new a.IntPoint0;if(e.Curr.X>r.Curr.X){this.IntersectPoint(e,r,i),i.Y<t&&(i=new a.IntPoint2(a.Clipper.TopX(e,t),t));var o=new a.IntersectNode;o.Edge1=e,o.Edge2=r,o.Pt.X=i.X,o.Pt.Y=i.Y,a.use_xyz&&(o.Pt.Z=i.Z),this.m_IntersectList.push(o),this.SwapPositionsInSEL(e,r),n=!0}else e=r}if(null===e.PrevInSEL)break;e.PrevInSEL.NextInSEL=null}this.m_SortedEdges=null}},a.Clipper.prototype.EdgesAdjacent=function(t){return t.Edge1.NextInSEL===t.Edge2||t.Edge1.PrevInSEL===t.Edge2},a.Clipper.IntersectNodeSort=function(t,e){return e.Pt.Y-t.Pt.Y},a.Clipper.prototype.FixupIntersectionOrder=function(){this.m_IntersectList.sort(this.m_IntersectNodeComparer),this.CopyAELToSEL();for(var t=this.m_IntersectList.length,e=0;e<t;e++){if(!this.EdgesAdjacent(this.m_IntersectList[e])){for(var n=e+1;n<t&&!this.EdgesAdjacent(this.m_IntersectList[n]);)n++;if(n===t)return!1;var r=this.m_IntersectList[e];this.m_IntersectList[e]=this.m_IntersectList[n],this.m_IntersectList[n]=r}this.SwapPositionsInSEL(this.m_IntersectList[e].Edge1,this.m_IntersectList[e].Edge2)}return!0},a.Clipper.prototype.ProcessIntersectList=function(){for(var t=0,e=this.m_IntersectList.length;t<e;t++){var n=this.m_IntersectList[t];this.IntersectEdges(n.Edge1,n.Edge2,n.Pt),this.SwapPositionsInAEL(n.Edge1,n.Edge2)}this.m_IntersectList.length=0};c.msie?a.Clipper.Round=function(t){return t<0?Math.ceil(t-.5):Math.round(t)}:c.chromium?a.Clipper.Round=function(t){return t<0?-Math.round(Math.abs(t)):Math.round(t)}:c.safari?a.Clipper.Round=function(t){return t<0?(t-=.5)<-2147483648?Math.ceil(t):0|t:(t+=.5)>2147483647?Math.floor(t):0|t}:a.Clipper.Round=function(t){return t<0?Math.ceil(t-.5):Math.floor(t+.5)},a.Clipper.TopX=function(t,e){return e===t.Top.Y?t.Top.X:t.Bot.X+a.Clipper.Round(t.Dx*(e-t.Bot.Y))},a.Clipper.prototype.IntersectPoint=function(t,e,n){var r,i;if(n.X=0,n.Y=0,t.Dx===e.Dx)return n.Y=t.Curr.Y,void(n.X=a.Clipper.TopX(t,n.Y));if(0===t.Delta.X)n.X=t.Bot.X,a.ClipperBase.IsHorizontal(e)?n.Y=e.Bot.Y:(i=e.Bot.Y-e.Bot.X/e.Dx,n.Y=a.Clipper.Round(n.X/e.Dx+i));else if(0===e.Delta.X)n.X=e.Bot.X,a.ClipperBase.IsHorizontal(t)?n.Y=t.Bot.Y:(r=t.Bot.Y-t.Bot.X/t.Dx,n.Y=a.Clipper.Round(n.X/t.Dx+r));else{r=t.Bot.X-t.Bot.Y*t.Dx;var o=((i=e.Bot.X-e.Bot.Y*e.Dx)-r)/(t.Dx-e.Dx);n.Y=a.Clipper.Round(o),Math.abs(t.Dx)<Math.abs(e.Dx)?n.X=a.Clipper.Round(t.Dx*o+r):n.X=a.Clipper.Round(e.Dx*o+i)}if(n.Y<t.Top.Y||n.Y<e.Top.Y){if(t.Top.Y>e.Top.Y)return n.Y=t.Top.Y,n.X=a.Clipper.TopX(e,t.Top.Y),n.X<t.Top.X;n.Y=e.Top.Y,Math.abs(t.Dx)<Math.abs(e.Dx)?n.X=a.Clipper.TopX(t,n.Y):n.X=a.Clipper.TopX(e,n.Y)}n.Y>t.Curr.Y&&(n.Y=t.Curr.Y,Math.abs(t.Dx)>Math.abs(e.Dx)?n.X=a.Clipper.TopX(e,n.Y):n.X=a.Clipper.TopX(t,n.Y))},a.Clipper.prototype.ProcessEdgesAtTopOfScanbeam=function(t){for(var e=this.m_ActiveEdges;null!==e;){var n=this.IsMaxima(e,t);if(n){var r=this.GetMaximaPairEx(e);n=null===r||!a.ClipperBase.IsHorizontal(r)}if(n){this.StrictlySimple&&this.InsertMaxima(e.Top.X);var i=e.PrevInAEL;this.DoMaxima(e),e=null===i?this.m_ActiveEdges:i.NextInAEL}else{if(this.IsIntermediate(e,t)&&a.ClipperBase.IsHorizontal(e.NextInLML)?((e=this.UpdateEdgeIntoAEL(e)).OutIdx>=0&&this.AddOutPt(e,e.Bot),this.AddEdgeToSEL(e)):(e.Curr.X=a.Clipper.TopX(e,t),e.Curr.Y=t),a.use_xyz&&(e.Top.Y===t?e.Curr.Z=e.Top.Z:e.Bot.Y===t?e.Curr.Z=e.Bot.Z:e.Curr.Z=0),this.StrictlySimple){i=e.PrevInAEL;if(e.OutIdx>=0&&0!==e.WindDelta&&null!==i&&i.OutIdx>=0&&i.Curr.X===e.Curr.X&&0!==i.WindDelta){var o=new a.IntPoint1(e.Curr);a.use_xyz&&this.SetZ(o,i,e);var s=this.AddOutPt(i,o),u=this.AddOutPt(e,o);this.AddJoin(s,u,o)}}e=e.NextInAEL}}for(this.ProcessHorizontals(),this.m_Maxima=null,e=this.m_ActiveEdges;null!==e;){if(this.IsIntermediate(e,t)){s=null;e.OutIdx>=0&&(s=this.AddOutPt(e,e.Top));i=(e=this.UpdateEdgeIntoAEL(e)).PrevInAEL;var l=e.NextInAEL;if(null!==i&&i.Curr.X===e.Bot.X&&i.Curr.Y===e.Bot.Y&&null!==s&&i.OutIdx>=0&&i.Curr.Y===i.Top.Y&&a.ClipperBase.SlopesEqual5(e.Curr,e.Top,i.Curr,i.Top,this.m_UseFullRange)&&0!==e.WindDelta&&0!==i.WindDelta){u=this.AddOutPt(ePrev2,e.Bot);this.AddJoin(s,u,e.Top)}else if(null!==l&&l.Curr.X===e.Bot.X&&l.Curr.Y===e.Bot.Y&&null!==s&&l.OutIdx>=0&&l.Curr.Y===l.Top.Y&&a.ClipperBase.SlopesEqual5(e.Curr,e.Top,l.Curr,l.Top,this.m_UseFullRange)&&0!==e.WindDelta&&0!==l.WindDelta){u=this.AddOutPt(l,e.Bot);this.AddJoin(s,u,e.Top)}}e=e.NextInAEL}},a.Clipper.prototype.DoMaxima=function(t){var e=this.GetMaximaPairEx(t);if(null===e)return t.OutIdx>=0&&this.AddOutPt(t,t.Top),void this.DeleteFromAEL(t);for(var n=t.NextInAEL;null!==n&&n!==e;)this.IntersectEdges(t,n,t.Top),this.SwapPositionsInAEL(t,n),n=t.NextInAEL;-1===t.OutIdx&&-1===e.OutIdx?(this.DeleteFromAEL(t),this.DeleteFromAEL(e)):t.OutIdx>=0&&e.OutIdx>=0?(t.OutIdx>=0&&this.AddLocalMaxPoly(t,e,t.Top),this.DeleteFromAEL(t),this.DeleteFromAEL(e)):a.use_lines&&0===t.WindDelta?(t.OutIdx>=0&&(this.AddOutPt(t,t.Top),t.OutIdx=a.ClipperBase.Unassigned),this.DeleteFromAEL(t),e.OutIdx>=0&&(this.AddOutPt(e,t.Top),e.OutIdx=a.ClipperBase.Unassigned),this.DeleteFromAEL(e)):a.Error("DoMaxima error")},a.Clipper.ReversePaths=function(t){for(var e=0,n=t.length;e<n;e++)t[e].reverse()},a.Clipper.Orientation=function(t){return a.Clipper.Area(t)>=0},a.Clipper.prototype.PointCount=function(t){if(null===t)return 0;var e=0,n=t;do{e++,n=n.Next}while(n!==t);return e},a.Clipper.prototype.BuildResult=function(t){a.Clear(t);for(var e=0,n=this.m_PolyOuts.length;e<n;e++){var r=this.m_PolyOuts[e];if(null!==r.Pts){var i=r.Pts.Prev,o=this.PointCount(i);if(!(o<2)){for(var s=new Array(o),u=0;u<o;u++)s[u]=i.Pt,i=i.Prev;t.push(s)}}}},a.Clipper.prototype.BuildResult2=function(t){t.Clear();for(var e=0,n=this.m_PolyOuts.length;e<n;e++){var r=this.m_PolyOuts[e],i=this.PointCount(r.Pts);if(!(r.IsOpen&&i<2||!r.IsOpen&&i<3)){this.FixHoleLinkage(r);var o=new a.PolyNode;t.m_AllPolys.push(o),r.PolyNode=o,o.m_polygon.length=i;for(var s=r.Pts.Prev,u=0;u<i;u++)o.m_polygon[u]=s.Pt,s=s.Prev}}for(e=0,n=this.m_PolyOuts.length;e<n;e++){null!==(r=this.m_PolyOuts[e]).PolyNode&&(r.IsOpen?(r.PolyNode.IsOpen=!0,t.AddChild(r.PolyNode)):null!==r.FirstLeft&&null!==r.FirstLeft.PolyNode?r.FirstLeft.PolyNode.AddChild(r.PolyNode):t.AddChild(r.PolyNode))}},a.Clipper.prototype.FixupOutPolyline=function(t){for(var e=t.Pts,n=e.Prev;e!==n;)if(e=e.Next,a.IntPoint.op_Equality(e.Pt,e.Prev.Pt)){e===n&&(n=e.Prev);var r=e.Prev;r.Next=e.Next,e.Next.Prev=r,e=r}e===e.Prev&&(t.Pts=null)},a.Clipper.prototype.FixupOutPolygon=function(t){var e=null;t.BottomPt=null;for(var n=t.Pts,r=this.PreserveCollinear||this.StrictlySimple;;){if(n.Prev===n||n.Prev===n.Next)return void(t.Pts=null);if(a.IntPoint.op_Equality(n.Pt,n.Next.Pt)||a.IntPoint.op_Equality(n.Pt,n.Prev.Pt)||a.ClipperBase.SlopesEqual4(n.Prev.Pt,n.Pt,n.Next.Pt,this.m_UseFullRange)&&(!r||!this.Pt2IsBetweenPt1AndPt3(n.Prev.Pt,n.Pt,n.Next.Pt)))e=null,n.Prev.Next=n.Next,n.Next.Prev=n.Prev,n=n.Prev;else{if(n===e)break;null===e&&(e=n),n=n.Next}}t.Pts=n},a.Clipper.prototype.DupOutPt=function(t,e){var n=new a.OutPt;return n.Pt.X=t.Pt.X,n.Pt.Y=t.Pt.Y,a.use_xyz&&(n.Pt.Z=t.Pt.Z),n.Idx=t.Idx,e?(n.Next=t.Next,n.Prev=t,t.Next.Prev=n,t.Next=n):(n.Prev=t.Prev,n.Next=t,t.Prev.Next=n,t.Prev=n),n},a.Clipper.prototype.GetOverlap=function(t,e,n,r,i){return t<e?n<r?(i.Left=Math.max(t,n),i.Right=Math.min(e,r)):(i.Left=Math.max(t,r),i.Right=Math.min(e,n)):n<r?(i.Left=Math.max(e,n),i.Right=Math.min(t,r)):(i.Left=Math.max(e,r),i.Right=Math.min(t,n)),i.Left<i.Right},a.Clipper.prototype.JoinHorz=function(t,e,n,r,i,o){var s=t.Pt.X>e.Pt.X?a.Direction.dRightToLeft:a.Direction.dLeftToRight,u=n.Pt.X>r.Pt.X?a.Direction.dRightToLeft:a.Direction.dLeftToRight;if(s===u)return!1;if(s===a.Direction.dLeftToRight){for(;t.Next.Pt.X<=i.X&&t.Next.Pt.X>=t.Pt.X&&t.Next.Pt.Y===i.Y;)t=t.Next;o&&t.Pt.X!==i.X&&(t=t.Next),e=this.DupOutPt(t,!o),a.IntPoint.op_Inequality(e.Pt,i)&&((t=e).Pt.X=i.X,t.Pt.Y=i.Y,a.use_xyz&&(t.Pt.Z=i.Z),e=this.DupOutPt(t,!o))}else{for(;t.Next.Pt.X>=i.X&&t.Next.Pt.X<=t.Pt.X&&t.Next.Pt.Y===i.Y;)t=t.Next;o||t.Pt.X===i.X||(t=t.Next),e=this.DupOutPt(t,o),a.IntPoint.op_Inequality(e.Pt,i)&&((t=e).Pt.X=i.X,t.Pt.Y=i.Y,a.use_xyz&&(t.Pt.Z=i.Z),e=this.DupOutPt(t,o))}if(u===a.Direction.dLeftToRight){for(;n.Next.Pt.X<=i.X&&n.Next.Pt.X>=n.Pt.X&&n.Next.Pt.Y===i.Y;)n=n.Next;o&&n.Pt.X!==i.X&&(n=n.Next),r=this.DupOutPt(n,!o),a.IntPoint.op_Inequality(r.Pt,i)&&((n=r).Pt.X=i.X,n.Pt.Y=i.Y,a.use_xyz&&(n.Pt.Z=i.Z),r=this.DupOutPt(n,!o))}else{for(;n.Next.Pt.X>=i.X&&n.Next.Pt.X<=n.Pt.X&&n.Next.Pt.Y===i.Y;)n=n.Next;o||n.Pt.X===i.X||(n=n.Next),r=this.DupOutPt(n,o),a.IntPoint.op_Inequality(r.Pt,i)&&((n=r).Pt.X=i.X,n.Pt.Y=i.Y,a.use_xyz&&(n.Pt.Z=i.Z),r=this.DupOutPt(n,o))}return s===a.Direction.dLeftToRight===o?(t.Prev=n,n.Next=t,e.Next=r,r.Prev=e):(t.Next=n,n.Prev=t,e.Prev=r,r.Next=e),!0},a.Clipper.prototype.JoinPoints=function(t,e,n){var r=t.OutPt1,i=new a.OutPt,o=t.OutPt2,s=new a.OutPt,u=t.OutPt1.Pt.Y===t.OffPt.Y;if(u&&a.IntPoint.op_Equality(t.OffPt,t.OutPt1.Pt)&&a.IntPoint.op_Equality(t.OffPt,t.OutPt2.Pt)){if(e!==n)return!1;for(i=t.OutPt1.Next;i!==r&&a.IntPoint.op_Equality(i.Pt,t.OffPt);)i=i.Next;var l=i.Pt.Y>t.OffPt.Y;for(s=t.OutPt2.Next;s!==o&&a.IntPoint.op_Equality(s.Pt,t.OffPt);)s=s.Next;return l!==s.Pt.Y>t.OffPt.Y&&(l?(i=this.DupOutPt(r,!1),s=this.DupOutPt(o,!0),r.Prev=o,o.Next=r,i.Next=s,s.Prev=i,t.OutPt1=r,t.OutPt2=i,!0):(i=this.DupOutPt(r,!0),s=this.DupOutPt(o,!1),r.Next=o,o.Prev=r,i.Prev=s,s.Next=i,t.OutPt1=r,t.OutPt2=i,!0))}if(u){for(i=r;r.Prev.Pt.Y===r.Pt.Y&&r.Prev!==i&&r.Prev!==o;)r=r.Prev;for(;i.Next.Pt.Y===i.Pt.Y&&i.Next!==r&&i.Next!==o;)i=i.Next;if(i.Next===r||i.Next===o)return!1;for(s=o;o.Prev.Pt.Y===o.Pt.Y&&o.Prev!==s&&o.Prev!==i;)o=o.Prev;for(;s.Next.Pt.Y===s.Pt.Y&&s.Next!==o&&s.Next!==r;)s=s.Next;if(s.Next===o||s.Next===r)return!1;var c={Left:null,Right:null};if(!this.GetOverlap(r.Pt.X,i.Pt.X,o.Pt.X,s.Pt.X,c))return!1;var h,p=c.Left,f=c.Right,d=new a.IntPoint0;return r.Pt.X>=p&&r.Pt.X<=f?(d.X=r.Pt.X,d.Y=r.Pt.Y,a.use_xyz&&(d.Z=r.Pt.Z),h=r.Pt.X>i.Pt.X):o.Pt.X>=p&&o.Pt.X<=f?(d.X=o.Pt.X,d.Y=o.Pt.Y,a.use_xyz&&(d.Z=o.Pt.Z),h=o.Pt.X>s.Pt.X):i.Pt.X>=p&&i.Pt.X<=f?(d.X=i.Pt.X,d.Y=i.Pt.Y,a.use_xyz&&(d.Z=i.Pt.Z),h=i.Pt.X>r.Pt.X):(d.X=s.Pt.X,d.Y=s.Pt.Y,a.use_xyz&&(d.Z=s.Pt.Z),h=s.Pt.X>o.Pt.X),t.OutPt1=r,t.OutPt2=o,this.JoinHorz(r,i,o,s,d,h)}for(i=r.Next;a.IntPoint.op_Equality(i.Pt,r.Pt)&&i!==r;)i=i.Next;var m=i.Pt.Y>r.Pt.Y||!a.ClipperBase.SlopesEqual4(r.Pt,i.Pt,t.OffPt,this.m_UseFullRange);if(m){for(i=r.Prev;a.IntPoint.op_Equality(i.Pt,r.Pt)&&i!==r;)i=i.Prev;if(i.Pt.Y>r.Pt.Y||!a.ClipperBase.SlopesEqual4(r.Pt,i.Pt,t.OffPt,this.m_UseFullRange))return!1}for(s=o.Next;a.IntPoint.op_Equality(s.Pt,o.Pt)&&s!==o;)s=s.Next;var g=s.Pt.Y>o.Pt.Y||!a.ClipperBase.SlopesEqual4(o.Pt,s.Pt,t.OffPt,this.m_UseFullRange);if(g){for(s=o.Prev;a.IntPoint.op_Equality(s.Pt,o.Pt)&&s!==o;)s=s.Prev;if(s.Pt.Y>o.Pt.Y||!a.ClipperBase.SlopesEqual4(o.Pt,s.Pt,t.OffPt,this.m_UseFullRange))return!1}return i!==r&&s!==o&&i!==s&&(e!==n||m!==g)&&(m?(i=this.DupOutPt(r,!1),s=this.DupOutPt(o,!0),r.Prev=o,o.Next=r,i.Next=s,s.Prev=i,t.OutPt1=r,t.OutPt2=i,!0):(i=this.DupOutPt(r,!0),s=this.DupOutPt(o,!1),r.Next=o,o.Prev=r,i.Prev=s,s.Next=i,t.OutPt1=r,t.OutPt2=i,!0))},a.Clipper.GetBounds=function(t){for(var e=0,n=t.length;e<n&&0===t[e].length;)e++;if(e===n)return new a.IntRect(0,0,0,0);var r=new a.IntRect;for(r.left=t[e][0].X,r.right=r.left,r.top=t[e][0].Y,r.bottom=r.top;e<n;e++)for(var i=0,o=t[e].length;i<o;i++)t[e][i].X<r.left?r.left=t[e][i].X:t[e][i].X>r.right&&(r.right=t[e][i].X),t[e][i].Y<r.top?r.top=t[e][i].Y:t[e][i].Y>r.bottom&&(r.bottom=t[e][i].Y);return r},a.Clipper.prototype.GetBounds2=function(t){var e=t,n=new a.IntRect;for(n.left=t.Pt.X,n.right=t.Pt.X,n.top=t.Pt.Y,n.bottom=t.Pt.Y,t=t.Next;t!==e;)t.Pt.X<n.left&&(n.left=t.Pt.X),t.Pt.X>n.right&&(n.right=t.Pt.X),t.Pt.Y<n.top&&(n.top=t.Pt.Y),t.Pt.Y>n.bottom&&(n.bottom=t.Pt.Y),t=t.Next;return n},a.Clipper.PointInPolygon=function(t,e){var n=0,r=e.length;if(r<3)return 0;for(var i=e[0],o=1;o<=r;++o){var a=o===r?e[0]:e[o];if(a.Y===t.Y&&(a.X===t.X||i.Y===t.Y&&a.X>t.X==i.X<t.X))return-1;if(i.Y<t.Y!=a.Y<t.Y)if(i.X>=t.X)if(a.X>t.X)n=1-n;else{if(0===(s=(i.X-t.X)*(a.Y-t.Y)-(a.X-t.X)*(i.Y-t.Y)))return-1;s>0==a.Y>i.Y&&(n=1-n)}else if(a.X>t.X){var s;if(0===(s=(i.X-t.X)*(a.Y-t.Y)-(a.X-t.X)*(i.Y-t.Y)))return-1;s>0==a.Y>i.Y&&(n=1-n)}i=a}return n},a.Clipper.prototype.PointInPolygon=function(t,e){var n=0,r=e,i=t.X,o=t.Y,a=e.Pt.X,s=e.Pt.Y;do{var u=(e=e.Next).Pt.X,l=e.Pt.Y;if(l===o&&(u===i||s===o&&u>i==a<i))return-1;if(s<o!=l<o)if(a>=i)if(u>i)n=1-n;else{if(0===(c=(a-i)*(l-o)-(u-i)*(s-o)))return-1;c>0==l>s&&(n=1-n)}else if(u>i){var c;if(0===(c=(a-i)*(l-o)-(u-i)*(s-o)))return-1;c>0==l>s&&(n=1-n)}a=u,s=l}while(r!==e);return n},a.Clipper.prototype.Poly2ContainsPoly1=function(t,e){var n=t;do{var r=this.PointInPolygon(n.Pt,e);if(r>=0)return r>0;n=n.Next}while(n!==t);return!0},a.Clipper.prototype.FixupFirstLefts1=function(t,e){for(var n,r,i=0,o=this.m_PolyOuts.length;i<o;i++)n=this.m_PolyOuts[i],r=a.Clipper.ParseFirstLeft(n.FirstLeft),null!==n.Pts&&r===t&&this.Poly2ContainsPoly1(n.Pts,e.Pts)&&(n.FirstLeft=e)},a.Clipper.prototype.FixupFirstLefts2=function(t,e){for(var n,r,i=e.FirstLeft,o=0,s=this.m_PolyOuts.length;o<s;o++)null!==(n=this.m_PolyOuts[o]).Pts&&n!==e&&n!==t&&((r=a.Clipper.ParseFirstLeft(n.FirstLeft))!==i&&r!==t&&r!==e||(this.Poly2ContainsPoly1(n.Pts,t.Pts)?n.FirstLeft=t:this.Poly2ContainsPoly1(n.Pts,e.Pts)?n.FirstLeft=e:n.FirstLeft!==t&&n.FirstLeft!==e||(n.FirstLeft=i)))},a.Clipper.prototype.FixupFirstLefts3=function(t,e){for(var n,r,i=0,o=this.m_PolyOuts.length;i<o;i++)n=this.m_PolyOuts[i],r=a.Clipper.ParseFirstLeft(n.FirstLeft),null!==n.Pts&&r===t&&(n.FirstLeft=e)},a.Clipper.ParseFirstLeft=function(t){for(;null!==t&&null===t.Pts;)t=t.FirstLeft;return t},a.Clipper.prototype.JoinCommonEdges=function(){for(var t=0,e=this.m_Joins.length;t<e;t++){var n,r=this.m_Joins[t],i=this.GetOutRec(r.OutPt1.Idx),o=this.GetOutRec(r.OutPt2.Idx);if(null!==i.Pts&&null!==o.Pts)if(!i.IsOpen&&!o.IsOpen)n=i===o?i:this.OutRec1RightOfOutRec2(i,o)?o:this.OutRec1RightOfOutRec2(o,i)?i:this.GetLowermostRec(i,o),this.JoinPoints(r,i,o)&&(i===o?(i.Pts=r.OutPt1,i.BottomPt=null,(o=this.CreateOutRec()).Pts=r.OutPt2,this.UpdateOutPtIdxs(o),this.Poly2ContainsPoly1(o.Pts,i.Pts)?(o.IsHole=!i.IsHole,o.FirstLeft=i,this.m_UsingPolyTree&&this.FixupFirstLefts2(o,i),(o.IsHole^this.ReverseSolution)==this.Area$1(o)>0&&this.ReversePolyPtLinks(o.Pts)):this.Poly2ContainsPoly1(i.Pts,o.Pts)?(o.IsHole=i.IsHole,i.IsHole=!o.IsHole,o.FirstLeft=i.FirstLeft,i.FirstLeft=o,this.m_UsingPolyTree&&this.FixupFirstLefts2(i,o),(i.IsHole^this.ReverseSolution)==this.Area$1(i)>0&&this.ReversePolyPtLinks(i.Pts)):(o.IsHole=i.IsHole,o.FirstLeft=i.FirstLeft,this.m_UsingPolyTree&&this.FixupFirstLefts1(i,o))):(o.Pts=null,o.BottomPt=null,o.Idx=i.Idx,i.IsHole=n.IsHole,n===o&&(i.FirstLeft=o.FirstLeft),o.FirstLeft=i,this.m_UsingPolyTree&&this.FixupFirstLefts3(o,i)))}},a.Clipper.prototype.UpdateOutPtIdxs=function(t){var e=t.Pts;do{e.Idx=t.Idx,e=e.Prev}while(e!==t.Pts)},a.Clipper.prototype.DoSimplePolygons=function(){for(var t=0;t<this.m_PolyOuts.length;){var e=this.m_PolyOuts[t++],n=e.Pts;if(null!==n&&!e.IsOpen)do{for(var r=n.Next;r!==e.Pts;){if(a.IntPoint.op_Equality(n.Pt,r.Pt)&&r.Next!==n&&r.Prev!==n){var i=n.Prev,o=r.Prev;n.Prev=o,o.Next=n,r.Prev=i,i.Next=r,e.Pts=n;var s=this.CreateOutRec();s.Pts=r,this.UpdateOutPtIdxs(s),this.Poly2ContainsPoly1(s.Pts,e.Pts)?(s.IsHole=!e.IsHole,s.FirstLeft=e,this.m_UsingPolyTree&&this.FixupFirstLefts2(s,e)):this.Poly2ContainsPoly1(e.Pts,s.Pts)?(s.IsHole=e.IsHole,e.IsHole=!s.IsHole,s.FirstLeft=e.FirstLeft,e.FirstLeft=s,this.m_UsingPolyTree&&this.FixupFirstLefts2(e,s)):(s.IsHole=e.IsHole,s.FirstLeft=e.FirstLeft,this.m_UsingPolyTree&&this.FixupFirstLefts1(e,s)),r=n}r=r.Next}n=n.Next}while(n!==e.Pts)}},a.Clipper.Area=function(t){if(!Array.isArray(t))return 0;var e=t.length;if(e<3)return 0;for(var n=0,r=0,i=e-1;r<e;++r)n+=(t[i].X+t[r].X)*(t[i].Y-t[r].Y),i=r;return.5*-n},a.Clipper.prototype.Area=function(t){var e=t;if(null===t)return 0;var n=0;do{n+=(t.Prev.Pt.X+t.Pt.X)*(t.Prev.Pt.Y-t.Pt.Y),t=t.Next}while(t!==e);return.5*n},a.Clipper.prototype.Area$1=function(t){return this.Area(t.Pts)},a.Clipper.SimplifyPolygon=function(t,e){var n=new Array,r=new a.Clipper(0);return r.StrictlySimple=!0,r.AddPath(t,a.PolyType.ptSubject,!0),r.Execute(a.ClipType.ctUnion,n,e,e),n},a.Clipper.SimplifyPolygons=function(t,e){void 0===e&&(e=a.PolyFillType.pftEvenOdd);var n=new Array,r=new a.Clipper(0);return r.StrictlySimple=!0,r.AddPaths(t,a.PolyType.ptSubject,!0),r.Execute(a.ClipType.ctUnion,n,e,e),n},a.Clipper.DistanceSqrd=function(t,e){var n=t.X-e.X,r=t.Y-e.Y;return n*n+r*r},a.Clipper.DistanceFromLineSqrd=function(t,e,n){var r=e.Y-n.Y,i=n.X-e.X,o=r*e.X+i*e.Y;return(o=r*t.X+i*t.Y-o)*o/(r*r+i*i)},a.Clipper.SlopesNearCollinear=function(t,e,n,r){return Math.abs(t.X-e.X)>Math.abs(t.Y-e.Y)?t.X>e.X==t.X<n.X?a.Clipper.DistanceFromLineSqrd(t,e,n)<r:e.X>t.X==e.X<n.X?a.Clipper.DistanceFromLineSqrd(e,t,n)<r:a.Clipper.DistanceFromLineSqrd(n,t,e)<r:t.Y>e.Y==t.Y<n.Y?a.Clipper.DistanceFromLineSqrd(t,e,n)<r:e.Y>t.Y==e.Y<n.Y?a.Clipper.DistanceFromLineSqrd(e,t,n)<r:a.Clipper.DistanceFromLineSqrd(n,t,e)<r},a.Clipper.PointsAreClose=function(t,e,n){var r=t.X-e.X,i=t.Y-e.Y;return r*r+i*i<=n},a.Clipper.ExcludeOp=function(t){var e=t.Prev;return e.Next=t.Next,t.Next.Prev=e,e.Idx=0,e},a.Clipper.CleanPolygon=function(t,e){void 0===e&&(e=1.415);var n=t.length;if(0===n)return new Array;for(var r=new Array(n),i=0;i<n;++i)r[i]=new a.OutPt;for(i=0;i<n;++i)r[i].Pt=t[i],r[i].Next=r[(i+1)%n],r[i].Next.Prev=r[i],r[i].Idx=0;for(var o=e*e,s=r[0];0===s.Idx&&s.Next!==s.Prev;)a.Clipper.PointsAreClose(s.Pt,s.Prev.Pt,o)?(s=a.Clipper.ExcludeOp(s),n--):a.Clipper.PointsAreClose(s.Prev.Pt,s.Next.Pt,o)?(a.Clipper.ExcludeOp(s.Next),s=a.Clipper.ExcludeOp(s),n-=2):a.Clipper.SlopesNearCollinear(s.Prev.Pt,s.Pt,s.Next.Pt,o)?(s=a.Clipper.ExcludeOp(s),n--):(s.Idx=1,s=s.Next);n<3&&(n=0);var u=new Array(n);for(i=0;i<n;++i)u[i]=new a.IntPoint1(s.Pt),s=s.Next;return r=null,u},a.Clipper.CleanPolygons=function(t,e){for(var n=new Array(t.length),r=0,i=t.length;r<i;r++)n[r]=a.Clipper.CleanPolygon(t[r],e);return n},a.Clipper.Minkowski=function(t,e,n,r){var i=r?1:0,o=t.length,s=e.length,u=new Array;if(n)for(var l=0;l<s;l++){for(var c=new Array(o),h=0,p=t.length,f=t[h];h<p;f=t[++h])c[h]=new a.IntPoint2(e[l].X+f.X,e[l].Y+f.Y);u.push(c)}else for(l=0;l<s;l++){for(c=new Array(o),h=0,p=t.length,f=t[h];h<p;f=t[++h])c[h]=new a.IntPoint2(e[l].X-f.X,e[l].Y-f.Y);u.push(c)}var d=new Array;for(l=0;l<s-1+i;l++)for(h=0;h<o;h++){var m=new Array;m.push(u[l%s][h%o]),m.push(u[(l+1)%s][h%o]),m.push(u[(l+1)%s][(h+1)%o]),m.push(u[l%s][(h+1)%o]),a.Clipper.Orientation(m)||m.reverse(),d.push(m)}return d},a.Clipper.MinkowskiSum=function(t,e,n){if(e[0]instanceof Array){l=e;for(var r=new a.Paths,i=(s=new a.Clipper,0);i<l.length;++i){var o=a.Clipper.Minkowski(t,l[i],!0,n);if(s.AddPaths(o,a.PolyType.ptSubject,!0),n){u=a.Clipper.TranslatePath(l[i],t[0]);s.AddPath(u,a.PolyType.ptClip,!0)}}return s.Execute(a.ClipType.ctUnion,r,a.PolyFillType.pftNonZero,a.PolyFillType.pftNonZero),r}var s,u=e,l=a.Clipper.Minkowski(t,u,!0,n);return(s=new a.Clipper).AddPaths(l,a.PolyType.ptSubject,!0),s.Execute(a.ClipType.ctUnion,l,a.PolyFillType.pftNonZero,a.PolyFillType.pftNonZero),l},a.Clipper.TranslatePath=function(t,e){for(var n=new a.Path,r=0;r<t.length;r++)n.push(new a.IntPoint2(t[r].X+e.X,t[r].Y+e.Y));return n},a.Clipper.MinkowskiDiff=function(t,e){var n=a.Clipper.Minkowski(t,e,!1,!0),r=new a.Clipper;return r.AddPaths(n,a.PolyType.ptSubject,!0),r.Execute(a.ClipType.ctUnion,n,a.PolyFillType.pftNonZero,a.PolyFillType.pftNonZero),n},a.Clipper.PolyTreeToPaths=function(t){var e=new Array;return a.Clipper.AddPolyNodeToPaths(t,a.Clipper.NodeType.ntAny,e),e},a.Clipper.AddPolyNodeToPaths=function(t,e,n){var r=!0;switch(e){case a.Clipper.NodeType.ntOpen:return;case a.Clipper.NodeType.ntClosed:r=!t.IsOpen}t.m_polygon.length>0&&r&&n.push(t.m_polygon);for(var i=0,o=t.Childs(),s=o.length,u=o[i];i<s;u=o[++i])a.Clipper.AddPolyNodeToPaths(u,e,n)},a.Clipper.OpenPathsFromPolyTree=function(t){for(var e=new a.Paths,n=0,r=t.ChildCount();n<r;n++)t.Childs()[n].IsOpen&&e.push(t.Childs()[n].m_polygon);return e},a.Clipper.ClosedPathsFromPolyTree=function(t){var e=new a.Paths;return a.Clipper.AddPolyNodeToPaths(t,a.Clipper.NodeType.ntClosed,e),e},D(a.Clipper,a.ClipperBase),a.Clipper.NodeType={ntAny:0,ntOpen:1,ntClosed:2},a.ClipperOffset=function(t,e){void 0===t&&(t=2),void 0===e&&(e=a.ClipperOffset.def_arc_tolerance),this.m_destPolys=new a.Paths,this.m_srcPoly=new a.Path,this.m_destPoly=new a.Path,this.m_normals=new Array,this.m_delta=0,this.m_sinA=0,this.m_sin=0,this.m_cos=0,this.m_miterLim=0,this.m_StepsPerRad=0,this.m_lowest=new a.IntPoint0,this.m_polyNodes=new a.PolyNode,this.MiterLimit=t,this.ArcTolerance=e,this.m_lowest.X=-1},a.ClipperOffset.two_pi=6.28318530717959,a.ClipperOffset.def_arc_tolerance=.25,a.ClipperOffset.prototype.Clear=function(){a.Clear(this.m_polyNodes.Childs()),this.m_lowest.X=-1},a.ClipperOffset.Round=a.Clipper.Round,a.ClipperOffset.prototype.AddPath=function(t,e,n){var r=t.length-1;if(!(r<0)){var i=new a.PolyNode;if(i.m_jointype=e,i.m_endtype=n,n===a.EndType.etClosedLine||n===a.EndType.etClosedPolygon)for(;r>0&&a.IntPoint.op_Equality(t[0],t[r]);)r--;i.m_polygon.push(t[0]);for(var o=0,s=0,u=1;u<=r;u++)a.IntPoint.op_Inequality(i.m_polygon[o],t[u])&&(o++,i.m_polygon.push(t[u]),(t[u].Y>i.m_polygon[s].Y||t[u].Y===i.m_polygon[s].Y&&t[u].X<i.m_polygon[s].X)&&(s=o));if(!(n===a.EndType.etClosedPolygon&&o<2)&&(this.m_polyNodes.AddChild(i),n===a.EndType.etClosedPolygon))if(this.m_lowest.X<0)this.m_lowest=new a.IntPoint2(this.m_polyNodes.ChildCount()-1,s);else{var l=this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon[this.m_lowest.Y];(i.m_polygon[s].Y>l.Y||i.m_polygon[s].Y===l.Y&&i.m_polygon[s].X<l.X)&&(this.m_lowest=new a.IntPoint2(this.m_polyNodes.ChildCount()-1,s))}}},a.ClipperOffset.prototype.AddPaths=function(t,e,n){for(var r=0,i=t.length;r<i;r++)this.AddPath(t[r],e,n)},a.ClipperOffset.prototype.FixOrientations=function(){if(this.m_lowest.X>=0&&!a.Clipper.Orientation(this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon))for(var t=0;t<this.m_polyNodes.ChildCount();t++){((e=this.m_polyNodes.Childs()[t]).m_endtype===a.EndType.etClosedPolygon||e.m_endtype===a.EndType.etClosedLine&&a.Clipper.Orientation(e.m_polygon))&&e.m_polygon.reverse()}else for(t=0;t<this.m_polyNodes.ChildCount();t++){var e;(e=this.m_polyNodes.Childs()[t]).m_endtype!==a.EndType.etClosedLine||a.Clipper.Orientation(e.m_polygon)||e.m_polygon.reverse()}},a.ClipperOffset.GetUnitNormal=function(t,e){var n=e.X-t.X,r=e.Y-t.Y;if(0===n&&0===r)return new a.DoublePoint2(0,0);var i=1/Math.sqrt(n*n+r*r);return n*=i,r*=i,new a.DoublePoint2(r,-n)},a.ClipperOffset.prototype.DoOffset=function(t){if(this.m_destPolys=new Array,this.m_delta=t,a.ClipperBase.near_zero(t))for(var e=0;e<this.m_polyNodes.ChildCount();e++){(i=this.m_polyNodes.Childs()[e]).m_endtype===a.EndType.etClosedPolygon&&this.m_destPolys.push(i.m_polygon)}else{var n;this.MiterLimit>2?this.m_miterLim=2/(this.MiterLimit*this.MiterLimit):this.m_miterLim=.5,n=this.ArcTolerance<=0?a.ClipperOffset.def_arc_tolerance:this.ArcTolerance>Math.abs(t)*a.ClipperOffset.def_arc_tolerance?Math.abs(t)*a.ClipperOffset.def_arc_tolerance:this.ArcTolerance;var r=3.14159265358979/Math.acos(1-n/Math.abs(t));this.m_sin=Math.sin(a.ClipperOffset.two_pi/r),this.m_cos=Math.cos(a.ClipperOffset.two_pi/r),this.m_StepsPerRad=r/a.ClipperOffset.two_pi,t<0&&(this.m_sin=-this.m_sin);for(e=0;e<this.m_polyNodes.ChildCount();e++){var i=this.m_polyNodes.Childs()[e];this.m_srcPoly=i.m_polygon;var o=this.m_srcPoly.length;if(!(0===o||t<=0&&(o<3||i.m_endtype!==a.EndType.etClosedPolygon)))if(this.m_destPoly=new Array,1!==o){this.m_normals.length=0;for(p=0;p<o-1;p++)this.m_normals.push(a.ClipperOffset.GetUnitNormal(this.m_srcPoly[p],this.m_srcPoly[p+1]));if(i.m_endtype===a.EndType.etClosedLine||i.m_endtype===a.EndType.etClosedPolygon?this.m_normals.push(a.ClipperOffset.GetUnitNormal(this.m_srcPoly[o-1],this.m_srcPoly[0])):this.m_normals.push(new a.DoublePoint1(this.m_normals[o-2])),i.m_endtype===a.EndType.etClosedPolygon){var s=o-1;for(p=0;p<o;p++)s=this.OffsetPoint(p,s,i.m_jointype);this.m_destPolys.push(this.m_destPoly)}else if(i.m_endtype===a.EndType.etClosedLine){for(s=o-1,p=0;p<o;p++)s=this.OffsetPoint(p,s,i.m_jointype);this.m_destPolys.push(this.m_destPoly),this.m_destPoly=new Array;var u=this.m_normals[o-1];for(p=o-1;p>0;p--)this.m_normals[p]=new a.DoublePoint2(-this.m_normals[p-1].X,-this.m_normals[p-1].Y);this.m_normals[0]=new a.DoublePoint2(-u.X,-u.Y),s=0;for(p=o-1;p>=0;p--)s=this.OffsetPoint(p,s,i.m_jointype);this.m_destPolys.push(this.m_destPoly)}else{var l;for(s=0,p=1;p<o-1;++p)s=this.OffsetPoint(p,s,i.m_jointype);if(i.m_endtype===a.EndType.etOpenButt){p=o-1;l=new a.IntPoint2(a.ClipperOffset.Round(this.m_srcPoly[p].X+this.m_normals[p].X*t),a.ClipperOffset.Round(this.m_srcPoly[p].Y+this.m_normals[p].Y*t)),this.m_destPoly.push(l),l=new a.IntPoint2(a.ClipperOffset.Round(this.m_srcPoly[p].X-this.m_normals[p].X*t),a.ClipperOffset.Round(this.m_srcPoly[p].Y-this.m_normals[p].Y*t)),this.m_destPoly.push(l)}else{p=o-1;s=o-2,this.m_sinA=0,this.m_normals[p]=new a.DoublePoint2(-this.m_normals[p].X,-this.m_normals[p].Y),i.m_endtype===a.EndType.etOpenSquare?this.DoSquare(p,s):this.DoRound(p,s)}for(p=o-1;p>0;p--)this.m_normals[p]=new a.DoublePoint2(-this.m_normals[p-1].X,-this.m_normals[p-1].Y);this.m_normals[0]=new a.DoublePoint2(-this.m_normals[1].X,-this.m_normals[1].Y);for(p=(s=o-1)-1;p>0;--p)s=this.OffsetPoint(p,s,i.m_jointype);i.m_endtype===a.EndType.etOpenButt?(l=new a.IntPoint2(a.ClipperOffset.Round(this.m_srcPoly[0].X-this.m_normals[0].X*t),a.ClipperOffset.Round(this.m_srcPoly[0].Y-this.m_normals[0].Y*t)),this.m_destPoly.push(l),l=new a.IntPoint2(a.ClipperOffset.Round(this.m_srcPoly[0].X+this.m_normals[0].X*t),a.ClipperOffset.Round(this.m_srcPoly[0].Y+this.m_normals[0].Y*t)),this.m_destPoly.push(l)):(s=1,this.m_sinA=0,i.m_endtype===a.EndType.etOpenSquare?this.DoSquare(0,1):this.DoRound(0,1)),this.m_destPolys.push(this.m_destPoly)}}else{if(i.m_jointype===a.JoinType.jtRound)for(var c=1,h=0,p=1;p<=r;p++){this.m_destPoly.push(new a.IntPoint2(a.ClipperOffset.Round(this.m_srcPoly[0].X+c*t),a.ClipperOffset.Round(this.m_srcPoly[0].Y+h*t)));var f=c;c=c*this.m_cos-this.m_sin*h,h=f*this.m_sin+h*this.m_cos}else{c=-1,h=-1;for(var p=0;p<4;++p)this.m_destPoly.push(new a.IntPoint2(a.ClipperOffset.Round(this.m_srcPoly[0].X+c*t),a.ClipperOffset.Round(this.m_srcPoly[0].Y+h*t))),c<0?c=1:h<0?h=1:c=-1}this.m_destPolys.push(this.m_destPoly)}}}},a.ClipperOffset.prototype.Execute=function(){var t=arguments;if(t[0]instanceof a.PolyTree){o=t[1];if((i=t[0]).Clear(),this.FixOrientations(),this.DoOffset(o),(r=new a.Clipper(0)).AddPaths(this.m_destPolys,a.PolyType.ptSubject,!0),o>0)r.Execute(a.ClipType.ctUnion,i,a.PolyFillType.pftPositive,a.PolyFillType.pftPositive);else{u=a.Clipper.GetBounds(this.m_destPolys);if((s=new a.Path).push(new a.IntPoint2(u.left-10,u.bottom+10)),s.push(new a.IntPoint2(u.right+10,u.bottom+10)),s.push(new a.IntPoint2(u.right+10,u.top-10)),s.push(new a.IntPoint2(u.left-10,u.top-10)),r.AddPath(s,a.PolyType.ptSubject,!0),r.ReverseSolution=!0,r.Execute(a.ClipType.ctUnion,i,a.PolyFillType.pftNegative,a.PolyFillType.pftNegative),1===i.ChildCount()&&i.Childs()[0].ChildCount()>0){var e=i.Childs()[0];i.Childs()[0]=e.Childs()[0],i.Childs()[0].m_Parent=i;for(var n=1;n<e.ChildCount();n++)i.AddChild(e.Childs()[n])}else i.Clear()}}else{var r,i=t[0],o=t[1];if(a.Clear(i),this.FixOrientations(),this.DoOffset(o),(r=new a.Clipper(0)).AddPaths(this.m_destPolys,a.PolyType.ptSubject,!0),o>0)r.Execute(a.ClipType.ctUnion,i,a.PolyFillType.pftPositive,a.PolyFillType.pftPositive);else{var s,u=a.Clipper.GetBounds(this.m_destPolys);(s=new a.Path).push(new a.IntPoint2(u.left-10,u.bottom+10)),s.push(new a.IntPoint2(u.right+10,u.bottom+10)),s.push(new a.IntPoint2(u.right+10,u.top-10)),s.push(new a.IntPoint2(u.left-10,u.top-10)),r.AddPath(s,a.PolyType.ptSubject,!0),r.ReverseSolution=!0,r.Execute(a.ClipType.ctUnion,i,a.PolyFillType.pftNegative,a.PolyFillType.pftNegative),i.length>0&&i.splice(0,1)}}},a.ClipperOffset.prototype.OffsetPoint=function(t,e,n){if(this.m_sinA=this.m_normals[e].X*this.m_normals[t].Y-this.m_normals[t].X*this.m_normals[e].Y,Math.abs(this.m_sinA*this.m_delta)<1){if(this.m_normals[e].X*this.m_normals[t].X+this.m_normals[t].Y*this.m_normals[e].Y>0)return this.m_destPoly.push(new a.IntPoint2(a.ClipperOffset.Round(this.m_srcPoly[t].X+this.m_normals[e].X*this.m_delta),a.ClipperOffset.Round(this.m_srcPoly[t].Y+this.m_normals[e].Y*this.m_delta))),e}else this.m_sinA>1?this.m_sinA=1:this.m_sinA<-1&&(this.m_sinA=-1);if(this.m_sinA*this.m_delta<0)this.m_destPoly.push(new a.IntPoint2(a.ClipperOffset.Round(this.m_srcPoly[t].X+this.m_normals[e].X*this.m_delta),a.ClipperOffset.Round(this.m_srcPoly[t].Y+this.m_normals[e].Y*this.m_delta))),this.m_destPoly.push(new a.IntPoint1(this.m_srcPoly[t])),this.m_destPoly.push(new a.IntPoint2(a.ClipperOffset.Round(this.m_srcPoly[t].X+this.m_normals[t].X*this.m_delta),a.ClipperOffset.Round(this.m_srcPoly[t].Y+this.m_normals[t].Y*this.m_delta)));else switch(n){case a.JoinType.jtMiter:var r=this.m_normals[t].X*this.m_normals[e].X+this.m_normals[t].Y*this.m_normals[e].Y+1;r>=this.m_miterLim?this.DoMiter(t,e,r):this.DoSquare(t,e);break;case a.JoinType.jtSquare:this.DoSquare(t,e);break;case a.JoinType.jtRound:this.DoRound(t,e)}return e=t},a.ClipperOffset.prototype.DoSquare=function(t,e){var n=Math.tan(Math.atan2(this.m_sinA,this.m_normals[e].X*this.m_normals[t].X+this.m_normals[e].Y*this.m_normals[t].Y)/4);this.m_destPoly.push(new a.IntPoint2(a.ClipperOffset.Round(this.m_srcPoly[t].X+this.m_delta*(this.m_normals[e].X-this.m_normals[e].Y*n)),a.ClipperOffset.Round(this.m_srcPoly[t].Y+this.m_delta*(this.m_normals[e].Y+this.m_normals[e].X*n)))),this.m_destPoly.push(new a.IntPoint2(a.ClipperOffset.Round(this.m_srcPoly[t].X+this.m_delta*(this.m_normals[t].X+this.m_normals[t].Y*n)),a.ClipperOffset.Round(this.m_srcPoly[t].Y+this.m_delta*(this.m_normals[t].Y-this.m_normals[t].X*n))))},a.ClipperOffset.prototype.DoMiter=function(t,e,n){var r=this.m_delta/n;this.m_destPoly.push(new a.IntPoint2(a.ClipperOffset.Round(this.m_srcPoly[t].X+(this.m_normals[e].X+this.m_normals[t].X)*r),a.ClipperOffset.Round(this.m_srcPoly[t].Y+(this.m_normals[e].Y+this.m_normals[t].Y)*r)))},a.ClipperOffset.prototype.DoRound=function(t,e){for(var n,r=Math.atan2(this.m_sinA,this.m_normals[e].X*this.m_normals[t].X+this.m_normals[e].Y*this.m_normals[t].Y),i=Math.max(a.Cast_Int32(a.ClipperOffset.Round(this.m_StepsPerRad*Math.abs(r))),1),o=this.m_normals[e].X,s=this.m_normals[e].Y,u=0;u<i;++u)this.m_destPoly.push(new a.IntPoint2(a.ClipperOffset.Round(this.m_srcPoly[t].X+o*this.m_delta),a.ClipperOffset.Round(this.m_srcPoly[t].Y+s*this.m_delta))),n=o,o=o*this.m_cos-this.m_sin*s,s=n*this.m_sin+s*this.m_cos;this.m_destPoly.push(new a.IntPoint2(a.ClipperOffset.Round(this.m_srcPoly[t].X+this.m_normals[t].X*this.m_delta),a.ClipperOffset.Round(this.m_srcPoly[t].Y+this.m_normals[t].Y*this.m_delta)))},a.Error=function(t){try{throw new Error(t)}catch(t){alert(t.message)}},a.JS={},a.JS.AreaOfPolygon=function(t,e){return e||(e=1),a.Clipper.Area(t)/(e*e)},a.JS.AreaOfPolygons=function(t,e){e||(e=1);for(var n=0,r=0;r<t.length;r++)n+=a.Clipper.Area(t[r]);return n/(e*e)},a.JS.BoundsOfPath=function(t,e){return a.JS.BoundsOfPaths([t],e)},a.JS.BoundsOfPaths=function(t,e){e||(e=1);var n=a.Clipper.GetBounds(t);return n.left/=e,n.bottom/=e,n.right/=e,n.top/=e,n},a.JS.Clean=function(t,e){if(!(t instanceof Array))return[];var n=t[0]instanceof Array;t=a.JS.Clone(t);if("number"!=typeof e||null===e)return a.Error("Delta is not a number in Clean()."),t;if(0===t.length||1===t.length&&0===t[0].length||e<0)return t;n||(t=[t]);for(var r,i,o,s,u,l,c,h=t.length,p=[],f=0;f<h;f++)if(0!==(r=(i=t[f]).length))if(r<3)o=i,p.push(o);else{for(o=i,s=e*e,u=i[0],l=1,c=1;c<r;c++)(i[c].X-u.X)*(i[c].X-u.X)+(i[c].Y-u.Y)*(i[c].Y-u.Y)<=s||(o[l]=i[c],u=i[c],l++);u=i[l-1],(i[0].X-u.X)*(i[0].X-u.X)+(i[0].Y-u.Y)*(i[0].Y-u.Y)<=s&&l--,l<r&&o.splice(l,r-l),o.length&&p.push(o)}return!n&&p.length?p=p[0]:n||0!==p.length?n&&0===p.length&&(p=[[]]):p=[],p},a.JS.Clone=function(t){if(!(t instanceof Array))return[];if(0===t.length)return[];if(1===t.length&&0===t[0].length)return[[]];var e=t[0]instanceof Array;e||(t=[t]);var n,r,i,o,a=t.length,s=new Array(a);for(r=0;r<a;r++){for(n=t[r].length,o=new Array(n),i=0;i<n;i++)o[i]={X:t[r][i].X,Y:t[r][i].Y};s[r]=o}return e||(s=s[0]),s},a.JS.Lighten=function(t,e){if(!(t instanceof Array))return[];if("number"!=typeof e||null===e)return a.Error("Tolerance is not a number in Lighten()."),a.JS.Clone(t);if(0===t.length||1===t.length&&0===t[0].length||e<0)return a.JS.Clone(t);var n,r,i,o,s,u,l,c,h,p,f,d,m,g,v,y,x=t[0]instanceof Array;x||(t=[t]);var _=t.length,b=e*e,w=[];for(n=0;n<_;n++)if(0!==(u=(i=t[n]).length)){for(o=0;o<1e6;o++){for(s=[],i[(u=i.length)-1].X!==i[0].X||i[u-1].Y!==i[0].Y?(f=1,i.push({X:i[0].X,Y:i[0].Y}),u=i.length):f=0,p=[],r=0;r<u-2;r++)l=i[r],h=i[r+1],c=i[r+2],v=l.X,y=l.Y,d=c.X-v,m=c.Y-y,0===d&&0===m||((g=((h.X-v)*d+(h.Y-y)*m)/(d*d+m*m))>1?(v=c.X,y=c.Y):g>0&&(v+=d*g,y+=m*g)),(d=h.X-v)*d+(m=h.Y-y)*m<=b&&(p[r+1]=1,r++);for(s.push({X:i[0].X,Y:i[0].Y}),r=1;r<u-1;r++)p[r]||s.push({X:i[r].X,Y:i[r].Y});if(s.push({X:i[u-1].X,Y:i[u-1].Y}),f&&i.pop(),!p.length)break;i=s}s[(u=s.length)-1].X===s[0].X&&s[u-1].Y===s[0].Y&&s.pop(),s.length>2&&w.push(s)}return x||(w=w[0]),void 0===w&&(w=[]),w},a.JS.PerimeterOfPath=function(t,e,n){if(void 0===t)return 0;var r,i,o=Math.sqrt,a=0,s=0,u=0,l=0,c=0,h=t.length;if(h<2)return 0;for(e&&(t[h]=t[0],h++);--h;)s=(r=t[h]).X,u=r.Y,a+=o((s-(l=(i=t[h-1]).X))*(s-l)+(u-(c=i.Y))*(u-c));return e&&t.pop(),a/n},a.JS.PerimeterOfPaths=function(t,e,n){n||(n=1);for(var r=0,i=0;i<t.length;i++)r+=a.JS.PerimeterOfPath(t[i],e,n);return r},a.JS.ScaleDownPath=function(t,e){var n,r;for(e||(e=1),n=t.length;n--;)(r=t[n]).X=r.X/e,r.Y=r.Y/e},a.JS.ScaleDownPaths=function(t,e){var n,r,i;for(e||(e=1),n=t.length;n--;)for(r=t[n].length;r--;)(i=t[n][r]).X=i.X/e,i.Y=i.Y/e},a.JS.ScaleUpPath=function(t,e){var n,r,i=Math.round;for(e||(e=1),n=t.length;n--;)(r=t[n]).X=i(r.X*e),r.Y=i(r.Y*e)},a.JS.ScaleUpPaths=function(t,e){var n,r,i,o=Math.round;for(e||(e=1),n=t.length;n--;)for(r=t[n].length;r--;)(i=t[n][r]).X=o(i.X*e),i.Y=o(i.Y*e)},a.ExPolygons=function(){return[]},a.ExPolygon=function(){this.outer=null,this.holes=null},a.JS.AddOuterPolyNodeToExPolygons=function(t,e){var n=new a.ExPolygon;n.outer=t.Contour();var r,i,o,s,u,l,c=t.Childs(),h=c.length;for(n.holes=new Array(h),o=0;o<h;o++)for(r=c[o],n.holes[o]=r.Contour(),s=0,l=(u=r.Childs()).length;s<l;s++)i=u[s],a.JS.AddOuterPolyNodeToExPolygons(i,e);e.push(n)},a.JS.ExPolygonsToPaths=function(t){var e,n,r,i,o=new a.Paths;for(e=0,r=t.length;e<r;e++)for(o.push(t[e].outer),n=0,i=t[e].holes.length;n<i;n++)o.push(t[e].holes[n]);return o},a.JS.PolyTreeToExPolygons=function(t){var e,n,r,i,o=new a.ExPolygons;for(n=0,i=(r=t.Childs()).length;n<i;n++)e=r[n],a.JS.AddOuterPolyNodeToExPolygons(e,o);return o}}()},28856:function(t){"use strict";var e;function n(t,e){return t.b===e.b&&t.a===e.a}function r(t,e){return t.b<e.b||t.b===e.b&&t.a<=e.a}function i(t,e,n){var r=e.b-t.b,i=n.b-e.b;return 0<r+i?r<i?e.a-t.a+r/(r+i)*(t.a-n.a):e.a-n.a+i/(r+i)*(n.a-t.a):0}function o(t,e,n){var r=e.b-t.b,i=n.b-e.b;return 0<r+i?(e.a-n.a)*r+(e.a-t.a)*i:0}function a(t,e){return t.a<e.a||t.a===e.a&&t.b<=e.b}function s(t,e,n){var r=e.a-t.a,i=n.a-e.a;return 0<r+i?r<i?e.b-t.b+r/(r+i)*(t.b-n.b):e.b-n.b+i/(r+i)*(n.b-t.b):0}function u(t,e,n){var r=e.a-t.a,i=n.a-e.a;return 0<r+i?(e.b-n.b)*r+(e.b-t.b)*i:0}function l(t){return r(t.b.a,t.a)}function c(t){return r(t.a,t.b.a)}function h(t,e,n,r){return(t=0>t?0:t)<=(n=0>n?0:n)?0===n?(e+r)/2:e+t/(t+n)*(r-e):r+n/(t+n)*(e-r)}function p(t){var e=v(t.b);return x(e,t.c),x(e.b,t.c),_(e,t.a),e}function f(t,e){var n=!1,r=!1;t!==e&&(e.a!==t.a&&(r=!0,w(e.a,t.a)),e.d!==t.d&&(n=!0,M(e.d,t.d)),y(e,t),r||(x(e,t.a),t.a.c=t),n||(_(e,t.d),t.d.a=t))}function d(t){var e=t.b,n=!1;t.d!==t.b.d&&(n=!0,M(t.d,t.b.d)),t.c===t?w(t.a,null):(t.b.d.a=$(t),t.a.c=t.c,y(t,$(t)),n||_(t,t.d)),e.c===e?(w(e.a,null),M(e.d,null)):(t.d.a=$(e),e.a.c=e.c,y(e,$(e))),b(t)}function m(t){var e=v(t),n=e.b;return y(e,t.e),e.a=t.b.a,x(n,e.a),e.d=n.d=t.d,e=e.b,y(t.b,$(t.b)),y(t.b,e),t.b.a=e.a,e.b.a.c=e.b,e.b.d=t.b.d,e.f=t.f,e.b.f=t.b.f,e}function g(t,e){var n=!1,r=v(t),i=r.b;return e.d!==t.d&&(n=!0,M(e.d,t.d)),y(r,t.e),y(i,e),r.a=t.b.a,i.a=e.a,r.d=i.d=t.d,t.d.a=i,n||_(r,t.d),r}function v(t){var e=new Q,n=new Q,r=t.b.h;return n.h=r,r.b.h=e,e.h=t,t.b.h=n,e.b=n,e.c=e,e.e=n,n.b=e,n.c=n,n.e=e}function y(t,e){var n=t.c,r=e.c;n.b.e=e,r.b.e=t,t.c=r,e.c=n}function x(t,e){var n=e.f,r=new et(e,n);n.e=r,e.f=r,n=r.c=t;do{n.a=r,n=n.c}while(n!==t)}function _(t,e){var n=e.d,r=new K(e,n);n.b=r,e.d=r,r.a=t,r.c=e.c,n=t;do{n.d=r,n=n.e}while(n!==t)}function b(t){var e=t.h;t=t.b.h,e.b.h=t,t.b.h=e}function w(t,e){var n=t.c,r=n;do{r.a=e,r=r.c}while(r!==n);n=t.f,(r=t.e).f=n,n.e=r}function M(t,e){var n=t.a,r=n;do{r.d=e,r=r.e}while(r!==n);n=t.d,(r=t.b).d=n,n.b=r}function S(t){var e=0;return Math.abs(t[1])>Math.abs(t[0])&&(e=1),Math.abs(t[2])>Math.abs(t[e])&&(e=2),e}var T=4e150;function E(t,e){t.f+=e.f,t.b.f+=e.b.f}function A(t,e,n){return t=t.a,e=e.a,n=n.a,e.b.a===t?n.b.a===t?r(e.a,n.a)?0>=o(n.b.a,e.a,n.a):0<=o(e.b.a,n.a,e.a):0>=o(n.b.a,t,n.a):n.b.a===t?0<=o(e.b.a,t,e.a):(e=i(e.b.a,t,e.a))>=(t=i(n.b.a,t,n.a))}function P(t){t.a.i=null;var e=t.e;e.a.c=e.c,e.c.a=e.a,t.e=null}function C(t,e){d(t.a),t.c=!1,t.a=e,e.i=t}function L(t){var e=t.a.a;do{t=ft(t)}while(t.a.a===e);return t.c&&(C(t,e=g(pt(t).a.b,t.a.e)),t=ft(t)),t}function I(t,e,n){var r=new ht;return r.a=n,r.e=H(t.f,e.e,r),n.i=r}function O(t,e){switch(t.s){case 100130:return 0!=(1&e);case 100131:return 0!==e;case 100132:return 0<e;case 100133:return 0>e;case 100134:return 2<=e||-2>=e}return!1}function N(t){var e=t.a,n=e.d;n.c=t.d,n.a=e,P(t)}function R(t,e,n){for(t=e,e=e.a;t!==n;){t.c=!1;var r=pt(t),i=r.a;if(i.a!==e.a){if(!r.c){N(t);break}C(r,i=g(e.c.b,i.b))}e.c!==i&&(f($(i),i),f(e,i)),N(t),e=r.a,t=r}return e}function D(t,e,n,r,i,o){var a=!0;do{I(t,e,n.b),n=n.c}while(n!==r);for(null===i&&(i=pt(e).a.b.c);(n=(r=pt(e)).a.b).a===i.a;)n.c!==i&&(f($(n),n),f($(i),n)),r.f=e.f-n.f,r.d=O(t,r.f),e.b=!0,!a&&U(t,e)&&(E(n,i),P(e),d(i)),a=!1,e=r,i=n;e.b=!0,o&&V(t,e)}function k(t,e,n,r,i){var o=[e.g[0],e.g[1],e.g[2]];e.d=null,e.d=t.o&&t.o(o,n,r,t.c)||null,null===e.d&&(i?t.n||(J(t,100156),t.n=!0):e.d=n[0])}function F(t,e,n){var r=[null,null,null,null];r[0]=e.a.d,r[1]=n.a.d,k(t,e.a,r,[.5,.5,0,0],!1),f(e,n)}function B(t,e,n,r,i){var o=Math.abs(e.b-t.b)+Math.abs(e.a-t.a),a=Math.abs(n.b-t.b)+Math.abs(n.a-t.a),s=i+1;r[i]=.5*a/(o+a),r[s]=.5*o/(o+a),t.g[0]+=r[i]*e.g[0]+r[s]*n.g[0],t.g[1]+=r[i]*e.g[1]+r[s]*n.g[1],t.g[2]+=r[i]*e.g[2]+r[s]*n.g[2]}function U(t,e){var i=pt(e),a=e.a,s=i.a;if(r(a.a,s.a)){if(0<o(s.b.a,a.a,s.a))return!1;if(n(a.a,s.a)){if(a.a!==s.a){i=t.e;var u=a.a.h;if(0<=u){var l=(i=i.b).d,c=i.e,h=i.c,p=h[u];l[p]=l[i.a],h[l[p]]=p,p<=--i.a&&(1>=p||r(c[l[p>>1]],c[l[p]])?lt(i,p):ct(i,p)),c[u]=null,h[u]=i.b,i.b=u}else for(i.c[-(u+1)]=null;0<i.a&&null===i.c[i.d[i.a-1]];)--i.a;F(t,$(s),a)}}else m(s.b),f(a,$(s)),e.b=i.b=!0}else{if(0>o(a.b.a,s.a,a.a))return!1;ft(e).b=e.b=!0,m(a.b),f($(s),a)}return!0}function z(t,e){var l=pt(e),c=e.a,p=l.a,d=c.a,g=p.a,v=c.b.a,y=p.b.a,x=new et;if(o(v,t.a,d),o(y,t.a,g),d===g||Math.min(d.a,v.a)>Math.max(g.a,y.a))return!1;if(r(d,g)){if(0<o(y,d,g))return!1}else if(0>o(v,g,d))return!1;var _,b,w=v,M=d,S=y,T=g;if(r(w,M)||(_=w,w=M,M=_),r(S,T)||(_=S,S=T,T=_),r(w,S)||(_=w,w=S,S=_,_=M,M=T,T=_),r(S,M)?r(M,T)?(0>(_=i(w,S,M))+(b=i(S,M,T))&&(_=-_,b=-b),x.b=h(_,S.b,b,M.b)):(0>(_=o(w,S,M))+(b=-o(w,T,M))&&(_=-_,b=-b),x.b=h(_,S.b,b,T.b)):x.b=(S.b+M.b)/2,a(w,M)||(_=w,w=M,M=_),a(S,T)||(_=S,S=T,T=_),a(w,S)||(_=w,w=S,S=_,_=M,M=T,T=_),a(S,M)?a(M,T)?(0>(_=s(w,S,M))+(b=s(S,M,T))&&(_=-_,b=-b),x.a=h(_,S.a,b,M.a)):(0>(_=u(w,S,M))+(b=-u(w,T,M))&&(_=-_,b=-b),x.a=h(_,S.a,b,T.a)):x.a=(S.a+M.a)/2,r(x,t.a)&&(x.b=t.a.b,x.a=t.a.a),w=r(d,g)?d:g,r(w,x)&&(x.b=w.b,x.a=w.a),n(x,d)||n(x,g))return U(t,e),!1;if(!n(v,t.a)&&0<=o(v,t.a,x)||!n(y,t.a)&&0>=o(y,t.a,x)){if(y===t.a)return m(c.b),f(p.b,c),c=pt(e=L(e)).a,R(t,pt(e),l),D(t,e,$(c),c,c,!0),!0;if(v===t.a){m(p.b),f(c.e,$(p)),g=(d=l=e).a.b.a;do{d=ft(d)}while(d.a.b.a===g);return d=pt(e=d).a.b.c,l.a=$(p),D(t,e,(p=R(t,l,null)).c,c.b.c,d,!0),!0}return 0<=o(v,t.a,x)&&(ft(e).b=e.b=!0,m(c.b),c.a.b=t.a.b,c.a.a=t.a.a),0>=o(y,t.a,x)&&(e.b=l.b=!0,m(p.b),p.a.b=t.a.b,p.a.a=t.a.a),!1}return m(c.b),m(p.b),f($(p),c),c.a.b=x.b,c.a.a=x.a,c.a.h=rt(t.e,c.a),c=c.a,p=[0,0,0,0],x=[d.d,v.d,g.d,y.d],c.g[0]=c.g[1]=c.g[2]=0,B(c,d,v,p,0),B(c,g,y,p,2),k(t,c,x,p,!0),ft(e).b=e.b=l.b=!0,!1}function V(t,e){for(var n=pt(e);;){for(;n.b;)e=n,n=pt(n);if(!e.b&&(n=e,null===(e=ft(e))||!e.b))break;e.b=!1;var i,a=e.a,s=n.a;if(i=a.b.a!==s.b.a)t:{var u=pt(i=e),l=i.a,c=u.a,h=void 0;if(r(l.b.a,c.b.a)){if(0>o(l.b.a,c.b.a,l.a)){i=!1;break t}ft(i).b=i.b=!0,h=m(l),f(c.b,h),h.d.c=i.d}else{if(0<o(c.b.a,l.b.a,c.a)){i=!1;break t}i.b=u.b=!0,h=m(c),f(l.e,c.b),h.b.d.c=i.d}i=!0}if(i&&(n.c?(P(n),d(s),s=(n=pt(e)).a):e.c&&(P(e),d(a),a=(e=ft(n)).a)),a.a!==s.a)if(a.b.a===s.b.a||e.c||n.c||a.b.a!==t.a&&s.b.a!==t.a)U(t,e);else if(z(t,e))break;a.a===s.a&&a.b.a===s.b.a&&(E(s,a),P(e),d(a),e=ft(n))}}function G(t,e){t.a=e;for(var i=e.c;null===i.i;)if((i=i.c)===e.c){i=t;var a=e;(l=new ht).a=a.c.b;var s=(h=i.f).a;do{s=s.a}while(null!==s.b&&!h.c(h.b,l,s.b));var u=pt(h=s.b),l=h.a;s=u.a;if(0===o(l.b.a,a,l.a))n((l=h.a).a,a)||n(l.b.a,a)||(m(l.b),h.c&&(d(l.c),h.c=!1),f(a.c,l),G(i,a));else{var c=r(s.b.a,l.b.a)?h:u;u=void 0;h.d||c.c?(u=c===h?g(a.c.b,l.e):g(s.b.c.b,a.c).b,c.c?C(c,u):(l=i,(h=I(i,h,u)).f=ft(h).f+h.a.f,h.d=O(l,h.f)),G(i,a)):D(i,h,a.c,a.c,null,!0)}return}if(h=(l=pt(i=L(i.i))).a,(l=R(t,l,null)).c===h){l=(h=l).c,s=pt(i),u=i.a,c=s.a;var h,p=!1;u.b.a!==c.b.a&&z(t,i),n(u.a,t.a)&&(f($(l),u),l=pt(i=L(i)).a,R(t,pt(i),s),p=!0),n(c.a,t.a)&&(f(h,$(c)),h=R(t,s,null),p=!0),p?D(t,i,h.c,l,l,!0):(a=r(c.a,u.a)?$(c):u,D(t,i,a=g(h.c.b,a),a.c,a.c,!1),a.b.i.c=!0,V(t,i))}else D(t,i,l.c,h,h,!0)}function j(t,e){var n=new ht,r=p(t.b);r.a.b=T,r.a.a=e,r.b.a.b=-T,r.b.a.a=e,t.a=r.b.a,n.a=r,n.f=0,n.d=!1,n.c=!1,n.h=!0,n.b=!1,r=H(r=t.f,r.a,n),n.e=r}function W(t){this.a=new X,this.b=t,this.c=A}function H(t,e,n){do{e=e.c}while(null!==e.b&&!t.c(t.b,e.b,n));return t=new X(n,e.a,e),e.a.c=t,e.a=t}function X(t,e,n){this.b=t||null,this.a=e||this,this.c=n||this}function Y(){this.d=q,this.p=this.b=this.q=null,this.j=[0,0,0],this.s=100130,this.n=!1,this.o=this.a=this.e=this.f=null,this.m=!1,this.c=this.r=this.i=this.k=this.l=this.h=null}var q=0;function Z(t,e){if(t.d!==e)for(;t.d!==e;)if(t.d<e)switch(t.d){case q:J(t,100151),t.u(null);break;case 1:J(t,100152),t.t()}else switch(t.d){case 2:J(t,100154),t.v();break;case 1:J(t,100153),t.w()}}function J(t,e){t.p&&t.p(e,t.c)}function K(t,e){this.b=t||this,this.d=e||this,this.a=null,this.c=!1}function Q(){this.h=this,this.i=this.d=this.a=this.e=this.c=this.b=null,this.f=0}function $(t){return t.b.e}function tt(){this.c=new et,this.a=new K,this.b=new Q,this.d=new Q,this.b.b=this.d,this.d.b=this.b}function et(t,e){this.e=t||this,this.f=e||this,this.d=this.c=null,this.g=[0,0,0],this.h=this.a=this.b=0}function nt(){this.c=[],this.d=null,this.a=0,this.e=!1,this.b=new ot}function rt(t,e){if(t.e){var n,r=t.b,i=++r.a;return 2*i>r.f&&(r.f*=2,r.c=at(r.c,r.f+1)),0===r.b?n=i:(n=r.b,r.b=r.c[r.b]),r.e[n]=e,r.c[n]=i,r.d[i]=n,r.h&&ct(r,i),n}return r=t.a++,t.c[r]=e,-(r+1)}function it(t){if(0===t.a)return ut(t.b);var e=t.c[t.d[t.a-1]];if(0!==t.b.a&&r(st(t.b),e))return ut(t.b);do{--t.a}while(0<t.a&&null===t.c[t.d[t.a-1]]);return e}function ot(){this.d=at([0],33),this.e=[null,null],this.c=[0,0],this.a=0,this.f=32,this.b=0,this.h=!1,this.d[1]=1}function at(t,e){for(var n=Array(e),r=0;r<t.length;r++)n[r]=t[r];for(;r<e;r++)n[r]=0;return n}function st(t){return t.e[t.d[1]]}function ut(t){var e=t.d,n=t.e,r=t.c,i=e[1],o=n[i];return 0<t.a&&(e[1]=e[t.a],r[e[1]]=1,n[i]=null,r[i]=t.b,t.b=i,0<--t.a&&lt(t,1)),o}function lt(t,e){for(var n=t.d,i=t.e,o=t.c,a=e,s=n[a];;){var u=a<<1;u<t.a&&r(i[n[u+1]],i[n[u]])&&(u+=1);var l=n[u];if(u>t.a||r(i[s],i[l])){n[a]=s,o[s]=a;break}n[a]=l,o[l]=a,a=u}}function ct(t,e){for(var n=t.d,i=t.e,o=t.c,a=e,s=n[a];;){var u=a>>1,l=n[u];if(0===u||r(i[l],i[s])){n[a]=s,o[s]=a;break}n[a]=l,o[l]=a,a=u}}function ht(){this.e=this.a=null,this.f=0,this.c=this.b=this.h=this.d=!1}function pt(t){return t.e.c.b}function ft(t){return t.e.a.b}(e=Y.prototype).x=function(){Z(this,q)},e.B=function(t,e){switch(t){case 100142:return;case 100140:switch(e){case 100130:case 100131:case 100132:case 100133:case 100134:return void(this.s=e)}break;case 100141:return void(this.m=!!e);default:return void J(this,100900)}J(this,100901)},e.y=function(t){switch(t){case 100142:return 0;case 100140:return this.s;case 100141:return this.m;default:J(this,100900)}return!1},e.A=function(t,e,n){this.j[0]=t,this.j[1]=e,this.j[2]=n},e.z=function(t,e){var n=e||null;switch(t){case 100100:case 100106:this.h=n;break;case 100104:case 100110:this.l=n;break;case 100101:case 100107:this.k=n;break;case 100102:case 100108:this.i=n;break;case 100103:case 100109:this.p=n;break;case 100105:case 100111:this.o=n;break;case 100112:this.r=n;break;default:J(this,100900)}},e.C=function(t,e){var n=!1,r=[0,0,0];Z(this,2);for(var i=0;3>i;++i){var o=t[i];-1e150>o&&(o=-1e150,n=!0),1e150<o&&(o=1e150,n=!0),r[i]=o}n&&J(this,100155),null===(n=this.q)?f(n=p(this.b),n.b):(m(n),n=n.e),n.a.d=e,n.a.g[0]=r[0],n.a.g[1]=r[1],n.a.g[2]=r[2],n.f=1,n.b.f=-1,this.q=n},e.u=function(t){Z(this,q),this.d=1,this.b=new tt,this.c=t},e.t=function(){Z(this,1),this.d=2,this.q=null},e.v=function(){Z(this,2),this.d=1},e.w=function(){Z(this,1),this.d=q;var t=!1,e=[h=this.j[0],i=this.j[1],s=this.j[2]];if(0===h&&0===i&&0===s){for(var i=[-2e150,-2e150,-2e150],a=[2e150,2e150,2e150],s=[],u=[],h=(t=this.b.c).e;h!==t;h=h.e)for(var p=0;3>p;++p){var f=h.g[p];f<a[p]&&(a[p]=f,u[p]=h),f>i[p]&&(i[p]=f,s[p]=h)}if(h=0,i[1]-a[1]>i[0]-a[0]&&(h=1),i[2]-a[2]>i[h]-a[h]&&(h=2),a[h]>=i[h])e[0]=0,e[1]=0,e[2]=1;else{for(i=0,a=u[h],s=s[h],u=[0,0,0],a=[a.g[0]-s.g[0],a.g[1]-s.g[1],a.g[2]-s.g[2]],p=[0,0,0],h=t.e;h!==t;h=h.e)p[0]=h.g[0]-s.g[0],p[1]=h.g[1]-s.g[1],p[2]=h.g[2]-s.g[2],u[0]=a[1]*p[2]-a[2]*p[1],u[1]=a[2]*p[0]-a[0]*p[2],u[2]=a[0]*p[1]-a[1]*p[0],(f=u[0]*u[0]+u[1]*u[1]+u[2]*u[2])>i&&(i=f,e[0]=u[0],e[1]=u[1],e[2]=u[2]);0>=i&&(e[0]=e[1]=e[2]=0,e[S(a)]=1)}t=!0}for(u=S(e),h=this.b.c,i=(u+1)%3,s=(u+2)%3,u=0<e[u]?1:-1,e=h.e;e!==h;e=e.e)e.b=e.g[i],e.a=u*e.g[s];if(t){for(e=0,h=(t=this.b.a).b;h!==t;h=h.b)if(!(0>=(i=h.a).f))do{e+=(i.a.b-i.b.a.b)*(i.a.a+i.b.a.a),i=i.e}while(i!==h.a);if(0>e)for(t=(e=this.b.c).e;t!==e;t=t.e)t.a=-t.a}for(this.n=!1,h=(e=this.b.b).h;h!==e;h=t)t=h.h,i=h.e,n(h.a,h.b.a)&&h.e.e!==h&&(F(this,i,h),d(h),i=(h=i).e),i.e===h&&(i!==h&&(i!==t&&i!==t.b||(t=t.h),d(i)),h!==t&&h!==t.b||(t=t.h),d(h));for(this.e=e=new nt,h=(t=this.b.c).e;h!==t;h=h.e)h.h=rt(e,h);for(function(t){t.d=[];for(var e=0;e<t.a;e++)t.d[e]=e;t.d.sort(function(t){return function(e,n){return r(t[e],t[n])?1:-1}}(t.c)),t.e=!0,function(t){for(var e=t.a;1<=e;--e)lt(t,e);t.h=!0}(t.b)}(e),this.f=new W(this),j(this,-T),j(this,T);null!==(e=it(this.e));){for(;;){t:if(h=this.e,0===h.a)t=st(h.b);else if(t=h.c[h.d[h.a-1]],0!==h.b.a&&(h=st(h.b),r(h,t))){t=h;break t}if(null===t||!n(t,e))break;t=it(this.e),F(this,e.c,t.c)}G(this,e)}for(this.a=this.f.a.a.b.a.a,e=0;null!==(t=this.f.a.a.b);)t.h||++e,P(t);for(this.f=null,(e=this.e).b=null,e.d=null,this.e=e.c=null,h=(e=this.b).a.b;h!==e.a;h=t)t=h.b,(h=h.a).e.e===h&&(E(h.c,h),d(h));if(!this.n){if(e=this.b,this.m)for(h=e.b.h;h!==e.b;h=t)t=h.h,h.b.d.c!==h.d.c?h.f=h.d.c?1:-1:d(h);else for(h=e.a.b;h!==e.a;h=t)if(t=h.b,h.c){for(h=h.a;r(h.b.a,h.a);h=h.c.b);for(;r(h.a,h.b.a);h=h.e);for(i=h.c.b,s=void 0;h.e!==i;)if(r(h.b.a,i.a)){for(;i.e!==h&&(l(i.e)||0>=o(i.a,i.b.a,i.e.b.a));)i=(s=g(i.e,i)).b;i=i.c.b}else{for(;i.e!==h&&(c(h.c.b)||0<=o(h.b.a,h.a,h.c.b.a));)h=(s=g(h,h.c.b)).b;h=h.e}for(;i.e.e!==h;)i=(s=g(i.e,i)).b}if(this.h||this.i||this.k||this.l)if(this.m){for(t=(e=this.b).a.b;t!==e.a;t=t.b)if(t.c){this.h&&this.h(2,this.c),h=t.a;do{this.k&&this.k(h.a.d,this.c),h=h.e}while(h!==t.a);this.i&&this.i(this.c)}}else{for(e=this.b,t=!!this.l,h=!1,i=-1,s=e.a.d;s!==e.a;s=s.d)if(s.c){h||(this.h&&this.h(4,this.c),h=!0),u=s.a;do{t&&(i!==(a=u.b.d.c?0:1)&&(i=a,this.l&&this.l(!!i,this.c))),this.k&&this.k(u.a.d,this.c),u=u.e}while(u!==s.a)}h&&this.i&&this.i(this.c)}if(this.r){for(h=(e=this.b).a.b;h!==e.a;h=t)if(t=h.b,!h.c){s=(i=h.a).e,u=void 0;do{s=(u=s).e,u.d=null,null===u.b.d&&(u.c===u?w(u.a,null):(u.a.c=u.c,y(u,$(u))),(a=u.b).c===a?w(a.a,null):(a.a.c=a.c,y(a,$(a))),b(u))}while(u!==i);i=h.d,(h=h.b).d=i,i.b=h}return this.r(this.b),void(this.c=this.b=null)}}this.b=this.c=null},this.libtess={GluTesselator:Y,windingRule:{GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},primitiveType:{GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6},errorType:{GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},gluEnum:{GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,GLU_INVALID_VALUE:100901,GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111}},Y.prototype.gluDeleteTess=Y.prototype.x,Y.prototype.gluTessProperty=Y.prototype.B,Y.prototype.gluGetTessProperty=Y.prototype.y,Y.prototype.gluTessNormal=Y.prototype.A,Y.prototype.gluTessCallback=Y.prototype.z,Y.prototype.gluTessVertex=Y.prototype.C,Y.prototype.gluTessBeginPolygon=Y.prototype.u,Y.prototype.gluTessBeginContour=Y.prototype.t,Y.prototype.gluTessEndContour=Y.prototype.v,Y.prototype.gluTessEndPolygon=Y.prototype.w,t.exports=this.libtess},72564:function(__unused_webpack_module,exports,__webpack_require__){"use strict";var numeric=exports;void 0!==__webpack_require__.g&&(__webpack_require__.g.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(t,e){var n,r,i;for(void 0===e&&(e=15),r=.5,n=new Date;;){for(i=r*=2;i>3;i-=4)t(),t(),t(),t();for(;i>0;)t(),i--;if(new Date-n>e)break}for(i=r;i>3;i-=4)t(),t(),t(),t();for(;i>0;)t(),i--;return 1e3*(3*r-1)/(new Date-n)},numeric._myIndexOf=function(t){var e,n=this.length;for(e=0;e<n;++e)if(this[e]===t)return e;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(t){function e(t){if(0===t)return"0";if(isNaN(t))return"NaN";if(t<0)return"-"+e(-t);if(isFinite(t)){var n=Math.floor(Math.log(t)/Math.log(10)),r=t/Math.pow(10,n),i=r.toPrecision(numeric.precision);return 10===parseFloat(i)&&(n++,i=(r=1).toPrecision(numeric.precision)),parseFloat(i).toString()+"e"+n.toString()}return"Infinity"}var n=[];return function t(r){var i;if(void 0===r)return n.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof r)return n.push('"'+r+'"'),!1;if("boolean"==typeof r)return n.push(r.toString()),!1;if("number"==typeof r){var o=e(r),a=r.toPrecision(numeric.precision),s=parseFloat(r.toString()).toString(),u=[o,a,s,parseFloat(a).toString(),parseFloat(s).toString()];for(i=1;i<u.length;i++)u[i].length<o.length&&(o=u[i]);return n.push(Array(numeric.precision+8-o.length).join(" ")+o),!1}if(null===r)return n.push("null"),!1;if("function"==typeof r){n.push(r.toString());var l=!1;for(i in r)r.hasOwnProperty(i)&&(l?n.push(",\n"):n.push("\n{"),l=!0,n.push(i),n.push(": \n"),t(r[i]));return l&&n.push("}\n"),!0}if(r instanceof Array){if(r.length>numeric.largeArray)return n.push("...Large Array..."),!0;l=!1;for(n.push("["),i=0;i<r.length;i++)i>0&&(n.push(","),l&&n.push("\n ")),l=t(r[i]);return n.push("]"),!0}for(i in n.push("{"),l=!1,r)r.hasOwnProperty(i)&&(l&&n.push(",\n"),l=!0,n.push(i),n.push(": \n"),t(r[i]));return n.push("}"),!0}(t),n.join("")},numeric.parseDate=function(t){return function t(e){if("string"==typeof e)return Date.parse(e.replace(/-/g,"/"));if(!(e instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var n,r=[];for(n=0;n<e.length;n++)r[n]=t(e[n]);return r}(t)},numeric.parseFloat=function(t){return function t(e){if("string"==typeof e)return parseFloat(e);if(!(e instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var n,r=[];for(n=0;n<e.length;n++)r[n]=t(e[n]);return r}(t)},numeric.parseCSV=function(t){var e,n,r,i=t.split("\n"),o=[],a=/(([^'",]*)|('[^']*')|("[^"]*")),/g,s=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,u=0;for(n=0;n<i.length;n++){var l,c=(i[n]+",").match(a);if(c.length>0){for(o[u]=[],e=0;e<c.length;e++)l=(r=c[e]).substr(0,r.length-1),s.test(l)?o[u][e]=parseFloat(l):o[u][e]=l;u++}}return o},numeric.toCSV=function(t){var e,n,r,i,o,a=numeric.dim(t);for(r=a[0],a[1],o=[],e=0;e<r;e++){for(i=[],n=0;n<r;n++)i[n]=t[e][n].toString();o[e]=i.join(", ")}return o.join("\n")+"\n"},numeric.getURL=function(t){var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(),e},numeric.imageURL=function(t){function e(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.length);var r,i=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],o=-1;t.length;for(r=e;r<n;r++)o=o>>>8^i[255&(o^t[r])];return-1^o}var n,r,i,o,a,s,u,l,c,h,p=t[0].length,f=t[0][0].length,d=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,f>>24&255,f>>16&255,f>>8&255,255&f,p>>24&255,p>>16&255,p>>8&255,255&p,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(h=e(d,12,29),d[29]=h>>24&255,d[30]=h>>16&255,d[31]=h>>8&255,d[32]=255&h,n=1,r=0,u=0;u<p;u++){for(u<p-1?d.push(0):d.push(1),a=3*f+1+(0===u)&255,s=3*f+1+(0===u)>>8&255,d.push(a),d.push(s),d.push(255&~a),d.push(255&~s),0===u&&d.push(0),l=0;l<f;l++)for(i=0;i<3;i++)r=(r+(n=(n+(a=(a=t[i][u][l])>255?255:a<0?0:Math.round(a)))%65521))%65521,d.push(a);d.push(0)}return c=(r<<16)+n,d.push(c>>24&255),d.push(c>>16&255),d.push(c>>8&255),d.push(255&c),o=d.length-41,d[33]=o>>24&255,d[34]=o>>16&255,d[35]=o>>8&255,d[36]=255&o,h=e(d,37),d.push(h>>24&255),d.push(h>>16&255),d.push(h>>8&255),d.push(255&h),d.push(0),d.push(0),d.push(0),d.push(0),d.push(73),d.push(69),d.push(78),d.push(68),d.push(174),d.push(66),d.push(96),d.push(130),"data:image/png;base64,"+function(t){var e,n,r,i,o,a,s,u=t.length,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="";for(e=0;e<u;e+=3)o=((3&(n=t[e]))<<4)+((r=t[e+1])>>4),a=((15&r)<<2)+((i=t[e+2])>>6),s=63&i,e+1>=u?a=s=64:e+2>=u&&(s=64),c+=l.charAt(n>>2)+l.charAt(o)+l.charAt(a)+l.charAt(s);return c}(d)},numeric._dim=function(t){for(var e=[];"object"==typeof t;)e.push(t.length),t=t[0];return e},numeric.dim=function(t){var e;return"object"==typeof t?"object"==typeof(e=t[0])?"object"==typeof e[0]?numeric._dim(t):[t.length,e.length]:[t.length]:[]},numeric.mapreduce=function(t,e){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+e+';\nif(typeof x === "number") { var xi = x; '+t+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+t+";\n    xi = x[i-1];\n    "+t+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+t+"\n}\nreturn accum;")},numeric.mapreduce2=function(t,e){return Function("x","var n = x.length;\nvar i,xi;\n"+e+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+t+";\n}\nreturn accum;")},numeric.same=function t(e,n){var r,i;if(!(e instanceof Array&&n instanceof Array))return!1;if((i=e.length)!==n.length)return!1;for(r=0;r<i;r++)if(e[r]!==n[r]){if("object"!=typeof e[r])return!1;if(!t(e[r],n[r]))return!1}return!0},numeric.rep=function(t,e,n){void 0===n&&(n=0);var r,i=t[n],o=Array(i);if(n===t.length-1){for(r=i-2;r>=0;r-=2)o[r+1]=e,o[r]=e;return-1===r&&(o[0]=e),o}for(r=i-1;r>=0;r--)o[r]=numeric.rep(t,e,n+1);return o},numeric.dotMMsmall=function(t,e){var n,r,i,o,a,s,u,l,c,h,p;for(o=t.length,a=e.length,s=e[0].length,u=Array(o),n=o-1;n>=0;n--){for(l=Array(s),c=t[n],i=s-1;i>=0;i--){for(h=c[a-1]*e[a-1][i],r=a-2;r>=1;r-=2)p=r-1,h+=c[r]*e[r][i]+c[p]*e[p][i];0===r&&(h+=c[0]*e[0][i]),l[i]=h}u[n]=l}return u},numeric._getCol=function(t,e,n){var r;for(r=t.length-1;r>0;--r)n[r]=t[r][e],n[--r]=t[r][e];0===r&&(n[0]=t[0][e])},numeric.dotMMbig=function(t,e){var n,r,i,o=numeric._getCol,a=e.length,s=Array(a),u=t.length,l=e[0].length,c=new Array(u),h=numeric.dotVV;for(--a,r=--u;-1!==r;--r)c[r]=Array(l);for(r=--l;-1!==r;--r)for(o(e,r,s),i=u;-1!==i;--i)0,n=t[i],c[i][r]=h(n,s);return c},numeric.dotMV=function(t,e){var n,r=t.length,i=(e.length,Array(r)),o=numeric.dotVV;for(n=r-1;n>=0;n--)i[n]=o(t[n],e);return i},numeric.dotVM=function(t,e){var n,r,i,o,a,s,u;for(i=t.length,o=e[0].length,a=Array(o),r=o-1;r>=0;r--){for(s=t[i-1]*e[i-1][r],n=i-2;n>=1;n-=2)u=n-1,s+=t[n]*e[n][r]+t[u]*e[u][r];0===n&&(s+=t[0]*e[0][r]),a[r]=s}return a},numeric.dotVV=function(t,e){var n,r,i=t.length,o=t[i-1]*e[i-1];for(n=i-2;n>=1;n-=2)r=n-1,o+=t[n]*e[n]+t[r]*e[r];return 0===n&&(o+=t[0]*e[0]),o},numeric.dot=function(t,e){var n=numeric.dim;switch(1e3*n(t).length+n(e).length){case 2002:return e.length<10?numeric.dotMMsmall(t,e):numeric.dotMMbig(t,e);case 2001:return numeric.dotMV(t,e);case 1002:return numeric.dotVM(t,e);case 1001:return numeric.dotVV(t,e);case 1e3:return numeric.mulVS(t,e);case 1:return numeric.mulSV(t,e);case 0:return t*e;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(t){var e,n,r,i,o=t.length,a=Array(o);for(e=o-1;e>=0;e--){for(i=Array(o),n=e+2,r=o-1;r>=n;r-=2)i[r]=0,i[r-1]=0;for(r>e&&(i[r]=0),i[e]=t[e],r=e-1;r>=1;r-=2)i[r]=0,i[r-1]=0;0===r&&(i[0]=0),a[e]=i}return a},numeric.getDiag=function(t){var e,n=Math.min(t.length,t[0].length),r=Array(n);for(e=n-1;e>=1;--e)r[e]=t[e][e],r[--e]=t[e][e];return 0===e&&(r[0]=t[0][0]),r},numeric.identity=function(t){return numeric.diag(numeric.rep([t],1))},numeric.pointwise=function(t,e,n){void 0===n&&(n="");var r,i,o=[],a=/\[i\]$/,s="",u=!1;for(r=0;r<t.length;r++)a.test(t[r])?s=i=t[r].substring(0,t[r].length-3):i=t[r],"ret"===i&&(u=!0),o.push(i);return o[t.length]="_s",o[t.length+1]="_k",o[t.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+s+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(u?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+t.join(",")+",_s,_k+1);\n    return ret;\n}\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n    "+e+"\n}\nreturn ret;",Function.apply(null,o)},numeric.pointwise2=function(t,e,n){void 0===n&&(n="");var r,i,o=[],a=/\[i\]$/,s="",u=!1;for(r=0;r<t.length;r++)a.test(t[r])?s=i=t[r].substring(0,t[r].length-3):i=t[r],"ret"===i&&(u=!0),o.push(i);return o[t.length]="var _n = "+s+".length;\nvar i"+(u?"":", ret = Array(_n)")+";\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n"+e+"\n}\nreturn ret;",Function.apply(null,o)},numeric._biforeach=function t(e,n,r,i,o){var a;if(i!==r.length-1)for(a=r[i]-1;a>=0;a--)t("object"==typeof e?e[a]:e,"object"==typeof n?n[a]:n,r,i+1,o);else o(e,n)},numeric._biforeach2=function t(e,n,r,i,o){if(i===r.length-1)return o(e,n);var a,s=r[i],u=Array(s);for(a=s-1;a>=0;--a)u[a]=t("object"==typeof e?e[a]:e,"object"==typeof n?n[a]:n,r,i+1,o);return u},numeric._foreach=function t(e,n,r,i){var o;if(r!==n.length-1)for(o=n[r]-1;o>=0;o--)t(e[o],n,r+1,i);else i(e)},numeric._foreach2=function t(e,n,r,i){if(r===n.length-1)return i(e);var o,a=n[r],s=Array(a);for(o=a-1;o>=0;o--)s[o]=t(e[o],n,r+1,i);return s},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var t,e;for(t=0;t<numeric.mathfuns2.length;++t)e=numeric.mathfuns2[t],numeric.ops2[e]=e;for(t in numeric.ops2)if(numeric.ops2.hasOwnProperty(t)){e=numeric.ops2[t];var n,r,i="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,t)?(i="var "+e+" = Math."+e+";\n",n=function(t,n,r){return t+" = "+e+"("+n+","+r+")"},r=function(t,n){return t+" = "+e+"("+t+","+n+")"}):(n=function(t,n,r){return t+" = "+n+" "+e+" "+r},r=numeric.opseq.hasOwnProperty(t+"eq")?function(t,n){return t+" "+e+"= "+n}:function(t,n){return t+" = "+t+" "+e+" "+n}),numeric[t+"VV"]=numeric.pointwise2(["x[i]","y[i]"],n("ret[i]","x[i]","y[i]"),i),numeric[t+"SV"]=numeric.pointwise2(["x","y[i]"],n("ret[i]","x","y[i]"),i),numeric[t+"VS"]=numeric.pointwise2(["x[i]","y"],n("ret[i]","x[i]","y"),i),numeric[t]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+t+"VV, VS = numeric."+t+"VS, SV = numeric."+t+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+r("x","y")+"\n}\nreturn x;\n"),numeric[e]=numeric[t],numeric[t+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],r("ret[i]","x[i]"),i),numeric[t+"eqS"]=numeric.pointwise2(["ret[i]","x"],r("ret[i]","x"),i),numeric[t+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+t+"eqV, S = numeric."+t+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(t=0;t<numeric.mathfuns2.length;++t)e=numeric.mathfuns2[t],delete numeric.ops2[e];for(t=0;t<numeric.mathfuns.length;++t)e=numeric.mathfuns[t],numeric.ops1[e]=e;for(t in numeric.ops1)numeric.ops1.hasOwnProperty(t)&&(i="",e=numeric.ops1[t],-1!==numeric.myIndexOf.call(numeric.mathfuns,t)&&Math.hasOwnProperty(e)&&(i="var "+e+" = Math."+e+";\n"),numeric[t+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+e+"(ret[i]);",i),numeric[t+"eq"]=Function("x",'if(typeof x !== "object") return '+e+"x\nvar i;\nvar V = numeric."+t+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[t+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+e+"(x[i]);",i),numeric[t]=Function("x",'if(typeof x !== "object") return '+e+"(x)\nvar i;\nvar V = numeric."+t+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(t=0;t<numeric.mathfuns.length;++t)e=numeric.mathfuns[t],delete numeric.ops1[e];for(t in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(t)&&(e=numeric.mapreducers[t],numeric[t+"V"]=numeric.mapreduce2(e[0],e[1]),numeric[t]=Function("x","s","k",e[1]+'if(typeof x !== "object") {    xi = x;\n'+e[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+t+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+e[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(t,e){return"object"==typeof t?"object"==typeof e?numeric.truncVV(t,e):numeric.truncVS(t,e):"object"==typeof e?numeric.truncSV(t,e):Math.round(t/e)*e},numeric.inv=function(t){var e,n,r,i,o,a,s,u=numeric.dim(t),l=Math.abs,c=u[0],h=u[1],p=numeric.clone(t),f=numeric.identity(c);for(a=0;a<h;++a){var d=-1,m=-1;for(o=a;o!==c;++o)(s=l(p[o][a]))>m&&(d=o,m=s);for(n=p[d],p[d]=p[a],p[a]=n,i=f[d],f[d]=f[a],f[a]=i,t=n[a],s=a;s!==h;++s)n[s]/=t;for(s=h-1;-1!==s;--s)i[s]/=t;for(o=c-1;-1!==o;--o)if(o!==a){for(e=p[o],r=f[o],t=e[a],s=a+1;s!==h;++s)e[s]-=n[s]*t;for(s=h-1;s>0;--s)r[s]-=i[s]*t,r[--s]-=i[s]*t;0===s&&(r[0]-=i[0]*t)}}return f},numeric.det=function(t){var e=numeric.dim(t);if(2!==e.length||e[0]!==e[1])throw new Error("numeric: det() only works on square matrices");var n,r,i,o,a,s,u,l,c=e[0],h=1,p=numeric.clone(t);for(r=0;r<c-1;r++){for(i=r,n=r+1;n<c;n++)Math.abs(p[n][r])>Math.abs(p[i][r])&&(i=n);for(i!==r&&(u=p[i],p[i]=p[r],p[r]=u,h*=-1),o=p[r],n=r+1;n<c;n++){for(s=(a=p[n])[r]/o[r],i=r+1;i<c-1;i+=2)l=i+1,a[i]-=o[i]*s,a[l]-=o[l]*s;i!==c&&(a[i]-=o[i]*s)}if(0===o[r])return 0;h*=o[r]}return h*p[r][r]},numeric.transpose=function(t){var e,n,r,i,o,a=t.length,s=t[0].length,u=Array(s);for(n=0;n<s;n++)u[n]=Array(a);for(e=a-1;e>=1;e-=2){for(i=t[e],r=t[e-1],n=s-1;n>=1;--n)(o=u[n])[e]=i[n],o[e-1]=r[n],(o=u[--n])[e]=i[n],o[e-1]=r[n];0===n&&((o=u[0])[e]=i[0],o[e-1]=r[0])}if(0===e){for(r=t[0],n=s-1;n>=1;--n)u[n][0]=r[n],u[--n][0]=r[n];0===n&&(u[0][0]=r[0])}return u},numeric.negtranspose=function(t){var e,n,r,i,o,a=t.length,s=t[0].length,u=Array(s);for(n=0;n<s;n++)u[n]=Array(a);for(e=a-1;e>=1;e-=2){for(i=t[e],r=t[e-1],n=s-1;n>=1;--n)(o=u[n])[e]=-i[n],o[e-1]=-r[n],(o=u[--n])[e]=-i[n],o[e-1]=-r[n];0===n&&((o=u[0])[e]=-i[0],o[e-1]=-r[0])}if(0===e){for(r=t[0],n=s-1;n>=1;--n)u[n][0]=-r[n],u[--n][0]=-r[n];0===n&&(u[0][0]=-r[0])}return u},numeric._random=function t(e,n){var r,i,o=e[n],a=Array(o);if(n===e.length-1){for(i=Math.random,r=o-1;r>=1;r-=2)a[r]=i(),a[r-1]=i();return 0===r&&(a[0]=i()),a}for(r=o-1;r>=0;r--)a[r]=t(e,n+1);return a},numeric.random=function(t){return numeric._random(t,0)},numeric.norm2=function(t){return Math.sqrt(numeric.norm2Squared(t))},numeric.linspace=function(t,e,n){if(void 0===n&&(n=Math.max(Math.round(e-t)+1,1)),n<2)return 1===n?[t]:[];var r,i=Array(n);for(r=--n;r>=0;r--)i[r]=(r*e+(n-r)*t)/n;return i},numeric.getBlock=function(t,e,n){var r=numeric.dim(t);return function t(i,o){var a,s=e[o],u=n[o]-s,l=Array(u);if(o===r.length-1){for(a=u;a>=0;a--)l[a]=i[a+s];return l}for(a=u;a>=0;a--)l[a]=t(i[a+s],o+1);return l}(t,0)},numeric.setBlock=function(t,e,n,r){var i=numeric.dim(t);return function t(r,o,a){var s,u=e[a],l=n[a]-u;if(a===i.length-1)for(s=l;s>=0;s--)r[s+u]=o[s];for(s=l;s>=0;s--)t(r[s+u],o[s],a+1)}(t,r,0),t},numeric.getRange=function(t,e,n){var r,i,o,a,s=e.length,u=n.length,l=Array(s);for(r=s-1;-1!==r;--r)for(l[r]=Array(u),o=l[r],a=t[e[r]],i=u-1;-1!==i;--i)o[i]=a[n[i]];return l},numeric.blockMatrix=function(t){var e=numeric.dim(t);if(e.length<4)return numeric.blockMatrix([t]);var n,r,i,o,a,s=e[0],u=e[1];for(n=0,r=0,i=0;i<s;++i)n+=t[i][0].length;for(o=0;o<u;++o)r+=t[0][o][0].length;var l=Array(n);for(i=0;i<n;++i)l[i]=Array(r);var c,h,p,f,d,m=0;for(i=0;i<s;++i){for(c=r,o=u-1;-1!==o;--o)for(c-=(a=t[i][o])[0].length,p=a.length-1;-1!==p;--p)for(d=a[p],h=l[m+p],f=d.length-1;-1!==f;--f)h[c+f]=d[f];m+=t[i][0].length}return l},numeric.tensor=function(t,e){if("number"==typeof t||"number"==typeof e)return numeric.mul(t,e);var n=numeric.dim(t),r=numeric.dim(e);if(1!==n.length||1!==r.length)throw new Error("numeric: tensor product is only defined for vectors");var i,o,a,s,u=n[0],l=r[0],c=Array(u);for(o=u-1;o>=0;o--){for(i=Array(l),s=t[o],a=l-1;a>=3;--a)i[a]=s*e[a],i[--a]=s*e[a],i[--a]=s*e[a],i[--a]=s*e[a];for(;a>=0;)i[a]=s*e[a],--a;c[o]=i}return c},numeric.T=function(t,e){this.x=t,this.y=e},numeric.t=function(t,e){return new numeric.T(t,e)},numeric.Tbinop=function(t,e,n,r,i){var o;numeric.indexOf;if("string"!=typeof i)for(o in i="",numeric)numeric.hasOwnProperty(o)&&(t.indexOf(o)>=0||e.indexOf(o)>=0||n.indexOf(o)>=0||r.indexOf(o)>=0)&&o.length>1&&(i+="var "+o+" = numeric."+o+";\n");return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+i+"\nif(x.y) {  if(y.y) {    return new numeric.T("+r+");\n  }\n  return new numeric.T("+n+");\n}\nif(y.y) {\n  return new numeric.T("+e+");\n}\nreturn new numeric.T("+t+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var t=numeric.mul,e=numeric.div;if(this.y){var n=numeric.add(t(this.x,this.x),t(this.y,this.y));return new numeric.T(e(this.x,n),e(numeric.neg(this.y),n))}return new T(e(1,this.x))},numeric.T.prototype.div=function(t){if(t instanceof numeric.T||(t=new numeric.T(t)),t.y)return this.mul(t.reciprocal());var e=numeric.div;return this.y?new numeric.T(e(this.x,t.x),e(this.y,t.x)):new numeric.T(e(this.x,t.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var t=numeric.transpose,e=this.x,n=this.y;return n?new numeric.T(t(e),t(n)):new numeric.T(t(e))},numeric.T.prototype.transjugate=function(){var t=numeric.transpose,e=this.x,n=this.y;return n?new numeric.T(t(e),numeric.negtranspose(n)):new numeric.T(t(e))},numeric.Tunop=function(t,e,n){return"string"!=typeof n&&(n=""),Function("var x = this;\n"+n+"\nif(x.y) {  "+e+";\n}\n"+t+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var t=this;if(void 0===t.y)return new numeric.T(numeric.inv(t.x));var e,n,r,i,o,a,s,u,l,c,h,p,f,d,m,g,v,y,x=t.x.length,_=numeric.identity(x),b=numeric.rep([x,x],0),w=numeric.clone(t.x),M=numeric.clone(t.y);for(l=0;l<x;l++){for(p=(d=w[l][l])*d+(m=M[l][l])*m,h=l,c=l+1;c<x;c++)(f=(d=w[c][l])*d+(m=M[c][l])*m)>p&&(h=c,p=f);for(h!==l&&(y=w[l],w[l]=w[h],w[h]=y,y=M[l],M[l]=M[h],M[h]=y,y=_[l],_[l]=_[h],_[h]=y,y=b[l],b[l]=b[h],b[h]=y),e=w[l],n=M[l],o=_[l],a=b[l],d=e[l],m=n[l],c=l+1;c<x;c++)g=e[c],v=n[c],e[c]=(g*d+v*m)/p,n[c]=(v*d-g*m)/p;for(c=0;c<x;c++)g=o[c],v=a[c],o[c]=(g*d+v*m)/p,a[c]=(v*d-g*m)/p;for(c=l+1;c<x;c++){for(r=w[c],i=M[c],s=_[c],u=b[c],d=r[l],m=i[l],h=l+1;h<x;h++)g=e[h],v=n[h],r[h]-=g*d-v*m,i[h]-=v*d+g*m;for(h=0;h<x;h++)g=o[h],v=a[h],s[h]-=g*d-v*m,u[h]-=v*d+g*m}}for(l=x-1;l>0;l--)for(o=_[l],a=b[l],c=l-1;c>=0;c--)for(s=_[c],u=b[c],d=w[c][l],m=M[c][l],h=x-1;h>=0;h--)g=o[h],v=a[h],s[h]-=d*g-m*v,u[h]-=d*v+m*g;return new numeric.T(_,b)},numeric.T.prototype.get=function(t){var e,n=this.x,r=this.y,i=0,o=t.length;if(r){for(;i<o;)n=n[e=t[i]],r=r[e],i++;return new numeric.T(n,r)}for(;i<o;)n=n[e=t[i]],i++;return new numeric.T(n)},numeric.T.prototype.set=function(t,e){var n,r=this.x,i=this.y,o=0,a=t.length,s=e.x,u=e.y;if(0===a)return u?this.y=u:i&&(this.y=void 0),this.x=r,this;if(u){for(i||(i=numeric.rep(numeric.dim(r),0),this.y=i);o<a-1;)r=r[n=t[o]],i=i[n],o++;return r[n=t[o]]=s,i[n]=u,this}if(i){for(;o<a-1;)r=r[n=t[o]],i=i[n],o++;return r[n=t[o]]=s,i[n]=s instanceof Array?numeric.rep(numeric.dim(s),0):0,this}for(;o<a-1;)r=r[n=t[o]],o++;return r[n=t[o]]=s,this},numeric.T.prototype.getRows=function(t,e){var n,r,i=e-t+1,o=Array(i),a=this.x,s=this.y;for(n=t;n<=e;n++)o[n-t]=a[n];if(s){for(r=Array(i),n=t;n<=e;n++)r[n-t]=s[n];return new numeric.T(o,r)}return new numeric.T(o)},numeric.T.prototype.setRows=function(t,e,n){var r,i=this.x,o=this.y,a=n.x,s=n.y;for(r=t;r<=e;r++)i[r]=a[r-t];if(s)for(o||(o=numeric.rep(numeric.dim(i),0),this.y=o),r=t;r<=e;r++)o[r]=s[r-t];else if(o)for(r=t;r<=e;r++)o[r]=numeric.rep([a[r-t].length],0);return this},numeric.T.prototype.getRow=function(t){var e=this.x,n=this.y;return n?new numeric.T(e[t],n[t]):new numeric.T(e[t])},numeric.T.prototype.setRow=function(t,e){var n=this.x,r=this.y,i=e.x,o=e.y;return n[t]=i,o?(r||(r=numeric.rep(numeric.dim(n),0),this.y=r),r[t]=o):r&&(r=numeric.rep([i.length],0)),this},numeric.T.prototype.getBlock=function(t,e){var n=this.x,r=this.y,i=numeric.getBlock;return r?new numeric.T(i(n,t,e),i(r,t,e)):new numeric.T(i(n,t,e))},numeric.T.prototype.setBlock=function(t,e,n){n instanceof numeric.T||(n=new numeric.T(n));var r=this.x,i=this.y,o=numeric.setBlock,a=n.x,s=n.y;if(s)return i||(this.y=numeric.rep(numeric.dim(this),0),i=this.y),o(r,t,e,a),o(i,t,e,s),this;o(r,t,e,a),i&&o(i,t,e,numeric.rep(numeric.dim(a),0))},numeric.T.rep=function(t,e){var n=numeric.T;e instanceof n||(e=new n(e));var r=e.x,i=e.y,o=numeric.rep;return i?new n(o(t,r),o(t,i)):new n(o(t,r))},numeric.T.diag=function(t){t instanceof numeric.T||(t=new numeric.T(t));var e=t.x,n=t.y,r=numeric.diag;return n?new numeric.T(r(e),r(n)):new numeric.T(r(e))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(t){return new numeric.T(numeric.identity(t))},numeric.T.prototype.getDiag=function(){var t=numeric,e=this.x,n=this.y;return n?new t.T(t.getDiag(e),t.getDiag(n)):new t.T(t.getDiag(e))},numeric.house=function(t){var e=numeric.clone(t),n=(t[0]>=0?1:-1)*numeric.norm2(t);e[0]+=n;var r=numeric.norm2(e);if(0===r)throw new Error("eig: internal error");return numeric.div(e,r)},numeric.toUpperHessenberg=function(t){var e=numeric.dim(t);if(2!==e.length||e[0]!==e[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var n,r,i,o,a,s,u,l,c,h,p=e[0],f=numeric.clone(t),d=numeric.identity(p);for(r=0;r<p-2;r++){for(o=Array(p-r-1),n=r+1;n<p;n++)o[n-r-1]=f[n][r];if(numeric.norm2(o)>0){for(a=numeric.house(o),s=numeric.getBlock(f,[r+1,r],[p-1,p-1]),u=numeric.tensor(a,numeric.dot(a,s)),n=r+1;n<p;n++)for(l=f[n],c=u[n-r-1],i=r;i<p;i++)l[i]-=2*c[i-r];for(s=numeric.getBlock(f,[0,r+1],[p-1,p-1]),u=numeric.tensor(numeric.dot(s,a),a),n=0;n<p;n++)for(l=f[n],c=u[n],i=r+1;i<p;i++)l[i]-=2*c[i-r-1];for(s=Array(p-r-1),n=r+1;n<p;n++)s[n-r-1]=d[n];for(u=numeric.tensor(a,numeric.dot(a,s)),n=r+1;n<p;n++)for(h=d[n],c=u[n-r-1],i=0;i<p;i++)h[i]-=2*c[i]}}return{H:f,Q:d}},numeric.epsilon=2220446049250313e-31,numeric.QRFrancis=function(t,e){void 0===e&&(e=1e4),t=numeric.clone(t);numeric.clone(t);var n,r,i,o,a,s,u,l,c,h,p,f,d,m,g,v,y,x,_=numeric.dim(t)[0],b=numeric.identity(_);if(_<3)return{Q:b,B:[[0,_-1]]};var w=numeric.epsilon;for(x=0;x<e;x++){for(v=0;v<_-1;v++)if(Math.abs(t[v+1][v])<w*(Math.abs(t[v][v])+Math.abs(t[v+1][v+1]))){var M=numeric.QRFrancis(numeric.getBlock(t,[0,0],[v,v]),e),S=numeric.QRFrancis(numeric.getBlock(t,[v+1,v+1],[_-1,_-1]),e);for(f=Array(v+1),g=0;g<=v;g++)f[g]=b[g];for(d=numeric.dot(M.Q,f),g=0;g<=v;g++)b[g]=d[g];for(f=Array(_-v-1),g=v+1;g<_;g++)f[g-v-1]=b[g];for(d=numeric.dot(S.Q,f),g=v+1;g<_;g++)b[g]=d[g-v-1];return{Q:b,B:M.B.concat(numeric.add(S.B,v+1))}}var T,E,A;if(i=t[_-2][_-2],o=t[_-2][_-1],a=t[_-1][_-2],l=i+(s=t[_-1][_-1]),u=i*s-o*a,c=numeric.getBlock(t,[0,0],[2,2]),l*l>=4*u)T=.5*(l+Math.sqrt(l*l-4*u)),E=.5*(l-Math.sqrt(l*l-4*u)),c=numeric.add(numeric.sub(numeric.dot(c,c),numeric.mul(c,T+E)),numeric.diag(numeric.rep([3],T*E)));else c=numeric.add(numeric.sub(numeric.dot(c,c),numeric.mul(c,l)),numeric.diag(numeric.rep([3],u)));for(n=[c[0][0],c[1][0],c[2][0]],r=numeric.house(n),f=[t[0],t[1],t[2]],d=numeric.tensor(r,numeric.dot(r,f)),g=0;g<3;g++)for(p=t[g],m=d[g],y=0;y<_;y++)p[y]-=2*m[y];for(f=numeric.getBlock(t,[0,0],[_-1,2]),d=numeric.tensor(numeric.dot(f,r),r),g=0;g<_;g++)for(p=t[g],m=d[g],y=0;y<3;y++)p[y]-=2*m[y];for(f=[b[0],b[1],b[2]],d=numeric.tensor(r,numeric.dot(r,f)),g=0;g<3;g++)for(h=b[g],m=d[g],y=0;y<_;y++)h[y]-=2*m[y];for(v=0;v<_-2;v++){for(y=v;y<=v+1;y++)if(Math.abs(t[y+1][y])<w*(Math.abs(t[y][y])+Math.abs(t[y+1][y+1]))){M=numeric.QRFrancis(numeric.getBlock(t,[0,0],[y,y]),e),S=numeric.QRFrancis(numeric.getBlock(t,[y+1,y+1],[_-1,_-1]),e);for(f=Array(y+1),g=0;g<=y;g++)f[g]=b[g];for(d=numeric.dot(M.Q,f),g=0;g<=y;g++)b[g]=d[g];for(f=Array(_-y-1),g=y+1;g<_;g++)f[g-y-1]=b[g];for(d=numeric.dot(S.Q,f),g=y+1;g<_;g++)b[g]=d[g-y-1];return{Q:b,B:M.B.concat(numeric.add(S.B,y+1))}}for(A=Math.min(_-1,v+3),n=Array(A-v),g=v+1;g<=A;g++)n[g-v-1]=t[g][v];for(r=numeric.house(n),f=numeric.getBlock(t,[v+1,v],[A,_-1]),d=numeric.tensor(r,numeric.dot(r,f)),g=v+1;g<=A;g++)for(p=t[g],m=d[g-v-1],y=v;y<_;y++)p[y]-=2*m[y-v];for(f=numeric.getBlock(t,[0,v+1],[_-1,A]),d=numeric.tensor(numeric.dot(f,r),r),g=0;g<_;g++)for(p=t[g],m=d[g],y=v+1;y<=A;y++)p[y]-=2*m[y-v-1];for(f=Array(A-v),g=v+1;g<=A;g++)f[g-v-1]=b[g];for(d=numeric.tensor(r,numeric.dot(r,f)),g=v+1;g<=A;g++)for(h=b[g],m=d[g-v-1],y=0;y<_;y++)h[y]-=2*m[y]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(t,e){var n,r,i,o,a,s,u,l,c,h,p,f,d,m,g,v,y=numeric.toUpperHessenberg(t),x=numeric.QRFrancis(y.H,e),_=numeric.T,b=t.length,w=x.B,M=numeric.dot(x.Q,numeric.dot(y.H,numeric.transpose(x.Q))),S=new _(numeric.dot(x.Q,y.Q)),T=w.length,E=Math.sqrt;for(r=0;r<T;r++)if((n=w[r][0])===w[r][1]);else{if(o=n+1,a=M[n][n],s=M[n][o],u=M[o][n],l=M[o][o],0===s&&0===u)continue;(h=(c=-a-l)*c-4*(a*l-s*u))>=0?((g=(a-(p=c<0?-.5*(c-E(h)):-.5*(c+E(h))))*(a-p)+s*s)>(v=u*u+(l-p)*(l-p))?(d=(a-p)/(g=E(g)),m=s/g):(d=u/(v=E(v)),m=(l-p)/v),i=new _([[m,-d],[d,m]]),S.setRows(n,o,i.dot(S.getRows(n,o)))):(p=-.5*c,f=.5*E(-h),(g=(a-p)*(a-p)+s*s)>(v=u*u+(l-p)*(l-p))?(d=(a-p)/(g=E(g+f*f)),m=s/g,p=0,f/=g):(d=u/(v=E(v+f*f)),m=(l-p)/v,p=f/v,f=0),i=new _([[m,-d],[d,m]],[[p,f],[f,-p]]),S.setRows(n,o,i.dot(S.getRows(n,o))))}var A=S.dot(t).dot(S.transjugate()),P=(b=t.length,numeric.T.identity(b));for(o=0;o<b;o++)if(o>0)for(r=o-1;r>=0;r--){var C=A.get([r,r]),L=A.get([o,o]);numeric.neq(C.x,L.x)||numeric.neq(C.y,L.y)?(p=A.getRow(r).getBlock([r],[o-1]),f=P.getRow(o).getBlock([r],[o-1]),P.set([o,r],A.get([r,o]).neg().sub(p.dot(f)).div(C.sub(L)))):P.setRow(o,P.getRow(r))}for(o=0;o<b;o++)p=P.getRow(o),P.setRow(o,p.div(p.norm2()));return P=P.transpose(),P=S.transjugate().dot(P),{lambda:A.getDiag(),E:P}},numeric.ccsSparse=function(t){var e,n,r,i=t.length,o=[];for(n=i-1;-1!==n;--n)for(r in e=t[n]){for(r=parseInt(r);r>=o.length;)o[o.length]=0;0!==e[r]&&o[r]++}var a=o.length,s=Array(a+1);for(s[0]=0,n=0;n<a;++n)s[n+1]=s[n]+o[n];var u=Array(s[a]),l=Array(s[a]);for(n=i-1;-1!==n;--n)for(r in e=t[n])0!==e[r]&&(o[r]--,u[s[r]+o[r]]=n,l[s[r]+o[r]]=e[r]);return[s,u,l]},numeric.ccsFull=function(t){var e,n,r,i,o=t[0],a=t[1],s=t[2],u=numeric.ccsDim(t),l=u[0],c=u[1],h=numeric.rep([l,c],0);for(e=0;e<c;e++)for(r=o[e],i=o[e+1],n=r;n<i;++n)h[a[n]][e]=s[n];return h},numeric.ccsTSolve=function(t,e,n,r,i){var o,a,s,u,l,c,h,p=t[0],f=t[1],d=t[2],m=p.length-1,g=Math.max,v=0;function y(t){var e;if(0===n[t]){for(n[t]=1,e=p[t];e<p[t+1];++e)y(f[e]);i[v]=t,++v}}for(void 0===r&&(n=numeric.rep([m],0)),void 0===r&&(r=numeric.linspace(0,n.length-1)),void 0===i&&(i=[]),o=r.length-1;-1!==o;--o)y(r[o]);for(i.length=v,o=i.length-1;-1!==o;--o)n[i[o]]=0;for(o=r.length-1;-1!==o;--o)a=r[o],n[a]=e[a];for(o=i.length-1;-1!==o;--o){for(a=i[o],s=p[a],u=g(p[a+1],s),l=s;l!==u;++l)if(f[l]===a){n[a]/=d[l];break}for(h=n[a],l=s;l!==u;++l)(c=f[l])!==a&&(n[c]-=h*d[l])}return n},numeric.ccsDFS=function(t){this.k=Array(t),this.k1=Array(t),this.j=Array(t)},numeric.ccsDFS.prototype.dfs=function(t,e,n,r,i,o){var a,s,u,l=0,c=i.length,h=this.k,p=this.k1,f=this.j;if(0===r[t])for(r[t]=1,f[0]=t,h[0]=s=e[t],p[0]=u=e[t+1];;)if(s>=u){if(i[c]=f[l],0===l)return;++c,s=h[--l],u=p[l]}else 0===r[a=o[n[s]]]?(r[a]=1,h[l]=s,f[++l]=a,s=e[a],p[l]=u=e[a+1]):++s},numeric.ccsLPSolve=function(t,e,n,r,i,o,a){var s,u,l,c,h,p,f,d,m,g=t[0],v=t[1],y=t[2],x=(g.length,e[0]),_=e[1],b=e[2];for(u=x[i],l=x[i+1],r.length=0,s=u;s<l;++s)a.dfs(o[_[s]],g,v,n,r,o);for(s=r.length-1;-1!==s;--s)n[r[s]]=0;for(s=u;s!==l;++s)n[c=o[_[s]]]=b[s];for(s=r.length-1;-1!==s;--s){for(h=g[c=r[s]],p=g[c+1],f=h;f<p;++f)if(o[v[f]]===c){n[c]/=y[f];break}for(m=n[c],f=h;f<p;++f)(d=o[v[f]])!==c&&(n[d]-=m*y[f])}return n},numeric.ccsLUP1=function(t,e){var n,r,i,o,a,s,u,l=t[0].length-1,c=[numeric.rep([l+1],0),[],[]],h=[numeric.rep([l+1],0),[],[]],p=c[0],f=c[1],d=c[2],m=h[0],g=h[1],v=h[2],y=numeric.rep([l],0),x=numeric.rep([l],0),_=numeric.ccsLPSolve,b=(Math.max,Math.abs),w=numeric.linspace(0,l-1),M=numeric.linspace(0,l-1),S=new numeric.ccsDFS(l);for(void 0===e&&(e=1),n=0;n<l;++n){for(_(c,t,y,x,n,M,S),o=-1,a=-1,r=x.length-1;-1!==r;--r)(i=x[r])<=n||(s=b(y[i]))>o&&(a=i,o=s);for(b(y[n])<e*o&&(r=w[n],o=w[a],w[n]=o,M[o]=n,w[a]=r,M[r]=a,o=y[n],y[n]=y[a],y[a]=o),o=p[n],a=m[n],u=y[n],f[o]=w[n],d[o]=1,++o,r=x.length-1;-1!==r;--r)s=y[i=x[r]],x[r]=0,y[i]=0,i<=n?(g[a]=i,v[a]=s,++a):(f[o]=w[i],d[o]=s/u,++o);p[n+1]=o,m[n+1]=a}for(r=f.length-1;-1!==r;--r)f[r]=M[f[r]];return{L:c,U:h,P:w,Pinv:M}},numeric.ccsDFS0=function(t){this.k=Array(t),this.k1=Array(t),this.j=Array(t)},numeric.ccsDFS0.prototype.dfs=function(t,e,n,r,i,o,a){var s,u,l,c=0,h=i.length,p=this.k,f=this.k1,d=this.j;if(0===r[t])for(r[t]=1,d[0]=t,p[0]=u=e[o[t]],f[0]=l=e[o[t]+1];;){if(isNaN(u))throw new Error("Ow!");if(u>=l){if(i[h]=o[d[c]],0===c)return;++h,u=p[--c],l=f[c]}else 0===r[s=n[u]]?(r[s]=1,p[c]=u,d[++c]=s,u=e[s=o[s]],f[c]=l=e[s+1]):++u}},numeric.ccsLPSolve0=function(t,e,n,r,i,o,a,s){var u,l,c,h,p,f,d,m,g,v=t[0],y=t[1],x=t[2],_=(v.length,e[0]),b=e[1],w=e[2];for(l=_[i],c=_[i+1],r.length=0,u=l;u<c;++u)s.dfs(b[u],v,y,n,r,o,a);for(u=r.length-1;-1!==u;--u)n[a[h=r[u]]]=0;for(u=l;u!==c;++u)n[h=b[u]]=w[u];for(u=r.length-1;-1!==u;--u){for(m=a[h=r[u]],p=v[h],f=v[h+1],d=p;d<f;++d)if(y[d]===m){n[m]/=x[d];break}for(g=n[m],d=p;d<f;++d)n[y[d]]-=g*x[d];n[m]=g}},numeric.ccsLUP0=function(t,e){var n,r,i,o,a,s,u,l=t[0].length-1,c=[numeric.rep([l+1],0),[],[]],h=[numeric.rep([l+1],0),[],[]],p=c[0],f=c[1],d=c[2],m=h[0],g=h[1],v=h[2],y=numeric.rep([l],0),x=numeric.rep([l],0),_=numeric.ccsLPSolve0,b=(Math.max,Math.abs),w=numeric.linspace(0,l-1),M=numeric.linspace(0,l-1),S=new numeric.ccsDFS0(l);for(void 0===e&&(e=1),n=0;n<l;++n){for(_(c,t,y,x,n,M,w,S),o=-1,a=-1,r=x.length-1;-1!==r;--r)(i=x[r])<=n||(s=b(y[w[i]]))>o&&(a=i,o=s);for(b(y[w[n]])<e*o&&(r=w[n],o=w[a],w[n]=o,M[o]=n,w[a]=r,M[r]=a),o=p[n],a=m[n],u=y[w[n]],f[o]=w[n],d[o]=1,++o,r=x.length-1;-1!==r;--r)s=y[w[i=x[r]]],x[r]=0,y[w[i]]=0,i<=n?(g[a]=i,v[a]=s,++a):(f[o]=w[i],d[o]=s/u,++o);p[n+1]=o,m[n+1]=a}for(r=f.length-1;-1!==r;--r)f[r]=M[f[r]];return{L:c,U:h,P:w,Pinv:M}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(t){return[numeric.sup(t[1])+1,t[0].length-1]},numeric.ccsGetBlock=function(t,e,n){var r=numeric.ccsDim(t),i=r[0],o=r[1];void 0===e?e=numeric.linspace(0,i-1):"number"==typeof e&&(e=[e]),void 0===n?n=numeric.linspace(0,o-1):"number"==typeof n&&(n=[n]);var a,s,u,l,c=e.length,h=n.length,p=numeric.rep([o],0),f=[],d=[],m=[p,f,d],g=t[0],v=t[1],y=t[2],x=numeric.rep([i],0),_=0,b=numeric.rep([i],0);for(s=0;s<h;++s){var w=g[l=n[s]],M=g[l+1];for(a=w;a<M;++a)b[u=v[a]]=1,x[u]=y[a];for(a=0;a<c;++a)b[e[a]]&&(f[_]=a,d[_]=x[e[a]],++_);for(a=w;a<M;++a)b[u=v[a]]=0;p[s+1]=_}return m},numeric.ccsDot=function(t,e){var n,r,i,o,a,s,u,l,c,h,p,f=t[0],d=t[1],m=t[2],g=e[0],v=e[1],y=e[2],x=numeric.ccsDim(t),_=numeric.ccsDim(e),b=x[0],w=(x[1],_[1]),M=numeric.rep([b],0),S=numeric.rep([b],0),T=Array(b),E=numeric.rep([w],0),A=[],P=[],C=[E,A,P];for(i=0;i!==w;++i){for(o=g[i],a=g[i+1],c=0,r=o;r<a;++r)for(h=v[r],p=y[r],s=f[h],u=f[h+1],n=s;n<u;++n)0===S[l=d[n]]&&(T[c]=l,S[l]=1,c+=1),M[l]=M[l]+m[n]*p;for(a=(o=E[i])+c,E[i+1]=a,r=c-1;-1!==r;--r)p=o+r,n=T[r],A[p]=n,P[p]=M[n],S[n]=0,M[n]=0;E[i+1]=E[i]+c}return C},numeric.ccsLUPSolve=function(t,e){var n=t.L,r=t.U,i=(t.P,e[0]),o=!1;"object"!=typeof i&&(i=(e=[[0,e.length],numeric.linspace(0,e.length-1),e])[0],o=!0);var a,s,u,l,c,h,p=e[1],f=e[2],d=n[0].length-1,m=i.length-1,g=numeric.rep([d],0),v=Array(d),y=numeric.rep([d],0),x=Array(d),_=numeric.rep([m+1],0),b=[],w=[],M=numeric.ccsTSolve,S=0;for(a=0;a<m;++a){for(c=0,u=i[a],l=i[a+1],s=u;s<l;++s)h=t.Pinv[p[s]],x[c]=h,y[h]=f[s],++c;for(x.length=c,M(n,y,g,x,v),s=x.length-1;-1!==s;--s)y[x[s]]=0;if(M(r,g,y,v,x),o)return y;for(s=v.length-1;-1!==s;--s)g[v[s]]=0;for(s=x.length-1;-1!==s;--s)h=x[s],b[S]=h,w[S]=y[h],y[h]=0,++S;_[a+1]=S}return[_,b,w]},numeric.ccsbinop=function(t,e){return void 0===e&&(e=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+e+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+t+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(t){var e,n=t[0],r=t[1],i=t[2],o=numeric.sup(r)+1,a=n.length,s=numeric.rep([o],0),u=Array(a),l=Array(a),c=numeric.rep([o],0);for(e=0;e<a;++e)c[r[e]]++;for(e=0;e<o;++e)s[e+1]=s[e]+c[e];var h,p,f=s.slice(0);for(e=0;e<a;++e)u[h=f[p=r[e]]]=n[e],l[h]=i[e],f[p]=f[p]+1;return[s,u,l]},numeric.ccsGather=function(t){var e,n,r,i,o,a=t[0],s=t[1],u=t[2],l=a.length-1,c=s.length,h=Array(c),p=Array(c),f=Array(c);for(o=0,e=0;e<l;++e)for(r=a[e],i=a[e+1],n=r;n!==i;++n)p[o]=e,h[o]=s[n],f[o]=u[n],++o;return[h,p,f]},numeric.sdim=function t(e,n,r){if(void 0===n&&(n=[]),"object"!=typeof e)return n;var i;for(i in void 0===r&&(r=0),r in n||(n[r]=0),e.length>n[r]&&(n[r]=e.length),e)e.hasOwnProperty(i)&&t(e[i],n,r+1);return n},numeric.sclone=function t(e,n,r){void 0===n&&(n=0),void 0===r&&(r=numeric.sdim(e).length);var i,o=Array(e.length);if(n===r-1){for(i in e)e.hasOwnProperty(i)&&(o[i]=e[i]);return o}for(i in e)e.hasOwnProperty(i)&&(o[i]=t(e[i],n+1,r));return o},numeric.sdiag=function(t){var e,n,r=t.length,i=Array(r);for(e=r-1;e>=1;e-=2)n=e-1,i[e]=[],i[e][e]=t[e],i[n]=[],i[n][n]=t[n];return 0===e&&(i[0]=[],i[0][0]=t[e]),i},numeric.sidentity=function(t){return numeric.sdiag(numeric.rep([t],1))},numeric.stranspose=function(t){var e,n,r,i=[];t.length;for(e in t)if(t.hasOwnProperty(e))for(n in r=t[e])r.hasOwnProperty(n)&&("object"!=typeof i[n]&&(i[n]=[]),i[n][e]=r[n]);return i},numeric.sLUP=function(t,e){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(t,e){var n,r,i,o,a,s,u,l=t.length,c=(e.length,numeric.stranspose(e)),h=c.length,p=Array(l);for(i=l-1;i>=0;i--){for(u=[],n=t[i],a=h-1;a>=0;a--){for(o in s=0,r=c[a],n)n.hasOwnProperty(o)&&o in r&&(s+=n[o]*r[o]);s&&(u[a]=s)}p[i]=u}return p},numeric.sdotMV=function(t,e){var n,r,i,o,a=t.length,s=Array(a);for(r=a-1;r>=0;r--){for(i in o=0,n=t[r])n.hasOwnProperty(i)&&e[i]&&(o+=n[i]*e[i]);o&&(s[r]=o)}return s},numeric.sdotVM=function(t,e){var n,r,i,o,a=[];for(n in t)if(t.hasOwnProperty(n))for(r in i=e[n],o=t[n],i)i.hasOwnProperty(r)&&(a[r]||(a[r]=0),a[r]+=o*i[r]);return a},numeric.sdotVV=function(t,e){var n,r=0;for(n in t)t[n]&&e[n]&&(r+=t[n]*e[n]);return r},numeric.sdot=function(t,e){var n=numeric.sdim(t).length,r=numeric.sdim(e).length;switch(1e3*n+r){case 0:return t*e;case 1001:return numeric.sdotVV(t,e);case 2001:return numeric.sdotMV(t,e);case 1002:return numeric.sdotVM(t,e);case 2002:return numeric.sdotMM(t,e);default:throw new Error("numeric.sdot not implemented for tensors of order "+n+" and "+r)}},numeric.sscatter=function(t){var e,n,r,i,o=t[0].length,a=t.length,s=[];for(n=o-1;n>=0;--n)if(t[a-1][n]){for(i=s,r=0;r<a-2;r++)i[e=t[r][n]]||(i[e]=[]),i=i[e];i[t[r][n]]=t[r+1][n]}return s},numeric.sgather=function t(e,n,r){var i,o,a;for(o in void 0===n&&(n=[]),void 0===r&&(r=[]),i=r.length,e)if(e.hasOwnProperty(o))if(r[i]=parseInt(o),"number"==typeof(a=e[o])){if(a){if(0===n.length)for(o=i+1;o>=0;--o)n[o]=[];for(o=i;o>=0;--o)n[o].push(r[o]);n[i+1].push(a)}}else t(a,n,r);return r.length>i&&r.pop(),n},numeric.cLU=function(t){var e,n,r,i,o,a,s=t[0],u=t[1],l=t[2],c=s.length,h=0;for(e=0;e<c;e++)s[e]>h&&(h=s[e]);h++;var p,f=Array(h),d=Array(h),m=numeric.rep([h],1/0),g=numeric.rep([h],-1/0);for(r=0;r<c;r++)e=s[r],(n=u[r])<m[e]&&(m[e]=n),n>g[e]&&(g[e]=n);for(e=0;e<h-1;e++)g[e]>g[e+1]&&(g[e+1]=g[e]);for(e=h-1;e>=1;e--)m[e]<m[e-1]&&(m[e-1]=m[e]);for(e=0;e<h;e++)d[e]=numeric.rep([g[e]-m[e]+1],0),f[e]=numeric.rep([e-m[e]],0),e-m[e]+1,g[e]-e+1;for(r=0;r<c;r++)d[e=s[r]][u[r]-m[e]]=l[r];for(e=0;e<h-1;e++)for(i=e-m[e],x=d[e],n=e+1;m[n]<=e&&n<h;n++)if(o=e-m[n],a=g[e]-e,p=(_=d[n])[o]/x[i]){for(r=1;r<=a;r++)_[r+o]-=p*x[r+i];f[n][e-m[n]]=p}var v,y,x=[],_=[],b=[],w=[],M=[],S=[];for(c=0,v=0,e=0;e<h;e++){for(i=m[e],o=g[e],y=d[e],n=e;n<=o;n++)y[n-i]&&(x[c]=e,_[c]=n,b[c]=y[n-i],c++);for(y=f[e],n=i;n<e;n++)y[n-i]&&(w[v]=e,M[v]=n,S[v]=y[n-i],v++);w[v]=e,M[v]=e,S[v]=1,v++}return{U:[x,_,b],L:[w,M,S]}},numeric.cLUsolve=function(t,e){var n,r,i=t.L,o=t.U,a=numeric.clone(e),s=i[0],u=i[1],l=i[2],c=o[0],h=o[1],p=o[2],f=c.length,d=(s.length,a.length);for(r=0,n=0;n<d;n++){for(;u[r]<n;)a[n]-=l[r]*a[u[r]],r++;r++}for(r=f-1,n=d-1;n>=0;n--){for(;h[r]>n;)a[n]-=p[r]*a[h[r]],r--;a[n]/=p[r],r--}return a},numeric.cgrid=function(t,e){"number"==typeof t&&(t=[t,t]);var n,r,i,o=numeric.rep(t,-1);if("function"!=typeof e)if("L"===e)e=function(e,n){return e>=t[0]/2||n<t[1]/2};else e=function(t,e){return!0};for(i=0,n=1;n<t[0]-1;n++)for(r=1;r<t[1]-1;r++)e(n,r)&&(o[n][r]=i,i++);return o},numeric.cdelsq=function(t){var e,n,r,i,o,a=[[-1,0],[0,-1],[0,1],[1,0]],s=numeric.dim(t),u=s[0],l=s[1],c=[],h=[],p=[];for(e=1;e<u-1;e++)for(n=1;n<l-1;n++)if(!(t[e][n]<0)){for(r=0;r<4;r++)i=e+a[r][0],o=n+a[r][1],t[i][o]<0||(c.push(t[e][n]),h.push(t[i][o]),p.push(-1));c.push(t[e][n]),h.push(t[e][n]),p.push(4)}return[c,h,p]},numeric.cdotMV=function(t,e){var n,r,i,o=t[0],a=t[1],s=t[2],u=o.length;for(i=0,r=0;r<u;r++)o[r]>i&&(i=o[r]);for(i++,n=numeric.rep([i],0),r=0;r<u;r++)n[o[r]]+=s[r]*e[a[r]];return n},numeric.Spline=function(t,e,n,r,i){this.x=t,this.yl=e,this.yr=n,this.kl=r,this.kr=i},numeric.Spline.prototype._at=function(t,e){var n,r,i,o=this.x,a=this.yl,s=this.yr,u=this.kl,l=this.kr,c=numeric.add,h=numeric.sub,p=numeric.mul;n=h(p(u[e],o[e+1]-o[e]),h(s[e+1],a[e])),r=c(p(l[e+1],o[e]-o[e+1]),h(s[e+1],a[e]));var f=(i=(t-o[e])/(o[e+1]-o[e]))*(1-i);return c(c(c(p(1-i,a[e]),p(i,s[e+1])),p(n,f*(1-i))),p(r,f*i))},numeric.Spline.prototype.at=function(t){if("number"==typeof t){var e,n,r,i=this.x,o=i.length,a=Math.floor;for(e=0,n=o-1;n-e>1;)i[r=a((e+n)/2)]<=t?e=r:n=r;return this._at(t,e)}o=t.length;var s,u=Array(o);for(s=o-1;-1!==s;--s)u[s]=this.at(t[s]);return u},numeric.Spline.prototype.diff=function(){var t,e,n,r=this.x,i=this.yl,o=this.yr,a=this.kl,s=this.kr,u=i.length,l=a,c=s,h=Array(u),p=Array(u),f=numeric.add,d=numeric.mul,m=numeric.div,g=numeric.sub;for(t=u-1;-1!==t;--t)e=r[t+1]-r[t],n=g(o[t+1],i[t]),h[t]=m(f(d(n,6),d(a[t],-4*e),d(s[t+1],-2*e)),e*e),p[t+1]=m(f(d(n,-6),d(a[t],2*e),d(s[t+1],4*e)),e*e);return new numeric.Spline(r,l,c,h,p)},numeric.Spline.prototype.roots=function(){function t(t){return t*t}var e=[],n=this.x,r=this.yl,i=this.yr,o=this.kl,a=this.kr;"number"==typeof r[0]&&(r=[r],i=[i],o=[o],a=[a]);var s,u,l,c,h,p,f,d,m,g,v,y,x,_,b,w,M,S,T,E,A,P,C,L=r.length,I=n.length-1,O=(e=Array(L),Math.sqrt);for(s=0;s!==L;++s){for(c=r[s],h=i[s],p=o[s],f=a[s],d=[],u=0;u!==I;u++){for(u>0&&h[u]*c[u]<0&&d.push(n[u]),w=n[u+1]-n[u],n[u],v=c[u],y=h[u+1],m=p[u]/w,x=(g=f[u+1]/w)+3*v+2*m-3*y,_=3*(g+m+2*(v-y)),(b=t(m-g+3*(v-y))+12*g*v)<=0?M=(S=x/_)>n[u]&&S<n[u+1]?[n[u],S,n[u+1]]:[n[u],n[u+1]]:(S=(x-O(b))/_,T=(x+O(b))/_,M=[n[u]],S>n[u]&&S<n[u+1]&&M.push(S),T>n[u]&&T<n[u+1]&&M.push(T),M.push(n[u+1])),A=M[0],S=this._at(A,u),l=0;l<M.length-1;l++)if(P=M[l+1],T=this._at(P,u),0!==S)if(0===T||S*T>0)A=P,S=T;else{for(var N=0;!((C=(S*P-T*A)/(S-T))<=A||C>=P);)if((E=this._at(C,u))*T>0)P=C,T=E,-1===N&&(S*=.5),N=-1;else{if(!(E*S>0))break;A=C,S=E,1===N&&(T*=.5),N=1}d.push(C),A=M[l+1],S=this._at(A,u)}else d.push(A),A=P,S=T;0===T&&d.push(P)}e[s]=d}return"number"==typeof this.yl[0]?e[0]:e},numeric.spline=function(t,e,n,r){var i,o=t.length,a=[],s=[],u=[],l=numeric.sub,c=numeric.mul,h=numeric.add;for(i=o-2;i>=0;i--)s[i]=t[i+1]-t[i],u[i]=l(e[i+1],e[i]);"string"!=typeof n&&"string"!=typeof r||(n=r="periodic");var p=[[],[],[]];switch(typeof n){case"undefined":a[0]=c(3/(s[0]*s[0]),u[0]),p[0].push(0,0),p[1].push(0,1),p[2].push(2/s[0],1/s[0]);break;case"string":a[0]=h(c(3/(s[o-2]*s[o-2]),u[o-2]),c(3/(s[0]*s[0]),u[0])),p[0].push(0,0,0),p[1].push(o-2,0,1),p[2].push(1/s[o-2],2/s[o-2]+2/s[0],1/s[0]);break;default:a[0]=n,p[0].push(0),p[1].push(0),p[2].push(1)}for(i=1;i<o-1;i++)a[i]=h(c(3/(s[i-1]*s[i-1]),u[i-1]),c(3/(s[i]*s[i]),u[i])),p[0].push(i,i,i),p[1].push(i-1,i,i+1),p[2].push(1/s[i-1],2/s[i-1]+2/s[i],1/s[i]);switch(typeof r){case"undefined":a[o-1]=c(3/(s[o-2]*s[o-2]),u[o-2]),p[0].push(o-1,o-1),p[1].push(o-2,o-1),p[2].push(1/s[o-2],2/s[o-2]);break;case"string":p[1][p[1].length-1]=0;break;default:a[o-1]=r,p[0].push(o-1),p[1].push(o-1),p[2].push(1)}a="number"!=typeof a[0]?numeric.transpose(a):[a];var f=Array(a.length);if("string"==typeof n)for(i=f.length-1;-1!==i;--i)f[i]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(p)),a[i]),f[i][o-1]=f[i][0];else for(i=f.length-1;-1!==i;--i)f[i]=numeric.cLUsolve(numeric.cLU(p),a[i]);return f="number"==typeof e[0]?f[0]:numeric.transpose(f),new numeric.Spline(t,e,e,f,f)},numeric.fftpow2=function t(e,n){var r=e.length;if(1!==r){var i,o,a=Math.cos,s=Math.sin,u=Array(r/2),l=Array(r/2),c=Array(r/2),h=Array(r/2);for(o=r/2,i=r-1;-1!==i;--i)c[--o]=e[i],h[o]=n[i],--i,u[o]=e[i],l[o]=n[i];t(u,l),t(c,h),o=r/2;var p,f,d,m=-6.283185307179586/r;for(i=r-1;-1!==i;--i)-1===--o&&(o=r/2-1),f=a(p=m*i),d=s(p),e[i]=u[o]+f*c[o]-d*h[o],n[i]=l[o]+f*h[o]+d*c[o]}},numeric._ifftpow2=function t(e,n){var r=e.length;if(1!==r){var i,o,a=Math.cos,s=Math.sin,u=Array(r/2),l=Array(r/2),c=Array(r/2),h=Array(r/2);for(o=r/2,i=r-1;-1!==i;--i)c[--o]=e[i],h[o]=n[i],--i,u[o]=e[i],l[o]=n[i];t(u,l),t(c,h),o=r/2;var p,f,d,m=6.283185307179586/r;for(i=r-1;-1!==i;--i)-1===--o&&(o=r/2-1),f=a(p=m*i),d=s(p),e[i]=u[o]+f*c[o]-d*h[o],n[i]=l[o]+f*h[o]+d*c[o]}},numeric.ifftpow2=function(t,e){numeric._ifftpow2(t,e),numeric.diveq(t,t.length),numeric.diveq(e,e.length)},numeric.convpow2=function(t,e,n,r){var i,o,a,s,u;for(numeric.fftpow2(t,e),numeric.fftpow2(n,r),i=t.length-1;-1!==i;--i)o=t[i],s=e[i],a=n[i],u=r[i],t[i]=o*a-s*u,e[i]=o*u+s*a;numeric.ifftpow2(t,e)},numeric.T.prototype.fft=function(){var t,e,n=this.x,r=this.y,i=n.length,o=Math.log,a=o(2),s=Math.ceil(o(2*i-1)/a),u=Math.pow(2,s),l=numeric.rep([u],0),c=numeric.rep([u],0),h=Math.cos,p=Math.sin,f=-3.141592653589793/i,d=numeric.rep([u],0),m=numeric.rep([u],0);Math.floor(i/2);for(t=0;t<i;t++)d[t]=n[t];if(void 0!==r)for(t=0;t<i;t++)m[t]=r[t];for(l[0]=1,t=1;t<=u/2;t++)e=f*t*t,l[t]=h(e),c[t]=p(e),l[u-t]=h(e),c[u-t]=p(e);var g=new numeric.T(d,m),v=new numeric.T(l,c);return g=g.mul(v),numeric.convpow2(g.x,g.y,numeric.clone(v.x),numeric.neg(v.y)),(g=g.mul(v)).x.length=i,g.y.length=i,g},numeric.T.prototype.ifft=function(){var t,e,n=this.x,r=this.y,i=n.length,o=Math.log,a=o(2),s=Math.ceil(o(2*i-1)/a),u=Math.pow(2,s),l=numeric.rep([u],0),c=numeric.rep([u],0),h=Math.cos,p=Math.sin,f=3.141592653589793/i,d=numeric.rep([u],0),m=numeric.rep([u],0);Math.floor(i/2);for(t=0;t<i;t++)d[t]=n[t];if(void 0!==r)for(t=0;t<i;t++)m[t]=r[t];for(l[0]=1,t=1;t<=u/2;t++)e=f*t*t,l[t]=h(e),c[t]=p(e),l[u-t]=h(e),c[u-t]=p(e);var g=new numeric.T(d,m),v=new numeric.T(l,c);return g=g.mul(v),numeric.convpow2(g.x,g.y,numeric.clone(v.x),numeric.neg(v.y)),(g=g.mul(v)).x.length=i,g.y.length=i,g.div(i)},numeric.gradient=function(t,e){var n=e.length,r=t(e);if(isNaN(r))throw new Error("gradient: f(x) is a NaN!");var i,o,a,s,u,l,c,h,p,f=Math.max,d=numeric.clone(e),m=Array(n),g=(numeric.div,numeric.sub,f=Math.max,Math.abs),v=Math.min,y=0;for(i=0;i<n;i++)for(var x=f(1e-6*r,1e-8);;){if(++y>20)throw new Error("Numerical gradient fails");if(d[i]=e[i]+x,o=t(d),d[i]=e[i]-x,a=t(d),d[i]=e[i],isNaN(o)||isNaN(a))x/=16;else{if(m[i]=(o-a)/(2*x),s=e[i]-x,u=e[i],l=e[i]+x,c=(o-r)/x,h=(r-a)/x,p=f(g(m[i]),g(r),g(o),g(a),g(s),g(u),g(l),1e-8),!(v(f(g(c-m[i]),g(h-m[i]),g(c-h))/p,x/p)>.001))break;x/=16}}return m},numeric.uncmin=function(t,e,n,r,i,o,a){var s=numeric.gradient;void 0===a&&(a={}),void 0===n&&(n=1e-8),void 0===r&&(r=function(e){return s(t,e)}),void 0===i&&(i=1e3);var u,l,c=(e=numeric.clone(e)).length,h=t(e);if(isNaN(h))throw new Error("uncmin: f(x0) is a NaN!");var p=Math.max,f=numeric.norm2;n=p(n,numeric.epsilon);var d,m,g,v,y,x,_,b,w,M,S=a.Hinv||numeric.identity(c),T=numeric.dot,E=(numeric.inv,numeric.sub),A=numeric.add,P=numeric.tensor,C=numeric.div,L=numeric.mul,I=numeric.all,O=numeric.isFinite,N=numeric.neg,R=0,D="";for(m=r(e);R<i;){if("function"==typeof o&&o(R,e,h,m,S)){D="Callback returned true";break}if(!I(O(m))){D="Gradient has Infinity or NaN";break}if(!I(O(d=N(T(S,m))))){D="Search direction has Infinity or NaN";break}if((M=f(d))<n){D="Newton step smaller than tol";break}for(w=1,l=T(m,d),y=e;R<i&&!(w*M<n)&&(y=A(e,v=L(d,w)),(u=t(y))-h>=.1*w*l||isNaN(u));)w*=.5,++R;if(w*M<n){D="Line search step size smaller than tol";break}if(R===i){D="maxit reached during line search";break}b=T(x=E(g=r(y),m),v),_=T(S,x),S=E(A(S,L((b+T(x,_))/(b*b),P(v,v))),C(A(P(_,v),P(v,_)),b)),e=y,h=u,m=g,++R}return{solution:e,f:h,gradient:m,invHessian:S,iterations:R,message:D}},numeric.Dopri=function(t,e,n,r,i,o,a){this.x=t,this.y=e,this.f=n,this.ymid=r,this.iterations=i,this.events=a,this.message=o},numeric.Dopri.prototype._at=function(t,e){function n(t){return t*t}var r,i,o,a,s,u,l,c,h,p=this,f=p.x,d=p.y,m=p.f,g=p.ymid,v=(f.length,Math.floor,numeric.add),y=numeric.mul,x=numeric.sub;return r=f[e],i=f[e+1],a=d[e],s=d[e+1],o=r+.5*(i-r),u=g[e],l=x(m[e],y(a,1/(r-o)+2/(r-i))),c=x(m[e+1],y(s,1/(i-o)+2/(i-r))),v(v(v(v(y(a,(h=[n(t-i)*(t-o)/n(r-i)/(r-o),n(t-r)*n(t-i)/n(r-o)/n(i-o),n(t-r)*(t-o)/n(i-r)/(i-o),(t-r)*n(t-i)*(t-o)/n(r-i)/(r-o),(t-i)*n(t-r)*(t-o)/n(r-i)/(i-o)])[0]),y(u,h[1])),y(s,h[2])),y(l,h[3])),y(c,h[4]))},numeric.Dopri.prototype.at=function(t){var e,n,r,i=Math.floor;if("number"!=typeof t){var o=t.length,a=Array(o);for(e=o-1;-1!==e;--e)a[e]=this.at(t[e]);return a}var s=this.x;for(e=0,n=s.length-1;n-e>1;)s[r=i(.5*(e+n))]<=t?e=r:n=r;return this._at(t,e)},numeric.dopri=function(t,e,n,r,i,o,a){void 0===i&&(i=1e-6),void 0===o&&(o=1e3);var s,u,l,c,h,p,f,d,m,g,v,y,x,_=[t],b=[n],w=[r(t,n)],M=[],S=[3/40,9/40],T=[44/45,-56/15,32/9],E=[19372/6561,-25360/2187,64448/6561,-212/729],A=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],P=[35/384,0,500/1113,125/192,-2187/6784,11/84],C=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,5618549.5/235043384],L=[.2,.3,.8,8/9,1,1],I=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,1/40],O=0,N=(e-t)/10,R=0,D=numeric.add,k=numeric.mul,F=(Math.max,Math.min),B=Math.abs,U=numeric.norminf,z=Math.pow,V=numeric.any,G=numeric.lt,j=numeric.and,W=(numeric.sub,new numeric.Dopri(_,b,w,M,-1,""));for("function"==typeof a&&(v=a(t,n));t<e&&R<o;)if(++R,t+N>e&&(N=e-t),s=r(t+L[0]*N,D(n,k(.2*N,w[O]))),u=r(t+L[1]*N,D(D(n,k(S[0]*N,w[O])),k(S[1]*N,s))),l=r(t+L[2]*N,D(D(D(n,k(T[0]*N,w[O])),k(T[1]*N,s)),k(T[2]*N,u))),c=r(t+L[3]*N,D(D(D(D(n,k(E[0]*N,w[O])),k(E[1]*N,s)),k(E[2]*N,u)),k(E[3]*N,l))),h=r(t+L[4]*N,D(D(D(D(D(n,k(A[0]*N,w[O])),k(A[1]*N,s)),k(A[2]*N,u)),k(A[3]*N,l)),k(A[4]*N,c))),p=r(t+N,m=D(D(D(D(D(n,k(w[O],N*P[0])),k(u,N*P[2])),k(l,N*P[3])),k(c,N*P[4])),k(h,N*P[5]))),(g="number"==typeof(f=D(D(D(D(D(k(w[O],N*I[0]),k(u,N*I[2])),k(l,N*I[3])),k(c,N*I[4])),k(h,N*I[5])),k(p,N*I[6])))?B(f):U(f))>i){if(t+(N=.2*N*z(i/g,.25))===t){W.msg="Step size became too small";break}}else{if(M[O]=D(D(D(D(D(D(n,k(w[O],N*C[0])),k(u,N*C[2])),k(l,N*C[3])),k(c,N*C[4])),k(h,N*C[5])),k(p,N*C[6])),_[++O]=t+N,b[O]=m,w[O]=p,"function"==typeof a){var H,X,Y=t,q=t+.5*N;if(y=a(q,M[O-1]),V(x=j(G(v,0),G(0,y)))||(Y=q,v=y,y=a(q=t+N,m),x=j(G(v,0),G(0,y))),V(x)){for(var Z,J,K=0,Q=1,$=1;;){if("number"==typeof v)X=($*y*Y-Q*v*q)/($*y-Q*v);else for(X=q,d=v.length-1;-1!==d;--d)v[d]<0&&y[d]>0&&(X=F(X,($*y[d]*Y-Q*v[d]*q)/($*y[d]-Q*v[d])));if(X<=Y||X>=q)break;J=a(X,H=W._at(X,O-1)),V(Z=j(G(v,0),G(0,J)))?(q=X,y=J,x=Z,$=1,-1===K?Q*=.5:Q=1,K=-1):(Y=X,v=J,Q=1,1===K?$*=.5:$=1,K=1)}return m=W._at(.5*(t+X),O-1),W.f[O]=r(X,H),W.x[O]=X,W.y[O]=H,W.ymid[O-1]=m,W.events=x,W.iterations=R,W}}t+=N,n=m,v=y,N=F(.8*N*z(i/g,.25),4*N)}return W.iterations=R,W},numeric.LU=function(t,e){e=e||!1;var n,r,i,o,a,s,u,l,c,h=Math.abs,p=t.length,f=p-1,d=new Array(p);for(e||(t=numeric.clone(t)),i=0;i<p;++i){for(u=i,c=h((s=t[i])[i]),r=i+1;r<p;++r)c<(o=h(t[r][i]))&&(c=o,u=r);for(d[i]=u,u!=i&&(t[i]=t[u],t[u]=s,s=t[i]),a=s[i],n=i+1;n<p;++n)t[n][i]/=a;for(n=i+1;n<p;++n){for(l=t[n],r=i+1;r<f;++r)l[r]-=l[i]*s[r],l[++r]-=l[i]*s[r];r===f&&(l[r]-=l[i]*s[r])}}return{LU:t,P:d}},numeric.LUsolve=function(t,e){var n,r,i,o,a,s=t.LU,u=s.length,l=numeric.clone(e),c=t.P;for(n=u-1;-1!==n;--n)l[n]=e[n];for(n=0;n<u;++n)for(i=c[n],c[n]!==n&&(a=l[n],l[n]=l[i],l[i]=a),o=s[n],r=0;r<n;++r)l[n]-=l[r]*o[r];for(n=u-1;n>=0;--n){for(o=s[n],r=n+1;r<u;++r)l[n]-=l[r]*o[r];l[n]/=o[n]}return l},numeric.solve=function(t,e,n){return numeric.LUsolve(numeric.LU(t,n),e)},numeric.echelonize=function(t){var e,n,r,i,o,a,s,u,l=numeric.dim(t),c=l[0],h=l[1],p=numeric.identity(c),f=Array(c),d=Math.abs,m=numeric.diveq;for(t=numeric.clone(t),e=0;e<c;++e){for(r=0,o=t[e],a=p[e],n=1;n<h;++n)d(o[r])<d(o[n])&&(r=n);for(f[e]=r,m(a,o[r]),m(o,o[r]),n=0;n<c;++n)if(n!==e){for(u=(s=t[n])[r],i=h-1;-1!==i;--i)s[i]-=o[i]*u;for(s=p[n],i=c-1;-1!==i;--i)s[i]-=a[i]*u}}return{I:p,A:t,P:f}},numeric.__solveLP=function(t,e,n,r,i,o,a){var s,u,l,c,h=numeric.sum,p=(numeric.log,numeric.mul),f=numeric.sub,d=numeric.dot,m=numeric.div,g=numeric.add,v=t.length,y=n.length,x=!1,_=1,b=(numeric.transpose(e),numeric.svd,numeric.transpose),w=(numeric.leq,Math.sqrt),M=Math.abs,S=(numeric.muleq,numeric.norminf,numeric.any,Math.min),T=numeric.all,E=numeric.gt,A=Array(v),P=Array(y),C=(numeric.rep([y],1),numeric.solve),L=f(n,d(e,o)),I=d(t,t);for(l=0;l<i;++l){var O,N;for(O=y-1;-1!==O;--O)P[O]=m(e[O],L[O]);var R=b(P);for(O=v-1;-1!==O;--O)A[O]=h(R[O]);_=.25*M(I/d(t,A));var D=100*w(I/d(A,A));for((!isFinite(_)||_>D)&&(_=D),c=g(t,p(_,A)),u=d(R,P),O=v-1;-1!==O;--O)u[O][O]+=1;N=C(u,m(c,_),!0);var k=m(L,d(e,N)),F=1;for(O=y-1;-1!==O;--O)k[O]<0&&(F=S(F,-.999*k[O]));if(s=f(o,p(N,F)),!T(E(L=f(n,d(e,s)),0)))return{solution:o,message:"",iterations:l};if(o=s,_<r)return{solution:s,message:"",iterations:l};if(a){var B=d(t,c),U=d(e,c);for(x=!0,O=y-1;-1!==O;--O)if(B*U[O]<0){x=!1;break}}else x=!(o[v-1]>=0);if(x)return{solution:s,message:"Unbounded",iterations:l}}return{solution:o,message:"maximum iteration count exceeded",iterations:l}},numeric._solveLP=function(t,e,n,r,i){var o=t.length,a=n.length,s=(numeric.sum,numeric.log,numeric.mul,numeric.sub),u=numeric.dot,l=(numeric.div,numeric.add,numeric.rep([o],0).concat([1])),c=numeric.rep([a,1],-1),h=numeric.blockMatrix([[e,c]]),p=n,f=numeric.rep([o],0).concat(Math.max(0,numeric.sup(numeric.neg(n)))+1),d=numeric.__solveLP(l,h,p,r,i,f,!1),m=numeric.clone(d.solution);if(m.length=o,numeric.inf(s(n,u(e,m)))<0)return{solution:NaN,message:"Infeasible",iterations:d.iterations};var g=numeric.__solveLP(t,e,n,r,i-d.iterations,m,!0);return g.iterations+=d.iterations,g},numeric.solveLP=function(t,e,n,r,i,o,a){if(void 0===a&&(a=1e3),void 0===o&&(o=numeric.epsilon),void 0===r)return numeric._solveLP(t,e,n,o,a);var s,u=r.length,l=r[0].length,c=e.length,h=numeric.echelonize(r),p=numeric.rep([l],0),f=h.P,d=[];for(s=f.length-1;-1!==s;--s)p[f[s]]=1;for(s=l-1;-1!==s;--s)0===p[s]&&d.push(s);var m=numeric.getRange,g=numeric.linspace(0,u-1),v=numeric.linspace(0,c-1),y=m(r,g,d),x=m(e,v,f),_=m(e,v,d),b=numeric.dot,w=numeric.sub,M=b(x,h.I),S=w(_,b(M,y)),T=w(n,b(M,i)),E=Array(f.length),A=Array(d.length);for(s=f.length-1;-1!==s;--s)E[s]=t[f[s]];for(s=d.length-1;-1!==s;--s)A[s]=t[d[s]];var P=w(A,b(E,b(h.I,y))),C=numeric._solveLP(P,S,T,o,a),L=C.solution;if(L!=L)return C;var I=b(h.I,w(i,b(y,L))),O=Array(t.length);for(s=f.length-1;-1!==s;--s)O[f[s]]=I[s];for(s=d.length-1;-1!==s;--s)O[d[s]]=L[s];return{solution:O,message:C.message,iterations:C.iterations}},numeric.MPStoLP=function(t){t instanceof String&&t.split("\n");var e,n,r,i,o=0,a=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],s=t.length,u=0,l={},c=[],h=0,p={},f=0,d=[],m=[],g=[];function v(n){throw new Error("MPStoLP: "+n+"\nLine "+e+": "+t[e]+"\nCurrent state: "+a[o]+"\n")}for(e=0;e<s;++e){var y=(r=t[e]).match(/\S*/g),x=[];for(n=0;n<y.length;++n)""!==y[n]&&x.push(y[n]);if(0!==x.length){for(n=0;n<a.length&&r.substr(0,a[n].length)!==a[n];++n);if(n<a.length){if(o=n,1===n&&(i=x[1]),6===n)return{name:i,c:d,A:numeric.transpose(m),b:g,rows:l,vars:p}}else switch(o){case 0:case 1:v("Unexpected line");case 2:switch(x[0]){case"N":0===u?u=x[1]:v("Two or more N rows");break;case"L":l[x[1]]=h,c[h]=1,g[h]=0,++h;break;case"G":l[x[1]]=h,c[h]=-1,g[h]=0,++h;break;case"E":l[x[1]]=h,c[h]=0,g[h]=0,++h;break;default:v("Parse error "+numeric.prettyPrint(x))}break;case 3:p.hasOwnProperty(x[0])||(p[x[0]]=f,d[f]=0,m[f]=numeric.rep([h],0),++f);var _=p[x[0]];for(n=1;n<x.length;n+=2)if(x[n]!==u){var b=l[x[n]];m[_][b]=(c[b]<0?-1:1)*parseFloat(x[n+1])}else d[_]=parseFloat(x[n+1]);break;case 4:for(n=1;n<x.length;n+=2)g[l[x[n]]]=(c[l[x[n]]]<0?-1:1)*parseFloat(x[n+1]);break;case 5:break;case 6:v("Internal error")}}}v("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(t,e,n,r,i,o,a){function s(t){var e,r,i=this,o=t.length,a=0,s=i.i=i.j=i.m=0;for(i.S=[],i.c=[],o||(t=[o++]);a<n;)i.S[a]=a++;for(a=0;a<n;a++)s=c(s+(e=i.S[a])+t[a%o]),r=i.S[s],i.S[a]=r,i.S[s]=e;i.g=function(t){var e=i.S,r=c(i.i+1),o=e[r],a=c(i.j+o),s=e[a];e[r]=s,e[a]=o;for(var u=e[c(o+s)];--t;)r=c(r+1),s=e[a=c(a+(o=e[r]))],e[r]=s,e[a]=o,u=u*n+e[c(o+s)];return i.i=r,i.j=a,u},i.g(n)}function u(t,e,n,r,i){if(n=[],i=typeof t,e&&"object"==i)for(r in t)if(r.indexOf("S")<5)try{n.push(u(t[r],e-1))}catch(t){}return n.length?n:t+("string"!=i?"\0":"")}function l(t,e,n,r){for(t+="",n=0,r=0;r<t.length;r++)e[c(r)]=c((n^=19*e[c(r)])+t.charCodeAt(r));for(r in t="",e)t+=String.fromCharCode(e[r]);return t}function c(t){return t&n-1}e.seedrandom=function(c,h){var p,f=[];return c=l(u(h?[c,t]:arguments.length?c:[(new Date).getTime(),t,window],3),f),l((p=new s(f)).S,t),e.random=function(){for(var t=p.g(r),e=a,s=0;t<i;)t=(t+s)*n,e*=n,s=p.g(1);for(;t>=o;)t/=2,e/=2,s>>>=1;return(t+s)/e},c},a=e.pow(n,r),i=e.pow(2,i),o=2*i,l(e.random(),t)}([],numeric.seedrandom,256,6,52),function(t){function e(t){if("object"!=typeof t)return t;var n,r=[],i=t.length;for(n=0;n<i;n++)r[n+1]=e(t[n]);return r}function n(t){if("object"!=typeof t)return t;var e,r=[],i=t.length;for(e=1;e<i;e++)r[e-1]=n(t[e]);return r}function r(t,e,n,r,i,o,a,s,u,l,c,h,p,f,d,m){var g,v,y,x,_,b,w,M,S,T,E,A,P,C,L,I,O,N,R,D,k,F,B,U,z,V,G;P=Math.min(r,l),y=2*r+P*(P+5)/2+2*l+1,U=1e-60;do{z=1+.1*(U+=U),V=1+.2*U}while(z<=1||V<=1);for(g=1;g<=r;g+=1)d[g]=e[g];for(g=r+1;g<=y;g+=1)d[g]=0;for(g=1;g<=l;g+=1)h[g]=0;if(_=[],0===m[1]){if(function(t,e,n,r){var i,o,a,s,u,l;for(o=1;o<=n;o+=1){if(r[1]=o,l=0,(a=o-1)<1){if((l=t[o][o]-l)<=0)break;t[o][o]=Math.sqrt(l)}else{for(s=1;s<=a;s+=1){for(u=t[s][o],i=1;i<s;i+=1)u-=t[i][o]*t[i][s];u/=t[s][s],t[s][o]=u,l+=u*u}if((l=t[o][o]-l)<=0)break;t[o][o]=Math.sqrt(l)}r[1]=0}}(t,0,r,_),0!==_[1])return void(m[1]=2);!function(t,e,n,r){var i,o,a,s;for(o=1;o<=n;o+=1){for(s=0,i=1;i<o;i+=1)s+=t[i][o]*r[i];r[o]=(r[o]-s)/t[o][o]}for(a=1;a<=n;a+=1)for(r[o=n+1-a]=r[o]/t[o][o],s=-r[o],i=1;i<o;i+=1)r[i]=r[i]+s*t[i][o]}(t,0,r,e),function(t,e,n){var r,i,o,a,s;for(o=1;o<=n;o+=1){for(t[o][o]=1/t[o][o],s=-t[o][o],r=1;r<o;r+=1)t[r][o]=s*t[r][o];if(n<(a=o+1))break;for(i=a;i<=n;i+=1)for(s=t[o][i],t[o][i]=0,r=1;r<=o;r+=1)t[r][i]=t[r][i]+s*t[r][o]}}(t,0,r)}else{for(v=1;v<=r;v+=1)for(i[v]=0,g=1;g<=v;g+=1)i[v]=i[v]+t[g][v]*e[g];for(v=1;v<=r;v+=1)for(e[v]=0,g=v;g<=r;g+=1)e[v]=e[v]+t[v][g]*i[g]}for(o[1]=0,v=1;v<=r;v+=1)for(i[v]=e[v],o[1]=o[1]+d[v]*i[v],d[v]=0,g=v+1;g<=r;g+=1)t[g][v]=0;for(o[1]=-o[1]/2,m[1]=0,C=(T=(S=(E=(M=(w=r)+r)+P)+P+1)+P*(P+1)/2)+l,g=1;g<=l;g+=1){for(I=0,v=1;v<=r;v+=1)I+=a[v][g]*a[v][g];d[C+g]=Math.sqrt(I)}function j(){for(f[1]=f[1]+1,y=T,g=1;g<=l;g+=1){for(y+=1,I=-s[g],v=1;v<=r;v+=1)I+=a[v][g]*i[v];if(Math.abs(I)<U&&(I=0),g>c)d[y]=I;else if(d[y]=-Math.abs(I),I>0){for(v=1;v<=r;v+=1)a[v][g]=-a[v][g];s[g]=-s[g]}}for(g=1;g<=p;g+=1)d[T+h[g]]=0;for(A=0,L=0,g=1;g<=l;g+=1)d[T+g]<L*d[C+g]&&(A=g,L=d[T+g]/d[C+g]);return 0===A?999:0}function W(){for(g=1;g<=r;g+=1){for(I=0,v=1;v<=r;v+=1)I+=t[v][g]*a[v][A];d[g]=I}for(x=w,g=1;g<=r;g+=1)d[x+g]=0;for(v=p+1;v<=r;v+=1)for(g=1;g<=r;g+=1)d[x+g]=d[x+g]+t[g][v]*d[v];for(F=!0,g=p;g>=1;g-=1){for(I=d[g],x=(y=S+g*(g+3)/2)-g,v=g+1;v<=p;v+=1)I-=d[y]*d[M+v],y+=v;if(I/=d[x],d[M+g]=I,h[g]<c)break;if(I<0)break;F=!1,b=g}if(!F)for(O=d[E+b]/d[M+b],g=1;g<=p&&!(h[g]<c)&&!(d[M+g]<0);g+=1)(L=d[E+g]/d[M+g])<O&&(O=L,b=g);for(I=0,g=w+1;g<=w+r;g+=1)I+=d[g]*d[g];if(Math.abs(I)<=U){if(F)return m[1]=1,999;for(g=1;g<=p;g+=1)d[E+g]=d[E+g]-O*d[M+g];return d[E+p+1]=d[E+p+1]+O,700}for(I=0,g=1;g<=r;g+=1)I+=d[w+g]*a[g][A];for(N=-d[T+A]/I,B=!0,F||O<N&&(N=O,B=!1),g=1;g<=r;g+=1)i[g]=i[g]+N*d[w+g],Math.abs(i[g])<U&&(i[g]=0);for(o[1]=o[1]+N*I*(N/2+d[E+p+1]),g=1;g<=p;g+=1)d[E+g]=d[E+g]-N*d[M+g];if(d[E+p+1]=d[E+p+1]+N,!B){for(I=-s[A],v=1;v<=r;v+=1)I+=i[v]*a[v][A];if(A>c)d[T+A]=I;else if(d[T+A]=-Math.abs(I),I>0){for(v=1;v<=r;v+=1)a[v][A]=-a[v][A];s[A]=-s[A]}return 700}for(h[p+=1]=A,y=S+(p-1)*p/2+1,g=1;g<=p-1;g+=1)d[y]=d[g],y+=1;if(p===r)d[y]=d[r];else{for(g=r;g>=p+1&&0!==d[g]&&(R=Math.max(Math.abs(d[g-1]),Math.abs(d[g])),D=Math.min(Math.abs(d[g-1]),Math.abs(d[g])),L=d[g-1]>=0?Math.abs(R*Math.sqrt(1+D*D/(R*R))):-Math.abs(R*Math.sqrt(1+D*D/(R*R))),R=d[g-1]/L,D=d[g]/L,1!==R);g-=1)if(0===R)for(d[g-1]=D*L,v=1;v<=r;v+=1)L=t[v][g-1],t[v][g-1]=t[v][g],t[v][g]=L;else for(d[g-1]=L,k=D/(1+R),v=1;v<=r;v+=1)L=R*t[v][g-1]+D*t[v][g],t[v][g]=k*(t[v][g-1]+L)-t[v][g],t[v][g-1]=L;d[y]=d[p]}return 0}function H(){if(0===d[x=(y=S+b*(b+1)/2+1)+b])return 798;if(R=Math.max(Math.abs(d[x-1]),Math.abs(d[x])),D=Math.min(Math.abs(d[x-1]),Math.abs(d[x])),L=d[x-1]>=0?Math.abs(R*Math.sqrt(1+D*D/(R*R))):-Math.abs(R*Math.sqrt(1+D*D/(R*R))),R=d[x-1]/L,D=d[x]/L,1===R)return 798;if(0===R){for(g=b+1;g<=p;g+=1)L=d[x-1],d[x-1]=d[x],d[x]=L,x+=g;for(g=1;g<=r;g+=1)L=t[g][b],t[g][b]=t[g][b+1],t[g][b+1]=L}else{for(k=D/(1+R),g=b+1;g<=p;g+=1)L=R*d[x-1]+D*d[x],d[x]=k*(d[x-1]+L)-d[x],d[x-1]=L,x+=g;for(g=1;g<=r;g+=1)L=R*t[g][b]+D*t[g][b+1],t[g][b+1]=k*(t[g][b]+L)-t[g][b+1],t[g][b]=L}return 0}function X(){for(x=y-b,g=1;g<=b;g+=1)d[x]=d[y],y+=1,x+=1;return d[E+b]=d[E+b+1],h[b]=h[b+1],(b+=1)<p?797:0}function Y(){return d[E+p]=d[E+p+1],d[E+p+1]=0,h[p]=0,p-=1,f[2]=f[2]+1,0}for(p=0,f[1]=0,f[2]=0,G=0;;){if(999===(G=j()))return;for(;0!==(G=W());){if(999===G)return;if(700===G)if(b===p)Y();else{for(;H(),797===(G=X()););Y()}}}}t.solveQP=function(t,i,o,a,s,u){t=e(t),i=e(i),o=e(o);var l,c,h,p,f,d=[],m=[],g=[],v=[],y=[];if(s=s||0,u=u?e(u):[void 0,0],a=a?e(a):[],c=t.length-1,h=o[1].length-1,!a)for(l=1;l<=h;l+=1)a[l]=0;for(l=1;l<=h;l+=1)m[l]=0;for(0,p=Math.min(c,h),l=1;l<=c;l+=1)g[l]=0;for(d[1]=0,l=1;l<=2*c+p*(p+5)/2+2*h+1;l+=1)v[l]=0;for(l=1;l<=2;l+=1)y[l]=0;return r(t,i,0,c,g,d,o,a,0,h,s,m,0,y,v,u),f="",1===u[1]&&(f="constraints are inconsistent, no solution!"),2===u[1]&&(f="matrix D in quadratic function is not positive definite!"),{solution:n(g),value:n(d),unconstrained_solution:n(i),iterations:n(y),iact:n(m),message:f}}}(numeric),numeric.svd=function(t){var e,n=numeric.epsilon,r=1e-64/n,i=0,o=0,a=0,s=0,u=0,l=numeric.clone(t),c=l.length,h=l[0].length;if(c<h)throw"Need more rows than columns";var p=new Array(h),f=new Array(h);for(o=0;o<h;o++)p[o]=f[o]=0;var d=numeric.rep([h,h],0);function m(t,e){return(t=Math.abs(t))>(e=Math.abs(e))?t*Math.sqrt(1+e*e/t/t):0==e?t:e*Math.sqrt(1+t*t/e/e)}var g=0,v=0,y=0,x=0,_=0,b=0,w=0;for(o=0;o<h;o++){for(p[o]=v,w=0,u=o+1,a=o;a<c;a++)w+=l[a][o]*l[a][o];if(w<=r)v=0;else for(g=l[o][o],v=Math.sqrt(w),g>=0&&(v=-v),y=g*v-w,l[o][o]=g-v,a=u;a<h;a++){for(w=0,s=o;s<c;s++)w+=l[s][o]*l[s][a];for(g=w/y,s=o;s<c;s++)l[s][a]+=g*l[s][o]}for(f[o]=v,w=0,a=u;a<h;a++)w+=l[o][a]*l[o][a];if(w<=r)v=0;else{for(g=l[o][o+1],v=Math.sqrt(w),g>=0&&(v=-v),y=g*v-w,l[o][o+1]=g-v,a=u;a<h;a++)p[a]=l[o][a]/y;for(a=u;a<c;a++){for(w=0,s=u;s<h;s++)w+=l[a][s]*l[o][s];for(s=u;s<h;s++)l[a][s]+=w*p[s]}}(_=Math.abs(f[o])+Math.abs(p[o]))>x&&(x=_)}for(o=h-1;-1!=o;o+=-1){if(0!=v){for(y=v*l[o][o+1],a=u;a<h;a++)d[a][o]=l[o][a]/y;for(a=u;a<h;a++){for(w=0,s=u;s<h;s++)w+=l[o][s]*d[s][a];for(s=u;s<h;s++)d[s][a]+=w*d[s][o]}}for(a=u;a<h;a++)d[o][a]=0,d[a][o]=0;d[o][o]=1,v=p[o],u=o}for(o=h-1;-1!=o;o+=-1){for(u=o+1,v=f[o],a=u;a<h;a++)l[o][a]=0;if(0!=v){for(y=l[o][o]*v,a=u;a<h;a++){for(w=0,s=u;s<c;s++)w+=l[s][o]*l[s][a];for(g=w/y,s=o;s<c;s++)l[s][a]+=g*l[s][o]}for(a=o;a<c;a++)l[a][o]=l[a][o]/v}else for(a=o;a<c;a++)l[a][o]=0;l[o][o]+=1}for(n*=x,s=h-1;-1!=s;s+=-1)for(var M=0;M<50;M++){var S=!1;for(u=s;-1!=u;u+=-1){if(Math.abs(p[u])<=n){S=!0;break}if(Math.abs(f[u-1])<=n)break}if(!S){i=0,w=1;var T=u-1;for(o=u;o<s+1&&(g=w*p[o],p[o]=i*p[o],!(Math.abs(g)<=n));o++)for(y=m(g,v=f[o]),f[o]=y,i=v/y,w=-g/y,a=0;a<c;a++)_=l[a][T],b=l[a][o],l[a][T]=_*i+b*w,l[a][o]=-_*w+b*i}if(b=f[s],u==s){if(b<0)for(f[s]=-b,a=0;a<h;a++)d[a][s]=-d[a][s];break}if(M>=49)throw"Error: no convergence.";for(x=f[u],v=m(g=(((_=f[s-1])-b)*(_+b)+((v=p[s-1])-(y=p[s]))*(v+y))/(2*y*_),1),g=g<0?((x-b)*(x+b)+y*(_/(g-v)-y))/x:((x-b)*(x+b)+y*(_/(g+v)-y))/x,i=1,w=1,o=u+1;o<s+1;o++){for(v=p[o],_=f[o],y=w*v,v*=i,b=m(g,y),p[o-1]=b,g=x*(i=g/b)+v*(w=y/b),v=-x*w+v*i,y=_*w,_*=i,a=0;a<h;a++)x=d[a][o-1],b=d[a][o],d[a][o-1]=x*i+b*w,d[a][o]=-x*w+b*i;for(b=m(g,y),f[o-1]=b,g=(i=g/b)*v+(w=y/b)*_,x=-w*v+i*_,a=0;a<c;a++)_=l[a][o-1],b=l[a][o],l[a][o-1]=_*i+b*w,l[a][o]=-_*w+b*i}p[u]=0,p[s]=g,f[s]=x}for(o=0;o<f.length;o++)f[o]<n&&(f[o]=0);for(o=0;o<h;o++)for(a=o-1;a>=0;a--)if(f[a]<f[o]){for(i=f[a],f[a]=f[o],f[o]=i,s=0;s<l.length;s++)e=l[s][o],l[s][o]=l[s][a],l[s][a]=e;for(s=0;s<d.length;s++)e=d[s][o],d[s][o]=d[s][a],d[s][a]=e;o=a}return{U:l,S:f,V:d}}},98184:function(t){"use strict";var e=function(t,e){this.head_=t,this.tail_=e,this.search_node_=t};e.prototype.head=function(){return this.head_},e.prototype.setHead=function(t){this.head_=t},e.prototype.tail=function(){return this.tail_},e.prototype.setTail=function(t){this.tail_=t},e.prototype.search=function(){return this.search_node_},e.prototype.setSearch=function(t){this.search_node_=t},e.prototype.findSearchNode=function(){return this.search_node_},e.prototype.locateNode=function(t){var e=this.search_node_;if(t<e.value){for(;e=e.prev;)if(t>=e.value)return this.search_node_=e,e}else for(;e=e.next;)if(t<e.value)return this.search_node_=e.prev,e.prev;return null},e.prototype.locatePoint=function(t){var e=t.x,n=this.findSearchNode(e),r=n.point.x;if(e===r){if(t!==n.point)if(t===n.prev.point)n=n.prev;else{if(t!==n.next.point)throw new Error("poly2tri Invalid AdvancingFront.locatePoint() call");n=n.next}}else if(e<r)for(;(n=n.prev)&&t!==n.point;);else for(;(n=n.next)&&t!==n.point;);return n&&(this.search_node_=n),n},t.exports=e,t.exports.Node=function(t,e){this.point=t,this.triangle=e||null,this.next=null,this.prev=null,this.value=t.x}},70088:function(t){"use strict";t.exports=function(t,e){if(!t)throw new Error(e||"Assert Failed")}},60787:function(t,e,n){"use strict";var r=n(36982),i=function(t,e){this.x=+t||0,this.y=+e||0,this._p2t_edge_list=null};i.prototype.toString=function(){return r.toStringBase(this)},i.prototype.toJSON=function(){return{x:this.x,y:this.y}},i.prototype.clone=function(){return new i(this.x,this.y)},i.prototype.set_zero=function(){return this.x=0,this.y=0,this},i.prototype.set=function(t,e){return this.x=+t||0,this.y=+e||0,this},i.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},i.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},i.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this},i.prototype.mul=function(t){return this.x*=t,this.y*=t,this},i.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},i.prototype.normalize=function(){var t=this.length();return this.x/=t,this.y/=t,t},i.prototype.equals=function(t){return this.x===t.x&&this.y===t.y},i.negate=function(t){return new i(-t.x,-t.y)},i.add=function(t,e){return new i(t.x+e.x,t.y+e.y)},i.sub=function(t,e){return new i(t.x-e.x,t.y-e.y)},i.mul=function(t,e){return new i(t*e.x,t*e.y)},i.cross=function(t,e){return"number"==typeof t?"number"==typeof e?t*e:new i(-t*e.y,t*e.x):"number"==typeof e?new i(e*t.y,-e*t.x):t.x*e.y-t.y*e.x},i.toString=r.toString,i.compare=r.compare,i.cmp=r.compare,i.equals=r.equals,i.dot=function(t,e){return t.x*e.x+t.y*e.y},t.exports=i},14358:function(t,e,n){"use strict";var r=n(36982),i=function(t,e){this.name="PointError",this.points=e=e||[],this.message=t||"Invalid Points!";for(var n=0;n<e.length;n++)this.message+=" "+r.toString(e[n])};(i.prototype=new Error).constructor=i,t.exports=i},46768:function(t,e,n){"use strict";var r=n.g.poly2tri;e.noConflict=function(){return n.g.poly2tri=r,e},e.VERSION=n(37426).version,e.PointError=n(14358),e.Point=n(60787),e.Triangle=n(90768),e.SweepContext=n(11860);var i=n(44343);e.triangulate=i.triangulate,e.sweep={Triangulate:i.triangulate}},44343:function(t,e,n){"use strict";var r=n(70088),i=n(14358),o=n(90768),a=n(98184).Node,s=n(47679),u=s.EPSILON,l=s.Orientation,c=s.orient2d,h=s.inScanArea,p=s.isAngleObtuse;function f(t,e){var n=t.locateNode(e),i=function(t,e,n){var r=new o(e,n.point,n.next.point);r.markNeighbor(n.triangle),t.addToMap(r);var i=new a(e);i.next=n.next,i.prev=n,n.next.prev=i,n.next=i,y(t,r)||t.mapTriangleToNodes(r);return i}(t,e,n);return e.x<=n.point.x+u&&v(t,n),function(t,e){var n=e.next;for(;n.next&&!p(n.point,n.next.point,n.prev.point);)v(t,n),n=n.next;n=e.prev;for(;n.prev&&!p(n.point,n.next.point,n.prev.point);)v(t,n),n=n.prev;e.next&&e.next.next&&function(t){var e=t.point.x-t.next.next.point.x,n=t.point.y-t.next.next.point.y;return r(n>=0,"unordered y"),e>=0||Math.abs(e)<n}(e)&&function(t,e){c(e.point,e.next.point,e.next.next.point)===l.CCW?t.basin.left_node=e.next.next:t.basin.left_node=e.next;t.basin.bottom_node=t.basin.left_node;for(;t.basin.bottom_node.next&&t.basin.bottom_node.point.y>=t.basin.bottom_node.next.point.y;)t.basin.bottom_node=t.basin.bottom_node.next;if(t.basin.bottom_node===t.basin.left_node)return;t.basin.right_node=t.basin.bottom_node;for(;t.basin.right_node.next&&t.basin.right_node.point.y<t.basin.right_node.next.point.y;)t.basin.right_node=t.basin.right_node.next;if(t.basin.right_node===t.basin.bottom_node)return;t.basin.width=t.basin.right_node.point.x-t.basin.left_node.point.x,t.basin.left_highest=t.basin.left_node.point.y>t.basin.right_node.point.y,b(t,t.basin.bottom_node)}(t,e)}(t,i),i}function d(t,e,n){t.edge_event.constrained_edge=e,t.edge_event.right=e.p.x>e.q.x,g(n.triangle,e.p,e.q)||(!function(t,e,n){t.edge_event.right?function(t,e,n){for(;n.next.point.x<e.p.x;)c(e.q,n.next.point,e.p)===l.CCW?w(t,e,n):n=n.next}(t,e,n):function(t,e,n){for(;n.prev.point.x>e.p.x;)c(e.q,n.prev.point,e.p)===l.CW?T(t,e,n):n=n.prev}(t,e,n)}(t,e,n),m(t,e.p,e.q,n.triangle,e.q))}function m(t,e,n,r,o){if(!g(r,e,n)){var a=r.pointCCW(o),s=c(n,a,e);if(s===l.COLLINEAR)throw new i("poly2tri EdgeEvent: Collinear not supported!",[n,a,e]);var u=r.pointCW(o),h=c(n,u,e);if(h===l.COLLINEAR)throw new i("poly2tri EdgeEvent: Collinear not supported!",[n,u,e]);s===h?m(t,e,n,r=s===l.CW?r.neighborCCW(o):r.neighborCW(o),o):P(t,e,n,r,o)}}function g(t,e,n){var r=t.edgeIndex(e,n);if(-1!==r){t.markConstrainedEdgeByIndex(r);var i=t.getNeighbor(r);return i&&i.markConstrainedEdgeByPoints(e,n),!0}return!1}function v(t,e){var n=new o(e.prev.point,e.point,e.next.point);n.markNeighbor(e.prev.triangle),n.markNeighbor(e.triangle),t.addToMap(n),e.prev.next=e.next,e.next.prev=e.prev,y(t,n)||t.mapTriangleToNodes(n)}function y(t,e){for(var n=0;n<3;++n)if(!e.delaunay_edge[n]){var r=e.getNeighbor(n);if(r){var i=e.getPoint(n),o=r.oppositePoint(e,i),a=r.index(o);if(r.constrained_edge[a]||r.delaunay_edge[a]){e.constrained_edge[n]=r.constrained_edge[a];continue}if(x(i,e.pointCCW(i),e.pointCW(i),o)){e.delaunay_edge[n]=!0,r.delaunay_edge[a]=!0,_(e,i,r,o);var s=!y(t,e);return s&&t.mapTriangleToNodes(e),(s=!y(t,r))&&t.mapTriangleToNodes(r),e.delaunay_edge[n]=!1,r.delaunay_edge[a]=!1,!0}}}return!1}function x(t,e,n,r){var i=t.x-r.x,o=t.y-r.y,a=e.x-r.x,s=e.y-r.y,u=i*s-a*o;if(u<=0)return!1;var l=n.x-r.x,c=n.y-r.y,h=l*o-i*c;return!(h<=0)&&(i*i+o*o)*(a*c-l*s)+(a*a+s*s)*h+(l*l+c*c)*u>0}function _(t,e,n,r){var i,o,a,s,u,l,c,h,p,f,d,m;i=t.neighborCCW(e),o=t.neighborCW(e),a=n.neighborCCW(r),s=n.neighborCW(r),u=t.getConstrainedEdgeCCW(e),l=t.getConstrainedEdgeCW(e),c=n.getConstrainedEdgeCCW(r),h=n.getConstrainedEdgeCW(r),p=t.getDelaunayEdgeCCW(e),f=t.getDelaunayEdgeCW(e),d=n.getDelaunayEdgeCCW(r),m=n.getDelaunayEdgeCW(r),t.legalize(e,r),n.legalize(r,e),n.setDelaunayEdgeCCW(e,p),t.setDelaunayEdgeCW(e,f),t.setDelaunayEdgeCCW(r,d),n.setDelaunayEdgeCW(r,m),n.setConstrainedEdgeCCW(e,u),t.setConstrainedEdgeCW(e,l),t.setConstrainedEdgeCCW(r,c),n.setConstrainedEdgeCW(r,h),t.clearNeighbors(),n.clearNeighbors(),i&&n.markNeighbor(i),o&&t.markNeighbor(o),a&&t.markNeighbor(a),s&&n.markNeighbor(s),t.markNeighbor(n)}function b(t,e){if(!function(t,e){var n;n=t.basin.left_highest?t.basin.left_node.point.y-e.point.y:t.basin.right_node.point.y-e.point.y;if(t.basin.width>n)return!0;return!1}(t,e)&&(v(t,e),e.prev!==t.basin.left_node||e.next!==t.basin.right_node)){if(e.prev===t.basin.left_node){if(c(e.point,e.next.point,e.next.next.point)===l.CW)return;e=e.next}else if(e.next===t.basin.right_node){if(c(e.point,e.prev.point,e.prev.prev.point)===l.CCW)return;e=e.prev}else e=e.prev.point.y<e.next.point.y?e.prev:e.next;b(t,e)}}function w(t,e,n){n.point.x<e.p.x&&(c(n.point,n.next.point,n.next.next.point)===l.CCW?M(t,e,n):(S(t,e,n),w(t,e,n)))}function M(t,e,n){v(t,n.next),n.next.point!==e.p&&c(e.q,n.next.point,e.p)===l.CCW&&c(n.point,n.next.point,n.next.next.point)===l.CCW&&M(t,e,n)}function S(t,e,n){c(n.next.point,n.next.next.point,n.next.next.next.point)===l.CCW?M(t,e,n.next):c(e.q,n.next.next.point,e.p)===l.CCW&&S(t,e,n.next)}function T(t,e,n){n.point.x>e.p.x&&(c(n.point,n.prev.point,n.prev.prev.point)===l.CW?A(t,e,n):(E(t,e,n),T(t,e,n)))}function E(t,e,n){c(n.prev.point,n.prev.prev.point,n.prev.prev.prev.point)===l.CW?A(t,e,n.prev):c(e.q,n.prev.prev.point,e.p)===l.CW&&E(t,e,n.prev)}function A(t,e,n){v(t,n.prev),n.prev.point!==e.p&&c(e.q,n.prev.point,e.p)===l.CW&&c(n.point,n.prev.point,n.prev.prev.point)===l.CW&&A(t,e,n)}function P(t,e,n,o,a){var s=o.neighborAcross(a);r(s,"FLIP failed due to missing triangle!");var u=s.oppositePoint(o,a);if(o.getConstrainedEdgeAcross(a)){var p=o.index(a);throw new i("poly2tri Intersecting Constraints",[a,u,o.getPoint((p+1)%3),o.getPoint((p+2)%3)])}h(a,o.pointCCW(a),o.pointCW(a),u)?(_(o,a,s,u),t.mapTriangleToNodes(o),t.mapTriangleToNodes(s),a===n&&u===e?n===t.edge_event.constrained_edge.q&&e===t.edge_event.constrained_edge.p&&(o.markConstrainedEdgeByPoints(e,n),s.markConstrainedEdgeByPoints(e,n),y(t,o),y(t,s)):(o=function(t,e,n,r,i,o){var a;if(e===l.CCW)return a=r.edgeIndex(i,o),r.delaunay_edge[a]=!0,y(t,r),r.clearDelaunayEdges(),n;return a=n.edgeIndex(i,o),n.delaunay_edge[a]=!0,y(t,n),n.clearDelaunayEdges(),r}(t,c(n,u,e),o,s,a,u),P(t,e,n,o,a))):(L(t,e,n,o,s,C(e,n,s,u)),m(t,e,n,o,a))}function C(t,e,n,r){var o=c(e,r,t);if(o===l.CW)return n.pointCCW(r);if(o===l.CCW)return n.pointCW(r);throw new i("poly2tri [Unsupported] nextFlipPoint: opposing point on constrained edge!",[e,r,t])}function L(t,e,n,i,o,a){var s=o.neighborAcross(a);r(s,"FLIP failed due to missing triangle");var u=s.oppositePoint(o,a);h(n,i.pointCCW(n),i.pointCW(n),u)?P(t,n,u,s,u):L(t,e,n,i,s,C(e,n,s,u))}e.triangulate=function(t){t.initTriangulation(),t.createAdvancingFront(),function(t){var e,n=t.pointCount();for(e=1;e<n;++e)for(var r=t.getPoint(e),i=f(t,r),o=r._p2t_edge_list,a=0;o&&a<o.length;++a)d(t,o[a],i)}(t),function(t){var e=t.front().head().next.triangle,n=t.front().head().next.point;for(;!e.getConstrainedEdgeCW(n);)e=e.neighborCCW(n);t.meshClean(e)}(t)}},11860:function(t,e,n){"use strict";var r=n(14358),i=n(60787),o=n(90768),a=n(44343),s=n(98184),u=s.Node,l=function(t,e){if(this.p=t,this.q=e,t.y>e.y)this.q=t,this.p=e;else if(t.y===e.y)if(t.x>e.x)this.q=t,this.p=e;else if(t.x===e.x)throw new r("poly2tri Invalid Edge constructor: repeated points!",[t]);this.q._p2t_edge_list||(this.q._p2t_edge_list=[]),this.q._p2t_edge_list.push(this)},c=function(){this.left_node=null,this.bottom_node=null,this.right_node=null,this.width=0,this.left_highest=!1};c.prototype.clear=function(){this.left_node=null,this.bottom_node=null,this.right_node=null,this.width=0,this.left_highest=!1};var h=function(){this.constrained_edge=null,this.right=!1},p=function(t,e){e=e||{},this.triangles_=[],this.map_=[],this.points_=e.cloneArrays?t.slice(0):t,this.edge_list=[],this.pmin_=this.pmax_=null,this.front_=null,this.head_=null,this.tail_=null,this.af_head_=null,this.af_middle_=null,this.af_tail_=null,this.basin=new c,this.edge_event=new h,this.initEdges(this.points_)};p.prototype.addHole=function(t){this.initEdges(t);var e,n=t.length;for(e=0;e<n;e++)this.points_.push(t[e]);return this},p.prototype.AddHole=p.prototype.addHole,p.prototype.addHoles=function(t){var e,n=t.length;for(e=0;e<n;e++)this.initEdges(t[e]);return this.points_=this.points_.concat.apply(this.points_,t),this},p.prototype.addPoint=function(t){return this.points_.push(t),this},p.prototype.AddPoint=p.prototype.addPoint,p.prototype.addPoints=function(t){return this.points_=this.points_.concat(t),this},p.prototype.triangulate=function(){return a.triangulate(this),this},p.prototype.getBoundingBox=function(){return{min:this.pmin_,max:this.pmax_}},p.prototype.getTriangles=function(){return this.triangles_},p.prototype.GetTriangles=p.prototype.getTriangles,p.prototype.front=function(){return this.front_},p.prototype.pointCount=function(){return this.points_.length},p.prototype.head=function(){return this.head_},p.prototype.setHead=function(t){this.head_=t},p.prototype.tail=function(){return this.tail_},p.prototype.setTail=function(t){this.tail_=t},p.prototype.getMap=function(){return this.map_},p.prototype.initTriangulation=function(){var t,e=this.points_[0].x,n=this.points_[0].x,r=this.points_[0].y,o=this.points_[0].y,a=this.points_.length;for(t=1;t<a;t++){var s=this.points_[t];s.x>e&&(e=s.x),s.x<n&&(n=s.x),s.y>r&&(r=s.y),s.y<o&&(o=s.y)}this.pmin_=new i(n,o),this.pmax_=new i(e,r);var u=.3*(e-n),l=.3*(r-o);this.head_=new i(e+u,o-l),this.tail_=new i(n-u,o-l),this.points_.sort(i.compare)},p.prototype.initEdges=function(t){var e,n=t.length;for(e=0;e<n;++e)this.edge_list.push(new l(t[e],t[(e+1)%n]))},p.prototype.getPoint=function(t){return this.points_[t]},p.prototype.addToMap=function(t){this.map_.push(t)},p.prototype.locateNode=function(t){return this.front_.locateNode(t.x)},p.prototype.createAdvancingFront=function(){var t,e,n,r=new o(this.points_[0],this.tail_,this.head_);this.map_.push(r),t=new u(r.getPoint(1),r),e=new u(r.getPoint(0),r),n=new u(r.getPoint(2)),this.front_=new s(t,n),t.next=e,e.next=n,e.prev=t,n.prev=e},p.prototype.removeNode=function(t){},p.prototype.mapTriangleToNodes=function(t){for(var e=0;e<3;++e)if(!t.getNeighbor(e)){var n=this.front_.locatePoint(t.pointCW(t.getPoint(e)));n&&(n.triangle=t)}},p.prototype.removeFromMap=function(t){var e,n=this.map_,r=n.length;for(e=0;e<r;e++)if(n[e]===t){n.splice(e,1);break}},p.prototype.meshClean=function(t){for(var e,n,r=[t];e=r.pop();)if(!e.isInterior())for(e.setInterior(!0),this.triangles_.push(e),n=0;n<3;n++)e.constrained_edge[n]||r.push(e.getNeighbor(n))},t.exports=p},90768:function(t,e,n){"use strict";var r=function(t,e,n){this.points_=[t,e,n],this.neighbors_=[null,null,null],this.interior_=!1,this.constrained_edge=[!1,!1,!1],this.delaunay_edge=[!1,!1,!1]},i=n(36982).toString;r.prototype.toString=function(){return"["+i(this.points_[0])+i(this.points_[1])+i(this.points_[2])+"]"},r.prototype.getPoint=function(t){return this.points_[t]},r.prototype.GetPoint=r.prototype.getPoint,r.prototype.getPoints=function(){return this.points_},r.prototype.getNeighbor=function(t){return this.neighbors_[t]},r.prototype.containsPoint=function(t){var e=this.points_;return t===e[0]||t===e[1]||t===e[2]},r.prototype.containsEdge=function(t){return this.containsPoint(t.p)&&this.containsPoint(t.q)},r.prototype.containsPoints=function(t,e){return this.containsPoint(t)&&this.containsPoint(e)},r.prototype.isInterior=function(){return this.interior_},r.prototype.setInterior=function(t){return this.interior_=t,this},r.prototype.markNeighborPointers=function(t,e,n){var r=this.points_;if(t===r[2]&&e===r[1]||t===r[1]&&e===r[2])this.neighbors_[0]=n;else if(t===r[0]&&e===r[2]||t===r[2]&&e===r[0])this.neighbors_[1]=n;else{if(!(t===r[0]&&e===r[1]||t===r[1]&&e===r[0]))throw new Error("poly2tri Invalid Triangle.markNeighborPointers() call");this.neighbors_[2]=n}},r.prototype.markNeighbor=function(t){var e=this.points_;t.containsPoints(e[1],e[2])?(this.neighbors_[0]=t,t.markNeighborPointers(e[1],e[2],this)):t.containsPoints(e[0],e[2])?(this.neighbors_[1]=t,t.markNeighborPointers(e[0],e[2],this)):t.containsPoints(e[0],e[1])&&(this.neighbors_[2]=t,t.markNeighborPointers(e[0],e[1],this))},r.prototype.clearNeighbors=function(){this.neighbors_[0]=null,this.neighbors_[1]=null,this.neighbors_[2]=null},r.prototype.clearDelaunayEdges=function(){this.delaunay_edge[0]=!1,this.delaunay_edge[1]=!1,this.delaunay_edge[2]=!1},r.prototype.pointCW=function(t){var e=this.points_;return t===e[0]?e[2]:t===e[1]?e[0]:t===e[2]?e[1]:null},r.prototype.pointCCW=function(t){var e=this.points_;return t===e[0]?e[1]:t===e[1]?e[2]:t===e[2]?e[0]:null},r.prototype.neighborCW=function(t){return t===this.points_[0]?this.neighbors_[1]:t===this.points_[1]?this.neighbors_[2]:this.neighbors_[0]},r.prototype.neighborCCW=function(t){return t===this.points_[0]?this.neighbors_[2]:t===this.points_[1]?this.neighbors_[0]:this.neighbors_[1]},r.prototype.getConstrainedEdgeCW=function(t){return t===this.points_[0]?this.constrained_edge[1]:t===this.points_[1]?this.constrained_edge[2]:this.constrained_edge[0]},r.prototype.getConstrainedEdgeCCW=function(t){return t===this.points_[0]?this.constrained_edge[2]:t===this.points_[1]?this.constrained_edge[0]:this.constrained_edge[1]},r.prototype.getConstrainedEdgeAcross=function(t){return t===this.points_[0]?this.constrained_edge[0]:t===this.points_[1]?this.constrained_edge[1]:this.constrained_edge[2]},r.prototype.setConstrainedEdgeCW=function(t,e){t===this.points_[0]?this.constrained_edge[1]=e:t===this.points_[1]?this.constrained_edge[2]=e:this.constrained_edge[0]=e},r.prototype.setConstrainedEdgeCCW=function(t,e){t===this.points_[0]?this.constrained_edge[2]=e:t===this.points_[1]?this.constrained_edge[0]=e:this.constrained_edge[1]=e},r.prototype.getDelaunayEdgeCW=function(t){return t===this.points_[0]?this.delaunay_edge[1]:t===this.points_[1]?this.delaunay_edge[2]:this.delaunay_edge[0]},r.prototype.getDelaunayEdgeCCW=function(t){return t===this.points_[0]?this.delaunay_edge[2]:t===this.points_[1]?this.delaunay_edge[0]:this.delaunay_edge[1]},r.prototype.setDelaunayEdgeCW=function(t,e){t===this.points_[0]?this.delaunay_edge[1]=e:t===this.points_[1]?this.delaunay_edge[2]=e:this.delaunay_edge[0]=e},r.prototype.setDelaunayEdgeCCW=function(t,e){t===this.points_[0]?this.delaunay_edge[2]=e:t===this.points_[1]?this.delaunay_edge[0]=e:this.delaunay_edge[1]=e},r.prototype.neighborAcross=function(t){return t===this.points_[0]?this.neighbors_[0]:t===this.points_[1]?this.neighbors_[1]:this.neighbors_[2]},r.prototype.oppositePoint=function(t,e){var n=t.pointCW(e);return this.pointCW(n)},r.prototype.legalize=function(t,e){var n=this.points_;if(t===n[0])n[1]=n[0],n[0]=n[2],n[2]=e;else if(t===n[1])n[2]=n[1],n[1]=n[0],n[0]=e;else{if(t!==n[2])throw new Error("poly2tri Invalid Triangle.legalize() call");n[0]=n[2],n[2]=n[1],n[1]=e}},r.prototype.index=function(t){var e=this.points_;if(t===e[0])return 0;if(t===e[1])return 1;if(t===e[2])return 2;throw new Error("poly2tri Invalid Triangle.index() call")},r.prototype.edgeIndex=function(t,e){var n=this.points_;if(t===n[0]){if(e===n[1])return 2;if(e===n[2])return 1}else if(t===n[1]){if(e===n[2])return 0;if(e===n[0])return 2}else if(t===n[2]){if(e===n[0])return 1;if(e===n[1])return 0}return-1},r.prototype.markConstrainedEdgeByIndex=function(t){this.constrained_edge[t]=!0},r.prototype.markConstrainedEdgeByEdge=function(t){this.markConstrainedEdgeByPoints(t.p,t.q)},r.prototype.markConstrainedEdgeByPoints=function(t,e){var n=this.points_;e===n[0]&&t===n[1]||e===n[1]&&t===n[0]?this.constrained_edge[2]=!0:e===n[0]&&t===n[2]||e===n[2]&&t===n[0]?this.constrained_edge[1]=!0:(e===n[1]&&t===n[2]||e===n[2]&&t===n[1])&&(this.constrained_edge[0]=!0)},t.exports=r},47679:function(t,e){"use strict";var n=1e-12;e.EPSILON=n;var r={CW:1,CCW:-1,COLLINEAR:0};e.Orientation=r,e.orient2d=function(t,e,i){var o=(t.x-i.x)*(e.y-i.y)-(t.y-i.y)*(e.x-i.x);return o>-n&&o<n?r.COLLINEAR:o>0?r.CCW:r.CW},e.inScanArea=function(t,e,r,i){return!((t.x-e.x)*(i.y-e.y)-(i.x-e.x)*(t.y-e.y)>=-n)&&!((t.x-r.x)*(i.y-r.y)-(i.x-r.x)*(t.y-r.y)<=n)},e.isAngleObtuse=function(t,e,n){var r=e.x-t.x,i=e.y-t.y;return r*(n.x-t.x)+i*(n.y-t.y)<0}},36982:function(t){"use strict";function e(t){return"("+t.x+";"+t.y+")"}t.exports={toString:function(t){var n=t.toString();return"[object Object]"===n?e(t):n},toStringBase:e,compare:function(t,e){return t.y===e.y?t.x-e.x:t.y-e.y},equals:function(t,e){return t.x===e.x&&t.y===e.y}}},9297:function(t){function e(t){this._comparator=t||e.DEFAULT_COMPARATOR,this._elements=[]}t.exports=e,e.DEFAULT_COMPARATOR=function(t,e){return"number"==typeof t&&"number"==typeof e?t-e:(t=t.toString())==(e=e.toString())?0:t>e?1:-1},e.prototype.isEmpty=function(){return 0===this.size()},e.prototype.peek=function(){if(this.isEmpty())throw new Error("PriorityQueue is empty");return this._elements[0]},e.prototype.deq=function(){var t=this.peek(),e=this._elements.pop(),n=this.size();if(0===n)return t;this._elements[0]=e;for(var r=0;r<n;){var i=r,o=2*r+1,a=2*r+2;if(o<n&&this._compare(o,i)>=0&&(i=o),a<n&&this._compare(a,i)>=0&&(i=a),i===r)break;this._swap(i,r),r=i}return t},e.prototype.enq=function(t){for(var e=this._elements.push(t),n=e-1;n>0;){var r=Math.floor((n-1)/2);if(this._compare(n,r)<=0)break;this._swap(r,n),n=r}return e},e.prototype.size=function(){return this._elements.length},e.prototype.forEach=function(t){return this._elements.forEach(t)},e.prototype._compare=function(t,e){return this._comparator(this._elements[t],this._elements[e])},e.prototype._swap=function(t,e){var n=this._elements[t];this._elements[t]=this._elements[e],this._elements[e]=n}},81726:function(t,e){var n,r,i;r=[],void 0===(i="function"==typeof(n=function(){return function(){function t(e){var n,r;if(this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this.maxElements=e.maxElements,null==this.width||null==this.height)throw new Error("Missing quadtree dimensions.");if(null==this.x&&(this.x=0),null==this.y&&(this.y=0),null==this.maxElements&&(this.maxElements=1),this.contents=[],this.oversized=[],this.size=0,this.width<1||this.height<1)throw new Error("Dimensions must be positive integers.");if(!Number.isInteger(this.x)||!Number.isInteger(this.y))throw new Error("Coordinates must be integers");if(this.maxElements<1)throw new Error("The maximum number of elements before a split must be a positive integer.");for(n in r=this,this.children={NW:{create:function(){return new t({x:r.x,y:r.y,width:Math.max(Math.floor(r.width/2),1),height:Math.max(Math.floor(r.height/2),1),maxElements:r.maxElements})},tree:null},NE:{create:function(){return new t({x:r.x+Math.max(Math.floor(r.width/2),1),y:r.y,width:Math.ceil(r.width/2),height:Math.max(Math.floor(r.height/2),1),maxElements:r.maxElements})},tree:null},SW:{create:function(){return new t({x:r.x,y:r.y+Math.max(Math.floor(r.height/2),1),width:Math.max(Math.floor(r.width/2),1),height:Math.ceil(r.height/2),maxElements:r.maxElements})},tree:null},SE:{create:function(){return new t({x:r.x+Math.max(Math.floor(r.width/2),1),y:r.y+Math.max(Math.floor(r.height/2),1),width:Math.ceil(r.width/2),height:Math.ceil(r.height/2),maxElements:r.maxElements})},tree:null}},this.children)this.children[n].get=function(){return null!=this.tree||(this.tree=this.create()),this.tree}}var e,n,r,i,o,a,s,u;return i=function(t){var e,n;return{x:Math.floor((null!=(e=t.width)?e:1)/2)+t.x,y:Math.floor((null!=(n=t.height)?n:1)/2)+t.y}},e=function(t,e){var n,r,i,o;return!(t.x>=e.x+(null!=(n=e.width)?n:1)||t.x+(null!=(r=t.width)?r:1)<=e.x||t.y>=e.y+(null!=(i=e.height)?i:1)||t.y+(null!=(o=t.height)?o:1)<=e.y)},n=function(t,e){var n;return n=i(e),t.x<n.x?t.y<n.y?"NW":"SW":t.y<n.y?"NE":"SE"},u=function(t){if("object"!=typeof t)throw new Error("Element must be an Object.");if(null==t.x||null==t.y)throw new Error("Coordinates properties are missing.");if((null!=t?t.width:void 0)<0||(null!=t?t.height:void 0)<0)throw new Error("Width and height must be positive integers.")},a=function(t){var e,n,r,i;return n=Math.max(Math.floor(t.width/2),1),r=Math.ceil(t.width/2),i=Math.max(Math.floor(t.height/2),1),e=Math.ceil(t.height/2),{NW:{x:t.x,y:t.y,width:n,height:i},NE:{x:t.x+n,y:t.y,width:r,height:i},SW:{x:t.x,y:t.y+i,width:n,height:e},SE:{x:t.x+n,y:t.y+i,width:r,height:e}}},r=function(t,n){var r,i,o,s;for(i in s=[],o=a(n))r=o[i],e(t,r)&&s.push(i);return s},o=function(t,e){var n;return(n=function(n){return t["_"+n]=t[n],Object.defineProperty(t,n,{set:function(t){return e.remove(this,!0),this["_"+n]=t,e.push(this)},get:function(){return this["_"+n]},configurable:!0})})("x"),n("y"),n("width"),n("height")},s=function(t){var e;return(e=function(e){if(null!=t["_"+e])return delete t[e],t[e]=t["_"+e],delete t["_"+e]})("x"),e("y"),e("width"),e("height")},t.prototype.clear=function(){var t,e;for(t in this.contents=[],this.oversized=[],this.size=0,e=[],this.children)e.push(this.children[t].tree=null);return e},t.prototype.push=function(t,e){return this.pushAll([t],e)},t.prototype.pushAll=function(t,e){var n,i,a,s,l,c,h,p,f,d,m,g,v,y,x,_,b,w,M,S;for(m=0,y=t.length;m<y;m++)d=t[m],u(d),e&&o(d,this);for(h=[{tree:this,elements:t}];h.length>0;){for(S=(b=h.shift()).tree,p={NW:null,NE:null,SW:null,SE:null},g=0,x=(c=b.elements).length;g<x;g++)if(l=c[g],S.size++,1!==(f=r(l,S)).length||1===S.width||1===S.height)S.oversized.push(l);else if(S.size-S.oversized.length<=S.maxElements)S.contents.push(l);else{for(s=f[0],M=S.children[s],null==p[s]&&(p[s]={tree:M.get(),elements:[]}),p[s].elements.push(l),v=0,_=(w=S.contents).length;v<_;v++)i=w[v],null==p[a=r(i,S)[0]]&&(p[a]={tree:S.children[a].get(),elements:[]}),p[a].elements.push(i);S.contents=[]}for(s in p)null!=(n=p[s])&&h.push(n)}return this},t.prototype.remove=function(t,e){var r,i;return u(t),(r=this.oversized.indexOf(t))>-1?(this.oversized.splice(r,1),this.size--,e||s(t),!0):(r=this.contents.indexOf(t))>-1?(this.contents.splice(r,1),this.size--,e||s(t),!0):!(null==(i=this.children[n(t,this)]).tree||!i.tree.remove(t,e)||(this.size--,0===i.tree.size&&(i.tree=null),0))},t.prototype.colliding=function(t,n){var i,o,a,s,l,c,h,p,f,d,m,g,v,y;for(null==n&&(n=e),u(t),l=[],a=[this];a.length>0;){for(c=0,f=(g=(y=a.shift()).oversized).length;c<f;c++)(o=g[c])!==t&&n(t,o)&&l.push(o);for(h=0,d=(v=y.contents).length;h<d;h++)(o=v[h])!==t&&n(t,o)&&l.push(o);for(0===(s=r(t,y)).length&&(s=[],t.x>=y.x+y.width&&s.push("NE"),t.y>=y.y+y.height&&s.push("SW"),s.length>0&&(1===s.length?s.push("SE"):s=["SE"])),p=0,m=s.length;p<m;p++)i=s[p],null!=y.children[i].tree&&a.push(y.children[i].tree)}return l},t.prototype.onCollision=function(t,n,i){var o,a,s,l,c,h,p,f,d,m,g,v,y;for(null==i&&(i=e),u(t),s=[this];s.length>0;){for(c=0,f=(g=(y=s.shift()).oversized).length;c<f;c++)(a=g[c])!==t&&i(t,a)&&n(a);for(h=0,d=(v=y.contents).length;h<d;h++)(a=v[h])!==t&&i(t,a)&&n(a);for(0===(l=r(t,y)).length&&(l=[],t.x>=y.x+y.width&&l.push("NE"),t.y>=y.y+y.height&&l.push("SW"),l.length>0&&(1===l.length?l.push("SE"):l=["SE"])),p=0,m=l.length;p<m;p++)o=l[p],null!=y.children[o].tree&&s.push(y.children[o].tree)}return null},t.prototype.get=function(t){return this.where(t)},t.prototype.where=function(t){var e,r,i,o,a,s,l,c,h,p,f,d,m;if("object"==typeof t&&(null==t.x||null==t.y))return this.find((function(e){var n,r;for(r in n=!0,t)t[r]!==e[r]&&(n=!1);return n}));for(u(t),o=[],i=[this];i.length>0;){for(a=0,c=(p=(m=i.shift()).oversized).length;a<c;a++){for(l in r=p[a],e=!0,t)t[l]!==r[l]&&(e=!1);e&&o.push(r)}for(s=0,h=(f=m.contents).length;s<h;s++){for(l in r=f[s],e=!0,t)t[l]!==r[l]&&(e=!1);e&&o.push(r)}null!=(d=m.children[n(t,m)]).tree&&i.push(d.tree)}return o},t.prototype.each=function(t){var e,n,r,i,o,a,s,u,l,c;for(n=[this];n.length>0;){for(i=0,a=(u=(c=n.shift()).oversized).length;i<a;i++)r=u[i],"function"==typeof t&&t(r);for(o=0,s=(l=c.contents).length;o<s;o++)r=l[o],"function"==typeof t&&t(r);for(e in c.children)null!=c.children[e].tree&&n.push(c.children[e].tree)}return this},t.prototype.find=function(t){var e,n,r,i,o,a,s,u,l,c,h;for(n=[this],i=[];n.length>0;){for(o=0,s=(l=(h=n.shift()).oversized).length;o<s;o++)r=l[o],("function"==typeof t?t(r):void 0)&&i.push(r);for(a=0,u=(c=h.contents).length;a<u;a++)r=c[a],("function"==typeof t?t(r):void 0)&&i.push(r);for(e in h.children)null!=h.children[e].tree&&n.push(h.children[e].tree)}return i},t.prototype.filter=function(e){var n;return(n=function(r){var i,o,a,s,u,l,c,h,p,f,d;for(i in(o=new t({x:r.x,y:r.y,width:r.width,height:r.height,maxElements:r.maxElements})).size=0,r.children)null!=r.children[i].tree&&(o.children[i].tree=n(r.children[i].tree),o.size+=null!=(h=null!=(p=o.children[i].tree)?p.size:void 0)?h:0);for(s=0,l=(f=r.oversized).length;s<l;s++)a=f[s],(null==e||("function"==typeof e?e(a):void 0))&&o.oversized.push(a);for(u=0,c=(d=r.contents).length;u<c;u++)a=d[u],(null==e||("function"==typeof e?e(a):void 0))&&o.contents.push(a);return o.size+=o.oversized.length+o.contents.length,0===o.size?null:o})(this)},t.prototype.reject=function(t){return this.filter((function(e){return!("function"==typeof t?t(e):void 0)}))},t.prototype.visit=function(t){var e,n,r;for(n=[this];n.length>0;)for(e in r=n.shift(),t.bind(r)(),r.children)null!=r.children[e].tree&&n.push(r.children[e].tree);return this},t.prototype.pretty=function(){var t,e,n,r,i,o,a;for(o="",n=function(t){var e,n,r;for(r="",e=n=t;n<=0?e<0:e>0;n<=0?++e:--e)r+="   ";return r},e=[{label:"ROOT",tree:this,level:0}];e.length>0;){for(t in o+=(r=n((a=e.shift()).level))+"| "+a.label+"\n"+r+"| ------------\n",a.tree.oversized.length>0&&(o+=r+"| * Oversized elements *\n"+r+"|   "+a.tree.oversized+"\n"),a.tree.contents.length>0&&(o+=r+"| * Leaf content *\n"+r+"|   "+a.tree.contents+"\n"),i=!1,a.tree.children)null!=a.tree.children[t].tree&&(i=!0,e.unshift({label:t,tree:a.tree.children[t].tree,level:a.level+1}));i&&(o+=r+"\n")}return o},t}()})?n.apply(e,r):n)||(t.exports=i)},65570:function(t,e,n){var r=n(49568);function i(t,e){var n=new r(t,e);return function(t){return n.convert(t)}}i.BIN="01",i.OCT="01234567",i.DEC="0123456789",i.HEX="0123456789abcdef",t.exports=i},49568:function(t){"use strict";function e(t,e){if(!(t&&e&&t.length&&e.length))throw new Error("Bad alphabet");this.srcAlphabet=t,this.dstAlphabet=e}e.prototype.convert=function(t){var e,n,r,i={},o=this.srcAlphabet.length,a=this.dstAlphabet.length,s=t.length,u="string"==typeof t?"":[];if(!this.isValid(t))throw new Error('Number "'+t+'" contains of non-alphabetic digits ('+this.srcAlphabet+")");if(this.srcAlphabet===this.dstAlphabet)return t;for(e=0;e<s;e++)i[e]=this.srcAlphabet.indexOf(t[e]);do{for(n=0,r=0,e=0;e<s;e++)(n=n*o+i[e])>=a?(i[r++]=parseInt(n/a,10),n%=a):r>0&&(i[r++]=0);s=r,u=this.dstAlphabet.slice(n,n+1).concat(u)}while(0!==r);return u},e.prototype.isValid=function(t){for(var e=0;e<t.length;++e)if(-1===this.srcAlphabet.indexOf(t[e]))return!1;return!0},t.exports=e},30083:function(t,e,n){t.exports=n(60331)},98597:function(t,e,n){"use strict";var r=n(29072),i=n(81257),o=n(11397),a=n(29495),s=n(8124),u=n(90232),l=n(41862);t.exports=function(t){return new Promise((function(e,c){var h=t.data,p=t.headers;r.isFormData(h)&&delete p["Content-Type"];var f=new XMLHttpRequest;if(t.auth){var d=t.auth.username||"",m=t.auth.password||"";p.Authorization="Basic "+btoa(d+":"+m)}var g=a(t.baseURL,t.url);if(f.open(t.method.toUpperCase(),o(g,t.params,t.paramsSerializer),!0),f.timeout=t.timeout,f.onreadystatechange=function(){if(f&&4===f.readyState&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in f?s(f.getAllResponseHeaders()):null,r={data:t.responseType&&"text"!==t.responseType?f.response:f.responseText,status:f.status,statusText:f.statusText,headers:n,config:t,request:f};i(e,c,r),f=null}},f.onabort=function(){f&&(c(l("Request aborted",t,"ECONNABORTED",f)),f=null)},f.onerror=function(){c(l("Network Error",t,null,f)),f=null},f.ontimeout=function(){var e="timeout of "+t.timeout+"ms exceeded";t.timeoutErrorMessage&&(e=t.timeoutErrorMessage),c(l(e,t,"ECONNABORTED",f)),f=null},r.isStandardBrowserEnv()){var v=n(99099),y=(t.withCredentials||u(g))&&t.xsrfCookieName?v.read(t.xsrfCookieName):void 0;y&&(p[t.xsrfHeaderName]=y)}if("setRequestHeader"in f&&r.forEach(p,(function(t,e){void 0===h&&"content-type"===e.toLowerCase()?delete p[e]:f.setRequestHeader(e,t)})),r.isUndefined(t.withCredentials)||(f.withCredentials=!!t.withCredentials),t.responseType)try{f.responseType=t.responseType}catch(e){if("json"!==t.responseType)throw e}"function"==typeof t.onDownloadProgress&&f.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&f.upload&&f.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then((function(t){f&&(f.abort(),c(t),f=null)})),void 0===h&&(h=null),f.send(h)}))}},60331:function(t,e,n){"use strict";var r=n(29072),i=n(99254),o=n(79536),a=n(52519);function s(t){var e=new o(t),n=i(o.prototype.request,e);return r.extend(n,o.prototype,e),r.extend(n,e),n}var u=s(n(12115));u.Axios=o,u.create=function(t){return s(a(u.defaults,t))},u.Cancel=n(44471),u.CancelToken=n(3987),u.isCancel=n(53146),u.all=function(t){return Promise.all(t)},u.spread=n(80854),t.exports=u,t.exports.default=u},44471:function(t){"use strict";function e(t){this.message=t}e.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},e.prototype.__CANCEL__=!0,t.exports=e},3987:function(t,e,n){"use strict";var r=n(44471);function i(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise((function(t){e=t}));var n=this;t((function(t){n.reason||(n.reason=new r(t),e(n.reason))}))}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.source=function(){var t;return{token:new i((function(e){t=e})),cancel:t}},t.exports=i},53146:function(t){"use strict";t.exports=function(t){return!(!t||!t.__CANCEL__)}},79536:function(t,e,n){"use strict";var r=n(29072),i=n(11397),o=n(93252),a=n(70049),s=n(52519);function u(t){this.defaults=t,this.interceptors={request:new o,response:new o}}u.prototype.request=function(t){"string"==typeof t?(t=arguments[1]||{}).url=arguments[0]:t=t||{},(t=s(this.defaults,t)).method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var e=[a,void 0],n=Promise.resolve(t);for(this.interceptors.request.forEach((function(t){e.unshift(t.fulfilled,t.rejected)})),this.interceptors.response.forEach((function(t){e.push(t.fulfilled,t.rejected)}));e.length;)n=n.then(e.shift(),e.shift());return n},u.prototype.getUri=function(t){return t=s(this.defaults,t),i(t.url,t.params,t.paramsSerializer).replace(/^\?/,"")},r.forEach(["delete","get","head","options"],(function(t){u.prototype[t]=function(e,n){return this.request(r.merge(n||{},{method:t,url:e}))}})),r.forEach(["post","put","patch"],(function(t){u.prototype[t]=function(e,n,i){return this.request(r.merge(i||{},{method:t,url:e,data:n}))}})),t.exports=u},93252:function(t,e,n){"use strict";var r=n(29072);function i(){this.handlers=[]}i.prototype.use=function(t,e){return this.handlers.push({fulfilled:t,rejected:e}),this.handlers.length-1},i.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},i.prototype.forEach=function(t){r.forEach(this.handlers,(function(e){null!==e&&t(e)}))},t.exports=i},29495:function(t,e,n){"use strict";var r=n(64617),i=n(38243);t.exports=function(t,e){return t&&!r(e)?i(t,e):e}},41862:function(t,e,n){"use strict";var r=n(83767);t.exports=function(t,e,n,i,o){var a=new Error(t);return r(a,e,n,i,o)}},70049:function(t,e,n){"use strict";var r=n(29072),i=n(93026),o=n(53146),a=n(12115);function s(t){t.cancelToken&&t.cancelToken.throwIfRequested()}t.exports=function(t){return s(t),t.headers=t.headers||{},t.data=i(t.data,t.headers,t.transformRequest),t.headers=r.merge(t.headers.common||{},t.headers[t.method]||{},t.headers),r.forEach(["delete","get","head","post","put","patch","common"],(function(e){delete t.headers[e]})),(t.adapter||a.adapter)(t).then((function(e){return s(t),e.data=i(e.data,e.headers,t.transformResponse),e}),(function(e){return o(e)||(s(t),e&&e.response&&(e.response.data=i(e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)}))}},83767:function(t){"use strict";t.exports=function(t,e,n,r,i){return t.config=e,n&&(t.code=n),t.request=r,t.response=i,t.isAxiosError=!0,t.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},t}},52519:function(t,e,n){"use strict";var r=n(29072);t.exports=function(t,e){e=e||{};var n={},i=["url","method","params","data"],o=["headers","auth","proxy"],a=["baseURL","url","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"];r.forEach(i,(function(t){void 0!==e[t]&&(n[t]=e[t])})),r.forEach(o,(function(i){r.isObject(e[i])?n[i]=r.deepMerge(t[i],e[i]):void 0!==e[i]?n[i]=e[i]:r.isObject(t[i])?n[i]=r.deepMerge(t[i]):void 0!==t[i]&&(n[i]=t[i])})),r.forEach(a,(function(r){void 0!==e[r]?n[r]=e[r]:void 0!==t[r]&&(n[r]=t[r])}));var s=i.concat(o).concat(a),u=Object.keys(e).filter((function(t){return-1===s.indexOf(t)}));return r.forEach(u,(function(r){void 0!==e[r]?n[r]=e[r]:void 0!==t[r]&&(n[r]=t[r])})),n}},81257:function(t,e,n){"use strict";var r=n(41862);t.exports=function(t,e,n){var i=n.config.validateStatus;!i||i(n.status)?t(n):e(r("Request failed with status code "+n.status,n.config,null,n.request,n))}},93026:function(t,e,n){"use strict";var r=n(29072);t.exports=function(t,e,n){return r.forEach(n,(function(n){t=n(t,e)})),t}},12115:function(t,e,n){"use strict";var r=n(29072),i=n(17048),o={"Content-Type":"application/x-www-form-urlencoded"};function a(t,e){!r.isUndefined(t)&&r.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}var s,u={adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(s=n(98597)),s),transformRequest:[function(t,e){return i(e,"Accept"),i(e,"Content-Type"),r.isFormData(t)||r.isArrayBuffer(t)||r.isBuffer(t)||r.isStream(t)||r.isFile(t)||r.isBlob(t)?t:r.isArrayBufferView(t)?t.buffer:r.isURLSearchParams(t)?(a(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):r.isObject(t)?(a(e,"application/json;charset=utf-8"),JSON.stringify(t)):t}],transformResponse:[function(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(t){return t>=200&&t<300}};u.headers={common:{Accept:"application/json, text/plain, */*"}},r.forEach(["delete","get","head"],(function(t){u.headers[t]={}})),r.forEach(["post","put","patch"],(function(t){u.headers[t]=r.merge(o)})),t.exports=u},99254:function(t){"use strict";t.exports=function(t,e){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return t.apply(e,n)}}},11397:function(t,e,n){"use strict";var r=n(29072);function i(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}t.exports=function(t,e,n){if(!e)return t;var o;if(n)o=n(e);else if(r.isURLSearchParams(e))o=e.toString();else{var a=[];r.forEach(e,(function(t,e){null!=t&&(r.isArray(t)?e+="[]":t=[t],r.forEach(t,(function(t){r.isDate(t)?t=t.toISOString():r.isObject(t)&&(t=JSON.stringify(t)),a.push(i(e)+"="+i(t))})))})),o=a.join("&")}if(o){var s=t.indexOf("#");-1!==s&&(t=t.slice(0,s)),t+=(-1===t.indexOf("?")?"?":"&")+o}return t}},38243:function(t){"use strict";t.exports=function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}},99099:function(t,e,n){"use strict";var r=n(29072);t.exports=r.isStandardBrowserEnv()?{write:function(t,e,n,i,o,a){var s=[];s.push(t+"="+encodeURIComponent(e)),r.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),r.isString(i)&&s.push("path="+i),r.isString(o)&&s.push("domain="+o),!0===a&&s.push("secure"),document.cookie=s.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},64617:function(t){"use strict";t.exports=function(t){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(t)}},90232:function(t,e,n){"use strict";var r=n(29072);t.exports=r.isStandardBrowserEnv()?function(){var t,e=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function i(t){var r=t;return e&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return t=i(window.location.href),function(e){var n=r.isString(e)?i(e):e;return n.protocol===t.protocol&&n.host===t.host}}():function(){return!0}},17048:function(t,e,n){"use strict";var r=n(29072);t.exports=function(t,e){r.forEach(t,(function(n,r){r!==e&&r.toUpperCase()===e.toUpperCase()&&(t[e]=n,delete t[r])}))}},8124:function(t,e,n){"use strict";var r=n(29072),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function(t){var e,n,o,a={};return t?(r.forEach(t.split("\n"),(function(t){if(o=t.indexOf(":"),e=r.trim(t.substr(0,o)).toLowerCase(),n=r.trim(t.substr(o+1)),e){if(a[e]&&i.indexOf(e)>=0)return;a[e]="set-cookie"===e?(a[e]?a[e]:[]).concat([n]):a[e]?a[e]+", "+n:n}})),a):a}},80854:function(t){"use strict";t.exports=function(t){return function(e){return t.apply(null,e)}}},29072:function(t,e,n){"use strict";var r=n(99254),i=Object.prototype.toString;function o(t){return"[object Array]"===i.call(t)}function a(t){return void 0===t}function s(t){return null!==t&&"object"==typeof t}function u(t){return"[object Function]"===i.call(t)}function l(t,e){if(null!=t)if("object"!=typeof t&&(t=[t]),o(t))for(var n=0,r=t.length;n<r;n++)e.call(null,t[n],n,t);else for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.call(null,t[i],i,t)}t.exports={isArray:o,isArrayBuffer:function(t){return"[object ArrayBuffer]"===i.call(t)},isBuffer:function(t){return null!==t&&!a(t)&&null!==t.constructor&&!a(t.constructor)&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)},isFormData:function(t){return"undefined"!=typeof FormData&&t instanceof FormData},isArrayBufferView:function(t){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isObject:s,isUndefined:a,isDate:function(t){return"[object Date]"===i.call(t)},isFile:function(t){return"[object File]"===i.call(t)},isBlob:function(t){return"[object Blob]"===i.call(t)},isFunction:u,isStream:function(t){return s(t)&&u(t.pipe)},isURLSearchParams:function(t){return"undefined"!=typeof URLSearchParams&&t instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:l,merge:function t(){var e={};function n(n,r){"object"==typeof e[r]&&"object"==typeof n?e[r]=t(e[r],n):e[r]=n}for(var r=0,i=arguments.length;r<i;r++)l(arguments[r],n);return e},deepMerge:function t(){var e={};function n(n,r){"object"==typeof e[r]&&"object"==typeof n?e[r]=t(e[r],n):e[r]="object"==typeof n?t({},n):n}for(var r=0,i=arguments.length;r<i;r++)l(arguments[r],n);return e},extend:function(t,e,n){return l(e,(function(e,i){t[i]=n&&"function"==typeof e?r(e,n):e})),t},trim:function(t){return t.replace(/^\s*/,"").replace(/\s*$/,"")}}},44567:function(t,e,n){var r=n(28873);t.exports={Graph:r.Graph,json:n(61163),alg:n(23126),version:r.version}},14129:function(t,e,n){var r=n(43417);t.exports=function(t){var e,n={},i=[];function o(i){r.has(n,i)||(n[i]=!0,e.push(i),r.each(t.successors(i),o),r.each(t.predecessors(i),o))}return r.each(t.nodes(),(function(t){e=[],o(t),e.length&&i.push(e)})),i}},44:function(t,e,n){var r=n(43417);function i(t,e,n,o,a,s){r.has(o,e)||(o[e]=!0,n||s.push(e),r.each(a(e),(function(e){i(t,e,n,o,a,s)})),n&&s.push(e))}t.exports=function(t,e,n){r.isArray(e)||(e=[e]);var o=(t.isDirected()?t.successors:t.neighbors).bind(t),a=[],s={};return r.each(e,(function(e){if(!t.hasNode(e))throw new Error("Graph does not have node: "+e);i(t,e,"post"===n,s,o,a)})),a}},38550:function(t,e,n){var r=n(42648),i=n(43417);t.exports=function(t,e,n){return i.transform(t.nodes(),(function(i,o){i[o]=r(t,o,e,n)}),{})}},42648:function(t,e,n){var r=n(43417),i=n(31428);t.exports=function(t,e,n,r){return function(t,e,n,r){var o,a,s={},u=new i,l=function(t){var e=t.v!==o?t.v:t.w,r=s[e],i=n(t),l=a.distance+i;if(i<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+t+" Weight: "+i);l<r.distance&&(r.distance=l,r.predecessor=o,u.decrease(e,l))};t.nodes().forEach((function(t){var n=t===e?0:Number.POSITIVE_INFINITY;s[t]={distance:n},u.add(t,n)}));for(;u.size()>0&&(o=u.removeMin(),(a=s[o]).distance!==Number.POSITIVE_INFINITY);)r(o).forEach(l);return s}(t,String(e),n||o,r||function(e){return t.outEdges(e)})};var o=r.constant(1)},28260:function(t,e,n){var r=n(43417),i=n(25451);t.exports=function(t){return r.filter(i(t),(function(e){return e.length>1||1===e.length&&t.hasEdge(e[0],e[0])}))}},67391:function(t,e,n){var r=n(43417);t.exports=function(t,e,n){return function(t,e,n){var r={},i=t.nodes();return i.forEach((function(t){r[t]={},r[t][t]={distance:0},i.forEach((function(e){t!==e&&(r[t][e]={distance:Number.POSITIVE_INFINITY})})),n(t).forEach((function(n){var i=n.v===t?n.w:n.v,o=e(n);r[t][i]={distance:o,predecessor:t}}))})),i.forEach((function(t){var e=r[t];i.forEach((function(n){var o=r[n];i.forEach((function(n){var r=o[t],i=e[n],a=o[n],s=r.distance+i.distance;s<a.distance&&(a.distance=s,a.predecessor=i.predecessor)}))}))})),r}(t,e||i,n||function(e){return t.outEdges(e)})};var i=r.constant(1)},23126:function(t,e,n){t.exports={components:n(14129),dijkstra:n(42648),dijkstraAll:n(38550),findCycles:n(28260),floydWarshall:n(67391),isAcyclic:n(33999),postorder:n(97738),preorder:n(47729),prim:n(41334),tarjan:n(25451),topsort:n(75481)}},33999:function(t,e,n){var r=n(75481);t.exports=function(t){try{r(t)}catch(t){if(t instanceof r.CycleException)return!1;throw t}return!0}},97738:function(t,e,n){var r=n(44);t.exports=function(t,e){return r(t,e,"post")}},47729:function(t,e,n){var r=n(44);t.exports=function(t,e){return r(t,e,"pre")}},41334:function(t,e,n){var r=n(43417),i=n(79587),o=n(31428);t.exports=function(t,e){var n,a=new i,s={},u=new o;function l(t){var r=t.v===n?t.w:t.v,i=u.priority(r);if(void 0!==i){var o=e(t);o<i&&(s[r]=n,u.decrease(r,o))}}if(0===t.nodeCount())return a;r.each(t.nodes(),(function(t){u.add(t,Number.POSITIVE_INFINITY),a.setNode(t)})),u.decrease(t.nodes()[0],0);var c=!1;for(;u.size()>0;){if(n=u.removeMin(),r.has(s,n))a.setEdge(n,s[n]);else{if(c)throw new Error("Input graph is not connected: "+t);c=!0}t.nodeEdges(n).forEach(l)}return a}},25451:function(t,e,n){var r=n(43417);t.exports=function(t){var e=0,n=[],i={},o=[];function a(s){var u=i[s]={onStack:!0,lowlink:e,index:e++};if(n.push(s),t.successors(s).forEach((function(t){r.has(i,t)?i[t].onStack&&(u.lowlink=Math.min(u.lowlink,i[t].index)):(a(t),u.lowlink=Math.min(u.lowlink,i[t].lowlink))})),u.lowlink===u.index){var l,c=[];do{l=n.pop(),i[l].onStack=!1,c.push(l)}while(s!==l);o.push(c)}}return t.nodes().forEach((function(t){r.has(i,t)||a(t)})),o}},75481:function(t,e,n){var r=n(43417);function i(t){var e={},n={},i=[];if(r.each(t.sinks(),(function a(s){if(r.has(n,s))throw new o;r.has(e,s)||(n[s]=!0,e[s]=!0,r.each(t.predecessors(s),a),delete n[s],i.push(s))})),r.size(e)!==t.nodeCount())throw new o;return i}function o(){}t.exports=i,i.CycleException=o,o.prototype=new Error},31428:function(t,e,n){var r=n(43417);function i(){this._arr=[],this._keyIndices={}}t.exports=i,i.prototype.size=function(){return this._arr.length},i.prototype.keys=function(){return this._arr.map((function(t){return t.key}))},i.prototype.has=function(t){return r.has(this._keyIndices,t)},i.prototype.priority=function(t){var e=this._keyIndices[t];if(void 0!==e)return this._arr[e].priority},i.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},i.prototype.add=function(t,e){var n=this._keyIndices;if(t=String(t),!r.has(n,t)){var i=this._arr,o=i.length;return n[t]=o,i.push({key:t,priority:e}),this._decrease(o),!0}return!1},i.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var t=this._arr.pop();return delete this._keyIndices[t.key],this._heapify(0),t.key},i.prototype.decrease=function(t,e){var n=this._keyIndices[t];if(e>this._arr[n].priority)throw new Error("New priority is greater than current priority. Key: "+t+" Old: "+this._arr[n].priority+" New: "+e);this._arr[n].priority=e,this._decrease(n)},i.prototype._heapify=function(t){var e=this._arr,n=2*t,r=n+1,i=t;n<e.length&&(i=e[n].priority<e[i].priority?n:i,r<e.length&&(i=e[r].priority<e[i].priority?r:i),i!==t&&(this._swap(t,i),this._heapify(i)))},i.prototype._decrease=function(t){for(var e,n=this._arr,r=n[t].priority;0!==t&&!(n[e=t>>1].priority<r);)this._swap(t,e),t=e},i.prototype._swap=function(t,e){var n=this._arr,r=this._keyIndices,i=n[t],o=n[e];n[t]=o,n[e]=i,r[o.key]=t,r[i.key]=e}},79587:function(t,e,n){"use strict";var r=n(43417);t.exports=s;var i="\0",o="\0",a="";function s(t){this._isDirected=!r.has(t,"directed")||t.directed,this._isMultigraph=!!r.has(t,"multigraph")&&t.multigraph,this._isCompound=!!r.has(t,"compound")&&t.compound,this._label=void 0,this._defaultNodeLabelFn=r.constant(void 0),this._defaultEdgeLabelFn=r.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[o]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function u(t,e){t[e]?t[e]++:t[e]=1}function l(t,e){--t[e]||delete t[e]}function c(t,e,n,o){var s=""+e,u=""+n;if(!t&&s>u){var l=s;s=u,u=l}return s+a+u+a+(r.isUndefined(o)?i:o)}function h(t,e){return c(t,e.v,e.w,e.name)}s.prototype._nodeCount=0,s.prototype._edgeCount=0,s.prototype.isDirected=function(){return this._isDirected},s.prototype.isMultigraph=function(){return this._isMultigraph},s.prototype.isCompound=function(){return this._isCompound},s.prototype.setGraph=function(t){return this._label=t,this},s.prototype.graph=function(){return this._label},s.prototype.setDefaultNodeLabel=function(t){return r.isFunction(t)||(t=r.constant(t)),this._defaultNodeLabelFn=t,this},s.prototype.nodeCount=function(){return this._nodeCount},s.prototype.nodes=function(){return r.keys(this._nodes)},s.prototype.sources=function(){var t=this;return r.filter(this.nodes(),(function(e){return r.isEmpty(t._in[e])}))},s.prototype.sinks=function(){var t=this;return r.filter(this.nodes(),(function(e){return r.isEmpty(t._out[e])}))},s.prototype.setNodes=function(t,e){var n=arguments,i=this;return r.each(t,(function(t){n.length>1?i.setNode(t,e):i.setNode(t)})),this},s.prototype.setNode=function(t,e){return r.has(this._nodes,t)?(arguments.length>1&&(this._nodes[t]=e),this):(this._nodes[t]=arguments.length>1?e:this._defaultNodeLabelFn(t),this._isCompound&&(this._parent[t]=o,this._children[t]={},this._children[o][t]=!0),this._in[t]={},this._preds[t]={},this._out[t]={},this._sucs[t]={},++this._nodeCount,this)},s.prototype.node=function(t){return this._nodes[t]},s.prototype.hasNode=function(t){return r.has(this._nodes,t)},s.prototype.removeNode=function(t){var e=this;if(r.has(this._nodes,t)){var n=function(t){e.removeEdge(e._edgeObjs[t])};delete this._nodes[t],this._isCompound&&(this._removeFromParentsChildList(t),delete this._parent[t],r.each(this.children(t),(function(t){e.setParent(t)})),delete this._children[t]),r.each(r.keys(this._in[t]),n),delete this._in[t],delete this._preds[t],r.each(r.keys(this._out[t]),n),delete this._out[t],delete this._sucs[t],--this._nodeCount}return this},s.prototype.setParent=function(t,e){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(r.isUndefined(e))e=o;else{for(var n=e+="";!r.isUndefined(n);n=this.parent(n))if(n===t)throw new Error("Setting "+e+" as parent of "+t+" would create a cycle");this.setNode(e)}return this.setNode(t),this._removeFromParentsChildList(t),this._parent[t]=e,this._children[e][t]=!0,this},s.prototype._removeFromParentsChildList=function(t){delete this._children[this._parent[t]][t]},s.prototype.parent=function(t){if(this._isCompound){var e=this._parent[t];if(e!==o)return e}},s.prototype.children=function(t){if(r.isUndefined(t)&&(t=o),this._isCompound){var e=this._children[t];if(e)return r.keys(e)}else{if(t===o)return this.nodes();if(this.hasNode(t))return[]}},s.prototype.predecessors=function(t){var e=this._preds[t];if(e)return r.keys(e)},s.prototype.successors=function(t){var e=this._sucs[t];if(e)return r.keys(e)},s.prototype.neighbors=function(t){var e=this.predecessors(t);if(e)return r.union(e,this.successors(t))},s.prototype.isLeaf=function(t){return 0===(this.isDirected()?this.successors(t):this.neighbors(t)).length},s.prototype.filterNodes=function(t){var e=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});e.setGraph(this.graph());var n=this;r.each(this._nodes,(function(n,r){t(r)&&e.setNode(r,n)})),r.each(this._edgeObjs,(function(t){e.hasNode(t.v)&&e.hasNode(t.w)&&e.setEdge(t,n.edge(t))}));var i={};function o(t){var r=n.parent(t);return void 0===r||e.hasNode(r)?(i[t]=r,r):r in i?i[r]:o(r)}return this._isCompound&&r.each(e.nodes(),(function(t){e.setParent(t,o(t))})),e},s.prototype.setDefaultEdgeLabel=function(t){return r.isFunction(t)||(t=r.constant(t)),this._defaultEdgeLabelFn=t,this},s.prototype.edgeCount=function(){return this._edgeCount},s.prototype.edges=function(){return r.values(this._edgeObjs)},s.prototype.setPath=function(t,e){var n=this,i=arguments;return r.reduce(t,(function(t,r){return i.length>1?n.setEdge(t,r,e):n.setEdge(t,r),r})),this},s.prototype.setEdge=function(){var t,e,n,i,o=!1,a=arguments[0];"object"==typeof a&&null!==a&&"v"in a?(t=a.v,e=a.w,n=a.name,2===arguments.length&&(i=arguments[1],o=!0)):(t=a,e=arguments[1],n=arguments[3],arguments.length>2&&(i=arguments[2],o=!0)),t=""+t,e=""+e,r.isUndefined(n)||(n=""+n);var s=c(this._isDirected,t,e,n);if(r.has(this._edgeLabels,s))return o&&(this._edgeLabels[s]=i),this;if(!r.isUndefined(n)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(t),this.setNode(e),this._edgeLabels[s]=o?i:this._defaultEdgeLabelFn(t,e,n);var l=function(t,e,n,r){var i=""+e,o=""+n;if(!t&&i>o){var a=i;i=o,o=a}var s={v:i,w:o};r&&(s.name=r);return s}(this._isDirected,t,e,n);return t=l.v,e=l.w,Object.freeze(l),this._edgeObjs[s]=l,u(this._preds[e],t),u(this._sucs[t],e),this._in[e][s]=l,this._out[t][s]=l,this._edgeCount++,this},s.prototype.edge=function(t,e,n){var r=1===arguments.length?h(this._isDirected,arguments[0]):c(this._isDirected,t,e,n);return this._edgeLabels[r]},s.prototype.hasEdge=function(t,e,n){var i=1===arguments.length?h(this._isDirected,arguments[0]):c(this._isDirected,t,e,n);return r.has(this._edgeLabels,i)},s.prototype.removeEdge=function(t,e,n){var r=1===arguments.length?h(this._isDirected,arguments[0]):c(this._isDirected,t,e,n),i=this._edgeObjs[r];return i&&(t=i.v,e=i.w,delete this._edgeLabels[r],delete this._edgeObjs[r],l(this._preds[e],t),l(this._sucs[t],e),delete this._in[e][r],delete this._out[t][r],this._edgeCount--),this},s.prototype.inEdges=function(t,e){var n=this._in[t];if(n){var i=r.values(n);return e?r.filter(i,(function(t){return t.v===e})):i}},s.prototype.outEdges=function(t,e){var n=this._out[t];if(n){var i=r.values(n);return e?r.filter(i,(function(t){return t.w===e})):i}},s.prototype.nodeEdges=function(t,e){var n=this.inEdges(t,e);if(n)return n.concat(this.outEdges(t,e))}},28873:function(t,e,n){t.exports={Graph:n(79587),version:n(89218)}},61163:function(t,e,n){var r=n(43417),i=n(79587);function o(t){return r.map(t.nodes(),(function(e){var n=t.node(e),i=t.parent(e),o={v:e};return r.isUndefined(n)||(o.value=n),r.isUndefined(i)||(o.parent=i),o}))}function a(t){return r.map(t.edges(),(function(e){var n=t.edge(e),i={v:e.v,w:e.w};return r.isUndefined(e.name)||(i.name=e.name),r.isUndefined(n)||(i.value=n),i}))}t.exports={write:function(t){var e={options:{directed:t.isDirected(),multigraph:t.isMultigraph(),compound:t.isCompound()},nodes:o(t),edges:a(t)};r.isUndefined(t.graph())||(e.value=r.clone(t.graph()));return e},read:function(t){var e=new i(t.options).setGraph(t.value);return r.each(t.nodes,(function(t){e.setNode(t.v,t.value),t.parent&&e.setParent(t.v,t.parent)})),r.each(t.edges,(function(t){e.setEdge({v:t.v,w:t.w,name:t.name},t.value)})),e}}},43417:function(t,e,n){var r;try{r={clone:n(50407),constant:n(86865),each:n(80637),filter:n(10247),has:n(43178),isArray:n(5022),isEmpty:n(25412),isFunction:n(52989),isUndefined:n(25280),keys:n(58291),map:n(50358),reduce:n(66102),size:n(5611),transform:n(62379),union:n(53484),values:n(44461)}}catch(t){}r||(r=window._),t.exports=r},89218:function(t){t.exports="2.1.8"},75733:function(t,e,n){var r;n.amdD,void 0===(r=function(){var t=-4,e=function(t){return"string"!=typeof t?t:t.replace(/[\+ \|\^\%]/g,(function(t){return{" ":"+","+":"%2B","|":"%7C","^":"%5E","%":"%25"}[t]}))},n=function(t){return"string"!=typeof t?t:t.replace(/\+|%2B|%7C|%5E|%25/g,(function(t){return{"+":" ","%2B":"+","%7C":"|","%5E":"^","%25":"%"}[t]}))},r=function(t){return Number.prototype.toString.call(t,36).toUpperCase()},i=function(t){return parseInt(t,36)},o=Array.prototype.indexOf||function(t,e){for(var n=e||0,r=this.length;n<r;n++)if(this[n]===t)return n;return-1};return{JSON:JSON,pack:function(n,i){(i=i||{}).verbose,n="string"==typeof n?this.JSON.parse(n):n;var a={strings:[],integers:[],floats:[]},s=function n(i){var s,u=typeof i;if(null===i)return{type:"null",index:-3};if(void 0===i)return{type:"undefined",index:-5};if(i instanceof Array){var l=["@"];for(var c in i)i.hasOwnProperty(c)&&l.push(n(i[c]));return l}if("object"===u){for(var h in l=["$"],i)i.hasOwnProperty(h)&&(l.push(n(h)),l.push(n(i[h])));return l}if(""===i)return{type:"empty",index:t};if("string"===u)return-1==(s=o.call(a.strings,i))&&(a.strings.push(e(i)),s=a.strings.length-1),{type:"strings",index:s};if("number"===u&&i%1==0)return-1==(s=o.call(a.integers,i))&&(a.integers.push(r(i)),s=a.integers.length-1),{type:"integers",index:s};if("number"===u)return-1==(s=o.call(a.floats,i))&&(a.floats.push(i),s=a.floats.length-1),{type:"floats",index:s};if("boolean"===u)return{type:"boolean",index:i?-1:-2};throw new Error("Unexpected argument of type "+typeof i)}(n),u=a.strings.length,l=a.integers.length,c=(a.floats.length,a.strings.join("|"));return c+="^"+a.integers.join("|"),c+="^"+a.floats.join("|"),c+="^"+function e(n){if(n instanceof Array){var i=n.shift();for(var o in n)n.hasOwnProperty(o)&&(i+=e(n[o])+"|");return("|"===i[i.length-1]?i.slice(0,-1):i)+"]"}var a=n.type,s=n.index;if("strings"===a)return r(s);if("integers"===a)return r(u+s);if("floats"===a)return r(u+l+s);if("boolean"===a)return n.index;if("null"===a)return-3;if("undefined"===a)return-5;if("empty"===a)return t;throw new TypeError("The item is alien!")}(s),i.debug?{dictionary:a,ast:s,packed:c}:c},unpack:function(e,r){r=r||{};var o=e.split("^");r.verbose;var a=[],s=o[0];if(""!==s){s=s.split("|"),r.verbose;for(var u=0,l=s.length;u<l;u++)a.push(n(s[u]))}if(""!==(s=o[1]))for(s=s.split("|"),r.verbose,u=0,l=s.length;u<l;u++)a.push(i(s[u]));if(""!==(s=o[2]))for(s=s.split("|"),r.verbose,u=0,l=s.length;u<l;u++)a.push(parseFloat(s[u]));s=null,r.verbose;var c="",h=[],p=o[3].length;for(u=0;u<p;u++){var f=o[3].charAt(u);"|"===f||"$"===f||"@"===f||"]"===f?(c&&(h.push(i(c)),c=""),"|"!==f&&h.push(f)):c+=f}var d=h.length,m=0;return r.verbose,function e(){var n=h[m++];if(r.verbose,"@"===n){for(var i=[];m<d;m++){var o=h[m];if(r.verbose,"]"===o)return i;if("@"===o||"$"===o)i.push(e());else switch(o){case-1:i.push(!0);break;case-2:i.push(!1);break;case-3:i.push(null);break;case-5:i.push(void 0);break;case t:i.push("");break;default:i.push(a[o])}}return r.verbose,i}if("$"===n){for(i={};m<d;m++){var s=h[m];if("]"===s)return i;if(s=s===t?"":a[s],"@"===(o=h[++m])||"$"===o)i[s]=e();else switch(o){case-1:i[s]=!0;break;case-2:i[s]=!1;break;case-3:i[s]=null;break;case-5:i[s]=void 0;break;case t:i[s]="";break;default:i[s]=a[o]}}return r.verbose,i}throw new TypeError("Bad token "+n+" isn't a type")}()}}}.apply(e,[]))||(t.exports=r)},29401:function(t,e,n){var r=n(75059)(n(18449),"DataView");t.exports=r},46109:function(t,e,n){var r=n(12929),i=n(52889),o=n(3219),a=n(60624),s=n(26775);function u(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=i,u.prototype.get=o,u.prototype.has=a,u.prototype.set=s,t.exports=u},59580:function(t,e,n){var r=n(34667),i=n(36996),o=n(69583),a=n(59624),s=n(80144);function u(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=i,u.prototype.get=o,u.prototype.has=a,u.prototype.set=s,t.exports=u},939:function(t,e,n){var r=n(75059)(n(18449),"Map");t.exports=r},71637:function(t,e,n){var r=n(67304),i=n(81702),o=n(28019),a=n(55490),s=n(80409);function u(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=i,u.prototype.get=o,u.prototype.has=a,u.prototype.set=s,t.exports=u},97238:function(t,e,n){var r=n(75059)(n(18449),"Promise");t.exports=r},80161:function(t,e,n){var r=n(75059)(n(18449),"Set");t.exports=r},3195:function(t,e,n){var r=n(71637),i=n(81278),o=n(10404);function a(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new r;++e<n;)this.add(t[e])}a.prototype.add=a.prototype.push=i,a.prototype.has=o,t.exports=a},88619:function(t,e,n){var r=n(59580),i=n(42899),o=n(59079),a=n(60817),s=n(33257),u=n(87435);function l(t){var e=this.__data__=new r(t);this.size=e.size}l.prototype.clear=i,l.prototype.delete=o,l.prototype.get=a,l.prototype.has=s,l.prototype.set=u,t.exports=l},72014:function(t,e,n){var r=n(18449).Symbol;t.exports=r},70513:function(t,e,n){var r=n(18449).Uint8Array;t.exports=r},14527:function(t,e,n){var r=n(75059)(n(18449),"WeakMap");t.exports=r},36771:function(t){t.exports=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}},44937:function(t){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}},9496:function(t){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length,i=0,o=[];++n<r;){var a=t[n];e(a,n,t)&&(o[i++]=a)}return o}},10783:function(t,e,n){var r=n(53027);t.exports=function(t,e){return!!(null==t?0:t.length)&&r(t,e,0)>-1}},46683:function(t){t.exports=function(t,e,n){for(var r=-1,i=null==t?0:t.length;++r<i;)if(n(e,t[r]))return!0;return!1}},94574:function(t,e,n){var r=n(76479),i=n(5086),o=n(5022),a=n(88348),s=n(96496),u=n(50178),l=Object.prototype.hasOwnProperty;t.exports=function(t,e){var n=o(t),c=!n&&i(t),h=!n&&!c&&a(t),p=!n&&!c&&!h&&u(t),f=n||c||h||p,d=f?r(t.length,String):[],m=d.length;for(var g in t)!e&&!l.call(t,g)||f&&("length"==g||h&&("offset"==g||"parent"==g)||p&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||s(g,m))||d.push(g);return d}},53992:function(t){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}},59898:function(t){t.exports=function(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}},56072:function(t){t.exports=function(t,e,n,r){var i=-1,o=null==t?0:t.length;for(r&&o&&(n=t[++i]);++i<o;)n=e(n,t[i],i,t);return n}},89367:function(t){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}},19783:function(t,e,n){var r=n(13960)("length");t.exports=r},21013:function(t,e,n){var r=n(30392),i=n(81446),o=Object.prototype.hasOwnProperty;t.exports=function(t,e,n){var a=t[e];o.call(t,e)&&i(a,n)&&(void 0!==n||e in t)||r(t,e,n)}},59291:function(t,e,n){var r=n(81446);t.exports=function(t,e){for(var n=t.length;n--;)if(r(t[n][0],e))return n;return-1}},89036:function(t,e,n){var r=n(92609),i=n(58291);t.exports=function(t,e){return t&&r(e,i(e),t)}},6518:function(t,e,n){var r=n(92609),i=n(80393);t.exports=function(t,e){return t&&r(e,i(e),t)}},30392:function(t,e,n){var r=n(94587);t.exports=function(t,e,n){"__proto__"==e&&r?r(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}},44103:function(t,e,n){var r=n(88619),i=n(44937),o=n(21013),a=n(89036),s=n(6518),u=n(66242),l=n(833),c=n(18873),h=n(81804),p=n(8971),f=n(8514),d=n(23817),m=n(25141),g=n(68566),v=n(81676),y=n(5022),x=n(88348),_=n(11597),b=n(80244),w=n(47573),M=n(58291),S=n(80393),T=1,E=2,A=4,P="[object Arguments]",C="[object Function]",L="[object GeneratorFunction]",I="[object Object]",O={};O[P]=O["[object Array]"]=O["[object ArrayBuffer]"]=O["[object DataView]"]=O["[object Boolean]"]=O["[object Date]"]=O["[object Float32Array]"]=O["[object Float64Array]"]=O["[object Int8Array]"]=O["[object Int16Array]"]=O["[object Int32Array]"]=O["[object Map]"]=O["[object Number]"]=O[I]=O["[object RegExp]"]=O["[object Set]"]=O["[object String]"]=O["[object Symbol]"]=O["[object Uint8Array]"]=O["[object Uint8ClampedArray]"]=O["[object Uint16Array]"]=O["[object Uint32Array]"]=!0,O["[object Error]"]=O[C]=O["[object WeakMap]"]=!1,t.exports=function t(e,n,N,R,D,k){var F,B=n&T,U=n&E,z=n&A;if(N&&(F=D?N(e,R,D,k):N(e)),void 0!==F)return F;if(!b(e))return e;var V=y(e);if(V){if(F=m(e),!B)return l(e,F)}else{var G=d(e),j=G==C||G==L;if(x(e))return u(e,B);if(G==I||G==P||j&&!D){if(F=U||j?{}:v(e),!B)return U?h(e,s(F,e)):c(e,a(F,e))}else{if(!O[G])return D?e:{};F=g(e,G,B)}}k||(k=new r);var W=k.get(e);if(W)return W;k.set(e,F),w(e)?e.forEach((function(r){F.add(t(r,n,N,r,e,k))})):_(e)&&e.forEach((function(r,i){F.set(i,t(r,n,N,i,e,k))}));var H=V?void 0:(z?U?f:p:U?S:M)(e);return i(H||e,(function(r,i){H&&(r=e[i=r]),o(F,i,t(r,n,N,i,e,k))})),F}},56865:function(t,e,n){var r=n(80244),i=Object.create,o=function(){function t(){}return function(e){if(!r(e))return{};if(i)return i(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();t.exports=o},27142:function(t,e,n){var r=n(1415),i=n(89868)(r);t.exports=i},26589:function(t,e,n){var r=n(27142);t.exports=function(t,e){var n=[];return r(t,(function(t,r,i){e(t,r,i)&&n.push(t)})),n}},75667:function(t){t.exports=function(t,e,n,r){for(var i=t.length,o=n+(r?1:-1);r?o--:++o<i;)if(e(t[o],o,t))return o;return-1}},47532:function(t,e,n){var r=n(59898),i=n(85288);t.exports=function t(e,n,o,a,s){var u=-1,l=e.length;for(o||(o=i),s||(s=[]);++u<l;){var c=e[u];n>0&&o(c)?n>1?t(c,n-1,o,a,s):r(s,c):a||(s[s.length]=c)}return s}},66565:function(t,e,n){var r=n(27349)();t.exports=r},1415:function(t,e,n){var r=n(66565),i=n(58291);t.exports=function(t,e){return t&&r(t,e,i)}},63521:function(t,e,n){var r=n(53684),i=n(1526);t.exports=function(t,e){for(var n=0,o=(e=r(e,t)).length;null!=t&&n<o;)t=t[i(e[n++])];return n&&n==o?t:void 0}},57638:function(t,e,n){var r=n(59898),i=n(5022);t.exports=function(t,e,n){var o=e(t);return i(t)?o:r(o,n(t))}},14679:function(t,e,n){var r=n(72014),i=n(32628),o=n(23582),a="[object Null]",s="[object Undefined]",u=r?r.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?s:a:u&&u in Object(t)?i(t):o(t)}},57324:function(t){var e=Object.prototype.hasOwnProperty;t.exports=function(t,n){return null!=t&&e.call(t,n)}},11263:function(t){t.exports=function(t,e){return null!=t&&e in Object(t)}},53027:function(t,e,n){var r=n(75667),i=n(58616),o=n(52411);t.exports=function(t,e,n){return e==e?o(t,e,n):r(t,i,n)}},74789:function(t,e,n){var r=n(14679),i=n(81824),o="[object Arguments]";t.exports=function(t){return i(t)&&r(t)==o}},21950:function(t,e,n){var r=n(22697),i=n(81824);t.exports=function t(e,n,o,a,s){return e===n||(null==e||null==n||!i(e)&&!i(n)?e!=e&&n!=n:r(e,n,o,a,t,s))}},22697:function(t,e,n){var r=n(88619),i=n(50841),o=n(8536),a=n(12608),s=n(23817),u=n(5022),l=n(88348),c=n(50178),h=1,p="[object Arguments]",f="[object Array]",d="[object Object]",m=Object.prototype.hasOwnProperty;t.exports=function(t,e,n,g,v,y){var x=u(t),_=u(e),b=x?f:s(t),w=_?f:s(e),M=(b=b==p?d:b)==d,S=(w=w==p?d:w)==d,T=b==w;if(T&&l(t)){if(!l(e))return!1;x=!0,M=!1}if(T&&!M)return y||(y=new r),x||c(t)?i(t,e,n,g,v,y):o(t,e,b,n,g,v,y);if(!(n&h)){var E=M&&m.call(t,"__wrapped__"),A=S&&m.call(e,"__wrapped__");if(E||A){var P=E?t.value():t,C=A?e.value():e;return y||(y=new r),v(P,C,n,g,y)}}return!!T&&(y||(y=new r),a(t,e,n,g,v,y))}},69074:function(t,e,n){var r=n(23817),i=n(81824),o="[object Map]";t.exports=function(t){return i(t)&&r(t)==o}},88540:function(t,e,n){var r=n(88619),i=n(21950),o=1,a=2;t.exports=function(t,e,n,s){var u=n.length,l=u,c=!s;if(null==t)return!l;for(t=Object(t);u--;){var h=n[u];if(c&&h[2]?h[1]!==t[h[0]]:!(h[0]in t))return!1}for(;++u<l;){var p=(h=n[u])[0],f=t[p],d=h[1];if(c&&h[2]){if(void 0===f&&!(p in t))return!1}else{var m=new r;if(s)var g=s(f,d,p,t,e,m);if(!(void 0===g?i(d,f,o|a,s,m):g))return!1}}return!0}},58616:function(t){t.exports=function(t){return t!=t}},59678:function(t,e,n){var r=n(52989),i=n(4684),o=n(80244),a=n(92285),s=/^\[object .+?Constructor\]$/,u=Function.prototype,l=Object.prototype,c=u.toString,h=l.hasOwnProperty,p=RegExp("^"+c.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!o(t)||i(t))&&(r(t)?p:s).test(a(t))}},82390:function(t,e,n){var r=n(23817),i=n(81824),o="[object Set]";t.exports=function(t){return i(t)&&r(t)==o}},60806:function(t,e,n){var r=n(14679),i=n(49173),o=n(81824),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,t.exports=function(t){return o(t)&&i(t.length)&&!!a[r(t)]}},82155:function(t,e,n){var r=n(40591),i=n(27210),o=n(29766),a=n(5022),s=n(28858);t.exports=function(t){return"function"==typeof t?t:null==t?o:"object"==typeof t?a(t)?i(t[0],t[1]):r(t):s(t)}},85334:function(t,e,n){var r=n(85708),i=n(92124),o=Object.prototype.hasOwnProperty;t.exports=function(t){if(!r(t))return i(t);var e=[];for(var n in Object(t))o.call(t,n)&&"constructor"!=n&&e.push(n);return e}},26151:function(t,e,n){var r=n(80244),i=n(85708),o=n(807),a=Object.prototype.hasOwnProperty;t.exports=function(t){if(!r(t))return o(t);var e=i(t),n=[];for(var s in t)("constructor"!=s||!e&&a.call(t,s))&&n.push(s);return n}},27671:function(t,e,n){var r=n(27142),i=n(36710);t.exports=function(t,e){var n=-1,o=i(t)?Array(t.length):[];return r(t,(function(t,r,i){o[++n]=e(t,r,i)})),o}},40591:function(t,e,n){var r=n(88540),i=n(68520),o=n(28255);t.exports=function(t){var e=i(t);return 1==e.length&&e[0][2]?o(e[0][0],e[0][1]):function(n){return n===t||r(n,t,e)}}},27210:function(t,e,n){var r=n(21950),i=n(15131),o=n(86977),a=n(84835),s=n(93186),u=n(28255),l=n(1526),c=1,h=2;t.exports=function(t,e){return a(t)&&s(e)?u(l(t),e):function(n){var a=i(n,t);return void 0===a&&a===e?o(n,t):r(e,a,c|h)}}},13960:function(t){t.exports=function(t){return function(e){return null==e?void 0:e[t]}}},16961:function(t,e,n){var r=n(63521);t.exports=function(t){return function(e){return r(e,t)}}},74243:function(t){t.exports=function(t,e,n,r,i){return i(t,(function(t,i,o){n=r?(r=!1,t):e(n,t,i,o)})),n}},33411:function(t,e,n){var r=n(29766),i=n(76018),o=n(88556);t.exports=function(t,e){return o(i(t,e,r),t+"")}},90208:function(t,e,n){var r=n(86865),i=n(94587),o=n(29766),a=i?function(t,e){return i(t,"toString",{configurable:!0,enumerable:!1,value:r(e),writable:!0})}:o;t.exports=a},76479:function(t){t.exports=function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}},28480:function(t,e,n){var r=n(72014),i=n(53992),o=n(5022),a=n(56581),s=1/0,u=r?r.prototype:void 0,l=u?u.toString:void 0;t.exports=function t(e){if("string"==typeof e)return e;if(o(e))return i(e,t)+"";if(a(e))return l?l.call(e):"";var n=e+"";return"0"==n&&1/e==-s?"-0":n}},13703:function(t){t.exports=function(t){return function(e){return t(e)}}},89122:function(t,e,n){var r=n(3195),i=n(10783),o=n(46683),a=n(62542),s=n(72656),u=n(48677),l=200;t.exports=function(t,e,n){var c=-1,h=i,p=t.length,f=!0,d=[],m=d;if(n)f=!1,h=o;else if(p>=l){var g=e?null:s(t);if(g)return u(g);f=!1,h=a,m=new r}else m=e?[]:d;t:for(;++c<p;){var v=t[c],y=e?e(v):v;if(v=n||0!==v?v:0,f&&y==y){for(var x=m.length;x--;)if(m[x]===y)continue t;e&&m.push(y),d.push(v)}else h(m,y,n)||(m!==d&&m.push(y),d.push(v))}return d}},26417:function(t,e,n){var r=n(53992);t.exports=function(t,e){return r(e,(function(e){return t[e]}))}},62542:function(t){t.exports=function(t,e){return t.has(e)}},45222:function(t,e,n){var r=n(29766);t.exports=function(t){return"function"==typeof t?t:r}},53684:function(t,e,n){var r=n(5022),i=n(84835),o=n(18506),a=n(94378);t.exports=function(t,e){return r(t)?t:i(t,e)?[t]:o(a(t))}},36283:function(t,e,n){var r=n(70513);t.exports=function(t){var e=new t.constructor(t.byteLength);return new r(e).set(new r(t)),e}},66242:function(t,e,n){t=n.nmd(t);var r=n(18449),i=e&&!e.nodeType&&e,o=i&&t&&!t.nodeType&&t,a=o&&o.exports===i?r.Buffer:void 0,s=a?a.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var n=t.length,r=s?s(n):new t.constructor(n);return t.copy(r),r}},63966:function(t,e,n){var r=n(36283);t.exports=function(t,e){var n=e?r(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}},62693:function(t){var e=/\w*$/;t.exports=function(t){var n=new t.constructor(t.source,e.exec(t));return n.lastIndex=t.lastIndex,n}},58129:function(t,e,n){var r=n(72014),i=r?r.prototype:void 0,o=i?i.valueOf:void 0;t.exports=function(t){return o?Object(o.call(t)):{}}},82479:function(t,e,n){var r=n(36283);t.exports=function(t,e){var n=e?r(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}},833:function(t){t.exports=function(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}},92609:function(t,e,n){var r=n(21013),i=n(30392);t.exports=function(t,e,n,o){var a=!n;n||(n={});for(var s=-1,u=e.length;++s<u;){var l=e[s],c=o?o(n[l],t[l],l,n,t):void 0;void 0===c&&(c=t[l]),a?i(n,l,c):r(n,l,c)}return n}},18873:function(t,e,n){var r=n(92609),i=n(78030);t.exports=function(t,e){return r(t,i(t),e)}},81804:function(t,e,n){var r=n(92609),i=n(38101);t.exports=function(t,e){return r(t,i(t),e)}},82467:function(t,e,n){var r=n(18449)["__core-js_shared__"];t.exports=r},89868:function(t,e,n){var r=n(36710);t.exports=function(t,e){return function(n,i){if(null==n)return n;if(!r(n))return t(n,i);for(var o=n.length,a=e?o:-1,s=Object(n);(e?a--:++a<o)&&!1!==i(s[a],a,s););return n}}},27349:function(t){t.exports=function(t){return function(e,n,r){for(var i=-1,o=Object(e),a=r(e),s=a.length;s--;){var u=a[t?s:++i];if(!1===n(o[u],u,o))break}return e}}},72656:function(t,e,n){var r=n(80161),i=n(1942),o=n(48677),a=r&&1/o(new r([,-0]))[1]==1/0?function(t){return new r(t)}:i;t.exports=a},94587:function(t,e,n){var r=n(75059),i=function(){try{var t=r(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=i},50841:function(t,e,n){var r=n(3195),i=n(89367),o=n(62542),a=1,s=2;t.exports=function(t,e,n,u,l,c){var h=n&a,p=t.length,f=e.length;if(p!=f&&!(h&&f>p))return!1;var d=c.get(t),m=c.get(e);if(d&&m)return d==e&&m==t;var g=-1,v=!0,y=n&s?new r:void 0;for(c.set(t,e),c.set(e,t);++g<p;){var x=t[g],_=e[g];if(u)var b=h?u(_,x,g,e,t,c):u(x,_,g,t,e,c);if(void 0!==b){if(b)continue;v=!1;break}if(y){if(!i(e,(function(t,e){if(!o(y,e)&&(x===t||l(x,t,n,u,c)))return y.push(e)}))){v=!1;break}}else if(x!==_&&!l(x,_,n,u,c)){v=!1;break}}return c.delete(t),c.delete(e),v}},8536:function(t,e,n){var r=n(72014),i=n(70513),o=n(81446),a=n(50841),s=n(79187),u=n(48677),l=1,c=2,h="[object Boolean]",p="[object Date]",f="[object Error]",d="[object Map]",m="[object Number]",g="[object RegExp]",v="[object Set]",y="[object String]",x="[object Symbol]",_="[object ArrayBuffer]",b="[object DataView]",w=r?r.prototype:void 0,M=w?w.valueOf:void 0;t.exports=function(t,e,n,r,w,S,T){switch(n){case b:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case _:return!(t.byteLength!=e.byteLength||!S(new i(t),new i(e)));case h:case p:case m:return o(+t,+e);case f:return t.name==e.name&&t.message==e.message;case g:case y:return t==e+"";case d:var E=s;case v:var A=r&l;if(E||(E=u),t.size!=e.size&&!A)return!1;var P=T.get(t);if(P)return P==e;r|=c,T.set(t,e);var C=a(E(t),E(e),r,w,S,T);return T.delete(t),C;case x:if(M)return M.call(t)==M.call(e)}return!1}},12608:function(t,e,n){var r=n(8971),i=1,o=Object.prototype.hasOwnProperty;t.exports=function(t,e,n,a,s,u){var l=n&i,c=r(t),h=c.length;if(h!=r(e).length&&!l)return!1;for(var p=h;p--;){var f=c[p];if(!(l?f in e:o.call(e,f)))return!1}var d=u.get(t),m=u.get(e);if(d&&m)return d==e&&m==t;var g=!0;u.set(t,e),u.set(e,t);for(var v=l;++p<h;){var y=t[f=c[p]],x=e[f];if(a)var _=l?a(x,y,f,e,t,u):a(y,x,f,t,e,u);if(!(void 0===_?y===x||s(y,x,n,a,u):_)){g=!1;break}v||(v="constructor"==f)}if(g&&!v){var b=t.constructor,w=e.constructor;b==w||!("constructor"in t)||!("constructor"in e)||"function"==typeof b&&b instanceof b&&"function"==typeof w&&w instanceof w||(g=!1)}return u.delete(t),u.delete(e),g}},53681:function(t,e,n){var r="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;t.exports=r},8971:function(t,e,n){var r=n(57638),i=n(78030),o=n(58291);t.exports=function(t){return r(t,o,i)}},8514:function(t,e,n){var r=n(57638),i=n(38101),o=n(80393);t.exports=function(t){return r(t,o,i)}},60917:function(t,e,n){var r=n(15427);t.exports=function(t,e){var n=t.__data__;return r(e)?n["string"==typeof e?"string":"hash"]:n.map}},68520:function(t,e,n){var r=n(93186),i=n(58291);t.exports=function(t){for(var e=i(t),n=e.length;n--;){var o=e[n],a=t[o];e[n]=[o,a,r(a)]}return e}},75059:function(t,e,n){var r=n(59678),i=n(29282);t.exports=function(t,e){var n=i(t,e);return r(n)?n:void 0}},94838:function(t,e,n){var r=n(34143)(Object.getPrototypeOf,Object);t.exports=r},32628:function(t,e,n){var r=n(72014),i=Object.prototype,o=i.hasOwnProperty,a=i.toString,s=r?r.toStringTag:void 0;t.exports=function(t){var e=o.call(t,s),n=t[s];try{t[s]=void 0;var r=!0}catch(t){}var i=a.call(t);return r&&(e?t[s]=n:delete t[s]),i}},78030:function(t,e,n){var r=n(9496),i=n(18247),o=Object.prototype.propertyIsEnumerable,a=Object.getOwnPropertySymbols,s=a?function(t){return null==t?[]:(t=Object(t),r(a(t),(function(e){return o.call(t,e)})))}:i;t.exports=s},38101:function(t,e,n){var r=n(59898),i=n(94838),o=n(78030),a=n(18247),s=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)r(e,o(t)),t=i(t);return e}:a;t.exports=s},23817:function(t,e,n){var r=n(29401),i=n(939),o=n(97238),a=n(80161),s=n(14527),u=n(14679),l=n(92285),c="[object Map]",h="[object Promise]",p="[object Set]",f="[object WeakMap]",d="[object DataView]",m=l(r),g=l(i),v=l(o),y=l(a),x=l(s),_=u;(r&&_(new r(new ArrayBuffer(1)))!=d||i&&_(new i)!=c||o&&_(o.resolve())!=h||a&&_(new a)!=p||s&&_(new s)!=f)&&(_=function(t){var e=u(t),n="[object Object]"==e?t.constructor:void 0,r=n?l(n):"";if(r)switch(r){case m:return d;case g:return c;case v:return h;case y:return p;case x:return f}return e}),t.exports=_},29282:function(t){t.exports=function(t,e){return null==t?void 0:t[e]}},50968:function(t,e,n){var r=n(53684),i=n(5086),o=n(5022),a=n(96496),s=n(49173),u=n(1526);t.exports=function(t,e,n){for(var l=-1,c=(e=r(e,t)).length,h=!1;++l<c;){var p=u(e[l]);if(!(h=null!=t&&n(t,p)))break;t=t[p]}return h||++l!=c?h:!!(c=null==t?0:t.length)&&s(c)&&a(p,c)&&(o(t)||i(t))}},87509:function(t){var e=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");t.exports=function(t){return e.test(t)}},12929:function(t,e,n){var r=n(51644);t.exports=function(){this.__data__=r?r(null):{},this.size=0}},52889:function(t){t.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}},3219:function(t,e,n){var r=n(51644),i="__lodash_hash_undefined__",o=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(r){var n=e[t];return n===i?void 0:n}return o.call(e,t)?e[t]:void 0}},60624:function(t,e,n){var r=n(51644),i=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return r?void 0!==e[t]:i.call(e,t)}},26775:function(t,e,n){var r=n(51644),i="__lodash_hash_undefined__";t.exports=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=r&&void 0===e?i:e,this}},25141:function(t){var e=Object.prototype.hasOwnProperty;t.exports=function(t){var n=t.length,r=new t.constructor(n);return n&&"string"==typeof t[0]&&e.call(t,"index")&&(r.index=t.index,r.input=t.input),r}},68566:function(t,e,n){var r=n(36283),i=n(63966),o=n(62693),a=n(58129),s=n(82479),u="[object Boolean]",l="[object Date]",c="[object Map]",h="[object Number]",p="[object RegExp]",f="[object Set]",d="[object String]",m="[object Symbol]",g="[object ArrayBuffer]",v="[object DataView]",y="[object Float32Array]",x="[object Float64Array]",_="[object Int8Array]",b="[object Int16Array]",w="[object Int32Array]",M="[object Uint8Array]",S="[object Uint8ClampedArray]",T="[object Uint16Array]",E="[object Uint32Array]";t.exports=function(t,e,n){var A=t.constructor;switch(e){case g:return r(t);case u:case l:return new A(+t);case v:return i(t,n);case y:case x:case _:case b:case w:case M:case S:case T:case E:return s(t,n);case c:return new A;case h:case d:return new A(t);case p:return o(t);case f:return new A;case m:return a(t)}}},81676:function(t,e,n){var r=n(56865),i=n(94838),o=n(85708);t.exports=function(t){return"function"!=typeof t.constructor||o(t)?{}:r(i(t))}},85288:function(t,e,n){var r=n(72014),i=n(5086),o=n(5022),a=r?r.isConcatSpreadable:void 0;t.exports=function(t){return o(t)||i(t)||!!(a&&t&&t[a])}},96496:function(t){var e=9007199254740991,n=/^(?:0|[1-9]\d*)$/;t.exports=function(t,r){var i=typeof t;return!!(r=null==r?e:r)&&("number"==i||"symbol"!=i&&n.test(t))&&t>-1&&t%1==0&&t<r}},84835:function(t,e,n){var r=n(5022),i=n(56581),o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;t.exports=function(t,e){if(r(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!i(t))||(a.test(t)||!o.test(t)||null!=e&&t in Object(e))}},15427:function(t){t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},4684:function(t,e,n){var r,i=n(82467),o=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";t.exports=function(t){return!!o&&o in t}},85708:function(t){var e=Object.prototype;t.exports=function(t){var n=t&&t.constructor;return t===("function"==typeof n&&n.prototype||e)}},93186:function(t,e,n){var r=n(80244);t.exports=function(t){return t==t&&!r(t)}},34667:function(t){t.exports=function(){this.__data__=[],this.size=0}},36996:function(t,e,n){var r=n(59291),i=Array.prototype.splice;t.exports=function(t){var e=this.__data__,n=r(e,t);return!(n<0)&&(n==e.length-1?e.pop():i.call(e,n,1),--this.size,!0)}},69583:function(t,e,n){var r=n(59291);t.exports=function(t){var e=this.__data__,n=r(e,t);return n<0?void 0:e[n][1]}},59624:function(t,e,n){var r=n(59291);t.exports=function(t){return r(this.__data__,t)>-1}},80144:function(t,e,n){var r=n(59291);t.exports=function(t,e){var n=this.__data__,i=r(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this}},67304:function(t,e,n){var r=n(46109),i=n(59580),o=n(939);t.exports=function(){this.size=0,this.__data__={hash:new r,map:new(o||i),string:new r}}},81702:function(t,e,n){var r=n(60917);t.exports=function(t){var e=r(this,t).delete(t);return this.size-=e?1:0,e}},28019:function(t,e,n){var r=n(60917);t.exports=function(t){return r(this,t).get(t)}},55490:function(t,e,n){var r=n(60917);t.exports=function(t){return r(this,t).has(t)}},80409:function(t,e,n){var r=n(60917);t.exports=function(t,e){var n=r(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this}},79187:function(t){t.exports=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n}},28255:function(t){t.exports=function(t,e){return function(n){return null!=n&&(n[t]===e&&(void 0!==e||t in Object(n)))}}},78980:function(t,e,n){var r=n(14386),i=500;t.exports=function(t){var e=r(t,(function(t){return n.size===i&&n.clear(),t})),n=e.cache;return e}},51644:function(t,e,n){var r=n(75059)(Object,"create");t.exports=r},92124:function(t,e,n){var r=n(34143)(Object.keys,Object);t.exports=r},807:function(t){t.exports=function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}},68960:function(t,e,n){t=n.nmd(t);var r=n(53681),i=e&&!e.nodeType&&e,o=i&&t&&!t.nodeType&&t,a=o&&o.exports===i&&r.process,s=function(){try{var t=o&&o.require&&o.require("util").types;return t||a&&a.binding&&a.binding("util")}catch(t){}}();t.exports=s},23582:function(t){var e=Object.prototype.toString;t.exports=function(t){return e.call(t)}},34143:function(t){t.exports=function(t,e){return function(n){return t(e(n))}}},76018:function(t,e,n){var r=n(36771),i=Math.max;t.exports=function(t,e,n){return e=i(void 0===e?t.length-1:e,0),function(){for(var o=arguments,a=-1,s=i(o.length-e,0),u=Array(s);++a<s;)u[a]=o[e+a];a=-1;for(var l=Array(e+1);++a<e;)l[a]=o[a];return l[e]=n(u),r(t,this,l)}}},18449:function(t,e,n){var r=n(53681),i="object"==typeof self&&self&&self.Object===Object&&self,o=r||i||Function("return this")();t.exports=o},81278:function(t){var e="__lodash_hash_undefined__";t.exports=function(t){return this.__data__.set(t,e),this}},10404:function(t){t.exports=function(t){return this.__data__.has(t)}},48677:function(t){t.exports=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}},88556:function(t,e,n){var r=n(90208),i=n(121)(r);t.exports=i},121:function(t){var e=800,n=16,r=Date.now;t.exports=function(t){var i=0,o=0;return function(){var a=r(),s=n-(a-o);if(o=a,s>0){if(++i>=e)return arguments[0]}else i=0;return t.apply(void 0,arguments)}}},42899:function(t,e,n){var r=n(59580);t.exports=function(){this.__data__=new r,this.size=0}},59079:function(t){t.exports=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}},60817:function(t){t.exports=function(t){return this.__data__.get(t)}},33257:function(t){t.exports=function(t){return this.__data__.has(t)}},87435:function(t,e,n){var r=n(59580),i=n(939),o=n(71637),a=200;t.exports=function(t,e){var n=this.__data__;if(n instanceof r){var s=n.__data__;if(!i||s.length<a-1)return s.push([t,e]),this.size=++n.size,this;n=this.__data__=new o(s)}return n.set(t,e),this.size=n.size,this}},52411:function(t){t.exports=function(t,e,n){for(var r=n-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1}},14722:function(t,e,n){var r=n(19783),i=n(87509),o=n(29389);t.exports=function(t){return i(t)?o(t):r(t)}},18506:function(t,e,n){var r=n(78980),i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,o=/\\(\\)?/g,a=r((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(i,(function(t,n,r,i){e.push(r?i.replace(o,"$1"):n||t)})),e}));t.exports=a},1526:function(t,e,n){var r=n(56581),i=1/0;t.exports=function(t){if("string"==typeof t||r(t))return t;var e=t+"";return"0"==e&&1/t==-i?"-0":e}},92285:function(t){var e=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return e.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},29389:function(t){var e="\\ud800-\\udfff",n="["+e+"]",r="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",i="\\ud83c[\\udffb-\\udfff]",o="[^"+e+"]",a="(?:\\ud83c[\\udde6-\\uddff]){2}",s="[\\ud800-\\udbff][\\udc00-\\udfff]",u="(?:"+r+"|"+i+")"+"?",l="[\\ufe0e\\ufe0f]?",c=l+u+("(?:\\u200d(?:"+[o,a,s].join("|")+")"+l+u+")*"),h="(?:"+[o+r+"?",r,a,s,n].join("|")+")",p=RegExp(i+"(?="+i+")|"+h+c,"g");t.exports=function(t){for(var e=p.lastIndex=0;p.test(t);)++e;return e}},50407:function(t,e,n){var r=n(44103),i=4;t.exports=function(t){return r(t,i)}},86865:function(t){t.exports=function(t){return function(){return t}}},80637:function(t,e,n){t.exports=n(33399)},81446:function(t){t.exports=function(t,e){return t===e||t!=t&&e!=e}},10247:function(t,e,n){var r=n(9496),i=n(26589),o=n(82155),a=n(5022);t.exports=function(t,e){return(a(t)?r:i)(t,o(e,3))}},33399:function(t,e,n){var r=n(44937),i=n(27142),o=n(45222),a=n(5022);t.exports=function(t,e){return(a(t)?r:i)(t,o(e))}},15131:function(t,e,n){var r=n(63521);t.exports=function(t,e,n){var i=null==t?void 0:r(t,e);return void 0===i?n:i}},43178:function(t,e,n){var r=n(57324),i=n(50968);t.exports=function(t,e){return null!=t&&i(t,e,r)}},86977:function(t,e,n){var r=n(11263),i=n(50968);t.exports=function(t,e){return null!=t&&i(t,e,r)}},29766:function(t){t.exports=function(t){return t}},5086:function(t,e,n){var r=n(74789),i=n(81824),o=Object.prototype,a=o.hasOwnProperty,s=o.propertyIsEnumerable,u=r(function(){return arguments}())?r:function(t){return i(t)&&a.call(t,"callee")&&!s.call(t,"callee")};t.exports=u},5022:function(t){var e=Array.isArray;t.exports=e},36710:function(t,e,n){var r=n(52989),i=n(49173);t.exports=function(t){return null!=t&&i(t.length)&&!r(t)}},39426:function(t,e,n){var r=n(36710),i=n(81824);t.exports=function(t){return i(t)&&r(t)}},88348:function(t,e,n){t=n.nmd(t);var r=n(18449),i=n(50210),o=e&&!e.nodeType&&e,a=o&&t&&!t.nodeType&&t,s=a&&a.exports===o?r.Buffer:void 0,u=(s?s.isBuffer:void 0)||i;t.exports=u},25412:function(t,e,n){var r=n(85334),i=n(23817),o=n(5086),a=n(5022),s=n(36710),u=n(88348),l=n(85708),c=n(50178),h="[object Map]",p="[object Set]",f=Object.prototype.hasOwnProperty;t.exports=function(t){if(null==t)return!0;if(s(t)&&(a(t)||"string"==typeof t||"function"==typeof t.splice||u(t)||c(t)||o(t)))return!t.length;var e=i(t);if(e==h||e==p)return!t.size;if(l(t))return!r(t).length;for(var n in t)if(f.call(t,n))return!1;return!0}},52989:function(t,e,n){var r=n(14679),i=n(80244),o="[object AsyncFunction]",a="[object Function]",s="[object GeneratorFunction]",u="[object Proxy]";t.exports=function(t){if(!i(t))return!1;var e=r(t);return e==a||e==s||e==o||e==u}},49173:function(t){var e=9007199254740991;t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=e}},11597:function(t,e,n){var r=n(69074),i=n(13703),o=n(68960),a=o&&o.isMap,s=a?i(a):r;t.exports=s},80244:function(t){t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},81824:function(t){t.exports=function(t){return null!=t&&"object"==typeof t}},47573:function(t,e,n){var r=n(82390),i=n(13703),o=n(68960),a=o&&o.isSet,s=a?i(a):r;t.exports=s},88915:function(t,e,n){var r=n(14679),i=n(5022),o=n(81824),a="[object String]";t.exports=function(t){return"string"==typeof t||!i(t)&&o(t)&&r(t)==a}},56581:function(t,e,n){var r=n(14679),i=n(81824),o="[object Symbol]";t.exports=function(t){return"symbol"==typeof t||i(t)&&r(t)==o}},50178:function(t,e,n){var r=n(60806),i=n(13703),o=n(68960),a=o&&o.isTypedArray,s=a?i(a):r;t.exports=s},25280:function(t){t.exports=function(t){return void 0===t}},58291:function(t,e,n){var r=n(94574),i=n(85334),o=n(36710);t.exports=function(t){return o(t)?r(t):i(t)}},80393:function(t,e,n){var r=n(94574),i=n(26151),o=n(36710);t.exports=function(t){return o(t)?r(t,!0):i(t)}},50358:function(t,e,n){var r=n(53992),i=n(82155),o=n(27671),a=n(5022);t.exports=function(t,e){return(a(t)?r:o)(t,i(e,3))}},14386:function(t,e,n){var r=n(71637),i="Expected a function";function o(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(i);var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=t.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(o.Cache||r),n}o.Cache=r,t.exports=o},1942:function(t){t.exports=function(){}},28858:function(t,e,n){var r=n(13960),i=n(16961),o=n(84835),a=n(1526);t.exports=function(t){return o(t)?r(a(t)):i(t)}},66102:function(t,e,n){var r=n(56072),i=n(27142),o=n(82155),a=n(74243),s=n(5022);t.exports=function(t,e,n){var u=s(t)?r:a,l=arguments.length<3;return u(t,o(e,4),n,l,i)}},5611:function(t,e,n){var r=n(85334),i=n(23817),o=n(36710),a=n(88915),s=n(14722),u="[object Map]",l="[object Set]";t.exports=function(t){if(null==t)return 0;if(o(t))return a(t)?s(t):t.length;var e=i(t);return e==u||e==l?t.size:r(t).length}},18247:function(t){t.exports=function(){return[]}},50210:function(t){t.exports=function(){return!1}},94378:function(t,e,n){var r=n(28480);t.exports=function(t){return null==t?"":r(t)}},62379:function(t,e,n){var r=n(44937),i=n(56865),o=n(1415),a=n(82155),s=n(94838),u=n(5022),l=n(88348),c=n(52989),h=n(80244),p=n(50178);t.exports=function(t,e,n){var f=u(t),d=f||l(t)||p(t);if(e=a(e,4),null==n){var m=t&&t.constructor;n=d?f?new m:[]:h(t)&&c(m)?i(s(t)):{}}return(d?r:o)(t,(function(t,r,i){return e(n,t,r,i)})),n}},53484:function(t,e,n){var r=n(47532),i=n(33411),o=n(89122),a=n(39426),s=i((function(t){return o(r(t,1,a,!0))}));t.exports=s},44461:function(t,e,n){var r=n(26417),i=n(58291);t.exports=function(t){return null==t?[]:r(t,i(t))}},42704:function(t,e,n){var r,i=n(65570),o=n(85162),a="123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ";function s(t,e){return e(t.toLowerCase().replace(/-/g,""))}t.exports=function(){function t(t){var e=t||a,n=i(i.HEX,e),r=i(e,i.HEX),u=function(){return s(o(),n)};return{new:u,generate:u,uuid:o,fromUUID:function(t){return s(t,n)},toUUID:function(t){return function(t,e){for(var n,r=e(t),i="",o=0,a=32-r.length;o<a;++o)i+="0";return[(n=(i+r).match(/(\w{8})(\w{4})(\w{4})(\w{4})(\w{12})/))[1],n[2],n[3],n[4],n[5]].join("-")}(t,r)},alphabet:e}}return t.constants={flickrBase58:a,cookieBase90:"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!#$%&'()*+-./:<=>?@[]^_`{|}~"},t.uuid=o,t.generate=function(){return r||(r=i(i.HEX,a)),s(o(),r)},t}()},37081:function(t){for(var e=[],n=0;n<256;++n)e[n]=(n+256).toString(16).substr(1);t.exports=function(t,n){var r=n||0,i=e;return[i[t[r++]],i[t[r++]],i[t[r++]],i[t[r++]],"-",i[t[r++]],i[t[r++]],"-",i[t[r++]],i[t[r++]],"-",i[t[r++]],i[t[r++]],"-",i[t[r++]],i[t[r++]],i[t[r++]],i[t[r++]],i[t[r++]],i[t[r++]]].join("")}},7390:function(t){var e="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(e){var n=new Uint8Array(16);t.exports=function(){return e(n),n}}else{var r=new Array(16);t.exports=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),r[e]=t>>>((3&e)<<3)&255;return r}}},85162:function(t,e,n){var r=n(7390),i=n(37081);t.exports=function(t,e,n){var o=e&&n||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null);var a=(t=t||{}).random||(t.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,e)for(var s=0;s<16;++s)e[o+s]=a[s];return e||i(a)}},65337:function(t,e,n){t.exports=n(43957)},22712:function(t,e,n){"use strict";var r=n(34671),i=n(46904),o=n(1445),a=n(52837),s=n(5130),u=n(58446),l=n(60749);t.exports=function(t){return new Promise((function(e,c){var h=t.data,p=t.headers;r.isFormData(h)&&delete p["Content-Type"];var f=new XMLHttpRequest;if(t.auth){var d=t.auth.username||"",m=t.auth.password||"";p.Authorization="Basic "+btoa(d+":"+m)}var g=a(t.baseURL,t.url);if(f.open(t.method.toUpperCase(),o(g,t.params,t.paramsSerializer),!0),f.timeout=t.timeout,f.onreadystatechange=function(){if(f&&4===f.readyState&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in f?s(f.getAllResponseHeaders()):null,r={data:t.responseType&&"text"!==t.responseType?f.response:f.responseText,status:f.status,statusText:f.statusText,headers:n,config:t,request:f};i(e,c,r),f=null}},f.onabort=function(){f&&(c(l("Request aborted",t,"ECONNABORTED",f)),f=null)},f.onerror=function(){c(l("Network Error",t,null,f)),f=null},f.ontimeout=function(){var e="timeout of "+t.timeout+"ms exceeded";t.timeoutErrorMessage&&(e=t.timeoutErrorMessage),c(l(e,t,"ECONNABORTED",f)),f=null},r.isStandardBrowserEnv()){var v=n(35436),y=(t.withCredentials||u(g))&&t.xsrfCookieName?v.read(t.xsrfCookieName):void 0;y&&(p[t.xsrfHeaderName]=y)}if("setRequestHeader"in f&&r.forEach(p,(function(t,e){void 0===h&&"content-type"===e.toLowerCase()?delete p[e]:f.setRequestHeader(e,t)})),r.isUndefined(t.withCredentials)||(f.withCredentials=!!t.withCredentials),t.responseType)try{f.responseType=t.responseType}catch(e){if("json"!==t.responseType)throw e}"function"==typeof t.onDownloadProgress&&f.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&f.upload&&f.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then((function(t){f&&(f.abort(),c(t),f=null)})),void 0===h&&(h=null),f.send(h)}))}},43957:function(t,e,n){"use strict";var r=n(34671),i=n(21333),o=n(92305),a=n(96448);function s(t){var e=new o(t),n=i(o.prototype.request,e);return r.extend(n,o.prototype,e),r.extend(n,e),n}var u=s(n(13430));u.Axios=o,u.create=function(t){return s(a(u.defaults,t))},u.Cancel=n(82703),u.CancelToken=n(48913),u.isCancel=n(53023),u.all=function(t){return Promise.all(t)},u.spread=n(21667),t.exports=u,t.exports.default=u},82703:function(t){"use strict";function e(t){this.message=t}e.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},e.prototype.__CANCEL__=!0,t.exports=e},48913:function(t,e,n){"use strict";var r=n(82703);function i(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise((function(t){e=t}));var n=this;t((function(t){n.reason||(n.reason=new r(t),e(n.reason))}))}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.source=function(){var t;return{token:new i((function(e){t=e})),cancel:t}},t.exports=i},53023:function(t){"use strict";t.exports=function(t){return!(!t||!t.__CANCEL__)}},92305:function(t,e,n){"use strict";var r=n(34671),i=n(1445),o=n(10576),a=n(81126),s=n(96448);function u(t){this.defaults=t,this.interceptors={request:new o,response:new o}}u.prototype.request=function(t){"string"==typeof t?(t=arguments[1]||{}).url=arguments[0]:t=t||{},(t=s(this.defaults,t)).method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var e=[a,void 0],n=Promise.resolve(t);for(this.interceptors.request.forEach((function(t){e.unshift(t.fulfilled,t.rejected)})),this.interceptors.response.forEach((function(t){e.push(t.fulfilled,t.rejected)}));e.length;)n=n.then(e.shift(),e.shift());return n},u.prototype.getUri=function(t){return t=s(this.defaults,t),i(t.url,t.params,t.paramsSerializer).replace(/^\?/,"")},r.forEach(["delete","get","head","options"],(function(t){u.prototype[t]=function(e,n){return this.request(r.merge(n||{},{method:t,url:e}))}})),r.forEach(["post","put","patch"],(function(t){u.prototype[t]=function(e,n,i){return this.request(r.merge(i||{},{method:t,url:e,data:n}))}})),t.exports=u},10576:function(t,e,n){"use strict";var r=n(34671);function i(){this.handlers=[]}i.prototype.use=function(t,e){return this.handlers.push({fulfilled:t,rejected:e}),this.handlers.length-1},i.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},i.prototype.forEach=function(t){r.forEach(this.handlers,(function(e){null!==e&&t(e)}))},t.exports=i},52837:function(t,e,n){"use strict";var r=n(97509),i=n(70858);t.exports=function(t,e){return t&&!r(e)?i(t,e):e}},60749:function(t,e,n){"use strict";var r=n(79959);t.exports=function(t,e,n,i,o){var a=new Error(t);return r(a,e,n,i,o)}},81126:function(t,e,n){"use strict";var r=n(34671),i=n(18590),o=n(53023),a=n(13430);function s(t){t.cancelToken&&t.cancelToken.throwIfRequested()}t.exports=function(t){return s(t),t.headers=t.headers||{},t.data=i(t.data,t.headers,t.transformRequest),t.headers=r.merge(t.headers.common||{},t.headers[t.method]||{},t.headers),r.forEach(["delete","get","head","post","put","patch","common"],(function(e){delete t.headers[e]})),(t.adapter||a.adapter)(t).then((function(e){return s(t),e.data=i(e.data,e.headers,t.transformResponse),e}),(function(e){return o(e)||(s(t),e&&e.response&&(e.response.data=i(e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)}))}},79959:function(t){"use strict";t.exports=function(t,e,n,r,i){return t.config=e,n&&(t.code=n),t.request=r,t.response=i,t.isAxiosError=!0,t.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},t}},96448:function(t,e,n){"use strict";var r=n(34671);t.exports=function(t,e){e=e||{};var n={},i=["url","method","params","data"],o=["headers","auth","proxy"],a=["baseURL","url","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"];r.forEach(i,(function(t){void 0!==e[t]&&(n[t]=e[t])})),r.forEach(o,(function(i){r.isObject(e[i])?n[i]=r.deepMerge(t[i],e[i]):void 0!==e[i]?n[i]=e[i]:r.isObject(t[i])?n[i]=r.deepMerge(t[i]):void 0!==t[i]&&(n[i]=t[i])})),r.forEach(a,(function(r){void 0!==e[r]?n[r]=e[r]:void 0!==t[r]&&(n[r]=t[r])}));var s=i.concat(o).concat(a),u=Object.keys(e).filter((function(t){return-1===s.indexOf(t)}));return r.forEach(u,(function(r){void 0!==e[r]?n[r]=e[r]:void 0!==t[r]&&(n[r]=t[r])})),n}},46904:function(t,e,n){"use strict";var r=n(60749);t.exports=function(t,e,n){var i=n.config.validateStatus;!i||i(n.status)?t(n):e(r("Request failed with status code "+n.status,n.config,null,n.request,n))}},18590:function(t,e,n){"use strict";var r=n(34671);t.exports=function(t,e,n){return r.forEach(n,(function(n){t=n(t,e)})),t}},13430:function(t,e,n){"use strict";var r=n(34671),i=n(30363),o={"Content-Type":"application/x-www-form-urlencoded"};function a(t,e){!r.isUndefined(t)&&r.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}var s,u={adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(s=n(22712)),s),transformRequest:[function(t,e){return i(e,"Accept"),i(e,"Content-Type"),r.isFormData(t)||r.isArrayBuffer(t)||r.isBuffer(t)||r.isStream(t)||r.isFile(t)||r.isBlob(t)?t:r.isArrayBufferView(t)?t.buffer:r.isURLSearchParams(t)?(a(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):r.isObject(t)?(a(e,"application/json;charset=utf-8"),JSON.stringify(t)):t}],transformResponse:[function(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(t){return t>=200&&t<300}};u.headers={common:{Accept:"application/json, text/plain, */*"}},r.forEach(["delete","get","head"],(function(t){u.headers[t]={}})),r.forEach(["post","put","patch"],(function(t){u.headers[t]=r.merge(o)})),t.exports=u},21333:function(t){"use strict";t.exports=function(t,e){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return t.apply(e,n)}}},1445:function(t,e,n){"use strict";var r=n(34671);function i(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}t.exports=function(t,e,n){if(!e)return t;var o;if(n)o=n(e);else if(r.isURLSearchParams(e))o=e.toString();else{var a=[];r.forEach(e,(function(t,e){null!=t&&(r.isArray(t)?e+="[]":t=[t],r.forEach(t,(function(t){r.isDate(t)?t=t.toISOString():r.isObject(t)&&(t=JSON.stringify(t)),a.push(i(e)+"="+i(t))})))})),o=a.join("&")}if(o){var s=t.indexOf("#");-1!==s&&(t=t.slice(0,s)),t+=(-1===t.indexOf("?")?"?":"&")+o}return t}},70858:function(t){"use strict";t.exports=function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}},35436:function(t,e,n){"use strict";var r=n(34671);t.exports=r.isStandardBrowserEnv()?{write:function(t,e,n,i,o,a){var s=[];s.push(t+"="+encodeURIComponent(e)),r.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),r.isString(i)&&s.push("path="+i),r.isString(o)&&s.push("domain="+o),!0===a&&s.push("secure"),document.cookie=s.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},97509:function(t){"use strict";t.exports=function(t){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(t)}},58446:function(t,e,n){"use strict";var r=n(34671);t.exports=r.isStandardBrowserEnv()?function(){var t,e=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function i(t){var r=t;return e&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return t=i(window.location.href),function(e){var n=r.isString(e)?i(e):e;return n.protocol===t.protocol&&n.host===t.host}}():function(){return!0}},30363:function(t,e,n){"use strict";var r=n(34671);t.exports=function(t,e){r.forEach(t,(function(n,r){r!==e&&r.toUpperCase()===e.toUpperCase()&&(t[e]=n,delete t[r])}))}},5130:function(t,e,n){"use strict";var r=n(34671),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function(t){var e,n,o,a={};return t?(r.forEach(t.split("\n"),(function(t){if(o=t.indexOf(":"),e=r.trim(t.substr(0,o)).toLowerCase(),n=r.trim(t.substr(o+1)),e){if(a[e]&&i.indexOf(e)>=0)return;a[e]="set-cookie"===e?(a[e]?a[e]:[]).concat([n]):a[e]?a[e]+", "+n:n}})),a):a}},21667:function(t){"use strict";t.exports=function(t){return function(e){return t.apply(null,e)}}},34671:function(t,e,n){"use strict";var r=n(21333),i=Object.prototype.toString;function o(t){return"[object Array]"===i.call(t)}function a(t){return void 0===t}function s(t){return null!==t&&"object"==typeof t}function u(t){return"[object Function]"===i.call(t)}function l(t,e){if(null!=t)if("object"!=typeof t&&(t=[t]),o(t))for(var n=0,r=t.length;n<r;n++)e.call(null,t[n],n,t);else for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.call(null,t[i],i,t)}t.exports={isArray:o,isArrayBuffer:function(t){return"[object ArrayBuffer]"===i.call(t)},isBuffer:function(t){return null!==t&&!a(t)&&null!==t.constructor&&!a(t.constructor)&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)},isFormData:function(t){return"undefined"!=typeof FormData&&t instanceof FormData},isArrayBufferView:function(t){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isObject:s,isUndefined:a,isDate:function(t){return"[object Date]"===i.call(t)},isFile:function(t){return"[object File]"===i.call(t)},isBlob:function(t){return"[object Blob]"===i.call(t)},isFunction:u,isStream:function(t){return s(t)&&u(t.pipe)},isURLSearchParams:function(t){return"undefined"!=typeof URLSearchParams&&t instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:l,merge:function t(){var e={};function n(n,r){"object"==typeof e[r]&&"object"==typeof n?e[r]=t(e[r],n):e[r]=n}for(var r=0,i=arguments.length;r<i;r++)l(arguments[r],n);return e},deepMerge:function t(){var e={};function n(n,r){"object"==typeof e[r]&&"object"==typeof n?e[r]=t(e[r],n):e[r]="object"==typeof n?t({},n):n}for(var r=0,i=arguments.length;r<i;r++)l(arguments[r],n);return e},extend:function(t,e,n){return l(e,(function(e,i){t[i]=n&&"function"==typeof e?r(e,n):e})),t},trim:function(t){return t.replace(/^\s*/,"").replace(/\s*$/,"")}}},18588:function(t,e,n){var r,i,o;i=[],void 0===(o="function"==typeof(r=function(){"use strict";function e(t,e){return void 0===e?e={autoBom:!1}:"object"!=typeof e&&(e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}function r(t,e,n){var r=new XMLHttpRequest;r.open("GET",t),r.responseType="blob",r.onload=function(){s(r.response,e,n)},r.onerror=function(){},r.send()}function i(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&299>=e.status}function o(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(n){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var a="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n.g&&n.g.global===n.g?n.g:void 0,s=a.saveAs||("object"!=typeof window||window!==a?function(){}:"download"in HTMLAnchorElement.prototype?function(t,e,n){var s=a.URL||a.webkitURL,u=document.createElement("a");e=e||t.name||"download",u.download=e,u.rel="noopener","string"==typeof t?(u.href=t,u.origin===location.origin?o(u):i(u.href)?r(t,e,n):o(u,u.target="_blank")):(u.href=s.createObjectURL(t),setTimeout((function(){s.revokeObjectURL(u.href)}),4e4),setTimeout((function(){o(u)}),0))}:"msSaveOrOpenBlob"in navigator?function(t,n,a){if(n=n||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(e(t,a),n);else if(i(t))r(t,n,a);else{var s=document.createElement("a");s.href=t,s.target="_blank",setTimeout((function(){o(s)}))}}:function(t,e,n,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),"string"==typeof t)return r(t,e,n);var o="application/octet-stream"===t.type,s=/constructor/i.test(a.HTMLElement)||a.safari,u=/CriOS\/[\d]+/.test(navigator.userAgent);if((u||o&&s)&&"object"==typeof FileReader){var l=new FileReader;l.onloadend=function(){var t=l.result;t=u?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=t:location=t,i=null},l.readAsDataURL(t)}else{var c=a.URL||a.webkitURL,h=c.createObjectURL(t);i?i.location=h:location.href=h,i=null,setTimeout((function(){c.revokeObjectURL(h)}),4e4)}});a.saveAs=s.saveAs=s,t.exports=s})?r.apply(e,i):r)||(t.exports=o)},12756:function(t){"use strict";function e(t,e){var n,r;if(0===e.length)return t;for(n=0,r=e.length;n<r;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return t<0?-2*t:t}function n(t,r,i,o){var a,s=e(e(e(t,i),(a=r,Object.prototype.toString.call(a))),typeof r);if(null===r)return e(s,"null");if(void 0===r)return e(s,"undefined");if("object"==typeof r||"function"==typeof r){if(-1!==o.indexOf(r))return e(s,"[Circular]"+i);o.push(r);var u=function(t,e,r){return Object.keys(e).sort().reduce((function(t,i){return n(t,e[i],i,r)}),t)}(s,r,o);if(!("valueOf"in r)||"function"!=typeof r.valueOf)return u;try{return e(u,String(r.valueOf()))}catch(t){return e(u,"[valueOf exception]"+(t.stack||t.message))}}return e(s,r.toString())}t.exports=function(t){return function(t,e){for(;t.length<e;)t="0"+t;return t}(n(0,t,"",[]).toString(16),8)}},14186:function(t,e,n){var r="Expected a function",i=NaN,o="[object Symbol]",a=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,l=/^0o[0-7]+$/i,c=parseInt,h="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,p="object"==typeof self&&self&&self.Object===Object&&self,f=h||p||Function("return this")(),d=Object.prototype.toString,m=Math.max,g=Math.min,v=function(){return f.Date.now()};function y(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function x(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&d.call(t)==o}(t))return i;if(y(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=y(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(a,"");var n=u.test(t);return n||l.test(t)?c(t.slice(2),n?2:8):s.test(t)?i:+t}t.exports=function(t,e,n){var i,o,a,s,u,l,c=0,h=!1,p=!1,f=!0;if("function"!=typeof t)throw new TypeError(r);function d(e){var n=i,r=o;return i=o=void 0,c=e,s=t.apply(r,n)}function _(t){var n=t-l;return void 0===l||n>=e||n<0||p&&t-c>=a}function b(){var t=v();if(_(t))return w(t);u=setTimeout(b,function(t){var n=e-(t-l);return p?g(n,a-(t-c)):n}(t))}function w(t){return u=void 0,f&&i?d(t):(i=o=void 0,s)}function M(){var t=v(),n=_(t);if(i=arguments,o=this,l=t,n){if(void 0===u)return function(t){return c=t,u=setTimeout(b,e),h?d(t):s}(l);if(p)return u=setTimeout(b,e),d(l)}return void 0===u&&(u=setTimeout(b,e)),s}return e=x(e)||0,y(n)&&(h=!!n.leading,a=(p="maxWait"in n)?m(x(n.maxWait)||0,e):a,f="trailing"in n?!!n.trailing:f),M.cancel=function(){void 0!==u&&clearTimeout(u),c=0,i=l=o=u=void 0},M.flush=function(){return void 0===u?s:w(v())},M}},96362:function(t,e,n){var r="Expected a function",i=NaN,o="[object Symbol]",a=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,l=/^0o[0-7]+$/i,c=parseInt,h="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,p="object"==typeof self&&self&&self.Object===Object&&self,f=h||p||Function("return this")(),d=Object.prototype.toString,m=Math.max,g=Math.min,v=function(){return f.Date.now()};function y(t,e,n){var i,o,a,s,u,l,c=0,h=!1,p=!1,f=!0;if("function"!=typeof t)throw new TypeError(r);function d(e){var n=i,r=o;return i=o=void 0,c=e,s=t.apply(r,n)}function y(t){var n=t-l;return void 0===l||n>=e||n<0||p&&t-c>=a}function b(){var t=v();if(y(t))return w(t);u=setTimeout(b,function(t){var n=e-(t-l);return p?g(n,a-(t-c)):n}(t))}function w(t){return u=void 0,f&&i?d(t):(i=o=void 0,s)}function M(){var t=v(),n=y(t);if(i=arguments,o=this,l=t,n){if(void 0===u)return function(t){return c=t,u=setTimeout(b,e),h?d(t):s}(l);if(p)return u=setTimeout(b,e),d(l)}return void 0===u&&(u=setTimeout(b,e)),s}return e=_(e)||0,x(n)&&(h=!!n.leading,a=(p="maxWait"in n)?m(_(n.maxWait)||0,e):a,f="trailing"in n?!!n.trailing:f),M.cancel=function(){void 0!==u&&clearTimeout(u),c=0,i=l=o=u=void 0},M.flush=function(){return void 0===u?s:w(v())},M}function x(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function _(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&d.call(t)==o}(t))return i;if(x(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=x(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(a,"");var n=u.test(t);return n||l.test(t)?c(t.slice(2),n?2:8):s.test(t)?i:+t}t.exports=function(t,e,n){var i=!0,o=!0;if("function"!=typeof t)throw new TypeError(r);return x(n)&&(i="leading"in n?!!n.leading:i,o="trailing"in n?!!n.trailing:o),y(t,e,{leading:i,maxWait:e,trailing:o})}},89149:function(t,e,n){var r;!function(i,o,a){if(i){for(var s,u={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},l={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},c={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},h={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},p=1;p<20;++p)u[111+p]="f"+p;for(p=0;p<=9;++p)u[p+96]=p.toString();x.prototype.bind=function(t,e,n){var r=this;return t=t instanceof Array?t:[t],r._bindMultiple.call(r,t,e,n),r},x.prototype.unbind=function(t,e){return this.bind.call(this,t,(function(){}),e)},x.prototype.trigger=function(t,e){var n=this;return n._directMap[t+":"+e]&&n._directMap[t+":"+e]({},t),n},x.prototype.reset=function(){var t=this;return t._callbacks={},t._directMap={},t},x.prototype.stopCallback=function(t,e){if((" "+e.className+" ").indexOf(" mousetrap ")>-1)return!1;if(y(e,this.target))return!1;if("composedPath"in t&&"function"==typeof t.composedPath){var n=t.composedPath()[0];n!==t.target&&(e=n)}return"INPUT"==e.tagName||"SELECT"==e.tagName||"TEXTAREA"==e.tagName||e.isContentEditable},x.prototype.handleKey=function(){return this._handleKey.apply(this,arguments)},x.addKeycodes=function(t){for(var e in t)t.hasOwnProperty(e)&&(u[e]=t[e]);s=null},x.init=function(){var t=x(o);for(var e in t)"_"!==e.charAt(0)&&(x[e]=function(e){return function(){return t[e].apply(t,arguments)}}(e))},x.init(),i.Mousetrap=x,t.exports&&(t.exports=x),void 0===(r=function(){return x}.call(e,n,e,t))||(t.exports=r)}function f(t,e,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent("on"+e,n)}function d(t){if("keypress"==t.type){var e=String.fromCharCode(t.which);return t.shiftKey||(e=e.toLowerCase()),e}return u[t.which]?u[t.which]:l[t.which]?l[t.which]:String.fromCharCode(t.which).toLowerCase()}function m(t){return"shift"==t||"ctrl"==t||"alt"==t||"meta"==t}function g(t,e,n){return n||(n=function(){if(!s)for(var t in s={},u)t>95&&t<112||u.hasOwnProperty(t)&&(s[u[t]]=t);return s}()[t]?"keydown":"keypress"),"keypress"==n&&e.length&&(n="keydown"),n}function v(t,e){var n,r,i,o=[];for(n=function(t){return"+"===t?["+"]:(t=t.replace(/\+{2}/g,"+plus")).split("+")}(t),i=0;i<n.length;++i)r=n[i],h[r]&&(r=h[r]),e&&"keypress"!=e&&c[r]&&(r=c[r],o.push("shift")),m(r)&&o.push(r);return{key:r,modifiers:o,action:e=g(r,o,e)}}function y(t,e){return null!==t&&t!==o&&(t===e||y(t.parentNode,e))}function x(t){var e=this;if(t=t||o,!(e instanceof x))return new x(t);e.target=t,e._callbacks={},e._directMap={};var n,r={},i=!1,a=!1,s=!1;function u(t){t=t||{};var e,n=!1;for(e in r)t[e]?n=!0:r[e]=0;n||(s=!1)}function l(t,n,i,o,a,s){var u,l,c,h,p=[],f=i.type;if(!e._callbacks[t])return[];for("keyup"==f&&m(t)&&(n=[t]),u=0;u<e._callbacks[t].length;++u)if(l=e._callbacks[t][u],(o||!l.seq||r[l.seq]==l.level)&&f==l.action&&("keypress"==f&&!i.metaKey&&!i.ctrlKey||(c=n,h=l.modifiers,c.sort().join(",")===h.sort().join(",")))){var d=!o&&l.combo==a,g=o&&l.seq==o&&l.level==s;(d||g)&&e._callbacks[t].splice(u,1),p.push(l)}return p}function c(t,n,r,i){e.stopCallback(n,n.target||n.srcElement,r,i)||!1===t(n,r)&&(function(t){t.preventDefault?t.preventDefault():t.returnValue=!1}(n),function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}(n))}function h(t){"number"!=typeof t.which&&(t.which=t.keyCode);var n=d(t);n&&("keyup"!=t.type||i!==n?e.handleKey(n,function(t){var e=[];return t.shiftKey&&e.push("shift"),t.altKey&&e.push("alt"),t.ctrlKey&&e.push("ctrl"),t.metaKey&&e.push("meta"),e}(t),t):i=!1)}function p(t,e,o,a){function l(e){return function(){s=e,++r[t],clearTimeout(n),n=setTimeout(u,1e3)}}function h(e){c(o,e,t),"keyup"!==a&&(i=d(e)),setTimeout(u,10)}r[t]=0;for(var p=0;p<e.length;++p){var f=p+1===e.length?h:l(a||v(e[p+1]).action);g(e[p],f,a,t,p)}}function g(t,n,r,i,o){e._directMap[t+":"+r]=n;var a,s=(t=t.replace(/\s+/g," ")).split(" ");s.length>1?p(t,s,n,r):(a=v(t,r),e._callbacks[a.key]=e._callbacks[a.key]||[],l(a.key,a.modifiers,{type:a.action},i,t,o),e._callbacks[a.key][i?"unshift":"push"]({callback:n,modifiers:a.modifiers,action:a.action,seq:i,level:o,combo:t}))}e._handleKey=function(t,e,n){var r,i=l(t,e,n),o={},h=0,p=!1;for(r=0;r<i.length;++r)i[r].seq&&(h=Math.max(h,i[r].level));for(r=0;r<i.length;++r)if(i[r].seq){if(i[r].level!=h)continue;p=!0,o[i[r].seq]=1,c(i[r].callback,n,i[r].combo,i[r].seq)}else p||c(i[r].callback,n,i[r].combo);var f="keypress"==n.type&&a;n.type!=s||m(t)||f||u(o),a=p&&"keydown"==n.type},e._bindMultiple=function(t,e,n){for(var r=0;r<t.length;++r)g(t[r],e,n)},f(t,"keypress",h),f(t,"keydown",h),f(t,"keyup",h)}}("undefined"!=typeof window?window:null,"undefined"!=typeof window?document:null)},34615:function(t,e,n){"use strict";n.r(e),n.d(e,{Line2:function(){return A},LineGeometry:function(){return E},LineMaterial:function(){return c},LineSegments2:function(){return T},LineSegmentsGeometry:function(){return u}});var r=n(78406);const i=window.THREE?window.THREE:{Box3:r.Box3,BufferGeometry:r.BufferGeometry,Float32BufferAttribute:r.Float32BufferAttribute,InstancedBufferGeometry:r.InstancedBufferGeometry,InstancedInterleavedBuffer:r.InstancedInterleavedBuffer,InterleavedBufferAttribute:r.InterleavedBufferAttribute,Sphere:r.Sphere,Vector3:r.Vector3,WireframeGeometry:r.WireframeGeometry};var o=(new i.BufferGeometry).setAttribute?"setAttribute":"addAttribute";const a=new i.Box3,s=new i.Vector3;class u extends i.InstancedBufferGeometry{constructor(){super(),this.type="LineSegmentsGeometry";this.setIndex([0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5]),this[o]("position",new i.Float32BufferAttribute([-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],3)),this[o]("uv",new i.Float32BufferAttribute([-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],2))}applyMatrix4(t){const e=this.attributes.instanceStart,n=this.attributes.instanceEnd;return void 0!==e&&(e.applyMatrix4(t),n.applyMatrix4(t),e.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}setPositions(t){let e;t instanceof Float32Array?e=t:Array.isArray(t)&&(e=new Float32Array(t));const n=new i.InstancedInterleavedBuffer(e,6,1);return this[o]("instanceStart",new i.InterleavedBufferAttribute(n,3,0)),this[o]("instanceEnd",new i.InterleavedBufferAttribute(n,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(t){let e;t instanceof Float32Array?e=t:Array.isArray(t)&&(e=new Float32Array(t));const n=new i.InstancedInterleavedBuffer(e,6,1);return this[o]("instanceColorStart",new i.InterleavedBufferAttribute(n,3,0)),this[o]("instanceColorEnd",new i.InterleavedBufferAttribute(n,3,3)),this}fromWireframeGeometry(t){return this.setPositions(t.attributes.position.array),this}fromEdgesGeometry(t){return this.setPositions(t.attributes.position.array),this}fromMesh(t){return this.fromWireframeGeometry(new i.WireframeGeometry(t.geometry)),this}fromLineSegments(t){const e=t.geometry;if(!e.isGeometry)return e.isBufferGeometry&&this.setPositions(e.attributes.position.array),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new i.Box3);const t=this.attributes.instanceStart,e=this.attributes.instanceEnd;void 0!==t&&void 0!==e&&(this.boundingBox.setFromBufferAttribute(t),a.setFromBufferAttribute(e),this.boundingBox.union(a))}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new i.Sphere),null===this.boundingBox&&this.computeBoundingBox();const t=this.attributes.instanceStart,e=this.attributes.instanceEnd;if(void 0!==t&&void 0!==e){const n=this.boundingSphere.center;this.boundingBox.getCenter(n);let r=0;for(let i=0,o=t.count;i<o;i++)s.fromBufferAttribute(t,i),r=Math.max(r,n.distanceToSquared(s)),s.fromBufferAttribute(e,i),r=Math.max(r,n.distanceToSquared(s));this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)}}toJSON(){}applyMatrix(t){return this.applyMatrix4(t)}}u.prototype.isLineSegmentsGeometry=!0;const l=window.THREE?window.THREE:{ShaderLib:r.ShaderLib,ShaderMaterial:r.ShaderMaterial,UniformsLib:r.UniformsLib,UniformsUtils:r.UniformsUtils,Vector2:r.Vector2};l.UniformsLib.line={worldUnits:{value:1},linewidth:{value:1},resolution:{value:new l.Vector2(1,1)},dashScale:{value:1},dashSize:{value:1},dashOffset:{value:0},gapSize:{value:1}},l.ShaderLib.line={uniforms:l.UniformsUtils.merge([l.UniformsLib.common,l.UniformsLib.fog,l.UniformsLib.line]),vertexShader:"\n\t\t#include <common>\n\t\t#include <color_pars_vertex>\n\t\t#include <fog_pars_vertex>\n\t\t#include <logdepthbuf_pars_vertex>\n\t\t#include <clipping_planes_pars_vertex>\n\n\t\tuniform float linewidth;\n\t\tuniform vec2 resolution;\n\n\t\tattribute vec3 instanceStart;\n\t\tattribute vec3 instanceEnd;\n\n\t\tattribute vec3 instanceColorStart;\n\t\tattribute vec3 instanceColorEnd;\n\n\t\tvarying vec2 vUv;\n\t\tvarying vec4 worldPos;\n\t\tvarying vec3 worldStart;\n\t\tvarying vec3 worldEnd;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashScale;\n\t\t\tattribute float instanceDistanceStart;\n\t\t\tattribute float instanceDistanceEnd;\n\t\t\tvarying float vLineDistance;\n\n\t\t#endif\n\n\t\tvoid trimSegment( const in vec4 start, inout vec4 end ) {\n\n\t\t\t// trim end segment so it terminates between the camera plane and the near plane\n\n\t\t\t// conservative estimate of the near plane\n\t\t\tfloat a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column\n\t\t\tfloat b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column\n\t\t\tfloat nearEstimate = - 0.5 * b / a;\n\n\t\t\tfloat alpha = ( nearEstimate - start.z ) / ( end.z - start.z );\n\n\t\t\tend.xyz = mix( start.xyz, end.xyz, alpha );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#ifdef USE_COLOR\n\n\t\t\t\tvColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;\n\n\t\t\t#endif\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;\n\n\t\t\t#endif\n\n\t\t\tfloat aspect = resolution.x / resolution.y;\n\n\t\t\tvUv = uv;\n\n\t\t\t// camera space\n\t\t\tvec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );\n\t\t\tvec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );\n\n\t\t\tworldStart = start.xyz;\n\t\t\tworldEnd = end.xyz;\n\n\t\t\t// special case for perspective projection, and segments that terminate either in, or behind, the camera plane\n\t\t\t// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\n\t\t\t// but we need to perform ndc-space calculations in the shader, so we must address this issue directly\n\t\t\t// perhaps there is a more elegant solution -- WestLangley\n\n\t\t\tbool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column\n\n\t\t\tif ( perspective ) {\n\n\t\t\t\tif ( start.z < 0.0 && end.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( start, end );\n\n\t\t\t\t} else if ( end.z < 0.0 && start.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( end, start );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// clip space\n\t\t\tvec4 clipStart = projectionMatrix * start;\n\t\t\tvec4 clipEnd = projectionMatrix * end;\n\n\t\t\t// ndc space\n\t\t\tvec3 ndcStart = clipStart.xyz / clipStart.w;\n\t\t\tvec3 ndcEnd = clipEnd.xyz / clipEnd.w;\n\n\t\t\t// direction\n\t\t\tvec2 dir = ndcEnd.xy - ndcStart.xy;\n\n\t\t\t// account for clip-space aspect ratio\n\t\t\tdir.x *= aspect;\n\t\t\tdir = normalize( dir );\n\n\t\t\t#ifdef WORLD_UNITS\n\n\t\t\t\t// get the offset direction as perpendicular to the view vector\n\t\t\t\tvec3 worldDir = normalize( end.xyz - start.xyz );\n\t\t\t\tvec3 offset;\n\t\t\t\tif ( position.y < 0.5 ) {\n\n\t\t\t\t\toffset = normalize( cross( start.xyz, worldDir ) );\n\n\t\t\t\t} else {\n\n\t\t\t\t\toffset = normalize( cross( end.xyz, worldDir ) );\n\n\t\t\t\t}\n\n\t\t\t\t// sign flip\n\t\t\t\tif ( position.x < 0.0 ) offset *= - 1.0;\n\n\t\t\t\tfloat forwardOffset = dot( worldDir, vec3( 0.0, 0.0, 1.0 ) );\n\n\t\t\t\t// don't extend the line if we're rendering dashes because we\n\t\t\t\t// won't be rendering the endcaps\n\t\t\t\t#ifndef USE_DASH\n\n\t\t\t\t\t// extend the line bounds to encompass  endcaps\n\t\t\t\t\tstart.xyz += - worldDir * linewidth * 0.5;\n\t\t\t\t\tend.xyz += worldDir * linewidth * 0.5;\n\n\t\t\t\t\t// shift the position of the quad so it hugs the forward edge of the line\n\t\t\t\t\toffset.xy -= dir * forwardOffset;\n\t\t\t\t\toffset.z += 0.5;\n\n\t\t\t\t#endif\n\n\t\t\t\t// endcaps\n\t\t\t\tif ( position.y > 1.0 || position.y < 0.0 ) {\n\n\t\t\t\t\toffset.xy += dir * 2.0 * forwardOffset;\n\n\t\t\t\t}\n\n\t\t\t\t// adjust for linewidth\n\t\t\t\toffset *= linewidth * 0.5;\n\n\t\t\t\t// set the world position\n\t\t\t\tworldPos = ( position.y < 0.5 ) ? start : end;\n\t\t\t\tworldPos.xyz += offset;\n\n\t\t\t\t// project the worldpos\n\t\t\t\tvec4 clip = projectionMatrix * worldPos;\n\n\t\t\t\t// shift the depth of the projected points so the line\n\t\t\t\t// segements overlap neatly\n\t\t\t\tvec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;\n\t\t\t\tclip.z = clipPose.z * clip.w;\n\n\t\t\t#else\n\n\t\t\tvec2 offset = vec2( dir.y, - dir.x );\n\t\t\t// undo aspect ratio adjustment\n\t\t\tdir.x /= aspect;\n\t\t\toffset.x /= aspect;\n\n\t\t\t// sign flip\n\t\t\tif ( position.x < 0.0 ) offset *= - 1.0;\n\n\t\t\t// endcaps\n\t\t\tif ( position.y < 0.0 ) {\n\n\t\t\t\toffset += - dir;\n\n\t\t\t} else if ( position.y > 1.0 ) {\n\n\t\t\t\toffset += dir;\n\n\t\t\t}\n\n\t\t\t// adjust for linewidth\n\t\t\toffset *= linewidth;\n\n\t\t\t// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n\t\t\toffset /= resolution.y;\n\n\t\t\t// select end\n\t\t\tvec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;\n\n\t\t\t// back to clip space\n\t\t\toffset *= clip.w;\n\n\t\t\tclip.xy += offset;\n\n\t\t\t#endif\n\n\t\t\tgl_Position = clip;\n\n\t\t\tvec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation\n\n\t\t\t#include <logdepthbuf_vertex>\n\t\t\t#include <clipping_planes_vertex>\n\t\t\t#include <fog_vertex>\n\n\t\t}\n\t\t",fragmentShader:"\n\t\tuniform vec3 diffuse;\n\t\tuniform float opacity;\n\t\tuniform float linewidth;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashOffset;\n\t\t\tuniform float dashSize;\n\t\t\tuniform float gapSize;\n\n\t\t#endif\n\n\t\tvarying float vLineDistance;\n\t\tvarying vec4 worldPos;\n\t\tvarying vec3 worldStart;\n\t\tvarying vec3 worldEnd;\n\n\t\t#include <common>\n\t\t#include <color_pars_fragment>\n\t\t#include <fog_pars_fragment>\n\t\t#include <logdepthbuf_pars_fragment>\n\t\t#include <clipping_planes_pars_fragment>\n\n\t\tvarying vec2 vUv;\n\n\t\tvec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {\n\n\t\t\tfloat mua;\n\t\t\tfloat mub;\n\n\t\t\tvec3 p13 = p1 - p3;\n\t\t\tvec3 p43 = p4 - p3;\n\n\t\t\tvec3 p21 = p2 - p1;\n\n\t\t\tfloat d1343 = dot( p13, p43 );\n\t\t\tfloat d4321 = dot( p43, p21 );\n\t\t\tfloat d1321 = dot( p13, p21 );\n\t\t\tfloat d4343 = dot( p43, p43 );\n\t\t\tfloat d2121 = dot( p21, p21 );\n\n\t\t\tfloat denom = d2121 * d4343 - d4321 * d4321;\n\n\t\t\tfloat numer = d1343 * d4321 - d1321 * d4343;\n\n\t\t\tmua = numer / denom;\n\t\t\tmua = clamp( mua, 0.0, 1.0 );\n\t\t\tmub = ( d1343 + d4321 * ( mua ) ) / d4343;\n\t\t\tmub = clamp( mub, 0.0, 1.0 );\n\n\t\t\treturn vec2( mua, mub );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#include <clipping_planes_fragment>\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tif ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps\n\n\t\t\t\tif ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX\n\n\t\t\t#endif\n\n\t\t\tfloat alpha = opacity;\n\n\t\t\t#ifdef WORLD_UNITS\n\n\t\t\t\t// Find the closest points on the view ray and the line segment\n\t\t\t\tvec3 rayEnd = normalize( worldPos.xyz ) * 1e5;\n\t\t\t\tvec3 lineDir = worldEnd - worldStart;\n\t\t\t\tvec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );\n\n\t\t\t\tvec3 p1 = worldStart + lineDir * params.x;\n\t\t\t\tvec3 p2 = rayEnd * params.y;\n\t\t\t\tvec3 delta = p1 - p2;\n\t\t\t\tfloat len = length( delta );\n\t\t\t\tfloat norm = len / linewidth;\n\n\t\t\t\t#ifndef USE_DASH\n\n\t\t\t\t\t#ifdef ALPHA_TO_COVERAGE\n\n\t\t\t\t\t\tfloat dnorm = fwidth( norm );\n\t\t\t\t\t\talpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );\n\n\t\t\t\t\t#else\n\n\t\t\t\t\t\tif ( norm > 0.5 ) {\n\n\t\t\t\t\t\t\tdiscard;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t#endif\n\n\t\t\t#endif\n\n\t\t\t#else\n\n\t\t\t\t#ifdef ALPHA_TO_COVERAGE\n\n\t\t\t\t\t// artifacts appear on some hardware if a derivative is taken within a conditional\n\t\t\t\t\tfloat a = vUv.x;\n\t\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t\t\tfloat len2 = a * a + b * b;\n\t\t\t\t\tfloat dlen = fwidth( len2 );\n\n\t\t\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\t\t\talpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );\n\n\t\t\t\t\t}\n\n\t\t\t\t#else\n\n\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\tfloat a = vUv.x;\n\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t\tfloat len2 = a * a + b * b;\n\n\t\t\t\tif ( len2 > 1.0 ) discard;\n\n\t\t\t}\n\n\t\t\t\t#endif\n\n\t\t\t#endif\n\n\t\t\tvec4 diffuseColor = vec4( diffuse, alpha );\n\n\t\t\t#include <logdepthbuf_fragment>\n\t\t\t#include <color_fragment>\n\n\t\t\tgl_FragColor = vec4( diffuseColor.rgb, alpha );\n\n\t\t\t#include <tonemapping_fragment>\n\t\t\t#include <encodings_fragment>\n\t\t\t#include <fog_fragment>\n\t\t\t#include <premultiplied_alpha_fragment>\n\n\t\t}\n\t\t"};class c extends l.ShaderMaterial{constructor(t){super({type:"LineMaterial",uniforms:l.UniformsUtils.clone(l.ShaderLib.line.uniforms),vertexShader:l.ShaderLib.line.vertexShader,fragmentShader:l.ShaderLib.line.fragmentShader,clipping:!0}),Object.defineProperties(this,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(t){this.uniforms.diffuse.value=t}},worldUnits:{enumerable:!0,get:function(){return"WORLD_UNITS"in this.defines},set:function(t){!0===t?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(t){this.uniforms.linewidth.value=t}},dashed:{enumerable:!0,get:function(){return Boolean("USE_DASH"in this.defines)},set(t){Boolean(t)!==Boolean("USE_DASH"in this.defines)&&(this.needsUpdate=!0),!0===t?this.defines.USE_DASH="":delete this.defines.USE_DASH}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(t){this.uniforms.dashScale.value=t}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(t){this.uniforms.dashSize.value=t}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(t){this.uniforms.dashOffset.value=t}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(t){this.uniforms.gapSize.value=t}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(t){this.uniforms.opacity.value=t}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(t){this.uniforms.resolution.value.copy(t)}},alphaToCoverage:{enumerable:!0,get:function(){return Boolean("ALPHA_TO_COVERAGE"in this.defines)},set:function(t){Boolean(t)!==Boolean("ALPHA_TO_COVERAGE"in this.defines)&&(this.needsUpdate=!0),!0===t?(this.defines.ALPHA_TO_COVERAGE="",this.extensions.derivatives=!0):(delete this.defines.ALPHA_TO_COVERAGE,this.extensions.derivatives=!1)}}}),this.setValues(t)}}c.prototype.isLineMaterial=!0;const h=window.THREE?window.THREE:{Box3:r.Box3,BufferGeometry:r.BufferGeometry,InstancedInterleavedBuffer:r.InstancedInterleavedBuffer,InterleavedBufferAttribute:r.InterleavedBufferAttribute,Line3:r.Line3,MathUtils:r.MathUtils,Matrix4:r.Matrix4,Mesh:r.Mesh,Sphere:r.Sphere,Vector3:r.Vector3,Vector4:r.Vector4};var p=(new h.BufferGeometry).setAttribute?"setAttribute":"addAttribute";const f=new h.Vector3,d=new h.Vector3,m=new h.Vector4,g=new h.Vector4,v=new h.Vector4,y=new h.Vector3,x=new h.Matrix4,_=new h.Line3,b=new h.Vector3,w=new h.Box3,M=new h.Sphere,S=new h.Vector4;class T extends h.Mesh{constructor(t=new u,e=new c({color:16777215*Math.random()})){super(t,e),this.type="LineSegments2"}computeLineDistances(){const t=this.geometry,e=t.attributes.instanceStart,n=t.attributes.instanceEnd,r=new Float32Array(2*e.count);for(let t=0,i=0,o=e.count;t<o;t++,i+=2)f.fromBufferAttribute(e,t),d.fromBufferAttribute(n,t),r[i]=0===i?0:r[i-1],r[i+1]=r[i]+f.distanceTo(d);const i=new h.InstancedInterleavedBuffer(r,2,1);return t[p]("instanceDistanceStart",new h.InterleavedBufferAttribute(i,1,0)),t[p]("instanceDistanceEnd",new h.InterleavedBufferAttribute(i,1,1)),this}raycast(t,e){t.camera;const n=void 0!==t.params.Line2&&t.params.Line2.threshold||0,r=t.ray,i=t.camera,o=i.projectionMatrix,a=this.matrixWorld,s=this.geometry,u=this.material,l=u.resolution,c=u.linewidth+n,p=s.attributes.instanceStart,f=s.attributes.instanceEnd,d=-i.near,T=2*Math.max(c/l.width,c/l.height);null===s.boundingSphere&&s.computeBoundingSphere(),M.copy(s.boundingSphere).applyMatrix4(a);const E=Math.max(i.near,M.distanceToPoint(r.origin));S.set(0,0,-E,1).applyMatrix4(i.projectionMatrix),S.multiplyScalar(1/S.w),S.applyMatrix4(i.projectionMatrixInverse);const A=.5*Math.abs(T/S.w);if(M.radius+=A,!1===t.ray.intersectsSphere(M))return;null===s.boundingBox&&s.computeBoundingBox(),w.copy(s.boundingBox).applyMatrix4(a);const P=Math.max(i.near,w.distanceToPoint(r.origin));S.set(0,0,-P,1).applyMatrix4(i.projectionMatrix),S.multiplyScalar(1/S.w),S.applyMatrix4(i.projectionMatrixInverse);const C=.5*Math.abs(T/S.w);if(w.max.x+=C,w.max.y+=C,w.max.z+=C,w.min.x-=C,w.min.y-=C,w.min.z-=C,!1!==t.ray.intersectsBox(w)){r.at(1,v),v.w=1,v.applyMatrix4(i.matrixWorldInverse),v.applyMatrix4(o),v.multiplyScalar(1/v.w),v.x*=l.x/2,v.y*=l.y/2,v.z=0,y.copy(v),x.multiplyMatrices(i.matrixWorldInverse,a);for(let t=0,n=p.count;t<n;t++){if(m.fromBufferAttribute(p,t),g.fromBufferAttribute(f,t),m.w=1,g.w=1,m.applyMatrix4(x),g.applyMatrix4(x),m.z>d&&g.z>d)continue;if(m.z>d){const t=m.z-g.z,e=(m.z-d)/t;m.lerp(g,e)}else if(g.z>d){const t=g.z-m.z,e=(g.z-d)/t;g.lerp(m,e)}m.applyMatrix4(o),g.applyMatrix4(o),m.multiplyScalar(1/m.w),g.multiplyScalar(1/g.w),m.x*=l.x/2,m.y*=l.y/2,g.x*=l.x/2,g.y*=l.y/2,_.start.copy(m),_.start.z=0,_.end.copy(g),_.end.z=0;const n=_.closestPointToPointParameter(y,!0);_.at(n,b);const i=h.MathUtils.lerp(m.z,g.z,n),s=i>=-1&&i<=1,u=y.distanceTo(b)<.5*c;if(s&&u){_.start.fromBufferAttribute(p,t),_.end.fromBufferAttribute(f,t),_.start.applyMatrix4(a),_.end.applyMatrix4(a);const n=new h.Vector3,i=new h.Vector3;r.distanceSqToSegment(_.start,_.end,i,n),e.push({point:i,pointOnLine:n,distance:r.origin.distanceTo(i),object:this,face:null,faceIndex:t,uv:null,uv2:null})}}}}}T.prototype.LineSegments2=!0;class E extends u{constructor(){super(),this.type="LineGeometry"}setPositions(t){for(var e=t.length-3,n=new Float32Array(2*e),r=0;r<e;r+=3)n[2*r]=t[r],n[2*r+1]=t[r+1],n[2*r+2]=t[r+2],n[2*r+3]=t[r+3],n[2*r+4]=t[r+4],n[2*r+5]=t[r+5];return super.setPositions(n),this}setColors(t){for(var e=t.length-3,n=new Float32Array(2*e),r=0;r<e;r+=3)n[2*r]=t[r],n[2*r+1]=t[r+1],n[2*r+2]=t[r+2],n[2*r+3]=t[r+3],n[2*r+4]=t[r+4],n[2*r+5]=t[r+5];return super.setColors(n),this}fromLine(t){var e=t.geometry;if(!e.isGeometry)return e.isBufferGeometry&&this.setPositions(e.attributes.position.array),this}}E.prototype.isLineGeometry=!0;class A extends T{constructor(t=new E,e=new c({color:16777215*Math.random()})){super(t,e),this.type="Line2"}}A.prototype.isLine2=!0},78406:function(t,e,n){"use strict";function r(){}n.r(e),n.d(e,{ACESFilmicToneMapping:function(){return pt},AddEquation:function(){return R},AddOperation:function(){return at},AdditiveBlending:function(){return L},AlphaFormat:function(){return Xt},AlwaysDepth:function(){return K},AlwaysStencilFunc:function(){return cn},AmbientLight:function(){return rl},AmbientLightProbe:function(){return Il},AnimationClip:function(){return pu},AnimationLoader:function(){return xu},AnimationMixer:function(){return oc},AnimationObjectGroup:function(){return rc},AnimationUtils:function(){return $s},ArcCurve:function(){return Au},ArrayCamera:function(){return Jo},ArrowHelper:function(){return Nc},Audio:function(){return Dl},AudioAnalyser:function(){return Fl},AudioContext:function(){return El},AudioListener:function(){return Rl},AudioLoader:function(){return Al},AxesHelper:function(){return Rc},AxisHelper:function(){return ah},BackSide:function(){return b},BasicDepthPacking:function(){return We},BasicShadowMap:function(){return v},BinaryTextureLoader:function(){return hh},Bone:function(){return ya},BooleanKeyframeTrack:function(){return ou},BoundingBoxHelper:function(){return sh},Box2:function(){return fc},Box3:function(){return rr},Box3Helper:function(){return Ic},BoxBufferGeometry:function(){return zr},BoxGeometry:function(){return Ur},BoxHelper:function(){return Lc},BufferAttribute:function(){return xr},BufferGeometry:function(){return Dr},BufferGeometryLoader:function(){return ll},ByteType:function(){return Dt},Cache:function(){return du},Camera:function(){return Yr},CameraHelper:function(){return Cc},CanvasRenderer:function(){return fh},CanvasTexture:function(){return Aa},CatmullRomCurve3:function(){return Nu},CineonToneMapping:function(){return ht},CircleBufferGeometry:function(){return zs},CircleGeometry:function(){return Us},ClampToEdgeWrapping:function(){return wt},Clock:function(){return Nl},ClosedSplineCurve3:function(){return rh},Color:function(){return hr},ColorKeyframeTrack:function(){return au},CompressedTexture:function(){return Ea},CompressedTextureLoader:function(){return _u},ConeBufferGeometry:function(){return Bs},ConeGeometry:function(){return Fs},CubeCamera:function(){return $r},CubeGeometry:function(){return Ur},CubeReflectionMapping:function(){return dt},CubeRefractionMapping:function(){return mt},CubeTexture:function(){return wi},CubeTextureLoader:function(){return Mu},CubeUVReflectionMapping:function(){return xt},CubeUVRefractionMapping:function(){return _t},CubicBezierCurve:function(){return Fu},CubicBezierCurve3:function(){return Bu},CubicInterpolant:function(){return eu},CullFaceBack:function(){return p},CullFaceFront:function(){return f},CullFaceFrontBack:function(){return d},CullFaceNone:function(){return h},Curve:function(){return Tu},CurvePath:function(){return Hu},CustomBlending:function(){return N},CylinderBufferGeometry:function(){return ks},CylinderGeometry:function(){return Ds},Cylindrical:function(){return pc},DataTexture:function(){return ei},DataTexture2DArray:function(){return Mi},DataTexture3D:function(){return Si},DataTextureLoader:function(){return bu},DecrementStencilOp:function(){return Qe},DecrementWrapStencilOp:function(){return tn},DefaultLoadingManager:function(){return gu},DepthFormat:function(){return Qt},DepthStencilFormat:function(){return $t},DepthTexture:function(){return Pa},DirectionalLight:function(){return nl},DirectionalLightHelper:function(){return Pc},DirectionalLightShadow:function(){return el},DiscreteInterpolant:function(){return ru},DodecahedronBufferGeometry:function(){return Va},DodecahedronGeometry:function(){return za},DoubleSide:function(){return w},DstAlphaFactor:function(){return H},DstColorFactor:function(){return Y},DynamicBufferAttribute:function(){return Yc},EdgesGeometry:function(){return Rs},EdgesHelper:function(){return uh},EllipseCurve:function(){return Eu},EqualDepth:function(){return tt},EqualStencilFunc:function(){return on},EquirectangularReflectionMapping:function(){return gt},EquirectangularRefractionMapping:function(){return vt},Euler:function(){return On},EventDispatcher:function(){return r},ExtrudeBufferGeometry:function(){return _s},ExtrudeGeometry:function(){return xs},Face3:function(){return mr},Face4:function(){return Dc},FaceColors:function(){return E},FaceNormalsHelper:function(){return Ac},FileLoader:function(){return yu},FlatShading:function(){return M},Float32Attribute:function(){return eh},Float32BufferAttribute:function(){return Ar},Float64Attribute:function(){return nh},Float64BufferAttribute:function(){return Pr},FloatType:function(){return zt},Fog:function(){return ca},FogExp2:function(){return la},Font:function(){return wl},FontLoader:function(){return Sl},FrontFaceDirectionCCW:function(){return g},FrontFaceDirectionCW:function(){return m},FrontSide:function(){return _},Frustum:function(){return ri},GammaEncoding:function(){return Be},Geometry:function(){return Br},GeometryUtils:function(){return ph},GreaterDepth:function(){return nt},GreaterEqualDepth:function(){return et},GreaterEqualStencilFunc:function(){return ln},GreaterStencilFunc:function(){return sn},GridHelper:function(){return Sc},Group:function(){return Zo},HalfFloatType:function(){return Vt},HemisphereLight:function(){return Zu},HemisphereLightHelper:function(){return wc},HemisphereLightProbe:function(){return Ll},IcosahedronBufferGeometry:function(){return Ua},IcosahedronGeometry:function(){return Ba},ImageBitmapLoader:function(){return _l},ImageLoader:function(){return wu},ImageUtils:function(){return Tn},ImmediateRenderObject:function(){return mc},IncrementStencilOp:function(){return Ke},IncrementWrapStencilOp:function(){return $e},InstancedBufferAttribute:function(){return ul},InstancedBufferGeometry:function(){return sl},InstancedInterleavedBuffer:function(){return sc},Int16Attribute:function(){return Kc},Int16BufferAttribute:function(){return Mr},Int32Attribute:function(){return $c},Int32BufferAttribute:function(){return Tr},Int8Attribute:function(){return qc},Int8BufferAttribute:function(){return _r},IntType:function(){return Bt},InterleavedBuffer:function(){return ha},InterleavedBufferAttribute:function(){return pa},Interpolant:function(){return tu},InterpolateDiscrete:function(){return Ae},InterpolateLinear:function(){return Pe},InterpolateSmooth:function(){return Ce},InvertStencilOp:function(){return en},JSONLoader:function(){return dh},KeepStencilOp:function(){return Ze},KeyframeTrack:function(){return iu},LOD:function(){return ma},LatheBufferGeometry:function(){return Ls},LatheGeometry:function(){return Cs},Layers:function(){return Nn},LensFlare:function(){return gh},LessDepth:function(){return Q},LessEqualDepth:function(){return $},LessEqualStencilFunc:function(){return an},LessStencilFunc:function(){return rn},Light:function(){return qu},LightProbe:function(){return Cl},LightProbeHelper:function(){return Mc},LightShadow:function(){return Ju},Line:function(){return _a},Line3:function(){return dc},LineBasicMaterial:function(){return xa},LineCurve:function(){return Uu},LineCurve3:function(){return zu},LineDashedMaterial:function(){return Ks},LineLoop:function(){return wa},LinePieces:function(){return Fc},LineSegments:function(){return ba},LineStrip:function(){return kc},LinearEncoding:function(){return ke},LinearFilter:function(){return Ct},LinearInterpolant:function(){return nu},LinearMipMapLinearFilter:function(){return Nt},LinearMipMapNearestFilter:function(){return It},LinearMipmapLinearFilter:function(){return Ot},LinearMipmapNearestFilter:function(){return Lt},LinearToneMapping:function(){return ut},Loader:function(){return Tl},LoaderUtils:function(){return al},LoadingManager:function(){return mu},LogLuvEncoding:function(){return ze},LoopOnce:function(){return Se},LoopPingPong:function(){return Ee},LoopRepeat:function(){return Te},LuminanceAlphaFormat:function(){return Jt},LuminanceFormat:function(){return Zt},MOUSE:function(){return l},Material:function(){return vr},MaterialLoader:function(){return ol},Math:function(){return hn},Matrix3:function(){return mn},Matrix4:function(){return In},MaxEquation:function(){return B},Mesh:function(){return kr},MeshBasicMaterial:function(){return yr},MeshDepthMaterial:function(){return jo},MeshDistanceMaterial:function(){return Wo},MeshFaceMaterial:function(){return Bc},MeshLambertMaterial:function(){return Zs},MeshMatcapMaterial:function(){return Js},MeshNormalMaterial:function(){return qs},MeshPhongMaterial:function(){return Xs},MeshPhysicalMaterial:function(){return Hs},MeshStandardMaterial:function(){return Ws},MeshToonMaterial:function(){return Ys},MinEquation:function(){return F},MirroredRepeatWrapping:function(){return Mt},MixOperation:function(){return ot},MultiMaterial:function(){return Uc},MultiplyBlending:function(){return O},MultiplyOperation:function(){return it},NearestFilter:function(){return St},NearestMipMapLinearFilter:function(){return Pt},NearestMipMapNearestFilter:function(){return Et},NearestMipmapLinearFilter:function(){return At},NearestMipmapNearestFilter:function(){return Tt},NeverDepth:function(){return J},NeverStencilFunc:function(){return nn},NoBlending:function(){return P},NoColors:function(){return T},NoToneMapping:function(){return st},NormalBlending:function(){return C},NotEqualDepth:function(){return rt},NotEqualStencilFunc:function(){return un},NumberKeyframeTrack:function(){return su},Object3D:function(){return er},ObjectLoader:function(){return hl},ObjectSpaceNormalMap:function(){return Ye},OctahedronBufferGeometry:function(){return Fa},OctahedronGeometry:function(){return ka},OneFactor:function(){return z},OneMinusDstAlphaFactor:function(){return X},OneMinusDstColorFactor:function(){return q},OneMinusSrcAlphaFactor:function(){return W},OneMinusSrcColorFactor:function(){return G},OrthographicCamera:function(){return tl},PCFShadowMap:function(){return y},PCFSoftShadowMap:function(){return x},ParametricBufferGeometry:function(){return Ia},ParametricGeometry:function(){return La},Particle:function(){return Vc},ParticleBasicMaterial:function(){return Wc},ParticleSystem:function(){return Gc},ParticleSystemMaterial:function(){return Hc},Path:function(){return Xu},PerspectiveCamera:function(){return qr},Plane:function(){return ni},PlaneBufferGeometry:function(){return ci},PlaneGeometry:function(){return li},PlaneHelper:function(){return Oc},PointCloud:function(){return zc},PointCloudMaterial:function(){return jc},PointLight:function(){return $u},PointLightHelper:function(){return _c},Points:function(){return Sa},PointsMaterial:function(){return Ma},PolarGridHelper:function(){return Tc},PolyhedronBufferGeometry:function(){return Na},PolyhedronGeometry:function(){return Oa},PositionalAudio:function(){return kl},PositionalAudioHelper:function(){return Ec},PropertyBinding:function(){return nc},PropertyMixer:function(){return Bl},QuadraticBezierCurve:function(){return Vu},QuadraticBezierCurve3:function(){return Gu},Quaternion:function(){return fn},QuaternionKeyframeTrack:function(){return lu},QuaternionLinearInterpolant:function(){return uu},REVISION:function(){return u},RGBADepthPacking:function(){return He},RGBAFormat:function(){return qt},RGBA_ASTC_10x10_Format:function(){return be},RGBA_ASTC_10x5_Format:function(){return ye},RGBA_ASTC_10x6_Format:function(){return xe},RGBA_ASTC_10x8_Format:function(){return _e},RGBA_ASTC_12x10_Format:function(){return we},RGBA_ASTC_12x12_Format:function(){return Me},RGBA_ASTC_4x4_Format:function(){return ce},RGBA_ASTC_5x4_Format:function(){return he},RGBA_ASTC_5x5_Format:function(){return pe},RGBA_ASTC_6x5_Format:function(){return fe},RGBA_ASTC_6x6_Format:function(){return de},RGBA_ASTC_8x5_Format:function(){return me},RGBA_ASTC_8x6_Format:function(){return ge},RGBA_ASTC_8x8_Format:function(){return ve},RGBA_PVRTC_2BPPV1_Format:function(){return ue},RGBA_PVRTC_4BPPV1_Format:function(){return se},RGBA_S3TC_DXT1_Format:function(){return ne},RGBA_S3TC_DXT3_Format:function(){return re},RGBA_S3TC_DXT5_Format:function(){return ie},RGBDEncoding:function(){return je},RGBEEncoding:function(){return Ue},RGBEFormat:function(){return Kt},RGBFormat:function(){return Yt},RGBM16Encoding:function(){return Ge},RGBM7Encoding:function(){return Ve},RGB_ETC1_Format:function(){return le},RGB_PVRTC_2BPPV1_Format:function(){return ae},RGB_PVRTC_4BPPV1_Format:function(){return oe},RGB_S3TC_DXT1_Format:function(){return ee},RawShaderMaterial:function(){return js},Ray:function(){return or},Raycaster:function(){return uc},RectAreaLight:function(){return il},RectAreaLightHelper:function(){return bc},RedFormat:function(){return te},ReinhardToneMapping:function(){return lt},RepeatWrapping:function(){return bt},ReplaceStencilOp:function(){return Je},ReverseSubtractEquation:function(){return k},RingBufferGeometry:function(){return Ps},RingGeometry:function(){return As},Scene:function(){return nr},SceneUtils:function(){return mh},ShaderChunk:function(){return ii},ShaderLib:function(){return ai},ShaderMaterial:function(){return Xr},ShadowMaterial:function(){return Gs},Shape:function(){return Yu},ShapeBufferGeometry:function(){return Os},ShapeGeometry:function(){return Is},ShapePath:function(){return bl},ShapeUtils:function(){return gs},ShortType:function(){return kt},Skeleton:function(){return va},SkeletonHelper:function(){return xc},SkinnedMesh:function(){return ga},SmoothShading:function(){return S},Sphere:function(){return ir},SphereBufferGeometry:function(){return Es},SphereGeometry:function(){return Ts},Spherical:function(){return hc},SphericalHarmonics3:function(){return Pl},SphericalReflectionMapping:function(){return yt},Spline:function(){return oh},SplineCurve:function(){return ju},SplineCurve3:function(){return ih},SpotLight:function(){return Qu},SpotLightHelper:function(){return vc},SpotLightShadow:function(){return Ku},Sprite:function(){return da},SpriteMaterial:function(){return fa},SrcAlphaFactor:function(){return j},SrcAlphaSaturateFactor:function(){return Z},SrcColorFactor:function(){return V},StereoCamera:function(){return Ol},StringKeyframeTrack:function(){return cu},SubtractEquation:function(){return D},SubtractiveBlending:function(){return I},TOUCH:function(){return c},TangentSpaceNormalMap:function(){return Xe},TetrahedronBufferGeometry:function(){return Da},TetrahedronGeometry:function(){return Ra},TextBufferGeometry:function(){return Ss},TextGeometry:function(){return Ms},Texture:function(){return An},TextureLoader:function(){return Su},TorusBufferGeometry:function(){return Ya},TorusGeometry:function(){return Xa},TorusKnotBufferGeometry:function(){return Ha},TorusKnotGeometry:function(){return Wa},Triangle:function(){return ar},TriangleFanDrawMode:function(){return De},TriangleStripDrawMode:function(){return Re},TrianglesDrawMode:function(){return Ne},TubeBufferGeometry:function(){return ja},TubeGeometry:function(){return Ga},UVMapping:function(){return ft},Uint16Attribute:function(){return Qc},Uint16BufferAttribute:function(){return Sr},Uint32Attribute:function(){return th},Uint32BufferAttribute:function(){return Er},Uint8Attribute:function(){return Zc},Uint8BufferAttribute:function(){return br},Uint8ClampedAttribute:function(){return Jc},Uint8ClampedBufferAttribute:function(){return wr},Uncharted2ToneMapping:function(){return ct},Uniform:function(){return ac},UniformsLib:function(){return oi},UniformsUtils:function(){return jr},UnsignedByteType:function(){return Rt},UnsignedInt248Type:function(){return Ht},UnsignedIntType:function(){return Ut},UnsignedShort4444Type:function(){return Gt},UnsignedShort5551Type:function(){return jt},UnsignedShort565Type:function(){return Wt},UnsignedShortType:function(){return Ft},Vector2:function(){return pn},Vector3:function(){return dn},Vector4:function(){return Pn},VectorKeyframeTrack:function(){return hu},Vertex:function(){return Xc},VertexColors:function(){return A},VertexNormalsHelper:function(){return gc},VideoTexture:function(){return Ta},WebGLMultisampleRenderTarget:function(){return Ln},WebGLRenderTarget:function(){return Cn},WebGLRenderTargetCube:function(){return ti},WebGLRenderer:function(){return ua},WebGLUtils:function(){return qo},WireframeGeometry:function(){return Ca},WireframeHelper:function(){return lh},WrapAroundEnding:function(){return Oe},XHRLoader:function(){return ch},ZeroCurvatureEnding:function(){return Le},ZeroFactor:function(){return U},ZeroSlopeEnding:function(){return Ie},ZeroStencilOp:function(){return qe},sRGBEncoding:function(){return Fe}}),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),void 0===Math.sign&&(Math.sign=function(t){return t<0?-1:t>0?1:+t}),"name"in Function.prototype==!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}),Object.assign(r.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)},removeEventListener:function(t,e){if(void 0!==this._listeners){var n=this._listeners[t];if(void 0!==n){var r=n.indexOf(e);-1!==r&&n.splice(r,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var n=e.slice(0),r=0,i=n.length;r<i;r++)n[r].call(this,t)}}}});var i,o,a,s,u="107",l={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},c={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},h=0,p=1,f=2,d=3,m=0,g=1,v=0,y=1,x=2,_=0,b=1,w=2,M=1,S=2,T=0,E=1,A=2,P=0,C=1,L=2,I=3,O=4,N=5,R=100,D=101,k=102,F=103,B=104,U=200,z=201,V=202,G=203,j=204,W=205,H=206,X=207,Y=208,q=209,Z=210,J=0,K=1,Q=2,$=3,tt=4,et=5,nt=6,rt=7,it=0,ot=1,at=2,st=0,ut=1,lt=2,ct=3,ht=4,pt=5,ft=300,dt=301,mt=302,gt=303,vt=304,yt=305,xt=306,_t=307,bt=1e3,wt=1001,Mt=1002,St=1003,Tt=1004,Et=1004,At=1005,Pt=1005,Ct=1006,Lt=1007,It=1007,Ot=1008,Nt=1008,Rt=1009,Dt=1010,kt=1011,Ft=1012,Bt=1013,Ut=1014,zt=1015,Vt=1016,Gt=1017,jt=1018,Wt=1019,Ht=1020,Xt=1021,Yt=1022,qt=1023,Zt=1024,Jt=1025,Kt=qt,Qt=1026,$t=1027,te=1028,ee=33776,ne=33777,re=33778,ie=33779,oe=35840,ae=35841,se=35842,ue=35843,le=36196,ce=37808,he=37809,pe=37810,fe=37811,de=37812,me=37813,ge=37814,ve=37815,ye=37816,xe=37817,_e=37818,be=37819,we=37820,Me=37821,Se=2200,Te=2201,Ee=2202,Ae=2300,Pe=2301,Ce=2302,Le=2400,Ie=2401,Oe=2402,Ne=0,Re=1,De=2,ke=3e3,Fe=3001,Be=3007,Ue=3002,ze=3003,Ve=3004,Ge=3005,je=3006,We=3200,He=3201,Xe=0,Ye=1,qe=0,Ze=7680,Je=7681,Ke=7682,Qe=7683,$e=34055,tn=34056,en=5386,nn=512,rn=513,on=514,an=515,sn=516,un=517,ln=518,cn=519,hn={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var t=[],e=0;e<256;e++)t[e]=(e<16?"0":"")+e.toString(16);return function(){var e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(t[255&e]+t[e>>8&255]+t[e>>16&255]+t[e>>24&255]+"-"+t[255&n]+t[n>>8&255]+"-"+t[n>>16&15|64]+t[n>>24&255]+"-"+t[63&r|128]+t[r>>8&255]+"-"+t[r>>16&255]+t[r>>24&255]+t[255&i]+t[i>>8&255]+t[i>>16&255]+t[i>>24&255]).toUpperCase()}}(),clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,r,i){return r+(t-e)*(i-r)/(n-e)},lerp:function(t,e,n){return(1-n)*t+n*e},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*hn.DEG2RAD},radToDeg:function(t){return t*hn.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}};function pn(t,e){this.x=t||0,this.y=e||0}function fn(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._w=void 0!==r?r:1}function dn(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0}function mn(){this.elements=[1,0,0,0,1,0,0,0,1]}Object.defineProperties(pn.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(pn.prototype,{isVector2:!0,set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){var e=this.x,n=this.y,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6],this.y=r[1]*e+r[4]*n+r[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y;return e*e+n*n},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromBufferAttribute:function(t,e,n){return this.x=t.getX(e),this.y=t.getY(e),this},rotateAround:function(t,e){var n=Math.cos(e),r=Math.sin(e),i=this.x-t.x,o=this.y-t.y;return this.x=i*n-o*r+t.x,this.y=i*r+o*n+t.y,this}}),Object.assign(fn,{slerp:function(t,e,n,r){return n.copy(t).slerp(e,r)},slerpFlat:function(t,e,n,r,i,o,a){var s=n[r+0],u=n[r+1],l=n[r+2],c=n[r+3],h=i[o+0],p=i[o+1],f=i[o+2],d=i[o+3];if(c!==d||s!==h||u!==p||l!==f){var m=1-a,g=s*h+u*p+l*f+c*d,v=g>=0?1:-1,y=1-g*g;if(y>Number.EPSILON){var x=Math.sqrt(y),_=Math.atan2(x,g*v);m=Math.sin(m*_)/x,a=Math.sin(a*_)/x}var b=a*v;if(s=s*m+h*b,u=u*m+p*b,l=l*m+f*b,c=c*m+d*b,m===1-a){var w=1/Math.sqrt(s*s+u*u+l*l+c*c);s*=w,u*=w,l*=w,c*=w}}t[e]=s,t[e+1]=u,t[e+2]=l,t[e+3]=c}}),Object.defineProperties(fn.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}}}),Object.assign(fn.prototype,{isQuaternion:!0,set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},setFromEuler:function(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=t._x,r=t._y,i=t._z,o=t.order,a=Math.cos,s=Math.sin,u=a(n/2),l=a(r/2),c=a(i/2),h=s(n/2),p=s(r/2),f=s(i/2);return"XYZ"===o?(this._x=h*l*c+u*p*f,this._y=u*p*c-h*l*f,this._z=u*l*f+h*p*c,this._w=u*l*c-h*p*f):"YXZ"===o?(this._x=h*l*c+u*p*f,this._y=u*p*c-h*l*f,this._z=u*l*f-h*p*c,this._w=u*l*c+h*p*f):"ZXY"===o?(this._x=h*l*c-u*p*f,this._y=u*p*c+h*l*f,this._z=u*l*f+h*p*c,this._w=u*l*c-h*p*f):"ZYX"===o?(this._x=h*l*c-u*p*f,this._y=u*p*c+h*l*f,this._z=u*l*f-h*p*c,this._w=u*l*c+h*p*f):"YZX"===o?(this._x=h*l*c+u*p*f,this._y=u*p*c+h*l*f,this._z=u*l*f-h*p*c,this._w=u*l*c-h*p*f):"XZY"===o&&(this._x=h*l*c-u*p*f,this._y=u*p*c-h*l*f,this._z=u*l*f+h*p*c,this._w=u*l*c+h*p*f),!1!==e&&this._onChangeCallback(),this},setFromAxisAngle:function(t,e){var n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this._onChangeCallback(),this},setFromRotationMatrix:function(t){var e,n=t.elements,r=n[0],i=n[4],o=n[8],a=n[1],s=n[5],u=n[9],l=n[2],c=n[6],h=n[10],p=r+s+h;return p>0?(e=.5/Math.sqrt(p+1),this._w=.25/e,this._x=(c-u)*e,this._y=(o-l)*e,this._z=(a-i)*e):r>s&&r>h?(e=2*Math.sqrt(1+r-s-h),this._w=(c-u)/e,this._x=.25*e,this._y=(i+a)/e,this._z=(o+l)/e):s>h?(e=2*Math.sqrt(1+s-r-h),this._w=(o-l)/e,this._x=(i+a)/e,this._y=.25*e,this._z=(u+c)/e):(e=2*Math.sqrt(1+h-r-s),this._w=(a-i)/e,this._x=(o+l)/e,this._y=(u+c)/e,this._z=.25*e),this._onChangeCallback(),this},setFromUnitVectors:function(t,e){var n=t.dot(e)+1;return n<1e-6?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(hn.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,e){var n=this.angleTo(t);if(0===n)return this;var r=Math.min(1,e/n);return this.slerp(t,r),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this},multiply:function(t,e){return void 0!==e?this.multiplyQuaternions(t,e):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var n=t._x,r=t._y,i=t._z,o=t._w,a=e._x,s=e._y,u=e._z,l=e._w;return this._x=n*l+o*a+r*u-i*s,this._y=r*l+o*s+i*a-n*u,this._z=i*l+o*u+n*s-r*a,this._w=o*l-n*a-r*s-i*u,this._onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var n=this._x,r=this._y,i=this._z,o=this._w,a=o*t._w+n*t._x+r*t._y+i*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=o,this._x=n,this._y=r,this._z=i,this;var s=1-a*a;if(s<=Number.EPSILON){var u=1-e;return this._w=u*o+e*this._w,this._x=u*n+e*this._x,this._y=u*r+e*this._y,this._z=u*i+e*this._z,this.normalize(),this._onChangeCallback(),this}var l=Math.sqrt(s),c=Math.atan2(l,a),h=Math.sin((1-e)*c)/l,p=Math.sin(e*c)/l;return this._w=o*h+this._w*p,this._x=n*h+this._x*p,this._y=r*h+this._y*p,this._z=i*h+this._z*p,this._onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}}),Object.assign(dn.prototype,{isVector3:!0,set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?this.multiplyVectors(t,e):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:(o=new fn,function(t){return!t||t.isEuler,this.applyQuaternion(o.setFromEuler(t))}),applyAxisAngle:function(){var t=new fn;return function(e,n){return this.applyQuaternion(t.setFromAxisAngle(e,n))}}(),applyMatrix3:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6]*r,this.y=i[1]*e+i[4]*n+i[7]*r,this.z=i[2]*e+i[5]*n+i[8]*r,this},applyMatrix4:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements,o=1/(i[3]*e+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*e+i[4]*n+i[8]*r+i[12])*o,this.y=(i[1]*e+i[5]*n+i[9]*r+i[13])*o,this.z=(i[2]*e+i[6]*n+i[10]*r+i[14])*o,this},applyQuaternion:function(t){var e=this.x,n=this.y,r=this.z,i=t.x,o=t.y,a=t.z,s=t.w,u=s*e+o*r-a*n,l=s*n+a*e-i*r,c=s*r+i*n-o*e,h=-i*e-o*n-a*r;return this.x=u*s+h*-i+l*-a-c*-o,this.y=l*s+h*-o+c*-i-u*-a,this.z=c*s+h*-a+u*-o-l*-i,this},project:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},unproject:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},transformDirection:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[4]*n+i[8]*r,this.y=i[1]*e+i[5]*n+i[9]*r,this.z=i[2]*e+i[6]*n+i[10]*r,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},cross:function(t,e){return void 0!==e?this.crossVectors(t,e):this.crossVectors(this,t)},crossVectors:function(t,e){var n=t.x,r=t.y,i=t.z,o=e.x,a=e.y,s=e.z;return this.x=r*s-i*a,this.y=i*o-n*s,this.z=n*a-r*o,this},projectOnVector:function(t){var e=t.dot(this)/t.lengthSq();return this.copy(t).multiplyScalar(e)},projectOnPlane:(i=new dn,function(t){return i.copy(this).projectOnVector(t),this.sub(i)}),reflect:function(){var t=new dn;return function(e){return this.sub(t.copy(e).multiplyScalar(2*this.dot(e)))}}(),angleTo:function(t){var e=this.dot(t)/Math.sqrt(this.lengthSq()*t.lengthSq());return Math.acos(hn.clamp(e,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return e*e+n*n+r*r},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},setFromSphericalCoords:function(t,e,n){var r=Math.sin(e)*t;return this.x=r*Math.sin(n),this.y=Math.cos(e)*t,this.z=r*Math.cos(n),this},setFromCylindrical:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},setFromCylindricalCoords:function(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this},setFromMatrixPosition:function(t){var e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=r,this},setFromMatrixColumn:function(t,e){return this.fromArray(t.elements,4*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromBufferAttribute:function(t,e,n){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}}),Object.assign(mn.prototype,{isMatrix3:!0,set:function(t,e,n,r,i,o,a,s,u){var l=this.elements;return l[0]=t,l[1]=r,l[2]=a,l[3]=e,l[4]=i,l[5]=s,l[6]=n,l[7]=o,l[8]=u,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this},setFromMatrix4:function(t){var e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},applyToBufferAttribute:function(t){void 0===a&&(a=new dn);for(var e=0,n=t.count;e<n;e++)a.x=t.getX(e),a.y=t.getY(e),a.z=t.getZ(e),a.applyMatrix3(this),t.setXYZ(e,a.x,a.y,a.z);return t},multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,r=e.elements,i=this.elements,o=n[0],a=n[3],s=n[6],u=n[1],l=n[4],c=n[7],h=n[2],p=n[5],f=n[8],d=r[0],m=r[3],g=r[6],v=r[1],y=r[4],x=r[7],_=r[2],b=r[5],w=r[8];return i[0]=o*d+a*v+s*_,i[3]=o*m+a*y+s*b,i[6]=o*g+a*x+s*w,i[1]=u*d+l*v+c*_,i[4]=u*m+l*y+c*b,i[7]=u*g+l*x+c*w,i[2]=h*d+p*v+f*_,i[5]=h*m+p*y+f*b,i[8]=h*g+p*x+f*w,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],l=t[8];return e*o*l-e*a*u-n*i*l+n*a*s+r*i*u-r*o*s},getInverse:function(t,e){t&&t.isMatrix4;var n=t.elements,r=this.elements,i=n[0],o=n[1],a=n[2],s=n[3],u=n[4],l=n[5],c=n[6],h=n[7],p=n[8],f=p*u-l*h,d=l*c-p*s,m=h*s-u*c,g=i*f+o*d+a*m;if(0===g){if(!0===e)throw new Error("THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0");return this.identity()}var v=1/g;return r[0]=f*v,r[1]=(a*h-p*o)*v,r[2]=(l*o-a*u)*v,r[3]=d*v,r[4]=(p*i-a*c)*v,r[5]=(a*s-l*i)*v,r[6]=m*v,r[7]=(o*c-h*i)*v,r[8]=(u*i-o*s)*v,this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},setUvTransform:function(t,e,n,r,i,o,a){var s=Math.cos(i),u=Math.sin(i);this.set(n*s,n*u,-n*(s*o+u*a)+o+t,-r*u,r*s,-r*(-u*o+s*a)+a+e,0,0,1)},scale:function(t,e){var n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this},rotate:function(t){var e=Math.cos(t),n=Math.sin(t),r=this.elements,i=r[0],o=r[3],a=r[6],s=r[1],u=r[4],l=r[7];return r[0]=e*i+n*s,r[3]=e*o+n*u,r[6]=e*a+n*l,r[1]=-n*i+e*s,r[4]=-n*o+e*u,r[7]=-n*a+e*l,this},translate:function(t,e){var n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this},equals:function(t){for(var e=this.elements,n=t.elements,r=0;r<9;r++)if(e[r]!==n[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<9;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}});var gn,vn,yn,xn,_n,bn,wn,Mn,Sn,Tn={getDataURL:function(t){var e;if("undefined"==typeof HTMLCanvasElement)return t.src;if(t instanceof HTMLCanvasElement)e=t;else{void 0===s&&(s=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),s.width=t.width,s.height=t.height;var n=s.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=s}return e.width>2048||e.height>2048?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}},En=0;function An(t,e,n,r,i,o,a,s,u,l){Object.defineProperty(this,"id",{value:En++}),this.uuid=hn.generateUUID(),this.name="",this.image=void 0!==t?t:An.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:An.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:wt,this.wrapT=void 0!==r?r:wt,this.magFilter=void 0!==i?i:Ct,this.minFilter=void 0!==o?o:Ot,this.anisotropy=void 0!==u?u:1,this.format=void 0!==a?a:qt,this.type=void 0!==s?s:Rt,this.offset=new pn(0,0),this.repeat=new pn(1,1),this.center=new pn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new mn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==l?l:ke,this.version=0,this.onUpdate=null}function Pn(t,e,n,r){this.x=t||0,this.y=e||0,this.z=n||0,this.w=void 0!==r?r:1}function Cn(t,e,n){this.width=t,this.height=e,this.scissor=new Pn(0,0,t,e),this.scissorTest=!1,this.viewport=new Pn(0,0,t,e),n=n||{},this.texture=new An(void 0,void 0,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.image={},this.texture.image.width=t,this.texture.image.height=e,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:Ct,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}function Ln(t,e,n){Cn.call(this,t,e,n),this.samples=4}function In(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function On(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._order=r||On.DefaultOrder}function Nn(){this.mask=1}An.DEFAULT_IMAGE=void 0,An.DEFAULT_MAPPING=ft,An.prototype=Object.assign(Object.create(r.prototype),{constructor:An,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){var e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var r=this.image;if(void 0===r.uuid&&(r.uuid=hn.generateUUID()),!e&&void 0===t.images[r.uuid]){var i;if(Array.isArray(r)){i=[];for(var o=0,a=r.length;o<a;o++)i.push(Tn.getDataURL(r[o]))}else i=Tn.getDataURL(r);t.images[r.uuid]={uuid:r.uuid,url:i}}n.image=r.uuid}return e||(t.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(this.mapping!==ft)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case bt:t.x=t.x-Math.floor(t.x);break;case wt:t.x=t.x<0?0:1;break;case Mt:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case bt:t.y=t.y-Math.floor(t.y);break;case wt:t.y=t.y<0?0:1;break;case Mt:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}}),Object.defineProperty(An.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.defineProperties(Pn.prototype,{width:{get:function(){return this.z},set:function(t){this.z=t}},height:{get:function(){return this.w},set:function(t){this.w=t}}}),Object.assign(Pn.prototype,{isVector4:!0,set:function(t,e,n,r){return this.x=t,this.y=e,this.z=n,this.w=r,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var e=this.x,n=this.y,r=this.z,i=this.w,o=t.elements;return this.x=o[0]*e+o[4]*n+o[8]*r+o[12]*i,this.y=o[1]*e+o[5]*n+o[9]*r+o[13]*i,this.z=o[2]*e+o[6]*n+o[10]*r+o[14]*i,this.w=o[3]*e+o[7]*n+o[11]*r+o[15]*i,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,n,r,i,o=.01,a=.1,s=t.elements,u=s[0],l=s[4],c=s[8],h=s[1],p=s[5],f=s[9],d=s[2],m=s[6],g=s[10];if(Math.abs(l-h)<o&&Math.abs(c-d)<o&&Math.abs(f-m)<o){if(Math.abs(l+h)<a&&Math.abs(c+d)<a&&Math.abs(f+m)<a&&Math.abs(u+p+g-3)<a)return this.set(1,0,0,0),this;e=Math.PI;var v=(u+1)/2,y=(p+1)/2,x=(g+1)/2,_=(l+h)/4,b=(c+d)/4,w=(f+m)/4;return v>y&&v>x?v<o?(n=0,r=.707106781,i=.707106781):(r=_/(n=Math.sqrt(v)),i=b/n):y>x?y<o?(n=.707106781,r=0,i=.707106781):(n=_/(r=Math.sqrt(y)),i=w/r):x<o?(n=.707106781,r=.707106781,i=0):(n=b/(i=Math.sqrt(x)),r=w/i),this.set(n,r,i,e),this}var M=Math.sqrt((m-f)*(m-f)+(c-d)*(c-d)+(h-l)*(h-l));return Math.abs(M)<.001&&(M=1),this.x=(m-f)/M,this.y=(c-d)/M,this.z=(h-l)/M,this.w=Math.acos((u+p+g-1)/2),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromBufferAttribute:function(t,e,n){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}}),Cn.prototype=Object.assign(Object.create(r.prototype),{constructor:Cn,isWebGLRenderTarget:!0,setSize:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.texture.image.width=t,this.texture.image.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Ln.prototype=Object.assign(Object.create(Cn.prototype),{constructor:Ln,isWebGLMultisampleRenderTarget:!0,copy:function(t){return Cn.prototype.copy.call(this,t),this.samples=t.samples,this}}),Object.assign(In.prototype,{isMatrix4:!0,set:function(t,e,n,r,i,o,a,s,u,l,c,h,p,f,d,m){var g=this.elements;return g[0]=t,g[4]=e,g[8]=n,g[12]=r,g[1]=i,g[5]=o,g[9]=a,g[13]=s,g[2]=u,g[6]=l,g[10]=c,g[14]=h,g[3]=p,g[7]=f,g[11]=d,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new In).fromArray(this.elements)},copy:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this},copyPosition:function(t){var e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this},extractBasis:function(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this},extractRotation:function(){var t=new dn;return function(e){var n=this.elements,r=e.elements,i=1/t.setFromMatrixColumn(e,0).length(),o=1/t.setFromMatrixColumn(e,1).length(),a=1/t.setFromMatrixColumn(e,2).length();return n[0]=r[0]*i,n[1]=r[1]*i,n[2]=r[2]*i,n[3]=0,n[4]=r[4]*o,n[5]=r[5]*o,n[6]=r[6]*o,n[7]=0,n[8]=r[8]*a,n[9]=r[9]*a,n[10]=r[10]*a,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}}(),makeRotationFromEuler:function(t){!t||t.isEuler;var e=this.elements,n=t.x,r=t.y,i=t.z,o=Math.cos(n),a=Math.sin(n),s=Math.cos(r),u=Math.sin(r),l=Math.cos(i),c=Math.sin(i);if("XYZ"===t.order){var h=o*l,p=o*c,f=a*l,d=a*c;e[0]=s*l,e[4]=-s*c,e[8]=u,e[1]=p+f*u,e[5]=h-d*u,e[9]=-a*s,e[2]=d-h*u,e[6]=f+p*u,e[10]=o*s}else if("YXZ"===t.order){var m=s*l,g=s*c,v=u*l,y=u*c;e[0]=m+y*a,e[4]=v*a-g,e[8]=o*u,e[1]=o*c,e[5]=o*l,e[9]=-a,e[2]=g*a-v,e[6]=y+m*a,e[10]=o*s}else if("ZXY"===t.order){m=s*l,g=s*c,v=u*l,y=u*c;e[0]=m-y*a,e[4]=-o*c,e[8]=v+g*a,e[1]=g+v*a,e[5]=o*l,e[9]=y-m*a,e[2]=-o*u,e[6]=a,e[10]=o*s}else if("ZYX"===t.order){h=o*l,p=o*c,f=a*l,d=a*c;e[0]=s*l,e[4]=f*u-p,e[8]=h*u+d,e[1]=s*c,e[5]=d*u+h,e[9]=p*u-f,e[2]=-u,e[6]=a*s,e[10]=o*s}else if("YZX"===t.order){var x=o*s,_=o*u,b=a*s,w=a*u;e[0]=s*l,e[4]=w-x*c,e[8]=b*c+_,e[1]=c,e[5]=o*l,e[9]=-a*l,e[2]=-u*l,e[6]=_*c+b,e[10]=x-w*c}else if("XZY"===t.order){x=o*s,_=o*u,b=a*s,w=a*u;e[0]=s*l,e[4]=-c,e[8]=u*l,e[1]=x*c+w,e[5]=o*l,e[9]=_*c-b,e[2]=b*c-_,e[6]=a*l,e[10]=w*c+x}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:(bn=new dn(0,0,0),wn=new dn(1,1,1),function(t){return this.compose(bn,t,wn)}),lookAt:(yn=new dn,xn=new dn,_n=new dn,function(t,e,n){var r=this.elements;return _n.subVectors(t,e),0===_n.lengthSq()&&(_n.z=1),_n.normalize(),yn.crossVectors(n,_n),0===yn.lengthSq()&&(1===Math.abs(n.z)?_n.x+=1e-4:_n.z+=1e-4,_n.normalize(),yn.crossVectors(n,_n)),yn.normalize(),xn.crossVectors(_n,yn),r[0]=yn.x,r[4]=xn.x,r[8]=_n.x,r[1]=yn.y,r[5]=xn.y,r[9]=_n.y,r[2]=yn.z,r[6]=xn.z,r[10]=_n.z,this}),multiply:function(t,e){return void 0!==e?this.multiplyMatrices(t,e):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,r=e.elements,i=this.elements,o=n[0],a=n[4],s=n[8],u=n[12],l=n[1],c=n[5],h=n[9],p=n[13],f=n[2],d=n[6],m=n[10],g=n[14],v=n[3],y=n[7],x=n[11],_=n[15],b=r[0],w=r[4],M=r[8],S=r[12],T=r[1],E=r[5],A=r[9],P=r[13],C=r[2],L=r[6],I=r[10],O=r[14],N=r[3],R=r[7],D=r[11],k=r[15];return i[0]=o*b+a*T+s*C+u*N,i[4]=o*w+a*E+s*L+u*R,i[8]=o*M+a*A+s*I+u*D,i[12]=o*S+a*P+s*O+u*k,i[1]=l*b+c*T+h*C+p*N,i[5]=l*w+c*E+h*L+p*R,i[9]=l*M+c*A+h*I+p*D,i[13]=l*S+c*P+h*O+p*k,i[2]=f*b+d*T+m*C+g*N,i[6]=f*w+d*E+m*L+g*R,i[10]=f*M+d*A+m*I+g*D,i[14]=f*S+d*P+m*O+g*k,i[3]=v*b+y*T+x*C+_*N,i[7]=v*w+y*E+x*L+_*R,i[11]=v*M+y*A+x*I+_*D,i[15]=v*S+y*P+x*O+_*k,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},applyToBufferAttribute:function(){var t=new dn;return function(e){for(var n=0,r=e.count;n<r;n++)t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.applyMatrix4(this),e.setXYZ(n,t.x,t.y,t.z);return e}}(),determinant:function(){var t=this.elements,e=t[0],n=t[4],r=t[8],i=t[12],o=t[1],a=t[5],s=t[9],u=t[13],l=t[2],c=t[6],h=t[10],p=t[14];return t[3]*(+i*s*c-r*u*c-i*a*h+n*u*h+r*a*p-n*s*p)+t[7]*(+e*s*p-e*u*h+i*o*h-r*o*p+r*u*l-i*s*l)+t[11]*(+e*u*c-e*a*p-i*o*c+n*o*p+i*a*l-n*u*l)+t[15]*(-r*a*l-e*s*c+e*a*h+r*o*c-n*o*h+n*s*l)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(t,e,n){var r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=e,r[14]=n),this},getInverse:function(t,e){var n=this.elements,r=t.elements,i=r[0],o=r[1],a=r[2],s=r[3],u=r[4],l=r[5],c=r[6],h=r[7],p=r[8],f=r[9],d=r[10],m=r[11],g=r[12],v=r[13],y=r[14],x=r[15],_=f*y*h-v*d*h+v*c*m-l*y*m-f*c*x+l*d*x,b=g*d*h-p*y*h-g*c*m+u*y*m+p*c*x-u*d*x,w=p*v*h-g*f*h+g*l*m-u*v*m-p*l*x+u*f*x,M=g*f*c-p*v*c-g*l*d+u*v*d+p*l*y-u*f*y,S=i*_+o*b+a*w+s*M;if(0===S){if(!0===e)throw new Error("THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0");return this.identity()}var T=1/S;return n[0]=_*T,n[1]=(v*d*s-f*y*s-v*a*m+o*y*m+f*a*x-o*d*x)*T,n[2]=(l*y*s-v*c*s+v*a*h-o*y*h-l*a*x+o*c*x)*T,n[3]=(f*c*s-l*d*s-f*a*h+o*d*h+l*a*m-o*c*m)*T,n[4]=b*T,n[5]=(p*y*s-g*d*s+g*a*m-i*y*m-p*a*x+i*d*x)*T,n[6]=(g*c*s-u*y*s-g*a*h+i*y*h+u*a*x-i*c*x)*T,n[7]=(u*d*s-p*c*s+p*a*h-i*d*h-u*a*m+i*c*m)*T,n[8]=w*T,n[9]=(g*f*s-p*v*s-g*o*m+i*v*m+p*o*x-i*f*x)*T,n[10]=(u*v*s-g*l*s+g*o*h-i*v*h-u*o*x+i*l*x)*T,n[11]=(p*l*s-u*f*s-p*o*h+i*f*h+u*o*m-i*l*m)*T,n[12]=M*T,n[13]=(p*v*a-g*f*a+g*o*d-i*v*d-p*o*y+i*f*y)*T,n[14]=(g*l*a-u*v*a-g*o*c+i*v*c+u*o*y-i*l*y)*T,n[15]=(u*f*a-p*l*a+p*o*c-i*f*c-u*o*d+i*l*d)*T,this},scale:function(t){var e=this.elements,n=t.x,r=t.y,i=t.z;return e[0]*=n,e[4]*=r,e[8]*=i,e[1]*=n,e[5]*=r,e[9]*=i,e[2]*=n,e[6]*=r,e[10]*=i,e[3]*=n,e[7]*=r,e[11]*=i,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,r))},makeTranslation:function(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var n=Math.cos(e),r=Math.sin(e),i=1-n,o=t.x,a=t.y,s=t.z,u=i*o,l=i*a;return this.set(u*o+n,u*a-r*s,u*s+r*a,0,u*a+r*s,l*a+n,l*s-r*o,0,u*s-r*a,l*s+r*o,i*s*s+n,0,0,0,0,1),this},makeScale:function(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(t,e,n){return this.set(1,e,n,0,t,1,n,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,n){var r=this.elements,i=e._x,o=e._y,a=e._z,s=e._w,u=i+i,l=o+o,c=a+a,h=i*u,p=i*l,f=i*c,d=o*l,m=o*c,g=a*c,v=s*u,y=s*l,x=s*c,_=n.x,b=n.y,w=n.z;return r[0]=(1-(d+g))*_,r[1]=(p+x)*_,r[2]=(f-y)*_,r[3]=0,r[4]=(p-x)*b,r[5]=(1-(h+g))*b,r[6]=(m+v)*b,r[7]=0,r[8]=(f+y)*w,r[9]=(m-v)*w,r[10]=(1-(h+d))*w,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this},decompose:(gn=new dn,vn=new In,function(t,e,n){var r=this.elements,i=gn.set(r[0],r[1],r[2]).length(),o=gn.set(r[4],r[5],r[6]).length(),a=gn.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),t.x=r[12],t.y=r[13],t.z=r[14],vn.copy(this);var s=1/i,u=1/o,l=1/a;return vn.elements[0]*=s,vn.elements[1]*=s,vn.elements[2]*=s,vn.elements[4]*=u,vn.elements[5]*=u,vn.elements[6]*=u,vn.elements[8]*=l,vn.elements[9]*=l,vn.elements[10]*=l,e.setFromRotationMatrix(vn),n.x=i,n.y=o,n.z=a,this}),makePerspective:function(t,e,n,r,i,o){var a=this.elements,s=2*i/(e-t),u=2*i/(n-r),l=(e+t)/(e-t),c=(n+r)/(n-r),h=-(o+i)/(o-i),p=-2*o*i/(o-i);return a[0]=s,a[4]=0,a[8]=l,a[12]=0,a[1]=0,a[5]=u,a[9]=c,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=p,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(t,e,n,r,i,o){var a=this.elements,s=1/(e-t),u=1/(n-r),l=1/(o-i),c=(e+t)*s,h=(n+r)*u,p=(o+i)*l;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-c,a[1]=0,a[5]=2*u,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*l,a[14]=-p,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(t){for(var e=this.elements,n=t.elements,r=0;r<16;r++)if(e[r]!==n[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<16;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}),On.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],On.DefaultOrder="XYZ",Object.defineProperties(On.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this._onChangeCallback()}}}),Object.assign(On.prototype,{isEuler:!0,set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._order=r||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this},setFromRotationMatrix:function(t,e,n){var r=hn.clamp,i=t.elements,o=i[0],a=i[4],s=i[8],u=i[1],l=i[5],c=i[9],h=i[2],p=i[6],f=i[10];return"XYZ"===(e=e||this._order)?(this._y=Math.asin(r(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(-c,f),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(p,l),this._z=0)):"YXZ"===e?(this._x=Math.asin(-r(c,-1,1)),Math.abs(c)<.99999?(this._y=Math.atan2(s,f),this._z=Math.atan2(u,l)):(this._y=Math.atan2(-h,o),this._z=0)):"ZXY"===e?(this._x=Math.asin(r(p,-1,1)),Math.abs(p)<.99999?(this._y=Math.atan2(-h,f),this._z=Math.atan2(-a,l)):(this._y=0,this._z=Math.atan2(u,o))):"ZYX"===e?(this._y=Math.asin(-r(h,-1,1)),Math.abs(h)<.99999?(this._x=Math.atan2(p,f),this._z=Math.atan2(u,o)):(this._x=0,this._z=Math.atan2(-a,l))):"YZX"===e?(this._z=Math.asin(r(u,-1,1)),Math.abs(u)<.99999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(s,f))):"XZY"===e&&(this._z=Math.asin(-r(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(p,l),this._y=Math.atan2(s,o)):(this._x=Math.atan2(-c,f),this._y=0)),this._order=e,!1!==n&&this._onChangeCallback(),this},setFromQuaternion:function(t,e,n){return void 0===Mn&&(Mn=new In),Mn.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Mn,e,n)},setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:function(t){return void 0===Sn&&(Sn=new fn),Sn.setFromEuler(this),this.setFromQuaternion(Sn,t)},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new dn(this._x,this._y,this._z)},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}}),Object.assign(Nn.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask|=1<<t|0},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},test:function(t){return 0!=(this.mask&t.mask)}});var Rn,Dn,kn,Fn,Bn,Un,zn,Vn,Gn,jn,Wn,Hn,Xn,Yn,qn,Zn,Jn,Kn,Qn,$n,tr=0;function er(){Object.defineProperty(this,"id",{value:tr++}),this.uuid=hn.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=er.DefaultUp.clone();var t=new dn,e=new On,n=new fn,r=new dn(1,1,1);e._onChange((function(){n.setFromEuler(e,!1)})),n._onChange((function(){e.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new In},normalMatrix:{value:new mn}}),this.matrix=new In,this.matrixWorld=new In,this.matrixAutoUpdate=er.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Nn,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function nr(){er.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function rr(t,e){this.min=void 0!==t?t:new dn(1/0,1/0,1/0),this.max=void 0!==e?e:new dn(-1/0,-1/0,-1/0)}function ir(t,e){this.center=void 0!==t?t:new dn,this.radius=void 0!==e?e:0}function or(t,e){this.origin=void 0!==t?t:new dn,this.direction=void 0!==e?e:new dn}function ar(t,e,n){this.a=void 0!==t?t:new dn,this.b=void 0!==e?e:new dn,this.c=void 0!==n?n:new dn}er.DefaultUp=new dn(0,1,0),er.DefaultMatrixAutoUpdate=!0,er.prototype=Object.assign(Object.create(r.prototype),{constructor:er,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:(Bn=new fn,function(t,e){return Bn.setFromAxisAngle(t,e),this.quaternion.multiply(Bn),this}),rotateOnWorldAxis:function(){var t=new fn;return function(e,n){return t.setFromAxisAngle(e,n),this.quaternion.premultiply(t),this}}(),rotateX:function(){var t=new dn(1,0,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateY:function(){var t=new dn(0,1,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateZ:function(){var t=new dn(0,0,1);return function(e){return this.rotateOnAxis(t,e)}}(),translateOnAxis:function(){var t=new dn;return function(e,n){return t.copy(e).applyQuaternion(this.quaternion),this.position.add(t.multiplyScalar(n)),this}}(),translateX:function(){var t=new dn(1,0,0);return function(e){return this.translateOnAxis(t,e)}}(),translateY:function(){var t=new dn(0,1,0);return function(e){return this.translateOnAxis(t,e)}}(),translateZ:function(){var t=new dn(0,0,1);return function(e){return this.translateOnAxis(t,e)}}(),localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:(Fn=new In,function(t){return t.applyMatrix4(Fn.getInverse(this.matrixWorld))}),lookAt:function(){var t=new fn,e=new In,n=new dn,r=new dn;return function(i,o,a){i.isVector3?n.copy(i):n.set(i,o,a);var s=this.parent;this.updateWorldMatrix(!0,!1),r.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?e.lookAt(r,n,this.up):e.lookAt(n,r,this.up),this.quaternion.setFromRotationMatrix(e),s&&(e.extractRotation(s.matrixWorld),t.setFromRotationMatrix(e),this.quaternion.premultiply(t.inverse()))}}(),add:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this||t&&t.isObject3D&&(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent({type:"added"})),this},remove:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}var n=this.children.indexOf(t);return-1!==n&&(t.parent=null,this.children.splice(n,1),t.dispatchEvent({type:"removed"})),this},attach:(kn=new In,function(t){return this.updateWorldMatrix(!0,!1),kn.getInverse(this.matrixWorld),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),kn.multiply(t.parent.matrixWorld)),t.applyMatrix(kn),t.updateWorldMatrix(!1,!1),this.add(t),this}),getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n].getObjectByProperty(t,e);if(void 0!==i)return i}},getWorldPosition:function(t){return void 0===t&&(t=new dn),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:(Rn=new dn,Dn=new dn,function(t){return void 0===t&&(t=new fn),this.updateMatrixWorld(!0),this.matrixWorld.decompose(Rn,t,Dn),t}),getWorldScale:function(){var t=new dn,e=new fn;return function(n){return void 0===n&&(n=new dn),this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,e,n),n}}(),getWorldDirection:function(t){void 0===t&&(t=new dn),this.updateMatrixWorld(!0);var e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()},raycast:function(){},traverse:function(t){t(this);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].updateMatrixWorld(t)},updateWorldMatrix:function(t,e){var n=this.parent;if(!0===t&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e)for(var r=this.children,i=0,o=r.length;i<o;i++)r[i].updateWorldMatrix(!1,!0)},toJSON:function(t){var e=void 0===t||"string"==typeof t,n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};function i(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isMesh&&this.drawMode!==Ne&&(r.drawMode=this.drawMode),this.isMesh||this.isLine||this.isPoints){r.geometry=i(t.geometries,this.geometry);var o=this.geometry.parameters;if(void 0!==o&&void 0!==o.shapes){var a=o.shapes;if(Array.isArray(a))for(var s=0,u=a.length;s<u;s++){var l=a[s];i(t.shapes,l)}else i(t.shapes,a)}}if(void 0!==this.material)if(Array.isArray(this.material)){var c=[];for(s=0,u=this.material.length;s<u;s++)c.push(i(t.materials,this.material[s]));r.material=c}else r.material=i(t.materials,this.material);if(this.children.length>0){r.children=[];for(s=0;s<this.children.length;s++)r.children.push(this.children[s].toJSON(t).object)}if(e){var h=m(t.geometries),p=m(t.materials),f=m(t.textures),d=m(t.images);a=m(t.shapes);h.length>0&&(n.geometries=h),p.length>0&&(n.materials=p),f.length>0&&(n.textures=f),d.length>0&&(n.images=d),a.length>0&&(n.shapes=a)}return n.object=r,n;function m(t){var e=[];for(var n in t){var r=t[n];delete r.metadata,e.push(r)}return e}},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(var n=0;n<t.children.length;n++){var r=t.children[n];this.add(r.clone())}return this}}),nr.prototype=Object.assign(Object.create(er.prototype),{constructor:nr,isScene:!0,copy:function(t,e){return er.prototype.copy.call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},toJSON:function(t){var e=er.prototype.toJSON.call(this,t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.assign(rr.prototype,{isBox3:!0,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){for(var e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,u=t.length;s<u;s+=3){var l=t[s],c=t[s+1],h=t[s+2];l<e&&(e=l),c<n&&(n=c),h<r&&(r=h),l>i&&(i=l),c>o&&(o=c),h>a&&(a=h)}return this.min.set(e,n,r),this.max.set(i,o,a),this},setFromBufferAttribute:function(t){for(var e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,u=t.count;s<u;s++){var l=t.getX(s),c=t.getY(s),h=t.getZ(s);l<e&&(e=l),c<n&&(n=c),h<r&&(r=h),l>i&&(i=l),c>o&&(o=c),h>a&&(a=h)}return this.min.set(e,n,r),this.max.set(i,o,a),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new dn;return function(e,n){var r=t.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}}(),setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return void 0===t&&(t=new dn),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(t=new dn),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(){var t,e,n,r=new dn;function i(i){var o=i.geometry;if(void 0!==o)if(o.isGeometry){var a=o.vertices;for(e=0,n=a.length;e<n;e++)r.copy(a[e]),r.applyMatrix4(i.matrixWorld),t.expandByPoint(r)}else if(o.isBufferGeometry){var s=o.attributes.position;if(void 0!==s)for(e=0,n=s.count;e<n;e++)r.fromBufferAttribute(s,e).applyMatrix4(i.matrixWorld),t.expandByPoint(r)}}return function(e){return t=this,e.updateMatrixWorld(!0),e.traverse(i),this}}(),containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){return void 0===e&&(e=new dn),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:(zn=new dn,function(t){return this.clampPoint(t.center,zn),zn.distanceToSquared(t.center)<=t.radius*t.radius}),intersectsPlane:function(t){var e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant},intersectsTriangle:function(){var t=new dn,e=new dn,n=new dn,r=new dn,i=new dn,o=new dn,a=new dn,s=new dn,u=new dn,l=new dn;function c(r){var i,o;for(i=0,o=r.length-3;i<=o;i+=3){a.fromArray(r,i);var s=u.x*Math.abs(a.x)+u.y*Math.abs(a.y)+u.z*Math.abs(a.z),l=t.dot(a),c=e.dot(a),h=n.dot(a);if(Math.max(-Math.max(l,c,h),Math.min(l,c,h))>s)return!1}return!0}return function(a){if(this.isEmpty())return!1;this.getCenter(s),u.subVectors(this.max,s),t.subVectors(a.a,s),e.subVectors(a.b,s),n.subVectors(a.c,s),r.subVectors(e,t),i.subVectors(n,e),o.subVectors(t,n);var h=[0,-r.z,r.y,0,-i.z,i.y,0,-o.z,o.y,r.z,0,-r.x,i.z,0,-i.x,o.z,0,-o.x,-r.y,r.x,0,-i.y,i.x,0,-o.y,o.x,0];return!!c(h)&&(!!c(h=[1,0,0,0,1,0,0,0,1])&&(l.crossVectors(r,i),c(h=[l.x,l.y,l.z])))}}(),clampPoint:function(t,e){return void 0===e&&(e=new dn),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new dn;return function(e){return t.copy(e).clamp(this.min,this.max).sub(e).length()}}(),getBoundingSphere:function(){var t=new dn;return function(e){return this.getCenter(e.center),e.radius=.5*this.getSize(t).length(),e}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:(Un=[new dn,new dn,new dn,new dn,new dn,new dn,new dn,new dn],function(t){return this.isEmpty()||(Un[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),Un[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),Un[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),Un[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),Un[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),Un[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),Un[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),Un[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(Un)),this}),translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}),Object.assign(ir.prototype,{set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(t,e){void 0===Vn&&(Vn=new rr);var n=this.center;void 0!==e?n.copy(e):Vn.setFromPoints(t).getCenter(n);for(var r=0,i=0,o=t.length;i<o;i++)r=Math.max(r,n.distanceToSquared(t[i]));return this.radius=Math.sqrt(r),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,e){var n=this.center.distanceToSquared(t);return void 0===e&&(e=new dn),e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e},getBoundingBox:function(t){return void 0===t&&(t=new rr),t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}}),Object.assign(or.prototype,{set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){return void 0===e&&(e=new dn),e.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(){var t=new dn;return function(e){return this.origin.copy(this.at(e,t)),this}}(),closestPointToPoint:function(t,e){void 0===e&&(e=new dn),e.subVectors(t,this.origin);var n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(){var t=new dn;return function(e){var n=t.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(t.copy(this.direction).multiplyScalar(n).add(this.origin),t.distanceToSquared(e))}}(),distanceSqToSegment:(jn=new dn,Wn=new dn,Hn=new dn,function(t,e,n,r){jn.copy(t).add(e).multiplyScalar(.5),Wn.copy(e).sub(t).normalize(),Hn.copy(this.origin).sub(jn);var i,o,a,s,u=.5*t.distanceTo(e),l=-this.direction.dot(Wn),c=Hn.dot(this.direction),h=-Hn.dot(Wn),p=Hn.lengthSq(),f=Math.abs(1-l*l);if(f>0)if(o=l*c-h,s=u*f,(i=l*h-c)>=0)if(o>=-s)if(o<=s){var d=1/f;a=(i*=d)*(i+l*(o*=d)+2*c)+o*(l*i+o+2*h)+p}else o=u,a=-(i=Math.max(0,-(l*o+c)))*i+o*(o+2*h)+p;else o=-u,a=-(i=Math.max(0,-(l*o+c)))*i+o*(o+2*h)+p;else o<=-s?a=-(i=Math.max(0,-(-l*u+c)))*i+(o=i>0?-u:Math.min(Math.max(-u,-h),u))*(o+2*h)+p:o<=s?(i=0,a=(o=Math.min(Math.max(-u,-h),u))*(o+2*h)+p):a=-(i=Math.max(0,-(l*u+c)))*i+(o=i>0?u:Math.min(Math.max(-u,-h),u))*(o+2*h)+p;else o=l>0?-u:u,a=-(i=Math.max(0,-(l*o+c)))*i+o*(o+2*h)+p;return n&&n.copy(this.direction).multiplyScalar(i).add(this.origin),r&&r.copy(Wn).multiplyScalar(o).add(jn),a}),intersectSphere:function(){var t=new dn;return function(e,n){t.subVectors(e.center,this.origin);var r=t.dot(this.direction),i=t.dot(t)-r*r,o=e.radius*e.radius;if(i>o)return null;var a=Math.sqrt(o-i),s=r-a,u=r+a;return s<0&&u<0?null:s<0?this.at(u,n):this.at(s,n)}}(),intersectsSphere:function(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius},distanceToPlane:function(t){var e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null},intersectPlane:function(t,e){var n=this.distanceToPlane(t);return null===n?null:this.at(n,e)},intersectsPlane:function(t){var e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0},intersectBox:function(t,e){var n,r,i,o,a,s,u=1/this.direction.x,l=1/this.direction.y,c=1/this.direction.z,h=this.origin;return u>=0?(n=(t.min.x-h.x)*u,r=(t.max.x-h.x)*u):(n=(t.max.x-h.x)*u,r=(t.min.x-h.x)*u),l>=0?(i=(t.min.y-h.y)*l,o=(t.max.y-h.y)*l):(i=(t.max.y-h.y)*l,o=(t.min.y-h.y)*l),n>o||i>r?null:((i>n||n!=n)&&(n=i),(o<r||r!=r)&&(r=o),c>=0?(a=(t.min.z-h.z)*c,s=(t.max.z-h.z)*c):(a=(t.max.z-h.z)*c,s=(t.min.z-h.z)*c),n>s||a>r?null:((a>n||n!=n)&&(n=a),(s<r||r!=r)&&(r=s),r<0?null:this.at(n>=0?n:r,e)))},intersectsBox:(Gn=new dn,function(t){return null!==this.intersectBox(t,Gn)}),intersectTriangle:function(){var t=new dn,e=new dn,n=new dn,r=new dn;return function(i,o,a,s,u){e.subVectors(o,i),n.subVectors(a,i),r.crossVectors(e,n);var l,c=this.direction.dot(r);if(c>0){if(s)return null;l=1}else{if(!(c<0))return null;l=-1,c=-c}t.subVectors(this.origin,i);var h=l*this.direction.dot(n.crossVectors(t,n));if(h<0)return null;var p=l*this.direction.dot(e.cross(t));if(p<0)return null;if(h+p>c)return null;var f=-l*t.dot(r);return f<0?null:this.at(f/c,u)}}(),applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}}),Object.assign(ar,{getNormal:(Yn=new dn,function(t,e,n,r){void 0===r&&(r=new dn),r.subVectors(n,e),Yn.subVectors(t,e),r.cross(Yn);var i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}),getBarycoord:function(){var t=new dn,e=new dn,n=new dn;return function(r,i,o,a,s){t.subVectors(a,i),e.subVectors(o,i),n.subVectors(r,i);var u=t.dot(t),l=t.dot(e),c=t.dot(n),h=e.dot(e),p=e.dot(n),f=u*h-l*l;if(void 0===s&&(s=new dn),0===f)return s.set(-2,-1,-1);var d=1/f,m=(h*c-l*p)*d,g=(u*p-l*c)*d;return s.set(1-m-g,g,m)}}(),containsPoint:function(){var t=new dn;return function(e,n,r,i){return ar.getBarycoord(e,n,r,i,t),t.x>=0&&t.y>=0&&t.x+t.y<=1}}(),getUV:(Xn=new dn,function(t,e,n,r,i,o,a,s){return this.getBarycoord(t,e,n,r,Xn),s.set(0,0),s.addScaledVector(i,Xn.x),s.addScaledVector(o,Xn.y),s.addScaledVector(a,Xn.z),s}),isFrontFacing:function(){var t=new dn,e=new dn;return function(n,r,i,o){return t.subVectors(i,r),e.subVectors(n,r),t.cross(e).dot(o)<0}}()}),Object.assign(ar.prototype,{set:function(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this},setFromPointsAndIndices:function(t,e,n,r){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[r]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},getArea:function(){var t=new dn,e=new dn;return function(){return t.subVectors(this.c,this.b),e.subVectors(this.a,this.b),.5*t.cross(e).length()}}(),getMidpoint:function(t){return void 0===t&&(t=new dn),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(t){return ar.getNormal(this.a,this.b,this.c,t)},getPlane:function(t){return void 0===t&&(t=new dn),t.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(t,e){return ar.getBarycoord(t,this.a,this.b,this.c,e)},getUV:function(t,e,n,r,i){return ar.getUV(t,this.a,this.b,this.c,e,n,r,i)},containsPoint:function(t){return ar.containsPoint(t,this.a,this.b,this.c)},isFrontFacing:function(t){return ar.isFrontFacing(this.a,this.b,this.c,t)},intersectsBox:function(t){return t.intersectsTriangle(this)},closestPointToPoint:(qn=new dn,Zn=new dn,Jn=new dn,Kn=new dn,Qn=new dn,$n=new dn,function(t,e){void 0===e&&(e=new dn);var n,r,i=this.a,o=this.b,a=this.c;qn.subVectors(o,i),Zn.subVectors(a,i),Kn.subVectors(t,i);var s=qn.dot(Kn),u=Zn.dot(Kn);if(s<=0&&u<=0)return e.copy(i);Qn.subVectors(t,o);var l=qn.dot(Qn),c=Zn.dot(Qn);if(l>=0&&c<=l)return e.copy(o);var h=s*c-l*u;if(h<=0&&s>=0&&l<=0)return n=s/(s-l),e.copy(i).addScaledVector(qn,n);$n.subVectors(t,a);var p=qn.dot($n),f=Zn.dot($n);if(f>=0&&p<=f)return e.copy(a);var d=p*u-s*f;if(d<=0&&u>=0&&f<=0)return r=u/(u-f),e.copy(i).addScaledVector(Zn,r);var m=l*f-p*c;if(m<=0&&c-l>=0&&p-f>=0)return Jn.subVectors(a,o),r=(c-l)/(c-l+(p-f)),e.copy(o).addScaledVector(Jn,r);var g=1/(m+d+h);return n=d*g,r=h*g,e.copy(i).addScaledVector(qn,n).addScaledVector(Zn,r)}),equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}});var sr,ur,lr,cr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function hr(t,e,n){return void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}function pr(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}function fr(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function dr(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}function mr(t,e,n,r,i,o){this.a=t,this.b=e,this.c=n,this.normal=r&&r.isVector3?r:new dn,this.vertexNormals=Array.isArray(r)?r:[],this.color=i&&i.isColor?i:new hr,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=void 0!==o?o:0}Object.assign(hr.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.r=t,this.g=t,this.b=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,n){return this.r=t,this.g=e,this.b=n,this},setHSL:function(t,e,n){if(t=hn.euclideanModulo(t,1),e=hn.clamp(e,0,1),n=hn.clamp(n,0,1),0===e)this.r=this.g=this.b=n;else{var r=n<=.5?n*(1+e):n+e-n*e,i=2*n-r;this.r=pr(i,r,t+1/3),this.g=pr(i,r,t),this.b=pr(i,r,t-1/3)}return this},setStyle:function(t){function e(t){void 0!==t&&parseFloat(t)}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var r,i=n[1],o=n[2];switch(i){case"rgb":case"rgba":if(r=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,e(r[5]),this;if(r=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,e(r[5]),this;break;case"hsl":case"hsla":if(r=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o)){var a=parseFloat(r[1])/360,s=parseInt(r[2],10)/100,u=parseInt(r[3],10)/100;return e(r[5]),this.setHSL(a,s,u)}}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(t)){var l,c=(l=n[1]).length;if(3===c)return this.r=parseInt(l.charAt(0)+l.charAt(0),16)/255,this.g=parseInt(l.charAt(1)+l.charAt(1),16)/255,this.b=parseInt(l.charAt(2)+l.charAt(2),16)/255,this;if(6===c)return this.r=parseInt(l.charAt(0)+l.charAt(1),16)/255,this.g=parseInt(l.charAt(2)+l.charAt(3),16)/255,this.b=parseInt(l.charAt(4)+l.charAt(5),16)/255,this}t&&t.length>0&&(void 0!==(l=cr[t])&&this.setHex(l));return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){void 0===e&&(e=2);var n=e>0?1/e:1;return this.r=Math.pow(t.r,n),this.g=Math.pow(t.g,n),this.b=Math.pow(t.b,n),this},convertGammaToLinear:function(t){return this.copyGammaToLinear(this,t),this},convertLinearToGamma:function(t){return this.copyLinearToGamma(this,t),this},copySRGBToLinear:function(t){return this.r=fr(t.r),this.g=fr(t.g),this.b=fr(t.b),this},copyLinearToSRGB:function(t){return this.r=dr(t.r),this.g=dr(t.g),this.b=dr(t.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){void 0===t&&(t={h:0,s:0,l:0});var e,n,r=this.r,i=this.g,o=this.b,a=Math.max(r,i,o),s=Math.min(r,i,o),u=(s+a)/2;if(s===a)e=0,n=0;else{var l=a-s;switch(n=u<=.5?l/(a+s):l/(2-a-s),a){case r:e=(i-o)/l+(i<o?6:0);break;case i:e=(o-r)/l+2;break;case o:e=(r-i)/l+4}e/=6}return t.h=e,t.s=n,t.l=u,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:(lr={},function(t,e,n){return this.getHSL(lr),lr.h+=t,lr.s+=e,lr.l+=n,this.setHSL(lr.h,lr.s,lr.l),this}),add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},lerpHSL:(sr={h:0,s:0,l:0},ur={h:0,s:0,l:0},function(t,e){this.getHSL(sr),t.getHSL(ur);var n=hn.lerp(sr.h,ur.h,e),r=hn.lerp(sr.s,ur.s,e),i=hn.lerp(sr.l,ur.l,e);return this.setHSL(n,r,i),this}),equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},toJSON:function(){return this.getHex()}}),Object.assign(mr.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,n=t.vertexNormals.length;e<n;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(e=0,n=t.vertexColors.length;e<n;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}});var gr=0;function vr(){Object.defineProperty(this,"id",{value:gr++}),this.uuid=hn.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=C,this.side=_,this.flatShading=!1,this.vertexTangents=!1,this.vertexColors=T,this.opacity=1,this.transparent=!1,this.blendSrc=j,this.blendDst=W,this.blendEquation=R,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=$,this.depthTest=!0,this.depthWrite=!0,this.stencilFunc=cn,this.stencilRef=0,this.stencilMask=255,this.stencilFail=Ze,this.stencilZFail=Ze,this.stencilZPass=Ze,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.userData={},this.needsUpdate=!0}function yr(t){vr.call(this),this.type="MeshBasicMaterial",this.color=new hr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=it,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(t)}function xr(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===n,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function _r(t,e,n){xr.call(this,new Int8Array(t),e,n)}function br(t,e,n){xr.call(this,new Uint8Array(t),e,n)}function wr(t,e,n){xr.call(this,new Uint8ClampedArray(t),e,n)}function Mr(t,e,n){xr.call(this,new Int16Array(t),e,n)}function Sr(t,e,n){xr.call(this,new Uint16Array(t),e,n)}function Tr(t,e,n){xr.call(this,new Int32Array(t),e,n)}function Er(t,e,n){xr.call(this,new Uint32Array(t),e,n)}function Ar(t,e,n){xr.call(this,new Float32Array(t),e,n)}function Pr(t,e,n){xr.call(this,new Float64Array(t),e,n)}function Cr(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function Lr(t){if(0===t.length)return-1/0;for(var e=t[0],n=1,r=t.length;n<r;++n)t[n]>e&&(e=t[n]);return e}vr.prototype=Object.assign(Object.create(r.prototype),{constructor:vr,isMaterial:!0,onBeforeCompile:function(){},setValues:function(t){if(void 0!==t)for(var e in t){var n=t[e];if(void 0!==n)if("shading"!==e){var r=this[e];void 0!==r&&(r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[e]=n)}else this.flatShading=n===M}},toJSON:function(t){var e=void 0===t||"string"==typeof t;e&&(t={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(t){var e=[];for(var n in t){var r=t[n];delete r.metadata,e.push(r)}return e}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearCoat&&(n.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(n.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,n.reflectivity=this.reflectivity,n.refractionRatio=this.refractionRatio,void 0!==this.combine&&(n.combine=this.combine),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==C&&(n.blending=this.blending),!0===this.flatShading&&(n.flatShading=this.flatShading),this.side!==_&&(n.side=this.side),this.vertexColors!==T&&(n.vertexColors=this.vertexColors),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.stencilWrite=this.stencilWrite,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilMask=this.stencilMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.morphNormals&&(n.morphNormals=!0),!0===this.skinning&&(n.skinning=!0),!1===this.visible&&(n.visible=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),e){var i=r(t.textures),o=r(t.images);i.length>0&&(n.textures=i),o.length>0&&(n.images=o)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.lights=t.lights,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWrite=t.stencilWrite,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilMask=t.stencilMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.userData=JSON.parse(JSON.stringify(t.userData)),this.clipShadows=t.clipShadows,this.clipIntersection=t.clipIntersection;var e=t.clippingPlanes,n=null;if(null!==e){var r=e.length;n=new Array(r);for(var i=0;i!==r;++i)n[i]=e[i].clone()}return this.clippingPlanes=n,this.shadowSide=t.shadowSide,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),yr.prototype=Object.create(vr.prototype),yr.prototype.constructor=yr,yr.prototype.isMeshBasicMaterial=!0,yr.prototype.copy=function(t){return vr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this},Object.defineProperty(xr.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(xr.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setArray:function(t){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");return this.count=void 0!==t?t.length/this.itemSize:0,this.array=t,this},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.dynamic=t.dynamic,this},copyAt:function(t,e,n){t*=this.itemSize,n*=e.itemSize;for(var r=0,i=this.itemSize;r<i;r++)this.array[t+r]=e.array[n+r];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(o=new hr),e[n++]=o.r,e[n++]=o.g,e[n++]=o.b}return this},copyVector2sArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(o=new pn),e[n++]=o.x,e[n++]=o.y}return this},copyVector3sArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(o=new dn),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z}return this},copyVector4sArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(o=new Pn),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z,e[n++]=o.w}return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this},setXYZ:function(t,e,n,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this},setXYZW:function(t,e,n,r,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this.array[t+3]=i,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),_r.prototype=Object.create(xr.prototype),_r.prototype.constructor=_r,br.prototype=Object.create(xr.prototype),br.prototype.constructor=br,wr.prototype=Object.create(xr.prototype),wr.prototype.constructor=wr,Mr.prototype=Object.create(xr.prototype),Mr.prototype.constructor=Mr,Sr.prototype=Object.create(xr.prototype),Sr.prototype.constructor=Sr,Tr.prototype=Object.create(xr.prototype),Tr.prototype.constructor=Tr,Er.prototype=Object.create(xr.prototype),Er.prototype.constructor=Er,Ar.prototype=Object.create(xr.prototype),Ar.prototype.constructor=Ar,Pr.prototype=Object.create(xr.prototype),Pr.prototype.constructor=Pr,Object.assign(Cr.prototype,{computeGroups:function(t){for(var e,n=[],r=void 0,i=t.faces,o=0;o<i.length;o++){var a=i[o];a.materialIndex!==r&&(r=a.materialIndex,void 0!==e&&(e.count=3*o-e.start,n.push(e)),e={start:3*o,materialIndex:r})}void 0!==e&&(e.count=3*o-e.start,n.push(e)),this.groups=n},fromGeometry:function(t){var e,n=t.faces,r=t.vertices,i=t.faceVertexUvs,o=i[0]&&i[0].length>0,a=i[1]&&i[1].length>0,s=t.morphTargets,u=s.length;if(u>0){e=[];for(var l=0;l<u;l++)e[l]={name:s[l].name,data:[]};this.morphTargets.position=e}var c,h=t.morphNormals,p=h.length;if(p>0){c=[];for(l=0;l<p;l++)c[l]={name:h[l].name,data:[]};this.morphTargets.normal=c}var f=t.skinIndices,d=t.skinWeights,m=f.length===r.length,g=d.length===r.length;r.length>0&&n.length;for(l=0;l<n.length;l++){var v=n[l];this.vertices.push(r[v.a],r[v.b],r[v.c]);var y=v.vertexNormals;if(3===y.length)this.normals.push(y[0],y[1],y[2]);else{var x=v.normal;this.normals.push(x,x,x)}var _,b=v.vertexColors;if(3===b.length)this.colors.push(b[0],b[1],b[2]);else{var w=v.color;this.colors.push(w,w,w)}if(!0===o)void 0!==(_=i[0][l])?this.uvs.push(_[0],_[1],_[2]):this.uvs.push(new pn,new pn,new pn);if(!0===a)void 0!==(_=i[1][l])?this.uvs2.push(_[0],_[1],_[2]):this.uvs2.push(new pn,new pn,new pn);for(var M=0;M<u;M++){var S=s[M].vertices;e[M].data.push(S[v.a],S[v.b],S[v.c])}for(M=0;M<p;M++){var T=h[M].vertexNormals[l];c[M].data.push(T.a,T.b,T.c)}m&&this.skinIndices.push(f[v.a],f[v.b],f[v.c]),g&&this.skinWeights.push(d[v.a],d[v.b],d[v.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this}});var Ir,Or,Nr,Rr=1;function Dr(){Object.defineProperty(this,"id",{value:Rr+=2}),this.uuid=hn.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}function kr(t,e){er.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new Dr,this.material=void 0!==e?e:new yr({color:16777215*Math.random()}),this.drawMode=Ne,this.updateMorphTargets()}Dr.prototype=Object.assign(Object.create(r.prototype),{constructor:Dr,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){Array.isArray(t)?this.index=new(Lr(t)>65535?Er:Sr)(t,1):this.index=t},addAttribute:function(t,e){return e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===t?(this.setIndex(e),this):(this.attributes[t]=e,this):this.addAttribute(t,new xr(arguments[1],arguments[2]))},getAttribute:function(t){return this.attributes[t]},removeAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,n){this.groups.push({start:t,count:e,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix:function(t){var e=this.attributes.position;void 0!==e&&(t.applyToBufferAttribute(e),e.needsUpdate=!0);var n=this.attributes.normal;void 0!==n&&((new mn).getNormalMatrix(t).applyToBufferAttribute(n),n.needsUpdate=!0);var r=this.attributes.tangent;void 0!==r&&((new mn).getNormalMatrix(t).applyToBufferAttribute(r),r.needsUpdate=!0);return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var t=new In;return function(e){return t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t=new In;return function(e){return t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t=new In;return function(e){return t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t=new In;return function(e,n,r){return t.makeTranslation(e,n,r),this.applyMatrix(t),this}}(),scale:function(){var t=new In;return function(e,n,r){return t.makeScale(e,n,r),this.applyMatrix(t),this}}(),lookAt:(Nr=new er,function(t){Nr.lookAt(t),Nr.updateMatrix(),this.applyMatrix(Nr.matrix)}),center:(Or=new dn,function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Or).negate(),this.translate(Or.x,Or.y,Or.z),this}),setFromObject:function(t){var e=t.geometry;if(t.isPoints||t.isLine){var n=new Ar(3*e.vertices.length,3),r=new Ar(3*e.colors.length,3);if(this.addAttribute("position",n.copyVector3sArray(e.vertices)),this.addAttribute("color",r.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length){var i=new Ar(e.lineDistances.length,1);this.addAttribute("lineDistance",i.copyArray(e.lineDistances))}null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())}else t.isMesh&&e&&e.isGeometry&&this.fromGeometry(e);return this},setFromPoints:function(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n];e.push(i.x,i.y,i.z||0)}return this.addAttribute("position",new Ar(e,3)),this},updateFromObject:function(t){var e,n=t.geometry;if(t.isMesh){var r=n.__directGeometry;if(!0===n.elementsNeedUpdate&&(r=void 0,n.elementsNeedUpdate=!1),void 0===r)return this.fromGeometry(n);r.verticesNeedUpdate=n.verticesNeedUpdate,r.normalsNeedUpdate=n.normalsNeedUpdate,r.colorsNeedUpdate=n.colorsNeedUpdate,r.uvsNeedUpdate=n.uvsNeedUpdate,r.groupsNeedUpdate=n.groupsNeedUpdate,n.verticesNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.groupsNeedUpdate=!1,n=r}return!0===n.verticesNeedUpdate&&(void 0!==(e=this.attributes.position)&&(e.copyVector3sArray(n.vertices),e.needsUpdate=!0),n.verticesNeedUpdate=!1),!0===n.normalsNeedUpdate&&(void 0!==(e=this.attributes.normal)&&(e.copyVector3sArray(n.normals),e.needsUpdate=!0),n.normalsNeedUpdate=!1),!0===n.colorsNeedUpdate&&(void 0!==(e=this.attributes.color)&&(e.copyColorsArray(n.colors),e.needsUpdate=!0),n.colorsNeedUpdate=!1),n.uvsNeedUpdate&&(void 0!==(e=this.attributes.uv)&&(e.copyVector2sArray(n.uvs),e.needsUpdate=!0),n.uvsNeedUpdate=!1),n.lineDistancesNeedUpdate&&(void 0!==(e=this.attributes.lineDistance)&&(e.copyArray(n.lineDistances),e.needsUpdate=!0),n.lineDistancesNeedUpdate=!1),n.groupsNeedUpdate&&(n.computeGroups(t.geometry),this.groups=n.groups,n.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new Cr).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var e=new Float32Array(3*t.vertices.length);if(this.addAttribute("position",new xr(e,3).copyVector3sArray(t.vertices)),t.normals.length>0){var n=new Float32Array(3*t.normals.length);this.addAttribute("normal",new xr(n,3).copyVector3sArray(t.normals))}if(t.colors.length>0){var r=new Float32Array(3*t.colors.length);this.addAttribute("color",new xr(r,3).copyColorsArray(t.colors))}if(t.uvs.length>0){var i=new Float32Array(2*t.uvs.length);this.addAttribute("uv",new xr(i,2).copyVector2sArray(t.uvs))}if(t.uvs2.length>0){var o=new Float32Array(2*t.uvs2.length);this.addAttribute("uv2",new xr(o,2).copyVector2sArray(t.uvs2))}for(var a in this.groups=t.groups,t.morphTargets){for(var s=[],u=t.morphTargets[a],l=0,c=u.length;l<c;l++){var h=u[l],p=new Ar(3*h.data.length,3);p.name=h.name,s.push(p.copyVector3sArray(h.data))}this.morphAttributes[a]=s}if(t.skinIndices.length>0){var f=new Ar(4*t.skinIndices.length,4);this.addAttribute("skinIndex",f.copyVector4sArray(t.skinIndices))}if(t.skinWeights.length>0){var d=new Ar(4*t.skinWeights.length,4);this.addAttribute("skinWeight",d.copyVector4sArray(t.skinWeights))}return null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:(Ir=new rr,function(){null===this.boundingBox&&(this.boundingBox=new rr);var t=this.attributes.position,e=this.morphAttributes.position;if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(var n=0,r=e.length;n<r;n++){var i=e[n];Ir.setFromBufferAttribute(i),this.boundingBox.expandByPoint(Ir.min),this.boundingBox.expandByPoint(Ir.max)}}else this.boundingBox.makeEmpty();isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z)}),computeBoundingSphere:function(){var t=new rr,e=new rr,n=new dn;return function(){null===this.boundingSphere&&(this.boundingSphere=new ir);var r=this.attributes.position,i=this.morphAttributes.position;if(r){var o=this.boundingSphere.center;if(t.setFromBufferAttribute(r),i)for(var a=0,s=i.length;a<s;a++){var u=i[a];e.setFromBufferAttribute(u),t.expandByPoint(e.min),t.expandByPoint(e.max)}t.getCenter(o);var l=0;for(a=0,s=r.count;a<s;a++)n.fromBufferAttribute(r,a),l=Math.max(l,o.distanceToSquared(n));if(i)for(a=0,s=i.length;a<s;a++)for(var c=0,h=(u=i[a]).count;c<h;c++)n.fromBufferAttribute(u,c),l=Math.max(l,o.distanceToSquared(n));this.boundingSphere.radius=Math.sqrt(l),isNaN(this.boundingSphere.radius)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes;if(e.position){var n=e.position.array;if(void 0===e.normal)this.addAttribute("normal",new xr(new Float32Array(n.length),3));else for(var r=e.normal.array,i=0,o=r.length;i<o;i++)r[i]=0;var a,s,u,l=e.normal.array,c=new dn,h=new dn,p=new dn,f=new dn,d=new dn;if(t){var m=t.array;for(i=0,o=t.count;i<o;i+=3)a=3*m[i+0],s=3*m[i+1],u=3*m[i+2],c.fromArray(n,a),h.fromArray(n,s),p.fromArray(n,u),f.subVectors(p,h),d.subVectors(c,h),f.cross(d),l[a]+=f.x,l[a+1]+=f.y,l[a+2]+=f.z,l[s]+=f.x,l[s+1]+=f.y,l[s+2]+=f.z,l[u]+=f.x,l[u+1]+=f.y,l[u+2]+=f.z}else for(i=0,o=n.length;i<o;i+=9)c.fromArray(n,i),h.fromArray(n,i+3),p.fromArray(n,i+6),f.subVectors(p,h),d.subVectors(c,h),f.cross(d),l[i]=f.x,l[i+1]=f.y,l[i+2]=f.z,l[i+3]=f.x,l[i+4]=f.y,l[i+5]=f.z,l[i+6]=f.x,l[i+7]=f.y,l[i+8]=f.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},merge:function(t,e){if(t&&t.isBufferGeometry){void 0===e&&(e=0);var n=this.attributes;for(var r in n)if(void 0!==t.attributes[r])for(var i=n[r].array,o=t.attributes[r],a=o.array,s=o.itemSize*e,u=Math.min(a.length,i.length-s),l=0,c=s;l<u;l++,c++)i[c]=a[l];return this}},normalizeNormals:function(){var t=new dn;return function(){for(var e=this.attributes.normal,n=0,r=e.count;n<r;n++)t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.normalize(),e.setXYZ(n,t.x,t.y,t.z)}}(),toNonIndexed:function(){function t(t,e){for(var n=t.array,r=t.itemSize,i=new n.constructor(e.length*r),o=0,a=0,s=0,u=e.length;s<u;s++){o=e[s]*r;for(var l=0;l<r;l++)i[a++]=n[o++]}return new xr(i,r)}if(null===this.index)return this;var e=new Dr,n=this.index.array,r=this.attributes;for(var i in r){var o=t(r[i],n);e.addAttribute(i,o)}var a=this.morphAttributes;for(i in a){for(var s=[],u=a[i],l=0,c=u.length;l<c;l++){o=t(u[l],n);s.push(o)}e.morphAttributes[i]=s}for(var h=this.groups,p=(l=0,h.length);l<p;l++){var f=h[l];e.addGroup(f.start,f.count,f.materialIndex)}return e},toJSON:function(){var t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){var e=this.parameters;for(var n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};var r=this.index;null!==r&&(t.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});var i=this.attributes;for(var n in i){var o=(p=i[n]).toJSON();""!==p.name&&(o.name=p.name),t.data.attributes[n]=o}var a={},s=!1;for(var n in this.morphAttributes){for(var u=this.morphAttributes[n],l=[],c=0,h=u.length;c<h;c++){var p;o=(p=u[c]).toJSON();""!==p.name&&(o.name=p.name),l.push(o)}l.length>0&&(a[n]=l,s=!0)}s&&(t.data.morphAttributes=a);var f=this.groups;f.length>0&&(t.data.groups=JSON.parse(JSON.stringify(f)));var d=this.boundingSphere;return null!==d&&(t.data.boundingSphere={center:d.center.toArray(),radius:d.radius}),t},clone:function(){return(new Dr).copy(this)},copy:function(t){var e,n,r;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var i=t.index;null!==i&&this.setIndex(i.clone());var o=t.attributes;for(e in o){var a=o[e];this.addAttribute(e,a.clone())}var s=t.morphAttributes;for(e in s){var u=[],l=s[e];for(n=0,r=l.length;n<r;n++)u.push(l[n].clone());this.morphAttributes[e]=u}var c=t.groups;for(n=0,r=c.length;n<r;n++){var h=c[n];this.addGroup(h.start,h.count,h.materialIndex)}var p=t.boundingBox;null!==p&&(this.boundingBox=p.clone());var f=t.boundingSphere;return null!==f&&(this.boundingSphere=f.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),kr.prototype=Object.assign(Object.create(er.prototype),{constructor:kr,isMesh:!0,setDrawMode:function(t){this.drawMode=t},copy:function(t){return er.prototype.copy.call(this,t),this.drawMode=t.drawMode,void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this},updateMorphTargets:function(){var t,e,n,r=this.geometry;if(r.isBufferGeometry){var i=r.morphAttributes,o=Object.keys(i);if(o.length>0){var a=i[o[0]];if(void 0!==a)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=a.length;t<e;t++)n=a[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}else{var s=r.morphTargets;void 0!==s&&s.length}},raycast:function(){var t=new In,e=new or,n=new ir,r=new dn,i=new dn,o=new dn,a=new dn,s=new dn,u=new dn,l=new dn,c=new dn,h=new dn,p=new pn,f=new pn,d=new pn,m=new dn,g=new dn;function v(t,e,n,r,i,o,a,s){if(null===(e.side===b?r.intersectTriangle(a,o,i,!0,s):r.intersectTriangle(i,o,a,e.side!==w,s)))return null;g.copy(s),g.applyMatrix4(t.matrixWorld);var u=n.ray.origin.distanceTo(g);return u<n.near||u>n.far?null:{distance:u,point:g.clone(),object:t}}function y(t,e,n,g,y,x,_,b,w,M,S){r.fromBufferAttribute(y,w),i.fromBufferAttribute(y,M),o.fromBufferAttribute(y,S);var T=t.morphTargetInfluences;if(e.morphTargets&&x&&T){l.set(0,0,0),c.set(0,0,0),h.set(0,0,0);for(var E=0,A=x.length;E<A;E++){var P=T[E],C=x[E];0!==P&&(a.fromBufferAttribute(C,w),s.fromBufferAttribute(C,M),u.fromBufferAttribute(C,S),l.addScaledVector(a.sub(r),P),c.addScaledVector(s.sub(i),P),h.addScaledVector(u.sub(o),P))}r.add(l),i.add(c),o.add(h)}var L=v(t,e,n,g,r,i,o,m);if(L){_&&(p.fromBufferAttribute(_,w),f.fromBufferAttribute(_,M),d.fromBufferAttribute(_,S),L.uv=ar.getUV(m,r,i,o,p,f,d,new pn)),b&&(p.fromBufferAttribute(b,w),f.fromBufferAttribute(b,M),d.fromBufferAttribute(b,S),L.uv2=ar.getUV(m,r,i,o,p,f,d,new pn));var I=new mr(w,M,S);ar.getNormal(r,i,o,I.normal),L.face=I}return L}return function(r,i){var o,a=this.geometry,s=this.material,u=this.matrixWorld;if(void 0!==s&&(null===a.boundingSphere&&a.computeBoundingSphere(),n.copy(a.boundingSphere),n.applyMatrix4(u),!1!==r.ray.intersectsSphere(n)&&(t.getInverse(u),e.copy(r.ray).applyMatrix4(t),null===a.boundingBox||!1!==e.intersectsBox(a.boundingBox))))if(a.isBufferGeometry){var l,c,h,g,x,_,b,w,M,S=a.index,T=a.attributes.position,E=a.morphAttributes.position,A=a.attributes.uv,P=a.attributes.uv2,C=a.groups,L=a.drawRange;if(null!==S)if(Array.isArray(s))for(g=0,_=C.length;g<_;g++)for(M=s[(w=C[g]).materialIndex],x=Math.max(w.start,L.start),b=Math.min(w.start+w.count,L.start+L.count);x<b;x+=3)l=S.getX(x),c=S.getX(x+1),h=S.getX(x+2),(o=y(this,M,r,e,T,E,A,P,l,c,h))&&(o.faceIndex=Math.floor(x/3),o.face.materialIndex=w.materialIndex,i.push(o));else for(g=Math.max(0,L.start),_=Math.min(S.count,L.start+L.count);g<_;g+=3)l=S.getX(g),c=S.getX(g+1),h=S.getX(g+2),(o=y(this,s,r,e,T,E,A,P,l,c,h))&&(o.faceIndex=Math.floor(g/3),i.push(o));else if(void 0!==T)if(Array.isArray(s))for(g=0,_=C.length;g<_;g++)for(M=s[(w=C[g]).materialIndex],x=Math.max(w.start,L.start),b=Math.min(w.start+w.count,L.start+L.count);x<b;x+=3)(o=y(this,M,r,e,T,E,A,P,l=x,c=x+1,h=x+2))&&(o.faceIndex=Math.floor(x/3),o.face.materialIndex=w.materialIndex,i.push(o));else for(g=Math.max(0,L.start),_=Math.min(T.count,L.start+L.count);g<_;g+=3)(o=y(this,s,r,e,T,E,A,P,l=g,c=g+1,h=g+2))&&(o.faceIndex=Math.floor(g/3),i.push(o))}else if(a.isGeometry){var I,O,N,R,D=Array.isArray(s),k=a.vertices,F=a.faces,B=a.faceVertexUvs[0];B.length>0&&(R=B);for(var U=0,z=F.length;U<z;U++){var V=F[U],G=D?s[V.materialIndex]:s;if(void 0!==G&&(I=k[V.a],O=k[V.b],N=k[V.c],o=v(this,G,r,e,I,O,N,m))){if(R&&R[U]){var j=R[U];p.copy(j[0]),f.copy(j[1]),d.copy(j[2]),o.uv=ar.getUV(m,I,O,N,p,f,d,new pn)}o.face=V,o.faceIndex=U,i.push(o)}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Fr=0;function Br(){Object.defineProperty(this,"id",{value:Fr+=2}),this.uuid=hn.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function Ur(t,e,n,r,i,o){Br.call(this),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:i,depthSegments:o},this.fromBufferGeometry(new zr(t,e,n,r,i,o)),this.mergeVertices()}function zr(t,e,n,r,i,o){Dr.call(this),this.type="BoxBufferGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:i,depthSegments:o};var a=this;t=t||1,e=e||1,n=n||1,r=Math.floor(r)||1,i=Math.floor(i)||1,o=Math.floor(o)||1;var s=[],u=[],l=[],c=[],h=0,p=0;function f(t,e,n,r,i,o,f,d,m,g,v){var y,x,_=o/m,b=f/g,w=o/2,M=f/2,S=d/2,T=m+1,E=g+1,A=0,P=0,C=new dn;for(x=0;x<E;x++){var L=x*b-M;for(y=0;y<T;y++){var I=y*_-w;C[t]=I*r,C[e]=L*i,C[n]=S,u.push(C.x,C.y,C.z),C[t]=0,C[e]=0,C[n]=d>0?1:-1,l.push(C.x,C.y,C.z),c.push(y/m),c.push(1-x/g),A+=1}}for(x=0;x<g;x++)for(y=0;y<m;y++){var O=h+y+T*x,N=h+y+T*(x+1),R=h+(y+1)+T*(x+1),D=h+(y+1)+T*x;s.push(O,N,D),s.push(N,R,D),P+=6}a.addGroup(p,P,v),p+=P,h+=A}f("z","y","x",-1,-1,n,e,t,o,i,0),f("z","y","x",1,-1,n,e,-t,o,i,1),f("x","z","y",1,1,t,n,e,r,o,2),f("x","z","y",1,-1,t,n,-e,r,o,3),f("x","y","z",1,-1,t,e,n,r,i,4),f("x","y","z",-1,-1,t,e,-n,r,i,5),this.setIndex(s),this.addAttribute("position",new Ar(u,3)),this.addAttribute("normal",new Ar(l,3)),this.addAttribute("uv",new Ar(c,2))}function Vr(t){var e={};for(var n in t)for(var r in e[n]={},t[n]){var i=t[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?e[n][r]=i.clone():Array.isArray(i)?e[n][r]=i.slice():e[n][r]=i}return e}function Gr(t){for(var e={},n=0;n<t.length;n++){var r=Vr(t[n]);for(var i in r)e[i]=r[i]}return e}Br.prototype=Object.assign(Object.create(r.prototype),{constructor:Br,isGeometry:!0,applyMatrix:function(t){for(var e=(new mn).getNormalMatrix(t),n=0,r=this.vertices.length;n<r;n++){this.vertices[n].applyMatrix4(t)}for(n=0,r=this.faces.length;n<r;n++){var i=this.faces[n];i.normal.applyMatrix3(e).normalize();for(var o=0,a=i.vertexNormals.length;o<a;o++)i.vertexNormals[o].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var t=new In;return function(e){return t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t=new In;return function(e){return t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t=new In;return function(e){return t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t=new In;return function(e,n,r){return t.makeTranslation(e,n,r),this.applyMatrix(t),this}}(),scale:function(){var t=new In;return function(e,n,r){return t.makeScale(e,n,r),this.applyMatrix(t),this}}(),lookAt:function(){var t=new er;return function(e){t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),fromBufferGeometry:function(t){var e=this,n=null!==t.index?t.index.array:void 0,r=t.attributes,i=r.position.array,o=void 0!==r.normal?r.normal.array:void 0,a=void 0!==r.color?r.color.array:void 0,s=void 0!==r.uv?r.uv.array:void 0,u=void 0!==r.uv2?r.uv2.array:void 0;void 0!==u&&(this.faceVertexUvs[1]=[]);for(var l=0;l<i.length;l+=3)e.vertices.push((new dn).fromArray(i,l)),void 0!==a&&e.colors.push((new hr).fromArray(a,l));function c(t,n,r,i){var l=void 0===a?[]:[e.colors[t].clone(),e.colors[n].clone(),e.colors[r].clone()],c=new mr(t,n,r,void 0===o?[]:[(new dn).fromArray(o,3*t),(new dn).fromArray(o,3*n),(new dn).fromArray(o,3*r)],l,i);e.faces.push(c),void 0!==s&&e.faceVertexUvs[0].push([(new pn).fromArray(s,2*t),(new pn).fromArray(s,2*n),(new pn).fromArray(s,2*r)]),void 0!==u&&e.faceVertexUvs[1].push([(new pn).fromArray(u,2*t),(new pn).fromArray(u,2*n),(new pn).fromArray(u,2*r)])}var h=t.groups;if(h.length>0)for(l=0;l<h.length;l++)for(var p=h[l],f=p.start,d=f,m=f+p.count;d<m;d+=3)void 0!==n?c(n[d],n[d+1],n[d+2],p.materialIndex):c(d,d+1,d+2,p.materialIndex);else if(void 0!==n)for(l=0;l<n.length;l+=3)c(n[l],n[l+1],n[l+2]);else for(l=0;l<i.length/3;l+=3)c(l,l+1,l+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){var t=new dn;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(t).negate(),this.translate(t.x,t.y,t.z),this}}(),normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=this.boundingSphere.radius,n=0===e?1:1/e,r=new In;return r.set(n,0,0,-n*t.x,0,n,0,-n*t.y,0,0,n,-n*t.z,0,0,0,1),this.applyMatrix(r),this},computeFaceNormals:function(){for(var t=new dn,e=new dn,n=0,r=this.faces.length;n<r;n++){var i=this.faces[n],o=this.vertices[i.a],a=this.vertices[i.b],s=this.vertices[i.c];t.subVectors(s,a),e.subVectors(o,a),t.cross(e),t.normalize(),i.normal.copy(t)}},computeVertexNormals:function(t){var e,n,r,i,o,a;for(void 0===t&&(t=!0),a=new Array(this.vertices.length),e=0,n=this.vertices.length;e<n;e++)a[e]=new dn;if(t){var s,u,l,c=new dn,h=new dn;for(r=0,i=this.faces.length;r<i;r++)o=this.faces[r],s=this.vertices[o.a],u=this.vertices[o.b],l=this.vertices[o.c],c.subVectors(l,u),h.subVectors(s,u),c.cross(h),a[o.a].add(c),a[o.b].add(c),a[o.c].add(c)}else for(this.computeFaceNormals(),r=0,i=this.faces.length;r<i;r++)a[(o=this.faces[r]).a].add(o.normal),a[o.b].add(o.normal),a[o.c].add(o.normal);for(e=0,n=this.vertices.length;e<n;e++)a[e].normalize();for(r=0,i=this.faces.length;r<i;r++){var p=(o=this.faces[r]).vertexNormals;3===p.length?(p[0].copy(a[o.a]),p[1].copy(a[o.b]),p[2].copy(a[o.c])):(p[0]=a[o.a].clone(),p[1]=a[o.b].clone(),p[2]=a[o.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var t,e,n;for(this.computeFaceNormals(),t=0,e=this.faces.length;t<e;t++){var r=(n=this.faces[t]).vertexNormals;3===r.length?(r[0].copy(n.normal),r[1].copy(n.normal),r[2].copy(n.normal)):(r[0]=n.normal.clone(),r[1]=n.normal.clone(),r[2]=n.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t,e,n,r,i;for(n=0,r=this.faces.length;n<r;n++)for((i=this.faces[n]).__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]),t=0,e=i.vertexNormals.length;t<e;t++)i.__originalVertexNormals[t]?i.__originalVertexNormals[t].copy(i.vertexNormals[t]):i.__originalVertexNormals[t]=i.vertexNormals[t].clone();var o=new Br;for(o.faces=this.faces,t=0,e=this.morphTargets.length;t<e;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];var a=this.morphNormals[t].faceNormals,s=this.morphNormals[t].vertexNormals;for(n=0,r=this.faces.length;n<r;n++)u=new dn,l={a:new dn,b:new dn,c:new dn},a.push(u),s.push(l)}var u,l,c=this.morphNormals[t];for(o.vertices=this.morphTargets[t].vertices,o.computeFaceNormals(),o.computeVertexNormals(),n=0,r=this.faces.length;n<r;n++)i=this.faces[n],u=c.faceNormals[n],l=c.vertexNormals[n],u.copy(i.normal),l.a.copy(i.vertexNormals[0]),l.b.copy(i.vertexNormals[1]),l.c.copy(i.vertexNormals[2])}for(n=0,r=this.faces.length;n<r;n++)(i=this.faces[n]).normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new rr),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new ir),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,n){if(t&&t.isGeometry){var r,i=this.vertices.length,o=this.vertices,a=t.vertices,s=this.faces,u=t.faces,l=this.colors,c=t.colors;void 0===n&&(n=0),void 0!==e&&(r=(new mn).getNormalMatrix(e));for(var h=0,p=a.length;h<p;h++){var f=a[h].clone();void 0!==e&&f.applyMatrix4(e),o.push(f)}for(h=0,p=c.length;h<p;h++)l.push(c[h].clone());for(h=0,p=u.length;h<p;h++){var d,m,g,v=u[h],y=v.vertexNormals,x=v.vertexColors;(d=new mr(v.a+i,v.b+i,v.c+i)).normal.copy(v.normal),void 0!==r&&d.normal.applyMatrix3(r).normalize();for(var _=0,b=y.length;_<b;_++)m=y[_].clone(),void 0!==r&&m.applyMatrix3(r).normalize(),d.vertexNormals.push(m);d.color.copy(v.color);for(_=0,b=x.length;_<b;_++)g=x[_],d.vertexColors.push(g.clone());d.materialIndex=v.materialIndex+n,s.push(d)}for(h=0,p=t.faceVertexUvs.length;h<p;h++){var w=t.faceVertexUvs[h];void 0===this.faceVertexUvs[h]&&(this.faceVertexUvs[h]=[]);for(_=0,b=w.length;_<b;_++){for(var M=w[_],S=[],T=0,E=M.length;T<E;T++)S.push(M[T].clone());this.faceVertexUvs[h].push(S)}}}},mergeMesh:function(t){t&&t.isMesh&&(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix))},mergeVertices:function(){var t,e,n,r,i,o,a,s,u={},l=[],c=[],h=Math.pow(10,4);for(n=0,r=this.vertices.length;n<r;n++)t=this.vertices[n],void 0===u[e=Math.round(t.x*h)+"_"+Math.round(t.y*h)+"_"+Math.round(t.z*h)]?(u[e]=n,l.push(this.vertices[n]),c[n]=l.length-1):c[n]=c[u[e]];var p=[];for(n=0,r=this.faces.length;n<r;n++){(i=this.faces[n]).a=c[i.a],i.b=c[i.b],i.c=c[i.c],o=[i.a,i.b,i.c];for(var f=0;f<3;f++)if(o[f]===o[(f+1)%3]){p.push(n);break}}for(n=p.length-1;n>=0;n--){var d=p[n];for(this.faces.splice(d,1),a=0,s=this.faceVertexUvs.length;a<s;a++)this.faceVertexUvs[a].splice(d,1)}var m=this.vertices.length-l.length;return this.vertices=l,m},setFromPoints:function(t){this.vertices=[];for(var e=0,n=t.length;e<n;e++){var r=t[e];this.vertices.push(new dn(r.x,r.y,r.z||0))}return this},sortFacesByMaterialIndex:function(){for(var t=this.faces,e=t.length,n=0;n<e;n++)t[n]._id=n;t.sort((function(t,e){return t.materialIndex-e.materialIndex}));var r,i,o=this.faceVertexUvs[0],a=this.faceVertexUvs[1];o&&o.length===e&&(r=[]),a&&a.length===e&&(i=[]);for(n=0;n<e;n++){var s=t[n]._id;r&&r.push(o[s]),i&&i.push(a[s])}r&&(this.faceVertexUvs[0]=r),i&&(this.faceVertexUvs[1]=i)},toJSON:function(){var t={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e=this.parameters;for(var n in e)void 0!==e[n]&&(t[n]=e[n]);return t}for(var r=[],i=0;i<this.vertices.length;i++){var o=this.vertices[i];r.push(o.x,o.y,o.z)}var a=[],s=[],u={},l=[],c={},h=[],p={};for(i=0;i<this.faces.length;i++){var f=this.faces[i],d=void 0!==this.faceVertexUvs[0][i],m=f.normal.length()>0,g=f.vertexNormals.length>0,v=1!==f.color.r||1!==f.color.g||1!==f.color.b,y=f.vertexColors.length>0,x=0;if(x=M(x,0,0),x=M(x,1,!0),x=M(x,2,!1),x=M(x,3,d),x=M(x,4,m),x=M(x,5,g),x=M(x,6,v),x=M(x,7,y),a.push(x),a.push(f.a,f.b,f.c),a.push(f.materialIndex),d){var _=this.faceVertexUvs[0][i];a.push(E(_[0]),E(_[1]),E(_[2]))}if(m&&a.push(S(f.normal)),g){var b=f.vertexNormals;a.push(S(b[0]),S(b[1]),S(b[2]))}if(v&&a.push(T(f.color)),y){var w=f.vertexColors;a.push(T(w[0]),T(w[1]),T(w[2]))}}function M(t,e,n){return n?t|1<<e:t&~(1<<e)}function S(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==u[e]||(u[e]=s.length/3,s.push(t.x,t.y,t.z)),u[e]}function T(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==c[e]||(c[e]=l.length,l.push(t.getHex())),c[e]}function E(t){var e=t.x.toString()+t.y.toString();return void 0!==p[e]||(p[e]=h.length/2,h.push(t.x,t.y)),p[e]}return t.data={},t.data.vertices=r,t.data.normals=s,l.length>0&&(t.data.colors=l),h.length>0&&(t.data.uvs=[h]),t.data.faces=a,t},clone:function(){return(new Br).copy(this)},copy:function(t){var e,n,r,i,o,a;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var s=t.vertices;for(e=0,n=s.length;e<n;e++)this.vertices.push(s[e].clone());var u=t.colors;for(e=0,n=u.length;e<n;e++)this.colors.push(u[e].clone());var l=t.faces;for(e=0,n=l.length;e<n;e++)this.faces.push(l[e].clone());for(e=0,n=t.faceVertexUvs.length;e<n;e++){var c=t.faceVertexUvs[e];for(void 0===this.faceVertexUvs[e]&&(this.faceVertexUvs[e]=[]),r=0,i=c.length;r<i;r++){var h=c[r],p=[];for(o=0,a=h.length;o<a;o++){var f=h[o];p.push(f.clone())}this.faceVertexUvs[e].push(p)}}var d=t.morphTargets;for(e=0,n=d.length;e<n;e++){var m={};if(m.name=d[e].name,void 0!==d[e].vertices)for(m.vertices=[],r=0,i=d[e].vertices.length;r<i;r++)m.vertices.push(d[e].vertices[r].clone());if(void 0!==d[e].normals)for(m.normals=[],r=0,i=d[e].normals.length;r<i;r++)m.normals.push(d[e].normals[r].clone());this.morphTargets.push(m)}var g=t.morphNormals;for(e=0,n=g.length;e<n;e++){var v={};if(void 0!==g[e].vertexNormals)for(v.vertexNormals=[],r=0,i=g[e].vertexNormals.length;r<i;r++){var y=g[e].vertexNormals[r],x={};x.a=y.a.clone(),x.b=y.b.clone(),x.c=y.c.clone(),v.vertexNormals.push(x)}if(void 0!==g[e].faceNormals)for(v.faceNormals=[],r=0,i=g[e].faceNormals.length;r<i;r++)v.faceNormals.push(g[e].faceNormals[r].clone());this.morphNormals.push(v)}var _=t.skinWeights;for(e=0,n=_.length;e<n;e++)this.skinWeights.push(_[e].clone());var b=t.skinIndices;for(e=0,n=b.length;e<n;e++)this.skinIndices.push(b[e].clone());var w=t.lineDistances;for(e=0,n=w.length;e<n;e++)this.lineDistances.push(w[e]);var M=t.boundingBox;null!==M&&(this.boundingBox=M.clone());var S=t.boundingSphere;return null!==S&&(this.boundingSphere=S.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Ur.prototype=Object.create(Br.prototype),Ur.prototype.constructor=Ur,zr.prototype=Object.create(Dr.prototype),zr.prototype.constructor=zr;var jr={clone:Vr,merge:Gr},Wr="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",Hr="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";function Xr(t){vr.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=Wr,this.fragmentShader=Hr,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==t&&(t.attributes,this.setValues(t))}function Yr(){er.call(this),this.type="Camera",this.matrixWorldInverse=new In,this.projectionMatrix=new In,this.projectionMatrixInverse=new In}function qr(t,e,n,r){Yr.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==r?r:2e3,this.focus=10,this.aspect=void 0!==e?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}Xr.prototype=Object.create(vr.prototype),Xr.prototype.constructor=Xr,Xr.prototype.isShaderMaterial=!0,Xr.prototype.copy=function(t){return vr.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Vr(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=t.extensions,this},Xr.prototype.toJSON=function(t){var e=vr.prototype.toJSON.call(this,t);for(var n in e.uniforms={},this.uniforms){var r=this.uniforms[n].value;r&&r.isTexture?e.uniforms[n]={type:"t",value:r.toJSON(t).uuid}:r&&r.isColor?e.uniforms[n]={type:"c",value:r.getHex()}:r&&r.isVector2?e.uniforms[n]={type:"v2",value:r.toArray()}:r&&r.isVector3?e.uniforms[n]={type:"v3",value:r.toArray()}:r&&r.isVector4?e.uniforms[n]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?e.uniforms[n]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?e.uniforms[n]={type:"m4",value:r.toArray()}:e.uniforms[n]={value:r}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;var i={};for(var o in this.extensions)!0===this.extensions[o]&&(i[o]=!0);return Object.keys(i).length>0&&(e.extensions=i),e},Yr.prototype=Object.assign(Object.create(er.prototype),{constructor:Yr,isCamera:!0,copy:function(t,e){return er.prototype.copy.call(this,t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this},getWorldDirection:function(t){void 0===t&&(t=new dn),this.updateMatrixWorld(!0);var e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()},updateMatrixWorld:function(t){er.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),qr.prototype=Object.assign(Object.create(Yr.prototype),{constructor:qr,isPerspectiveCamera:!0,copy:function(t,e){return Yr.prototype.copy.call(this,t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){var e=.5*this.getFilmHeight()/t;this.fov=2*hn.RAD2DEG*Math.atan(e),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(.5*hn.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*hn.RAD2DEG*Math.atan(Math.tan(.5*hn.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,n,r,i,o){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=this.near,e=t*Math.tan(.5*hn.DEG2RAD*this.fov)/this.zoom,n=2*e,r=this.aspect*n,i=-.5*r,o=this.view;if(null!==this.view&&this.view.enabled){var a=o.fullWidth,s=o.fullHeight;i+=o.offsetX*r/a,e-=o.offsetY*n/s,r*=o.width/a,n*=o.height/s}var u=this.filmOffset;0!==u&&(i+=t*u/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,e,e-n,t,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){var e=er.prototype.toJSON.call(this,t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}});var Zr,Jr,Kr=90,Qr=1;function $r(t,e,n,r){er.call(this),this.type="CubeCamera";var i=new qr(Kr,Qr,t,e);i.up.set(0,-1,0),i.lookAt(new dn(1,0,0)),this.add(i);var o=new qr(Kr,Qr,t,e);o.up.set(0,-1,0),o.lookAt(new dn(-1,0,0)),this.add(o);var a=new qr(Kr,Qr,t,e);a.up.set(0,0,1),a.lookAt(new dn(0,1,0)),this.add(a);var s=new qr(Kr,Qr,t,e);s.up.set(0,0,-1),s.lookAt(new dn(0,-1,0)),this.add(s);var u=new qr(Kr,Qr,t,e);u.up.set(0,-1,0),u.lookAt(new dn(0,0,1)),this.add(u);var l=new qr(Kr,Qr,t,e);l.up.set(0,-1,0),l.lookAt(new dn(0,0,-1)),this.add(l),r=r||{format:Yt,magFilter:Ct,minFilter:Ct},this.renderTarget=new ti(n,n,r),this.renderTarget.texture.name="CubeCamera",this.update=function(t,e){null===this.parent&&this.updateMatrixWorld();var n=t.getRenderTarget(),r=this.renderTarget,c=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,t.setRenderTarget(r,0),t.render(e,i),t.setRenderTarget(r,1),t.render(e,o),t.setRenderTarget(r,2),t.render(e,a),t.setRenderTarget(r,3),t.render(e,s),t.setRenderTarget(r,4),t.render(e,u),r.texture.generateMipmaps=c,t.setRenderTarget(r,5),t.render(e,l),t.setRenderTarget(n)},this.clear=function(t,e,n,r){for(var i=t.getRenderTarget(),o=this.renderTarget,a=0;a<6;a++)t.setRenderTarget(o,a),t.clear(e,n,r);t.setRenderTarget(i)}}function ti(t,e,n){Cn.call(this,t,e,n)}function ei(t,e,n,r,i,o,a,s,u,l,c,h){An.call(this,null,o,a,s,u,l,r,i,c,h),this.image={data:t,width:e,height:n},this.magFilter=void 0!==u?u:St,this.minFilter=void 0!==l?l:St,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}function ni(t,e){this.normal=void 0!==t?t:new dn(1,0,0),this.constant=void 0!==e?e:0}function ri(t,e,n,r,i,o){this.planes=[void 0!==t?t:new ni,void 0!==e?e:new ni,void 0!==n?n:new ni,void 0!==r?r:new ni,void 0!==i?i:new ni,void 0!==o?o:new ni]}$r.prototype=Object.create(er.prototype),$r.prototype.constructor=$r,ti.prototype=Object.create(Cn.prototype),ti.prototype.constructor=ti,ti.prototype.isWebGLRenderTargetCube=!0,ti.prototype.fromEquirectangularTexture=function(t,e){this.texture.type=e.type,this.texture.format=e.format,this.texture.encoding=e.encoding;var n=new nr,r={uniforms:{tEquirect:{value:null}},vertexShader:["varying vec3 vWorldDirection;","vec3 transformDirection( in vec3 dir, in mat4 matrix ) {","\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );","}","void main() {","\tvWorldDirection = transformDirection( position, modelMatrix );","\t#include <begin_vertex>","\t#include <project_vertex>","}"].join("\n"),fragmentShader:["uniform sampler2D tEquirect;","varying vec3 vWorldDirection;","#define RECIPROCAL_PI 0.31830988618","#define RECIPROCAL_PI2 0.15915494","void main() {","\tvec3 direction = normalize( vWorldDirection );","\tvec2 sampleUV;","\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;","\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;","\tgl_FragColor = texture2D( tEquirect, sampleUV );","}"].join("\n")},i=new Xr({type:"CubemapFromEquirect",uniforms:Vr(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:b,blending:P});i.uniforms.tEquirect.value=e;var o=new kr(new zr(5,5,5),i);n.add(o);var a=new $r(1,10,1);return a.renderTarget=this,a.renderTarget.texture.name="CubeCameraTexture",a.update(t,n),o.geometry.dispose(),o.material.dispose(),this},ei.prototype=Object.create(An.prototype),ei.prototype.constructor=ei,ei.prototype.isDataTexture=!0,Object.assign(ni.prototype,{isPlane:!0,set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,n,r){return this.normal.set(t,e,n),this.constant=r,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(){var t=new dn,e=new dn;return function(n,r,i){var o=t.subVectors(i,r).cross(e.subVectors(n,r)).normalize();return this.setFromNormalAndCoplanarPoint(o,n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return void 0===e&&(e=new dn),e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},intersectLine:function(){var t=new dn;return function(e,n){void 0===n&&(n=new dn);var r=e.delta(t),i=this.normal.dot(r);if(0===i)return 0===this.distanceToPoint(e.start)?n.copy(e.start):void 0;var o=-(e.start.dot(this.normal)+this.constant)/i;return o<0||o>1?void 0:n.copy(r).multiplyScalar(o).add(e.start)}}(),intersectsLine:function(t){var e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return void 0===t&&(t=new dn),t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var t=new dn,e=new mn;return function(n,r){var i=r||e.getNormalMatrix(n),o=this.coplanarPoint(t).applyMatrix4(n),a=this.normal.applyMatrix3(i).normalize();return this.constant=-o.dot(a),this}}(),translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}}),Object.assign(ri.prototype,{set:function(t,e,n,r,i,o){var a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(n),a[3].copy(r),a[4].copy(i),a[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var e=this.planes,n=0;n<6;n++)e[n].copy(t.planes[n]);return this},setFromMatrix:function(t){var e=this.planes,n=t.elements,r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],l=n[6],c=n[7],h=n[8],p=n[9],f=n[10],d=n[11],m=n[12],g=n[13],v=n[14],y=n[15];return e[0].setComponents(a-r,c-s,d-h,y-m).normalize(),e[1].setComponents(a+r,c+s,d+h,y+m).normalize(),e[2].setComponents(a+i,c+u,d+p,y+g).normalize(),e[3].setComponents(a-i,c-u,d-p,y-g).normalize(),e[4].setComponents(a-o,c-l,d-f,y-v).normalize(),e[5].setComponents(a+o,c+l,d+f,y+v).normalize(),this},intersectsObject:(Jr=new ir,function(t){var e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),Jr.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(Jr)}),intersectsSprite:function(){var t=new ir;return function(e){return t.center.set(0,0,0),t.radius=.7071067811865476,t.applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSphere:function(t){for(var e=this.planes,n=t.center,r=-t.radius,i=0;i<6;i++){if(e[i].distanceToPoint(n)<r)return!1}return!0},intersectsBox:(Zr=new dn,function(t){for(var e=this.planes,n=0;n<6;n++){var r=e[n];if(Zr.x=r.normal.x>0?t.max.x:t.min.x,Zr.y=r.normal.y>0?t.max.y:t.min.y,Zr.z=r.normal.z>0?t.max.z:t.min.z,r.distanceToPoint(Zr)<0)return!1}return!0}),containsPoint:function(t){for(var e=this.planes,n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}});var ii={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvarying vec3 vViewPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV( sampler2D envMap, vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = normalMatrix * objectTangent;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent ));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif",lights_pars_begin:"uniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#endif\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\tfloat clearCoatInv = 1.0 - clearCoatDHR;\n\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec3 singleScattering = vec3( 0.0 );\n\t\tvec3 multiScattering = vec3( 0.0 );\n\t\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\t\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\t\treflectedLight.indirectSpecular += clearCoatInv * radiance * singleScattering;\n\t\treflectedLight.indirectDiffuse += multiScattering * cosineWeightedIrradiance;\n\t\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n\t#else\n\t\treflectedLight.indirectSpecular += clearCoatInv * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#endif\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearCoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), maxMipLevel );\n\t#ifndef STANDARD\n\t\tclearCoatRadiance += getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, irradiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t#endif\n#endif",normal_fragment_maps:"#ifdef USE_NORMALMAP\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t#ifdef FLIP_SIDED\n\t\t\tnormal = - normal;\n\t\t#endif\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\tnormal = normalize( normalMatrix * normal );\n\t#else\n\t\t#ifdef USE_TANGENT\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t\tmapN.xy = normalScale * mapN.xy;\n\t\t\tnormal = normalize( vTBN * mapN );\n\t\t#else\n\t\t\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n\t\t#endif\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tuniform mat3 normalMatrix;\n\t#else\n\t\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\t\tvec2 st0 = dFdx( vUv.st );\n\t\t\tvec2 st1 = dFdy( vUv.st );\n\t\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\t\tvec3 N = normalize( surf_norm );\n\t\t\tmat3 tsn = mat3( S, T, N );\n\t\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t\tmapN.xy *= normalScale;\n\t\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\treturn normalize( tsn * mapN );\n\t\t}\n\t#endif\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#if defined( DITHERING )\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );\n}",uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},oi={common:{diffuse:{value:new hr(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new mn},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new pn(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new hr(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new hr(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new mn}},sprite:{diffuse:{value:new hr(15658734)},opacity:{value:1},center:{value:new pn(.5,.5)},rotation:{value:0},map:{value:null},uvTransform:{value:new mn}}},ai={basic:{uniforms:Gr([oi.common,oi.specularmap,oi.envmap,oi.aomap,oi.lightmap,oi.fog]),vertexShader:ii.meshbasic_vert,fragmentShader:ii.meshbasic_frag},lambert:{uniforms:Gr([oi.common,oi.specularmap,oi.envmap,oi.aomap,oi.lightmap,oi.emissivemap,oi.fog,oi.lights,{emissive:{value:new hr(0)}}]),vertexShader:ii.meshlambert_vert,fragmentShader:ii.meshlambert_frag},phong:{uniforms:Gr([oi.common,oi.specularmap,oi.envmap,oi.aomap,oi.lightmap,oi.emissivemap,oi.bumpmap,oi.normalmap,oi.displacementmap,oi.gradientmap,oi.fog,oi.lights,{emissive:{value:new hr(0)},specular:{value:new hr(1118481)},shininess:{value:30}}]),vertexShader:ii.meshphong_vert,fragmentShader:ii.meshphong_frag},standard:{uniforms:Gr([oi.common,oi.envmap,oi.aomap,oi.lightmap,oi.emissivemap,oi.bumpmap,oi.normalmap,oi.displacementmap,oi.roughnessmap,oi.metalnessmap,oi.fog,oi.lights,{emissive:{value:new hr(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:ii.meshphysical_vert,fragmentShader:ii.meshphysical_frag},matcap:{uniforms:Gr([oi.common,oi.bumpmap,oi.normalmap,oi.displacementmap,oi.fog,{matcap:{value:null}}]),vertexShader:ii.meshmatcap_vert,fragmentShader:ii.meshmatcap_frag},points:{uniforms:Gr([oi.points,oi.fog]),vertexShader:ii.points_vert,fragmentShader:ii.points_frag},dashed:{uniforms:Gr([oi.common,oi.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ii.linedashed_vert,fragmentShader:ii.linedashed_frag},depth:{uniforms:Gr([oi.common,oi.displacementmap]),vertexShader:ii.depth_vert,fragmentShader:ii.depth_frag},normal:{uniforms:Gr([oi.common,oi.bumpmap,oi.normalmap,oi.displacementmap,{opacity:{value:1}}]),vertexShader:ii.normal_vert,fragmentShader:ii.normal_frag},sprite:{uniforms:Gr([oi.sprite,oi.fog]),vertexShader:ii.sprite_vert,fragmentShader:ii.sprite_frag},background:{uniforms:{uvTransform:{value:new mn},t2D:{value:null}},vertexShader:ii.background_vert,fragmentShader:ii.background_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ii.cube_vert,fragmentShader:ii.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ii.equirect_vert,fragmentShader:ii.equirect_frag},distanceRGBA:{uniforms:Gr([oi.common,oi.displacementmap,{referencePosition:{value:new dn},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ii.distanceRGBA_vert,fragmentShader:ii.distanceRGBA_frag},shadow:{uniforms:Gr([oi.lights,oi.fog,{color:{value:new hr(0)},opacity:{value:1}}]),vertexShader:ii.shadow_vert,fragmentShader:ii.shadow_frag}};function si(){var t=null,e=!1,n=null;function r(i,o){!1!==e&&(n(i,o),t.requestAnimationFrame(r))}return{start:function(){!0!==e&&null!==n&&(t.requestAnimationFrame(r),e=!0)},stop:function(){e=!1},setAnimationLoop:function(t){n=t},setContext:function(e){t=e}}}function ui(t){var e=new WeakMap;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),e.get(t)},remove:function(n){n.isInterleavedBufferAttribute&&(n=n.data);var r=e.get(n);r&&(t.deleteBuffer(r.buffer),e.delete(n))},update:function(n,r){n.isInterleavedBufferAttribute&&(n=n.data);var i=e.get(n);void 0===i?e.set(n,function(e,n){var r=e.array,i=e.dynamic?35048:35044,o=t.createBuffer();t.bindBuffer(n,o),t.bufferData(n,r,i),e.onUploadCallback();var a=5126;return r instanceof Float32Array?a=5126:r instanceof Float64Array||(r instanceof Uint16Array?a=5123:r instanceof Int16Array?a=5122:r instanceof Uint32Array?a=5125:r instanceof Int32Array?a=5124:r instanceof Int8Array?a=5120:r instanceof Uint8Array&&(a=5121)),{buffer:o,type:a,bytesPerElement:r.BYTES_PER_ELEMENT,version:e.version}}(n,r)):i.version<n.version&&(!function(e,n,r){var i=n.array,o=n.updateRange;t.bindBuffer(r,e),!1===n.dynamic?t.bufferData(r,i,35044):-1===o.count?t.bufferSubData(r,0,i):0===o.count||(t.bufferSubData(r,o.offset*i.BYTES_PER_ELEMENT,i.subarray(o.offset,o.offset+o.count)),o.count=-1)}(i.buffer,n,r),i.version=n.version)}}}function li(t,e,n,r){Br.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r},this.fromBufferGeometry(new ci(t,e,n,r)),this.mergeVertices()}function ci(t,e,n,r){Dr.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r};var i,o,a=(t=t||1)/2,s=(e=e||1)/2,u=Math.floor(n)||1,l=Math.floor(r)||1,c=u+1,h=l+1,p=t/u,f=e/l,d=[],m=[],g=[],v=[];for(o=0;o<h;o++){var y=o*f-s;for(i=0;i<c;i++){var x=i*p-a;m.push(x,-y,0),g.push(0,0,1),v.push(i/u),v.push(1-o/l)}}for(o=0;o<l;o++)for(i=0;i<u;i++){var _=i+c*o,b=i+c*(o+1),w=i+1+c*(o+1),M=i+1+c*o;d.push(_,b,M),d.push(b,w,M)}this.setIndex(d),this.addAttribute("position",new Ar(m,3)),this.addAttribute("normal",new Ar(g,3)),this.addAttribute("uv",new Ar(v,2))}function hi(t,e,n,r){var i,o,a=new hr(0),s=0,u=null,l=0;function c(t,n){e.buffers.color.setClear(t.r,t.g,t.b,n,r)}return{getClearColor:function(){return a},setClearColor:function(t,e){a.set(t),c(a,s=void 0!==e?e:1)},getClearAlpha:function(){return s},setClearAlpha:function(t){c(a,s=t)},render:function(e,r,h,p){var f=r.background,d=t.vr,m=d.getSession&&d.getSession();if(m&&"additive"===m.environmentBlendMode&&(f=null),null===f?(c(a,s),u=null,l=0):f&&f.isColor&&(c(f,1),p=!0,u=null,l=0),(t.autoClear||p)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),f&&(f.isCubeTexture||f.isWebGLRenderTargetCube)){void 0===o&&((o=new kr(new zr(1,1,1),new Xr({type:"BackgroundCubeMaterial",uniforms:Vr(ai.cube.uniforms),vertexShader:ai.cube.vertexShader,fragmentShader:ai.cube.fragmentShader,side:b,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),o.geometry.removeAttribute("uv"),o.onBeforeRender=function(t,e,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(o.material,"map",{get:function(){return this.uniforms.tCube.value}}),n.update(o));var g=f.isWebGLRenderTargetCube?f.texture:f;o.material.uniforms.tCube.value=g,o.material.uniforms.tFlip.value=f.isWebGLRenderTargetCube?1:-1,u===f&&l===g.version||(o.material.needsUpdate=!0,u=f,l=g.version),e.unshift(o,o.geometry,o.material,0,0,null)}else f&&f.isTexture&&(void 0===i&&((i=new kr(new ci(2,2),new Xr({type:"BackgroundMaterial",uniforms:Vr(ai.background.uniforms),vertexShader:ai.background.vertexShader,fragmentShader:ai.background.fragmentShader,side:_,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),Object.defineProperty(i.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(i)),i.material.uniforms.t2D.value=f,!0===f.matrixAutoUpdate&&f.updateMatrix(),i.material.uniforms.uvTransform.value.copy(f.matrix),u===f&&l===f.version||(i.material.needsUpdate=!0,u=f,l=f.version),e.unshift(i,i.geometry,i.material,0,0,null))}}}function pi(t,e,n,r){var i;this.setMode=function(t){i=t},this.render=function(e,r){t.drawArrays(i,e,r),n.update(r,i)},this.renderInstances=function(o,a,s){var u;if(r.isWebGL2)u=t;else if(null===(u=e.get("ANGLE_instanced_arrays")))return;u[r.isWebGL2?"drawArraysInstanced":"drawArraysInstancedANGLE"](i,a,s,o.maxInstancedCount),n.update(s,i,o.maxInstancedCount)}}function fi(t,e,n){var r;function i(e){if("highp"===e){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}var o="undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext,a=void 0!==n.precision?n.precision:"highp",s=i(a);s!==a&&(a=s);var u=!0===n.logarithmicDepthBuffer,l=t.getParameter(34930),c=t.getParameter(35660),h=t.getParameter(3379),p=t.getParameter(34076),f=t.getParameter(34921),d=t.getParameter(36347),m=t.getParameter(36348),g=t.getParameter(36349),v=c>0,y=o||!!e.get("OES_texture_float");return{isWebGL2:o,getMaxAnisotropy:function(){if(void 0!==r)return r;var n=e.get("EXT_texture_filter_anisotropic");return r=null!==n?t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:i,precision:a,logarithmicDepthBuffer:u,maxTextures:l,maxVertexTextures:c,maxTextureSize:h,maxCubemapSize:p,maxAttributes:f,maxVertexUniforms:d,maxVaryings:m,maxFragmentUniforms:g,vertexTextures:v,floatFragmentTextures:y,floatVertexTextures:v&&y,maxSamples:o?t.getParameter(36183):0}}function di(){var t=this,e=null,n=0,r=!1,i=!1,o=new ni,a=new mn,s={value:null,needsUpdate:!1};function u(){s.value!==e&&(s.value=e,s.needsUpdate=n>0),t.numPlanes=n,t.numIntersection=0}function l(e,n,r,i){var u=null!==e?e.length:0,l=null;if(0!==u){if(l=s.value,!0!==i||null===l){var c=r+4*u,h=n.matrixWorldInverse;a.getNormalMatrix(h),(null===l||l.length<c)&&(l=new Float32Array(c));for(var p=0,f=r;p!==u;++p,f+=4)o.copy(e[p]).applyMatrix4(h,a),o.normal.toArray(l,f),l[f+3]=o.constant}s.value=l,s.needsUpdate=!0}return t.numPlanes=u,l}this.uniform=s,this.numPlanes=0,this.numIntersection=0,this.init=function(t,i,o){var a=0!==t.length||i||0!==n||r;return r=i,e=l(t,o,0),n=t.length,a},this.beginShadows=function(){i=!0,l(null)},this.endShadows=function(){i=!1,u()},this.setState=function(t,o,a,c,h,p){if(!r||null===t||0===t.length||i&&!a)i?l(null):u();else{var f=i?0:n,d=4*f,m=h.clippingState||null;s.value=m,m=l(t,c,d,p);for(var g=0;g!==d;++g)m[g]=e[g];h.clippingState=m,this.numIntersection=o?this.numPlanes:0,this.numPlanes+=f}}}function mi(t){var e={};return{get:function(n){if(void 0!==e[n])return e[n];var r;switch(n){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=t.getExtension(n)}return e[n]=r,r}}}function gi(t,e,n){var r={},i={};function o(t){var a=t.target,s=r[a.id];for(var u in null!==s.index&&e.remove(s.index),s.attributes)e.remove(s.attributes[u]);a.removeEventListener("dispose",o),delete r[a.id];var l=i[s.id];l&&(e.remove(l),delete i[s.id]),n.memory.geometries--}function a(t){var n=[],r=t.index,o=t.attributes.position,a=0;if(null!==r){var s=r.array;a=r.version;for(var u=0,l=s.length;u<l;u+=3){var c=s[u+0],h=s[u+1],p=s[u+2];n.push(c,h,h,p,p,c)}}else{s=o.array;a=o.version;for(u=0,l=s.length/3-1;u<l;u+=3){c=u+0,h=u+1,p=u+2;n.push(c,h,h,p,p,c)}}var f=new(Lr(n)>65535?Er:Sr)(n,1);f.version=a,e.update(f,34963);var d=i[t.id];d&&e.remove(d),i[t.id]=f}return{get:function(t,e){var i=r[e.id];return i||(e.addEventListener("dispose",o),e.isBufferGeometry?i=e:e.isGeometry&&(void 0===e._bufferGeometry&&(e._bufferGeometry=(new Dr).setFromObject(t)),i=e._bufferGeometry),r[e.id]=i,n.memory.geometries++,i)},update:function(t){var n=t.index,r=t.attributes;for(var i in null!==n&&e.update(n,34963),r)e.update(r[i],34962);var o=t.morphAttributes;for(var i in o)for(var a=o[i],s=0,u=a.length;s<u;s++)e.update(a[s],34962)},getWireframeAttribute:function(t){var e=i[t.id];if(e){var n=t.index;null!==n&&e.version<n.version&&a(t)}else a(t);return i[t.id]}}}function vi(t,e,n,r){var i,o,a;this.setMode=function(t){i=t},this.setIndex=function(t){o=t.type,a=t.bytesPerElement},this.render=function(e,r){t.drawElements(i,r,o,e*a),n.update(r,i)},this.renderInstances=function(s,u,l){var c;if(r.isWebGL2)c=t;else if(null===(c=e.get("ANGLE_instanced_arrays")))return;c[r.isWebGL2?"drawElementsInstanced":"drawElementsInstancedANGLE"](i,l,o,u*a,s.maxInstancedCount),n.update(l,i,s.maxInstancedCount)}}function yi(t){var e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(t,n,r){switch(r=r||1,e.calls++,n){case 4:e.triangles+=r*(t/3);break;case 5:case 6:e.triangles+=r*(t-2);break;case 1:e.lines+=r*(t/2);break;case 3:e.lines+=r*(t-1);break;case 2:e.lines+=r*t;break;case 0:e.points+=r*t}}}}function xi(t,e){return Math.abs(e[1])-Math.abs(t[1])}function _i(t){var e={},n=new Float32Array(8);return{update:function(r,i,o,a){var s=r.morphTargetInfluences,u=s.length,l=e[i.id];if(void 0===l){l=[];for(var c=0;c<u;c++)l[c]=[c,0];e[i.id]=l}var h=o.morphTargets&&i.morphAttributes.position,p=o.morphNormals&&i.morphAttributes.normal;for(c=0;c<u;c++){0!==(f=l[c])[1]&&(h&&i.removeAttribute("morphTarget"+c),p&&i.removeAttribute("morphNormal"+c))}for(c=0;c<u;c++){(f=l[c])[0]=c,f[1]=s[c]}for(l.sort(xi),c=0;c<8;c++){var f;if(f=l[c]){var d=f[0],m=f[1];if(m){h&&i.addAttribute("morphTarget"+c,h[d]),p&&i.addAttribute("morphNormal"+c,p[d]),n[c]=m;continue}}n[c]=0}a.getUniforms().setValue(t,"morphTargetInfluences",n)}}}function bi(t,e){var n={};return{update:function(r){var i=e.render.frame,o=r.geometry,a=t.get(r,o);return n[a.id]!==i&&(o.isGeometry&&a.updateFromObject(r),t.update(a),n[a.id]=i),a},dispose:function(){n={}}}}function wi(t,e,n,r,i,o,a,s,u,l){t=void 0!==t?t:[],e=void 0!==e?e:dt,a=void 0!==a?a:Yt,An.call(this,t,e,n,r,i,o,a,s,u,l),this.flipY=!1}function Mi(t,e,n,r){An.call(this,null),this.image={data:t,width:e,height:n,depth:r},this.magFilter=St,this.minFilter=St,this.wrapR=wt,this.generateMipmaps=!1,this.flipY=!1}function Si(t,e,n,r){An.call(this,null),this.image={data:t,width:e,height:n,depth:r},this.magFilter=St,this.minFilter=St,this.wrapR=wt,this.generateMipmaps=!1,this.flipY=!1}ai.physical={uniforms:Gr([ai.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:ii.meshphysical_vert,fragmentShader:ii.meshphysical_frag},li.prototype=Object.create(Br.prototype),li.prototype.constructor=li,ci.prototype=Object.create(Dr.prototype),ci.prototype.constructor=ci,wi.prototype=Object.create(An.prototype),wi.prototype.constructor=wi,wi.prototype.isCubeTexture=!0,Object.defineProperty(wi.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}}),Mi.prototype=Object.create(An.prototype),Mi.prototype.constructor=Mi,Mi.prototype.isDataTexture2DArray=!0,Si.prototype=Object.create(An.prototype),Si.prototype.constructor=Si,Si.prototype.isDataTexture3D=!0;var Ti=new An,Ei=new Mi,Ai=new Si,Pi=new wi,Ci=[],Li=[],Ii=new Float32Array(16),Oi=new Float32Array(9),Ni=new Float32Array(4);function Ri(t,e,n){var r=t[0];if(r<=0||r>0)return t;var i=e*n,o=Ci[i];if(void 0===o&&(o=new Float32Array(i),Ci[i]=o),0!==e){r.toArray(o,0);for(var a=1,s=0;a!==e;++a)s+=n,t[a].toArray(o,s)}return o}function Di(t,e){if(t.length!==e.length)return!1;for(var n=0,r=t.length;n<r;n++)if(t[n]!==e[n])return!1;return!0}function ki(t,e){for(var n=0,r=e.length;n<r;n++)t[n]=e[n]}function Fi(t,e){var n=Li[e];void 0===n&&(n=new Int32Array(e),Li[e]=n);for(var r=0;r!==e;++r)n[r]=t.allocateTextureUnit();return n}function Bi(t,e){var n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function Ui(t,e){var n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Di(n,e))return;t.uniform2fv(this.addr,e),ki(n,e)}}function zi(t,e){var n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(void 0!==e.r)n[0]===e.r&&n[1]===e.g&&n[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(Di(n,e))return;t.uniform3fv(this.addr,e),ki(n,e)}}function Vi(t,e){var n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z&&n[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Di(n,e))return;t.uniform4fv(this.addr,e),ki(n,e)}}function Gi(t,e){var n=this.cache,r=e.elements;if(void 0===r){if(Di(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),ki(n,e)}else{if(Di(n,r))return;Ni.set(r),t.uniformMatrix2fv(this.addr,!1,Ni),ki(n,r)}}function ji(t,e){var n=this.cache,r=e.elements;if(void 0===r){if(Di(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),ki(n,e)}else{if(Di(n,r))return;Oi.set(r),t.uniformMatrix3fv(this.addr,!1,Oi),ki(n,r)}}function Wi(t,e){var n=this.cache,r=e.elements;if(void 0===r){if(Di(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),ki(n,e)}else{if(Di(n,r))return;Ii.set(r),t.uniformMatrix4fv(this.addr,!1,Ii),ki(n,r)}}function Hi(t,e,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.safeSetTexture2D(e||Ti,i)}function Xi(t,e,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(e||Ei,i)}function Yi(t,e,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(e||Ai,i)}function qi(t,e,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.safeSetTextureCube(e||Pi,i)}function Zi(t,e){var n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function Ji(t,e){var n=this.cache;Di(n,e)||(t.uniform2iv(this.addr,e),ki(n,e))}function Ki(t,e){var n=this.cache;Di(n,e)||(t.uniform3iv(this.addr,e),ki(n,e))}function Qi(t,e){var n=this.cache;Di(n,e)||(t.uniform4iv(this.addr,e),ki(n,e))}function $i(t,e){t.uniform1fv(this.addr,e)}function to(t,e){t.uniform1iv(this.addr,e)}function eo(t,e){t.uniform2iv(this.addr,e)}function no(t,e){t.uniform3iv(this.addr,e)}function ro(t,e){t.uniform4iv(this.addr,e)}function io(t,e){var n=Ri(e,this.size,2);t.uniform2fv(this.addr,n)}function oo(t,e){var n=Ri(e,this.size,3);t.uniform3fv(this.addr,n)}function ao(t,e){var n=Ri(e,this.size,4);t.uniform4fv(this.addr,n)}function so(t,e){var n=Ri(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function uo(t,e){var n=Ri(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function lo(t,e){var n=Ri(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function co(t,e,n){var r=e.length,i=Fi(n,r);t.uniform1iv(this.addr,i);for(var o=0;o!==r;++o)n.safeSetTexture2D(e[o]||Ti,i[o])}function ho(t,e,n){var r=e.length,i=Fi(n,r);t.uniform1iv(this.addr,i);for(var o=0;o!==r;++o)n.safeSetTextureCube(e[o]||Pi,i[o])}function po(t,e,n){this.id=t,this.addr=n,this.cache=[],this.setValue=function(t){switch(t){case 5126:return Bi;case 35664:return Ui;case 35665:return zi;case 35666:return Vi;case 35674:return Gi;case 35675:return ji;case 35676:return Wi;case 35678:case 36198:return Hi;case 35679:return Yi;case 35680:return qi;case 36289:return Xi;case 5124:case 35670:return Zi;case 35667:case 35671:return Ji;case 35668:case 35672:return Ki;case 35669:case 35673:return Qi}}(e.type)}function fo(t,e,n){this.id=t,this.addr=n,this.cache=[],this.size=e.size,this.setValue=function(t){switch(t){case 5126:return $i;case 35664:return io;case 35665:return oo;case 35666:return ao;case 35674:return so;case 35675:return uo;case 35676:return lo;case 35678:return co;case 35680:return ho;case 5124:case 35670:return to;case 35667:case 35671:return eo;case 35668:case 35672:return no;case 35669:case 35673:return ro}}(e.type)}function mo(t){this.id=t,this.seq=[],this.map={}}fo.prototype.updateCache=function(t){var e=this.cache;t instanceof Float32Array&&e.length!==t.length&&(this.cache=new Float32Array(t.length)),ki(e,t)},mo.prototype.setValue=function(t,e,n){for(var r=this.seq,i=0,o=r.length;i!==o;++i){var a=r[i];a.setValue(t,e[a.id],n)}};var go=/([\w\d_]+)(\])?(\[|\.)?/g;function vo(t,e){t.seq.push(e),t.map[e.id]=e}function yo(t,e,n){var r=t.name,i=r.length;for(go.lastIndex=0;;){var o=go.exec(r),a=go.lastIndex,s=o[1],u="]"===o[2],l=o[3];if(u&&(s|=0),void 0===l||"["===l&&a+2===i){vo(n,void 0===l?new po(s,t,e):new fo(s,t,e));break}var c=n.map[s];void 0===c&&vo(n,c=new mo(s)),n=c}}function xo(t,e){this.seq=[],this.map={};for(var n=t.getProgramParameter(e,35718),r=0;r<n;++r){var i=t.getActiveUniform(e,r);yo(i,t.getUniformLocation(e,i.name),this)}}function _o(t,e,n){var r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),r}xo.prototype.setValue=function(t,e,n,r){var i=this.map[e];void 0!==i&&i.setValue(t,n,r)},xo.prototype.setOptional=function(t,e,n){var r=e[n];void 0!==r&&this.setValue(t,n,r)},xo.upload=function(t,e,n,r){for(var i=0,o=e.length;i!==o;++i){var a=e[i],s=n[a.id];!1!==s.needsUpdate&&a.setValue(t,s.value,r)}},xo.seqWithValue=function(t,e){for(var n=[],r=0,i=t.length;r!==i;++r){var o=t[r];o.id in e&&n.push(o)}return n};var bo=0;function wo(t){switch(t){case ke:return["Linear","( value )"];case Fe:return["sRGB","( value )"];case Ue:return["RGBE","( value )"];case Ve:return["RGBM","( value, 7.0 )"];case Ge:return["RGBM","( value, 16.0 )"];case je:return["RGBD","( value, 256.0 )"];case Be:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+t)}}function Mo(t,e,n){var r=t.getShaderParameter(e,35713),i=t.getShaderInfoLog(e).trim();return r&&""===i?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+n+"\n"+i+function(t){for(var e=t.split("\n"),n=0;n<e.length;n++)e[n]=n+1+": "+e[n];return e.join("\n")}(t.getShaderSource(e))}function So(t,e){var n=wo(e);return"vec4 "+t+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function To(t,e){var n;switch(e){case ut:n="Linear";break;case lt:n="Reinhard";break;case ct:n="Uncharted2";break;case ht:n="OptimizedCineon";break;case pt:n="ACESFilmic";break;default:throw new Error("unsupported toneMapping: "+e)}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function Eo(t){return""!==t}function Ao(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights)}function Po(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}function Co(t){return t.replace(/^[ \t]*#include +<([\w\d./]+)>/gm,(function(t,e){var n=ii[e];if(void 0===n)throw new Error("Can not resolve #include <"+e+">");return Co(n)}))}function Lo(t){return t.replace(/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,(function(t,e,n,r){for(var i="",o=parseInt(e);o<parseInt(n);o++)i+=r.replace(/\[ i \]/g,"[ "+o+" ]");return i}))}function Io(t,e,n,r,i,o,a){var s=t.getContext(),u=r.defines,l=i.vertexShader,c=i.fragmentShader,h="SHADOWMAP_TYPE_BASIC";o.shadowMapType===y?h="SHADOWMAP_TYPE_PCF":o.shadowMapType===x&&(h="SHADOWMAP_TYPE_PCF_SOFT");var p="ENVMAP_TYPE_CUBE",f="ENVMAP_MODE_REFLECTION",d="ENVMAP_BLENDING_MULTIPLY";if(o.envMap){switch(r.envMap.mapping){case dt:case mt:p="ENVMAP_TYPE_CUBE";break;case xt:case _t:p="ENVMAP_TYPE_CUBE_UV";break;case gt:case vt:p="ENVMAP_TYPE_EQUIREC";break;case yt:p="ENVMAP_TYPE_SPHERE"}switch(r.envMap.mapping){case mt:case vt:f="ENVMAP_MODE_REFRACTION"}switch(r.combine){case it:d="ENVMAP_BLENDING_MULTIPLY";break;case ot:d="ENVMAP_BLENDING_MIX";break;case at:d="ENVMAP_BLENDING_ADD"}}var m,g,v,_,b,w=t.gammaFactor>0?t.gammaFactor:1,M=a.isWebGL2?"":function(t,e,n){return[(t=t||{}).derivatives||e.envMapCubeUV||e.bumpMap||e.normalMap&&!e.objectSpaceNormalMap||e.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(t.fragDepth||e.logarithmicDepthBuffer)&&n.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",t.drawBuffers&&n.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(t.shaderTextureLOD||e.envMap)&&n.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Eo).join("\n")}(r.extensions,o,e),S=function(t){var e=[];for(var n in t){var r=t[n];!1!==r&&e.push("#define "+n+" "+r)}return e.join("\n")}(u),T=s.createProgram();if(r.isRawShaderMaterial?((m=[S].filter(Eo).join("\n")).length>0&&(m+="\n"),(g=[M,S].filter(Eo).join("\n")).length>0&&(g+="\n")):(m=["precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+i.name,S,o.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+w,"#define MAX_BONES "+o.maxBones,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+f:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.normalMap&&o.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",o.displacementMap&&o.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexTangents?"#define USE_TANGENT":"",o.vertexColors?"#define USE_COLOR":"",o.flatShading?"#define FLAT_SHADED":"",o.skinning?"#define USE_SKINNING":"",o.useVertexTexture?"#define BONE_TEXTURE":"",o.morphTargets?"#define USE_MORPHTARGETS":"",o.morphNormals&&!1===o.flatShading?"#define USE_MORPHNORMALS":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+h:"",o.sizeAttenuation?"#define USE_SIZEATTENUATION":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&(a.isWebGL2||e.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Eo).join("\n"),g=[M,"precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+i.name,S,o.alphaTest?"#define ALPHATEST "+o.alphaTest+(o.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+w,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.matcap?"#define USE_MATCAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+p:"",o.envMap?"#define "+f:"",o.envMap?"#define "+d:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.normalMap&&o.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexTangents?"#define USE_TANGENT":"",o.vertexColors?"#define USE_COLOR":"",o.gradientMap?"#define USE_GRADIENTMAP":"",o.flatShading?"#define FLAT_SHADED":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+h:"",o.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",o.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&(a.isWebGL2||e.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"",o.envMap&&(a.isWebGL2||e.get("EXT_shader_texture_lod"))?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",o.toneMapping!==st?"#define TONE_MAPPING":"",o.toneMapping!==st?ii.tonemapping_pars_fragment:"",o.toneMapping!==st?To("toneMapping",o.toneMapping):"",o.dithering?"#define DITHERING":"",o.outputEncoding||o.mapEncoding||o.matcapEncoding||o.envMapEncoding||o.emissiveMapEncoding?ii.encodings_pars_fragment:"",o.mapEncoding?So("mapTexelToLinear",o.mapEncoding):"",o.matcapEncoding?So("matcapTexelToLinear",o.matcapEncoding):"",o.envMapEncoding?So("envMapTexelToLinear",o.envMapEncoding):"",o.emissiveMapEncoding?So("emissiveMapTexelToLinear",o.emissiveMapEncoding):"",o.outputEncoding?(v="linearToOutputTexel",_=o.outputEncoding,b=wo(_),"vec4 "+v+"( vec4 value ) { return LinearTo"+b[0]+b[1]+"; }"):"",o.depthPacking?"#define DEPTH_PACKING "+r.depthPacking:"","\n"].filter(Eo).join("\n")),l=Po(l=Ao(l=Co(l),o),o),c=Po(c=Ao(c=Co(c),o),o),l=Lo(l),c=Lo(c),a.isWebGL2&&!r.isRawShaderMaterial){var E=!1,A=/^\s*#version\s+300\s+es\s*\n/;r.isShaderMaterial&&null!==l.match(A)&&null!==c.match(A)&&(E=!0,l=l.replace(A,""),c=c.replace(A,"")),m=["#version 300 es\n","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+m,g=["#version 300 es\n","#define varying in",E?"":"out highp vec4 pc_fragColor;",E?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+g}var P,C,L=g+c,I=_o(s,35633,m+l),O=_o(s,35632,L);if(s.attachShader(T,I),s.attachShader(T,O),void 0!==r.index0AttributeName?s.bindAttribLocation(T,0,r.index0AttributeName):!0===o.morphTargets&&s.bindAttribLocation(T,0,"position"),s.linkProgram(T),t.debug.checkShaderErrors){var N=s.getProgramInfoLog(T).trim(),R=s.getShaderInfoLog(I).trim(),D=s.getShaderInfoLog(O).trim(),k=!0,F=!0;if(!1===s.getProgramParameter(T,35714)){k=!1;Mo(s,I,"vertex"),Mo(s,O,"fragment")}else""!==N||""!==R&&""!==D||(F=!1);F&&(this.diagnostics={runnable:k,material:r,programLog:N,vertexShader:{log:R,prefix:m},fragmentShader:{log:D,prefix:g}})}return s.deleteShader(I),s.deleteShader(O),this.getUniforms=function(){return void 0===P&&(P=new xo(s,T)),P},this.getAttributes=function(){return void 0===C&&(C=function(t,e){for(var n={},r=t.getProgramParameter(e,35721),i=0;i<r;i++){var o=t.getActiveAttrib(e,i).name;n[o]=t.getAttribLocation(e,o)}return n}(s,T)),C},this.destroy=function(){s.deleteProgram(T),this.program=void 0},this.name=i.name,this.id=bo++,this.code=n,this.usedTimes=1,this.program=T,this.vertexShader=I,this.fragmentShader=O,this}function Oo(t,e,n){var r=[],i={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},o=["precision","supportsVertexTextures","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering"];function a(t,e){var n;return t?t.isTexture?n=t.encoding:t.isWebGLRenderTarget&&(n=t.texture.encoding):n=ke,n===ke&&e&&(n=Be),n}this.getParameters=function(e,r,o,s,u,l,c){var h=i[e.type],p=c.isSkinnedMesh?function(t){var e=t.skeleton.bones;if(n.floatVertexTextures)return 1024;var r=n.maxVertexUniforms,i=Math.floor((r-20)/4),o=Math.min(i,e.length);return o<e.length?0:o}(c):0,f=n.precision;null!==e.precision&&(f=n.getMaxPrecision(e.precision),e.precision);var d=t.getRenderTarget();return{shaderID:h,precision:f,supportsVertexTextures:n.vertexTextures,outputEncoding:a(d?d.texture:null,t.gammaOutput),map:!!e.map,mapEncoding:a(e.map,t.gammaInput),matcap:!!e.matcap,matcapEncoding:a(e.matcap,t.gammaInput),envMap:!!e.envMap,envMapMode:e.envMap&&e.envMap.mapping,envMapEncoding:a(e.envMap,t.gammaInput),envMapCubeUV:!!e.envMap&&(e.envMap.mapping===xt||e.envMap.mapping===_t),lightMap:!!e.lightMap,aoMap:!!e.aoMap,emissiveMap:!!e.emissiveMap,emissiveMapEncoding:a(e.emissiveMap,t.gammaInput),bumpMap:!!e.bumpMap,normalMap:!!e.normalMap,objectSpaceNormalMap:e.normalMapType===Ye,displacementMap:!!e.displacementMap,roughnessMap:!!e.roughnessMap,metalnessMap:!!e.metalnessMap,specularMap:!!e.specularMap,alphaMap:!!e.alphaMap,gradientMap:!!e.gradientMap,combine:e.combine,vertexTangents:e.normalMap&&e.vertexTangents,vertexColors:e.vertexColors,fog:!!s,useFog:e.fog,fogExp:s&&s.isFogExp2,flatShading:e.flatShading,sizeAttenuation:e.sizeAttenuation,logarithmicDepthBuffer:n.logarithmicDepthBuffer,skinning:e.skinning&&p>0,maxBones:p,useVertexTexture:n.floatVertexTextures,morphTargets:e.morphTargets,morphNormals:e.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:r.directional.length,numPointLights:r.point.length,numSpotLights:r.spot.length,numRectAreaLights:r.rectArea.length,numHemiLights:r.hemi.length,numClippingPlanes:u,numClipIntersection:l,dithering:e.dithering,shadowMapEnabled:t.shadowMap.enabled&&c.receiveShadow&&o.length>0,shadowMapType:t.shadowMap.type,toneMapping:t.toneMapping,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:e.premultipliedAlpha,alphaTest:e.alphaTest,doubleSided:e.side===w,flipSided:e.side===b,depthPacking:void 0!==e.depthPacking&&e.depthPacking}},this.getProgramCode=function(e,n){var r=[];if(n.shaderID?r.push(n.shaderID):(r.push(e.fragmentShader),r.push(e.vertexShader)),void 0!==e.defines)for(var i in e.defines)r.push(i),r.push(e.defines[i]);for(var a=0;a<o.length;a++)r.push(n[o[a]]);return r.push(e.onBeforeCompile.toString()),r.push(t.gammaOutput),r.push(t.gammaFactor),r.join()},this.acquireProgram=function(i,o,a,s){for(var u,l=0,c=r.length;l<c;l++){var h=r[l];if(h.code===s){++(u=h).usedTimes;break}}return void 0===u&&(u=new Io(t,e,s,i,o,a,n),r.push(u)),u},this.releaseProgram=function(t){if(0==--t.usedTimes){var e=r.indexOf(t);r[e]=r[r.length-1],r.pop(),t.destroy()}},this.programs=r}function No(){var t=new WeakMap;return{get:function(e){var n=t.get(e);return void 0===n&&(n={},t.set(e,n)),n},remove:function(e){t.delete(e)},update:function(e,n,r){t.get(e)[n]=r},dispose:function(){t=new WeakMap}}}function Ro(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program!==e.program?t.program.id-e.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function Do(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function ko(){var t=[],e=0,n=[],r=[],i={id:-1};function o(n,r,o,a,s,u){var l=t[e];return void 0===l?(l={id:n.id,object:n,geometry:r,material:o,program:o.program||i,groupOrder:a,renderOrder:n.renderOrder,z:s,group:u},t[e]=l):(l.id=n.id,l.object=n,l.geometry=r,l.material=o,l.program=o.program||i,l.groupOrder=a,l.renderOrder=n.renderOrder,l.z=s,l.group=u),e++,l}return{opaque:n,transparent:r,init:function(){e=0,n.length=0,r.length=0},push:function(t,e,i,a,s,u){var l=o(t,e,i,a,s,u);(!0===i.transparent?r:n).push(l)},unshift:function(t,e,i,a,s,u){var l=o(t,e,i,a,s,u);(!0===i.transparent?r:n).unshift(l)},sort:function(){n.length>1&&n.sort(Ro),r.length>1&&r.sort(Do)}}}function Fo(){var t={};function e(n){var r=n.target;r.removeEventListener("dispose",e),delete t[r.id]}return{get:function(n,r){var i,o=t[n.id];return void 0===o?(i=new ko,t[n.id]={},t[n.id][r.id]=i,n.addEventListener("dispose",e)):void 0===(i=o[r.id])&&(i=new ko,o[r.id]=i),i},dispose:function(){t={}}}}function Bo(){var t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];var n;switch(e.type){case"DirectionalLight":n={direction:new dn,color:new hr,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new pn};break;case"SpotLight":n={position:new dn,direction:new dn,color:new hr,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new pn};break;case"PointLight":n={position:new dn,color:new hr,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new pn,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":n={direction:new dn,skyColor:new hr,groundColor:new hr};break;case"RectAreaLight":n={color:new hr,position:new dn,halfWidth:new dn,halfHeight:new dn}}return t[e.id]=n,n}}}var Uo=0;function zo(){for(var t=new Bo,e={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,shadowsLength:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},n=0;n<9;n++)e.probe.push(new dn);var r=new dn,i=new In,o=new In;return{setup:function(n,a,s){for(var u=0,l=0,c=0,h=0;h<9;h++)e.probe[h].set(0,0,0);for(var p=0,f=0,d=0,m=0,g=0,v=s.matrixWorldInverse,y=(h=0,n.length);h<y;h++){var x=n[h],_=x.color,b=x.intensity,w=x.distance,M=x.shadow&&x.shadow.map?x.shadow.map.texture:null;if(x.isAmbientLight)u+=_.r*b,l+=_.g*b,c+=_.b*b;else if(x.isLightProbe)for(var S=0;S<9;S++)e.probe[S].addScaledVector(x.sh.coefficients[S],b);else if(x.isDirectionalLight){if((E=t.get(x)).color.copy(x.color).multiplyScalar(x.intensity),E.direction.setFromMatrixPosition(x.matrixWorld),r.setFromMatrixPosition(x.target.matrixWorld),E.direction.sub(r),E.direction.transformDirection(v),E.shadow=x.castShadow,x.castShadow){var T=x.shadow;E.shadowBias=T.bias,E.shadowRadius=T.radius,E.shadowMapSize=T.mapSize}e.directionalShadowMap[p]=M,e.directionalShadowMatrix[p]=x.shadow.matrix,e.directional[p]=E,p++}else if(x.isSpotLight){if((E=t.get(x)).position.setFromMatrixPosition(x.matrixWorld),E.position.applyMatrix4(v),E.color.copy(_).multiplyScalar(b),E.distance=w,E.direction.setFromMatrixPosition(x.matrixWorld),r.setFromMatrixPosition(x.target.matrixWorld),E.direction.sub(r),E.direction.transformDirection(v),E.coneCos=Math.cos(x.angle),E.penumbraCos=Math.cos(x.angle*(1-x.penumbra)),E.decay=x.decay,E.shadow=x.castShadow,x.castShadow){T=x.shadow;E.shadowBias=T.bias,E.shadowRadius=T.radius,E.shadowMapSize=T.mapSize}e.spotShadowMap[d]=M,e.spotShadowMatrix[d]=x.shadow.matrix,e.spot[d]=E,d++}else if(x.isRectAreaLight){(E=t.get(x)).color.copy(_).multiplyScalar(b),E.position.setFromMatrixPosition(x.matrixWorld),E.position.applyMatrix4(v),o.identity(),i.copy(x.matrixWorld),i.premultiply(v),o.extractRotation(i),E.halfWidth.set(.5*x.width,0,0),E.halfHeight.set(0,.5*x.height,0),E.halfWidth.applyMatrix4(o),E.halfHeight.applyMatrix4(o),e.rectArea[m]=E,m++}else if(x.isPointLight){if((E=t.get(x)).position.setFromMatrixPosition(x.matrixWorld),E.position.applyMatrix4(v),E.color.copy(x.color).multiplyScalar(x.intensity),E.distance=x.distance,E.decay=x.decay,E.shadow=x.castShadow,x.castShadow){T=x.shadow;E.shadowBias=T.bias,E.shadowRadius=T.radius,E.shadowMapSize=T.mapSize,E.shadowCameraNear=T.camera.near,E.shadowCameraFar=T.camera.far}e.pointShadowMap[f]=M,e.pointShadowMatrix[f]=x.shadow.matrix,e.point[f]=E,f++}else if(x.isHemisphereLight){var E;(E=t.get(x)).direction.setFromMatrixPosition(x.matrixWorld),E.direction.transformDirection(v),E.direction.normalize(),E.skyColor.copy(x.color).multiplyScalar(b),E.groundColor.copy(x.groundColor).multiplyScalar(b),e.hemi[g]=E,g++}}e.ambient[0]=u,e.ambient[1]=l,e.ambient[2]=c;var A=e.hash;A.directionalLength===p&&A.pointLength===f&&A.spotLength===d&&A.rectAreaLength===m&&A.hemiLength===g&&A.shadowsLength===a.length||(e.directional.length=p,e.spot.length=d,e.rectArea.length=m,e.point.length=f,e.hemi.length=g,A.directionalLength=p,A.pointLength=f,A.spotLength=d,A.rectAreaLength=m,A.hemiLength=g,A.shadowsLength=a.length,e.version=Uo++)},state:e}}function Vo(){var t=new zo,e=[],n=[];return{init:function(){e.length=0,n.length=0},state:{lightsArray:e,shadowsArray:n,lights:t},setupLights:function(r){t.setup(e,n,r)},pushLight:function(t){e.push(t)},pushShadow:function(t){n.push(t)}}}function Go(){var t={};function e(n){var r=n.target;r.removeEventListener("dispose",e),delete t[r.id]}return{get:function(n,r){var i;return void 0===t[n.id]?(i=new Vo,t[n.id]={},t[n.id][r.id]=i,n.addEventListener("dispose",e)):void 0===t[n.id][r.id]?(i=new Vo,t[n.id][r.id]=i):i=t[n.id][r.id],i},dispose:function(){t={}}}}function jo(t){vr.call(this),this.type="MeshDepthMaterial",this.depthPacking=We,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(t)}function Wo(t){vr.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new dn,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.lights=!1,this.setValues(t)}function Ho(t,e,n){for(var r=new ri,i=new In,o=new pn,a=new pn(n,n),s=new dn,u=new dn,l=1,c=2,h=1+(l|c),p=new Array(h),f=new Array(h),d={},m={0:b,1:_,2:w},g=[new dn(1,0,0),new dn(-1,0,0),new dn(0,0,1),new dn(0,0,-1),new dn(0,1,0),new dn(0,-1,0)],v=[new dn(0,1,0),new dn(0,1,0),new dn(0,1,0),new dn(0,1,0),new dn(0,0,1),new dn(0,0,-1)],x=[new Pn,new Pn,new Pn,new Pn,new Pn,new Pn],M=0;M!==h;++M){var S=0!=(M&l),T=0!=(M&c),E=new jo({depthPacking:He,morphTargets:S,skinning:T});p[M]=E;var A=new Wo({morphTargets:S,skinning:T});f[M]=A}var C=this;function L(e,n,r,i,o,a){var s=e.geometry,u=null,h=p,g=e.customDepthMaterial;if(r&&(h=f,g=e.customDistanceMaterial),g)u=g;else{var v=!1;n.morphTargets&&(s&&s.isBufferGeometry?v=s.morphAttributes&&s.morphAttributes.position&&s.morphAttributes.position.length>0:s&&s.isGeometry&&(v=s.morphTargets&&s.morphTargets.length>0)),e.isSkinnedMesh&&n.skinning;var y=e.isSkinnedMesh&&n.skinning,x=0;v&&(x|=l),y&&(x|=c),u=h[x]}if(t.localClippingEnabled&&!0===n.clipShadows&&0!==n.clippingPlanes.length){var _=u.uuid,b=n.uuid,w=d[_];void 0===w&&(w={},d[_]=w);var M=w[b];void 0===M&&(M=u.clone(),w[b]=M),u=M}return u.visible=n.visible,u.wireframe=n.wireframe,u.side=null!=n.shadowSide?n.shadowSide:m[n.side],u.clipShadows=n.clipShadows,u.clippingPlanes=n.clippingPlanes,u.clipIntersection=n.clipIntersection,u.wireframeLinewidth=n.wireframeLinewidth,u.linewidth=n.linewidth,r&&u.isMeshDistanceMaterial&&(u.referencePosition.copy(i),u.nearDistance=o,u.farDistance=a),u}function I(n,i,o,a){if(!1!==n.visible){if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&n.castShadow&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,n.matrixWorld);var s=e.update(n),l=n.material;if(Array.isArray(l))for(var c=s.groups,h=0,p=c.length;h<p;h++){var f=c[h],d=l[f.materialIndex];if(d&&d.visible){var m=L(n,d,a,u,o.near,o.far);t.renderBufferDirect(o,null,s,m,n,f)}}else if(l.visible){m=L(n,l,a,u,o.near,o.far);t.renderBufferDirect(o,null,s,m,n,null)}}for(var g=n.children,v=0,y=g.length;v<y;v++)I(g[v],i,o,a)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=y,this.render=function(e,n,l){if(!1!==C.enabled&&(!1!==C.autoUpdate||!1!==C.needsUpdate)&&0!==e.length){var c,h=t.getRenderTarget(),p=t.getActiveCubeFace(),f=t.getActiveMipmapLevel(),d=t.state;d.setBlending(P),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);for(var m=0,y=e.length;m<y;m++){var _=e[m],b=_.shadow,w=_&&_.isPointLight;if(void 0!==b){var M=b.camera;if(o.copy(b.mapSize),o.min(a),w){var S=o.x,T=o.y;x[0].set(2*S,T,S,T),x[1].set(0,T,S,T),x[2].set(3*S,T,S,T),x[3].set(S,T,S,T),x[4].set(3*S,0,S,T),x[5].set(S,0,S,T),o.x*=4,o.y*=2}if(null===b.map){var E={minFilter:St,magFilter:St,format:qt};b.map=new Cn(o.x,o.y,E),b.map.texture.name=_.name+".shadowMap",M.updateProjectionMatrix()}b.isSpotLightShadow&&b.update(_);var A=b.map,L=b.matrix;u.setFromMatrixPosition(_.matrixWorld),M.position.copy(u),w?(c=6,L.makeTranslation(-u.x,-u.y,-u.z)):(c=1,s.setFromMatrixPosition(_.target.matrixWorld),M.lookAt(s),M.updateMatrixWorld(),L.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),L.multiply(M.projectionMatrix),L.multiply(M.matrixWorldInverse)),t.setRenderTarget(A),t.clear();for(var O=0;O<c;O++){if(w){s.copy(M.position),s.add(g[O]),M.up.copy(v[O]),M.lookAt(s),M.updateMatrixWorld();var N=x[O];d.viewport(N)}i.multiplyMatrices(M.projectionMatrix,M.matrixWorldInverse),r.setFromMatrix(i),I(n,l,M,w)}}}C.needsUpdate=!1,t.setRenderTarget(h,p,f)}}}function Xo(t,e,n,r){var i=new function(){var e=!1,n=new Pn,r=null,i=new Pn(0,0,0,0);return{setMask:function(n){r===n||e||(t.colorMask(n,n,n,n),r=n)},setLocked:function(t){e=t},setClear:function(e,r,o,a,s){!0===s&&(e*=a,r*=a,o*=a),n.set(e,r,o,a),!1===i.equals(n)&&(t.clearColor(e,r,o,a),i.copy(n))},reset:function(){e=!1,r=null,i.set(-1,0,0,0)}}},o=new function(){var e=!1,n=null,r=null,i=null;return{setTest:function(t){t?ot(2929):at(2929)},setMask:function(r){n===r||e||(t.depthMask(r),n=r)},setFunc:function(e){if(r!==e){if(e)switch(e){case J:t.depthFunc(512);break;case K:t.depthFunc(519);break;case Q:t.depthFunc(513);break;case $:t.depthFunc(515);break;case tt:t.depthFunc(514);break;case et:t.depthFunc(518);break;case nt:t.depthFunc(516);break;case rt:t.depthFunc(517);break;default:t.depthFunc(515)}else t.depthFunc(515);r=e}},setLocked:function(t){e=t},setClear:function(e){i!==e&&(t.clearDepth(e),i=e)},reset:function(){e=!1,n=null,r=null,i=null}}},a=new function(){var e=!1,n=null,r=null,i=null,o=null,a=null,s=null,u=null,l=null;return{setTest:function(t){t?ot(2960):at(2960)},setMask:function(r){n===r||e||(t.stencilMask(r),n=r)},setFunc:function(e,n,a){r===e&&i===n&&o===a||(t.stencilFunc(e,n,a),r=e,i=n,o=a)},setOp:function(e,n,r){a===e&&s===n&&u===r||(t.stencilOp(e,n,r),a=e,s=n,u=r)},setLocked:function(t){e=t},setClear:function(e){l!==e&&(t.clearStencil(e),l=e)},reset:function(){e=!1,n=null,r=null,i=null,o=null,a=null,s=null,u=null,l=null}}},s=t.getParameter(34921),u=new Uint8Array(s),l=new Uint8Array(s),c=new Uint8Array(s),d={},m=null,g=null,v=null,y=null,x=null,_=null,M=null,S=null,T=null,E=null,A=!1,D=null,k=null,F=null,B=null,U=null,z=t.getParameter(35661),V=!1,G=0,j=t.getParameter(7938);-1!==j.indexOf("WebGL")?(G=parseFloat(/^WebGL\ ([0-9])/.exec(j)[1]),V=G>=1):-1!==j.indexOf("OpenGL ES")&&(G=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(j)[1]),V=G>=2);var W=null,H={},X=new Pn,Y=new Pn;function q(e,n,r){var i=new Uint8Array(4),o=t.createTexture();t.bindTexture(e,o),t.texParameteri(e,10241,9728),t.texParameteri(e,10240,9728);for(var a=0;a<r;a++)t.texImage2D(n+a,0,6408,1,1,0,6408,5121,i);return o}var Z={};function it(n,i){(u[n]=1,0===l[n]&&(t.enableVertexAttribArray(n),l[n]=1),c[n]!==i)&&((r.isWebGL2?t:e.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,i),c[n]=i)}function ot(e){!0!==d[e]&&(t.enable(e),d[e]=!0)}function at(e){!1!==d[e]&&(t.disable(e),d[e]=!1)}function st(e,r,i,o,a,s,u,l){if(e!==P){if(v||(ot(3042),v=!0),e===N)a=a||r,s=s||i,u=u||o,r===x&&a===S||(t.blendEquationSeparate(n.convert(r),n.convert(a)),x=r,S=a),i===_&&o===M&&s===T&&u===E||(t.blendFuncSeparate(n.convert(i),n.convert(o),n.convert(s),n.convert(u)),_=i,M=o,T=s,E=u),y=e,A=null;else if(e!==y||l!==A){if(x===R&&S===R||(t.blendEquation(32774),x=R,S=R),l)switch(e){case C:t.blendFuncSeparate(1,771,1,771);break;case L:t.blendFunc(1,1);break;case I:t.blendFuncSeparate(0,0,769,771);break;case O:t.blendFuncSeparate(0,768,0,770)}else switch(e){case C:t.blendFuncSeparate(770,771,1,771);break;case L:t.blendFunc(770,1);break;case I:t.blendFunc(0,769);break;case O:t.blendFunc(0,768)}_=null,M=null,T=null,E=null,y=e,A=l}}else v&&(at(3042),v=!1)}function ut(e){D!==e&&(e?t.frontFace(2304):t.frontFace(2305),D=e)}function lt(e){e!==h?(ot(2884),e!==k&&(e===p?t.cullFace(1029):e===f?t.cullFace(1028):t.cullFace(1032))):at(2884),k=e}function ct(e,n,r){e?(ot(32823),B===n&&U===r||(t.polygonOffset(n,r),B=n,U=r)):at(32823)}function ht(e){void 0===e&&(e=33984+z-1),W!==e&&(t.activeTexture(e),W=e)}return Z[3553]=q(3553,3553,1),Z[34067]=q(34067,34069,6),i.setClear(0,0,0,1),o.setClear(1),a.setClear(0),ot(2929),o.setFunc($),ut(!1),lt(p),ot(2884),st(P),{buffers:{color:i,depth:o,stencil:a},initAttributes:function(){for(var t=0,e=u.length;t<e;t++)u[t]=0},enableAttribute:function(t){it(t,0)},enableAttributeAndDivisor:it,disableUnusedAttributes:function(){for(var e=0,n=l.length;e!==n;++e)l[e]!==u[e]&&(t.disableVertexAttribArray(e),l[e]=0)},enable:ot,disable:at,getCompressedTextureFormats:function(){if(null===m&&(m=[],e.get("WEBGL_compressed_texture_pvrtc")||e.get("WEBGL_compressed_texture_s3tc")||e.get("WEBGL_compressed_texture_etc1")||e.get("WEBGL_compressed_texture_astc")))for(var n=t.getParameter(34467),r=0;r<n.length;r++)m.push(n[r]);return m},useProgram:function(e){return g!==e&&(t.useProgram(e),g=e,!0)},setBlending:st,setMaterial:function(t,e){t.side===w?at(2884):ot(2884);var n=t.side===b;e&&(n=!n),ut(n),t.blending===C&&!1===t.transparent?st(P):st(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),o.setFunc(t.depthFunc),o.setTest(t.depthTest),o.setMask(t.depthWrite),i.setMask(t.colorWrite);var r=t.stencilWrite;a.setTest(r),r&&(a.setFunc(t.stencilFunc,t.stencilRef,t.stencilMask),a.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),ct(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)},setFlipSided:ut,setCullFace:lt,setLineWidth:function(e){e!==F&&(V&&t.lineWidth(e),F=e)},setPolygonOffset:ct,setScissorTest:function(t){t?ot(3089):at(3089)},activeTexture:ht,bindTexture:function(e,n){null===W&&ht();var r=H[W];void 0===r&&(r={type:void 0,texture:void 0},H[W]=r),r.type===e&&r.texture===n||(t.bindTexture(e,n||Z[e]),r.type=e,r.texture=n)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(t){}},texImage3D:function(){try{t.texImage3D.apply(t,arguments)}catch(t){}},scissor:function(e){!1===X.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),X.copy(e))},viewport:function(e){!1===Y.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),Y.copy(e))},reset:function(){for(var e=0;e<l.length;e++)1===l[e]&&(t.disableVertexAttribArray(e),l[e]=0);d={},m=null,W=null,H={},g=null,y=null,D=null,k=null,i.reset(),o.reset(),a.reset()}}}function Yo(t,e,n,r,i,o,a){var s,u={},l="undefined"!=typeof OffscreenCanvas;function c(t,e){return l?new OffscreenCanvas(t,e):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function h(t,e,n,r){var i=1;if((t.width>r||t.height>r)&&(i=r/Math.max(t.width,t.height)),i<1||!0===e){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){var o=e?hn.floorPowerOfTwo:Math.floor,a=o(i*t.width),u=o(i*t.height);void 0===s&&(s=c(a,u));var l=n?c(a,u):s;return l.width=a,l.height=u,l.getContext("2d").drawImage(t,0,0,a,u),l}return t}return t}function p(t){return hn.isPowerOfTwo(t.width)&&hn.isPowerOfTwo(t.height)}function f(t,e){return t.generateMipmaps&&e&&t.minFilter!==St&&t.minFilter!==Ct}function d(e,n,i,o){t.generateMipmap(e),r.get(n).__maxMipLevel=Math.log(Math.max(i,o))*Math.LOG2E}function m(t,n){if(!i.isWebGL2)return t;var r=t;return 6403===t&&(5126===n&&(r=33326),5131===n&&(r=33325),5121===n&&(r=33321)),6407===t&&(5126===n&&(r=34837),5131===n&&(r=34843),5121===n&&(r=32849)),6408===t&&(5126===n&&(r=34836),5131===n&&(r=34842),5121===n&&(r=32856)),33325!==r&&33326!==r&&34842!==r&&34836!==r||e.get("EXT_color_buffer_float"),r}function g(t){return t===St||t===Tt||t===At?9728:9729}function v(e){var n=e.target;n.removeEventListener("dispose",v),function(e){var n=r.get(e);if(void 0===n.__webglInit)return;t.deleteTexture(n.__webglTexture),r.remove(e)}(n),n.isVideoTexture&&delete u[n.id],a.memory.textures--}function y(e){var n=e.target;n.removeEventListener("dispose",y),function(e){var n=r.get(e),i=r.get(e.texture);if(!e)return;void 0!==i.__webglTexture&&t.deleteTexture(i.__webglTexture);e.depthTexture&&e.depthTexture.dispose();if(e.isWebGLRenderTargetCube)for(var o=0;o<6;o++)t.deleteFramebuffer(n.__webglFramebuffer[o]),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer[o]);else t.deleteFramebuffer(n.__webglFramebuffer),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer);r.remove(e.texture),r.remove(e)}(n),a.memory.textures--}var x=0;function _(t,e){var i=r.get(t);if(t.isVideoTexture&&function(t){var e=t.id,n=a.render.frame;u[e]!==n&&(u[e]=n,t.update())}(t),t.version>0&&i.__version!==t.version){var o=t.image;if(void 0===o);else if(!1!==o.complete)return void T(i,t,e)}n.activeTexture(33984+e),n.bindTexture(3553,i.__webglTexture)}function b(e,a){var s=r.get(e);if(6===e.image.length)if(e.version>0&&s.__version!==e.version){S(s,e),n.activeTexture(33984+a),n.bindTexture(34067,s.__webglTexture),t.pixelStorei(37440,e.flipY);for(var u=e&&e.isCompressedTexture,l=e.image[0]&&e.image[0].isDataTexture,c=[],g=0;g<6;g++)c[g]=u||l?l?e.image[g].image:e.image[g]:h(e.image[g],!1,!0,i.maxCubemapSize);var v=c[0],y=p(v)||i.isWebGL2,x=o.convert(e.format),_=o.convert(e.type),b=m(x,_);M(34067,e,y);for(g=0;g<6;g++)if(u)for(var w,T=c[g].mipmaps,E=0,A=T.length;E<A;E++)w=T[E],e.format!==qt&&e.format!==Yt?n.getCompressedTextureFormats().indexOf(x)>-1&&n.compressedTexImage2D(34069+g,E,b,w.width,w.height,0,w.data):n.texImage2D(34069+g,E,b,w.width,w.height,0,x,_,w.data);else l?n.texImage2D(34069+g,0,b,c[g].width,c[g].height,0,x,_,c[g].data):n.texImage2D(34069+g,0,b,x,_,c[g]);s.__maxMipLevel=u?T.length-1:0,f(e,y)&&d(34067,e,v.width,v.height),s.__version=e.version,e.onUpdate&&e.onUpdate(e)}else n.activeTexture(33984+a),n.bindTexture(34067,s.__webglTexture)}function w(t,e){n.activeTexture(33984+e),n.bindTexture(34067,r.get(t).__webglTexture)}function M(n,a,s){var u;if(s?(t.texParameteri(n,10242,o.convert(a.wrapS)),t.texParameteri(n,10243,o.convert(a.wrapT)),32879!==n&&35866!==n||t.texParameteri(n,32882,o.convert(a.wrapR)),t.texParameteri(n,10240,o.convert(a.magFilter)),t.texParameteri(n,10241,o.convert(a.minFilter))):(t.texParameteri(n,10242,33071),t.texParameteri(n,10243,33071),32879!==n&&35866!==n||t.texParameteri(n,32882,33071),a.wrapS!==wt||a.wrapT,t.texParameteri(n,10240,g(a.magFilter)),t.texParameteri(n,10241,g(a.minFilter)),a.minFilter!==St&&a.minFilter),u=e.get("EXT_texture_filter_anisotropic")){if(a.type===zt&&null===e.get("OES_texture_float_linear"))return;if(a.type===Vt&&null===(i.isWebGL2||e.get("OES_texture_half_float_linear")))return;(a.anisotropy>1||r.get(a).__currentAnisotropy)&&(t.texParameterf(n,u.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,i.getMaxAnisotropy())),r.get(a).__currentAnisotropy=a.anisotropy)}}function S(e,n){void 0===e.__webglInit&&(e.__webglInit=!0,n.addEventListener("dispose",v),e.__webglTexture=t.createTexture(),a.memory.textures++)}function T(e,r,a){var s=3553;r.isDataTexture2DArray&&(s=35866),r.isDataTexture3D&&(s=32879),S(e,r),n.activeTexture(33984+a),n.bindTexture(s,e.__webglTexture),t.pixelStorei(37440,r.flipY),t.pixelStorei(37441,r.premultiplyAlpha),t.pixelStorei(3317,r.unpackAlignment);var u=function(t){return!i.isWebGL2&&(t.wrapS!==wt||t.wrapT!==wt||t.minFilter!==St&&t.minFilter!==Ct)}(r)&&!1===p(r.image),l=h(r.image,u,!1,i.maxTextureSize),c=p(l)||i.isWebGL2,g=o.convert(r.format),v=o.convert(r.type),y=m(g,v);M(s,r,c);var x,_=r.mipmaps;if(r.isDepthTexture){if(y=6402,r.type===zt){if(!i.isWebGL2)throw new Error("Float Depth Texture only supported in WebGL2.0");y=36012}else i.isWebGL2&&(y=33189);r.format===Qt&&6402===y&&r.type!==Ft&&r.type!==Ut&&(r.type=Ft,v=o.convert(r.type)),r.format===$t&&(y=34041,r.type!==Ht&&(r.type=Ht,v=o.convert(r.type))),n.texImage2D(3553,0,y,l.width,l.height,0,g,v,null)}else if(r.isDataTexture)if(_.length>0&&c){for(var b=0,w=_.length;b<w;b++)x=_[b],n.texImage2D(3553,b,y,x.width,x.height,0,g,v,x.data);r.generateMipmaps=!1,e.__maxMipLevel=_.length-1}else n.texImage2D(3553,0,y,l.width,l.height,0,g,v,l.data),e.__maxMipLevel=0;else if(r.isCompressedTexture){for(b=0,w=_.length;b<w;b++)x=_[b],r.format!==qt&&r.format!==Yt?n.getCompressedTextureFormats().indexOf(g)>-1&&n.compressedTexImage2D(3553,b,y,x.width,x.height,0,x.data):n.texImage2D(3553,b,y,x.width,x.height,0,g,v,x.data);e.__maxMipLevel=_.length-1}else if(r.isDataTexture2DArray)n.texImage3D(35866,0,y,l.width,l.height,l.depth,0,g,v,l.data),e.__maxMipLevel=0;else if(r.isDataTexture3D)n.texImage3D(32879,0,y,l.width,l.height,l.depth,0,g,v,l.data),e.__maxMipLevel=0;else if(_.length>0&&c){for(b=0,w=_.length;b<w;b++)x=_[b],n.texImage2D(3553,b,y,g,v,x);r.generateMipmaps=!1,e.__maxMipLevel=_.length-1}else n.texImage2D(3553,0,y,g,v,l),e.__maxMipLevel=0;f(r,c)&&d(3553,r,l.width,l.height),e.__version=r.version,r.onUpdate&&r.onUpdate(r)}function E(e,i,a,s){var u=o.convert(i.texture.format),l=o.convert(i.texture.type),c=m(u,l);n.texImage2D(s,0,c,i.width,i.height,0,u,l,null),t.bindFramebuffer(36160,e),t.framebufferTexture2D(36160,a,s,r.get(i.texture).__webglTexture,0),t.bindFramebuffer(36160,null)}function A(e,n,r){if(t.bindRenderbuffer(36161,e),n.depthBuffer&&!n.stencilBuffer){if(r){var i=C(n);t.renderbufferStorageMultisample(36161,i,33189,n.width,n.height)}else t.renderbufferStorage(36161,33189,n.width,n.height);t.framebufferRenderbuffer(36160,36096,36161,e)}else if(n.depthBuffer&&n.stencilBuffer){if(r){i=C(n);t.renderbufferStorageMultisample(36161,i,35056,n.width,n.height)}else t.renderbufferStorage(36161,34041,n.width,n.height);t.framebufferRenderbuffer(36160,33306,36161,e)}else{var a=m(o.convert(n.texture.format),o.convert(n.texture.type));if(r){i=C(n);t.renderbufferStorageMultisample(36161,i,a,n.width,n.height)}else t.renderbufferStorage(36161,a,n.width,n.height)}t.bindRenderbuffer(36161,null)}function P(e){var n=r.get(e),i=!0===e.isWebGLRenderTargetCube;if(e.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");!function(e,n){if(n&&n.isWebGLRenderTargetCube)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,e),!n.depthTexture||!n.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(n.depthTexture).__webglTexture&&n.depthTexture.image.width===n.width&&n.depthTexture.image.height===n.height||(n.depthTexture.image.width=n.width,n.depthTexture.image.height=n.height,n.depthTexture.needsUpdate=!0),_(n.depthTexture,0);var i=r.get(n.depthTexture).__webglTexture;if(n.depthTexture.format===Qt)t.framebufferTexture2D(36160,36096,3553,i,0);else{if(n.depthTexture.format!==$t)throw new Error("Unknown depthTexture format");t.framebufferTexture2D(36160,33306,3553,i,0)}}(n.__webglFramebuffer,e)}else if(i){n.__webglDepthbuffer=[];for(var o=0;o<6;o++)t.bindFramebuffer(36160,n.__webglFramebuffer[o]),n.__webglDepthbuffer[o]=t.createRenderbuffer(),A(n.__webglDepthbuffer[o],e)}else t.bindFramebuffer(36160,n.__webglFramebuffer),n.__webglDepthbuffer=t.createRenderbuffer(),A(n.__webglDepthbuffer,e);t.bindFramebuffer(36160,null)}function C(t){return i.isWebGL2&&t.isWebGLMultisampleRenderTarget?Math.min(i.maxSamples,t.samples):0}var L=!1,I=!1;this.allocateTextureUnit=function(){var t=x;return i.maxTextures,x+=1,t},this.resetTextureUnits=function(){x=0},this.setTexture2D=_,this.setTexture2DArray=function(t,e){var i=r.get(t);t.version>0&&i.__version!==t.version?T(i,t,e):(n.activeTexture(33984+e),n.bindTexture(35866,i.__webglTexture))},this.setTexture3D=function(t,e){var i=r.get(t);t.version>0&&i.__version!==t.version?T(i,t,e):(n.activeTexture(33984+e),n.bindTexture(32879,i.__webglTexture))},this.setTextureCube=b,this.setTextureCubeDynamic=w,this.setupRenderTarget=function(e){var s=r.get(e),u=r.get(e.texture);e.addEventListener("dispose",y),u.__webglTexture=t.createTexture(),a.memory.textures++;var l=!0===e.isWebGLRenderTargetCube,c=!0===e.isWebGLMultisampleRenderTarget,h=p(e)||i.isWebGL2;if(l){s.__webglFramebuffer=[];for(var g=0;g<6;g++)s.__webglFramebuffer[g]=t.createFramebuffer()}else if(s.__webglFramebuffer=t.createFramebuffer(),c&&i.isWebGL2){s.__webglMultisampledFramebuffer=t.createFramebuffer(),s.__webglColorRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(36161,s.__webglColorRenderbuffer);var v=m(o.convert(e.texture.format),o.convert(e.texture.type)),x=C(e);t.renderbufferStorageMultisample(36161,x,v,e.width,e.height),t.bindFramebuffer(36160,s.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064,36161,s.__webglColorRenderbuffer),t.bindRenderbuffer(36161,null),e.depthBuffer&&(s.__webglDepthRenderbuffer=t.createRenderbuffer(),A(s.__webglDepthRenderbuffer,e,!0)),t.bindFramebuffer(36160,null)}if(l){n.bindTexture(34067,u.__webglTexture),M(34067,e.texture,h);for(g=0;g<6;g++)E(s.__webglFramebuffer[g],e,36064,34069+g);f(e.texture,h)&&d(34067,e.texture,e.width,e.height),n.bindTexture(34067,null)}else n.bindTexture(3553,u.__webglTexture),M(3553,e.texture,h),E(s.__webglFramebuffer,e,36064,3553),f(e.texture,h)&&d(3553,e.texture,e.width,e.height),n.bindTexture(3553,null);e.depthBuffer&&P(e)},this.updateRenderTargetMipmap=function(t){var e=t.texture;if(f(e,p(t)||i.isWebGL2)){var o=t.isWebGLRenderTargetCube?34067:3553,a=r.get(e).__webglTexture;n.bindTexture(o,a),d(o,e,t.width,t.height),n.bindTexture(o,null)}},this.updateMultisampleRenderTarget=function(e){if(e.isWebGLMultisampleRenderTarget&&i.isWebGL2){var n=r.get(e);t.bindFramebuffer(36008,n.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,n.__webglFramebuffer);var o=e.width,a=e.height,s=16384;e.depthBuffer&&(s|=256),e.stencilBuffer&&(s|=1024),t.blitFramebuffer(0,0,o,a,0,0,o,a,s,9728)}},this.safeSetTexture2D=function(t,e){t&&t.isWebGLRenderTarget&&(!1===L&&(L=!0),t=t.texture),_(t,e)},this.safeSetTextureCube=function(t,e){t&&t.isWebGLRenderTargetCube&&(!1===I&&(I=!0),t=t.texture),t&&t.isCubeTexture||Array.isArray(t.image)&&6===t.image.length?b(t,e):w(t,e)}}function qo(t,e,n){return{convert:function(t){var r;if(t===bt)return 10497;if(t===wt)return 33071;if(t===Mt)return 33648;if(t===St)return 9728;if(t===Tt)return 9984;if(t===At)return 9986;if(t===Ct)return 9729;if(t===Lt)return 9985;if(t===Ot)return 9987;if(t===Rt)return 5121;if(t===Gt)return 32819;if(t===jt)return 32820;if(t===Wt)return 33635;if(t===Dt)return 5120;if(t===kt)return 5122;if(t===Ft)return 5123;if(t===Bt)return 5124;if(t===Ut)return 5125;if(t===zt)return 5126;if(t===Vt){if(n.isWebGL2)return 5131;if(null!==(r=e.get("OES_texture_half_float")))return r.HALF_FLOAT_OES}if(t===Xt)return 6406;if(t===Yt)return 6407;if(t===qt)return 6408;if(t===Zt)return 6409;if(t===Jt)return 6410;if(t===Qt)return 6402;if(t===$t)return 34041;if(t===te)return 6403;if(t===R)return 32774;if(t===D)return 32778;if(t===k)return 32779;if(t===U)return 0;if(t===z)return 1;if(t===V)return 768;if(t===G)return 769;if(t===j)return 770;if(t===W)return 771;if(t===H)return 772;if(t===X)return 773;if(t===Y)return 774;if(t===q)return 775;if(t===Z)return 776;if((t===ee||t===ne||t===re||t===ie)&&null!==(r=e.get("WEBGL_compressed_texture_s3tc"))){if(t===ee)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(t===ne)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(t===re)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(t===ie)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((t===oe||t===ae||t===se||t===ue)&&null!==(r=e.get("WEBGL_compressed_texture_pvrtc"))){if(t===oe)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(t===ae)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(t===se)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(t===ue)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(t===le&&null!==(r=e.get("WEBGL_compressed_texture_etc1")))return r.COMPRESSED_RGB_ETC1_WEBGL;if((t===ce||t===he||t===pe||t===fe||t===de||t===me||t===ge||t===ve||t===ye||t===xe||t===_e||t===be||t===we||t===Me)&&null!==(r=e.get("WEBGL_compressed_texture_astc")))return t;if(t===F||t===B){if(n.isWebGL2){if(t===F)return 32775;if(t===B)return 32776}if(null!==(r=e.get("EXT_blend_minmax"))){if(t===F)return r.MIN_EXT;if(t===B)return r.MAX_EXT}}if(t===Ht){if(n.isWebGL2)return 34042;if(null!==(r=e.get("WEBGL_depth_texture")))return r.UNSIGNED_INT_24_8_WEBGL}return 0}}}function Zo(){er.call(this),this.type="Group"}function Jo(t){qr.call(this),this.cameras=t||[]}jo.prototype=Object.create(vr.prototype),jo.prototype.constructor=jo,jo.prototype.isMeshDepthMaterial=!0,jo.prototype.copy=function(t){return vr.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},Wo.prototype=Object.create(vr.prototype),Wo.prototype.constructor=Wo,Wo.prototype.isMeshDistanceMaterial=!0,Wo.prototype.copy=function(t){return vr.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this},Zo.prototype=Object.assign(Object.create(er.prototype),{constructor:Zo,isGroup:!0}),Jo.prototype=Object.assign(Object.create(qr.prototype),{constructor:Jo,isArrayCamera:!0});var Ko,Qo,$o,ta,ea,na,ra=new dn,ia=new dn;function oa(t,e,n){ra.setFromMatrixPosition(e.matrixWorld),ia.setFromMatrixPosition(n.matrixWorld);var r=ra.distanceTo(ia),i=e.projectionMatrix.elements,o=n.projectionMatrix.elements,a=i[14]/(i[10]-1),s=i[14]/(i[10]+1),u=(i[9]+1)/i[5],l=(i[9]-1)/i[5],c=(i[8]-1)/i[0],h=(o[8]+1)/o[0],p=a*c,f=a*h,d=r/(-c+h),m=d*-c;e.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(m),t.translateZ(d),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.getInverse(t.matrixWorld);var g=a+d,v=s+d,y=p-m,x=f+(r-m),_=u*s/v*g,b=l*s/v*g;t.projectionMatrix.makePerspective(y,x,_,b,g,v)}function aa(t){var e,n,r=this,i=null,o=null,a=null,s=[],u=new In,l=new In,c=1,h="local-floor";"undefined"!=typeof window&&"VRFrameData"in window&&(o=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",b,!1));var p=new In,f=new fn,d=new dn,m=new qr;m.viewport=new Pn,m.layers.enable(1);var g=new qr;g.viewport=new Pn,g.layers.enable(2);var v=new Jo([m,g]);function y(){return null!==i&&!0===i.isPresenting}v.layers.enable(1),v.layers.enable(2);var x,_=new pn;function b(){if(y()){var o=i.getEyeParameters("left");e=2*o.renderWidth*c,n=o.renderHeight*c,x=t.getPixelRatio(),t.getSize(_),t.setDrawingBufferSize(e,n,1),m.viewport.set(0,0,e/2,n),g.viewport.set(e/2,0,e/2,n),T.start(),r.dispatchEvent({type:"sessionstart"})}else r.enabled&&t.setDrawingBufferSize(_.width,_.height,x),T.stop(),r.dispatchEvent({type:"sessionend"})}var w=[];function M(t){for(var e=navigator.getGamepads&&navigator.getGamepads(),n=0,r=0,i=e.length;n<i;n++){var o=e[n];if(o&&("Daydream Controller"===o.id||"Gear VR Controller"===o.id||"Oculus Go Controller"===o.id||"OpenVR Gamepad"===o.id||o.id.startsWith("Oculus Touch")||o.id.startsWith("HTC Vive Focus")||o.id.startsWith("Spatial Controller"))){if(r===t)return o;r++}}}function S(t,r){null!==r&&4===r.length&&t.set(r[0]*e,r[1]*n,r[2]*e,r[3]*n)}this.enabled=!1,this.getController=function(t){var e=s[t];return void 0===e&&((e=new Zo).matrixAutoUpdate=!1,e.visible=!1,s[t]=e),e},this.getDevice=function(){return i},this.setDevice=function(t){void 0!==t&&(i=t),T.setContext(t)},this.setFramebufferScaleFactor=function(t){c=t},this.setReferenceSpaceType=function(t){h=t},this.setPoseTarget=function(t){void 0!==t&&(a=t)},this.getCamera=function(t){var e="local-floor"===h?1.6:0;if(!1===y())return t.position.set(0,e,0),t.rotation.set(0,0,0),t;if(i.depthNear=t.near,i.depthFar=t.far,i.getFrameData(o),"local-floor"===h){var n=i.stageParameters;n?u.fromArray(n.sittingToStandingTransform):u.makeTranslation(0,e,0)}var r=o.pose,c=null!==a?a:t;c.matrix.copy(u),c.matrix.decompose(c.position,c.quaternion,c.scale),null!==r.orientation&&(f.fromArray(r.orientation),c.quaternion.multiply(f)),null!==r.position&&(f.setFromRotationMatrix(u),d.fromArray(r.position),d.applyQuaternion(f),c.position.add(d)),c.updateMatrixWorld(),m.near=t.near,g.near=t.near,m.far=t.far,g.far=t.far,m.matrixWorldInverse.fromArray(o.leftViewMatrix),g.matrixWorldInverse.fromArray(o.rightViewMatrix),l.getInverse(u),"local-floor"===h&&(m.matrixWorldInverse.multiply(l),g.matrixWorldInverse.multiply(l));var x=c.parent;null!==x&&(p.getInverse(x.matrixWorld),m.matrixWorldInverse.multiply(p),g.matrixWorldInverse.multiply(p)),m.matrixWorld.getInverse(m.matrixWorldInverse),g.matrixWorld.getInverse(g.matrixWorldInverse),m.projectionMatrix.fromArray(o.leftProjectionMatrix),g.projectionMatrix.fromArray(o.rightProjectionMatrix),oa(v,m,g);var _=i.getLayers();if(_.length){var b=_[0];S(m.viewport,b.leftBounds),S(g.viewport,b.rightBounds)}return function(){for(var t=0;t<s.length;t++){var e=s[t],n=M(t);if(void 0!==n&&void 0!==n.pose){if(null===n.pose)return;var r=n.pose;!1===r.hasPosition&&e.position.set(.2,-.6,-.05),null!==r.position&&e.position.fromArray(r.position),null!==r.orientation&&e.quaternion.fromArray(r.orientation),e.matrix.compose(e.position,e.quaternion,e.scale),e.matrix.premultiply(u),e.matrix.decompose(e.position,e.quaternion,e.scale),e.matrixWorldNeedsUpdate=!0,e.visible=!0;var i="Daydream Controller"===n.id?0:1;void 0===w[t]&&(w[t]=!1),w[t]!==n.buttons[i].pressed&&(w[t]=n.buttons[i].pressed,!0===w[t]?e.dispatchEvent({type:"selectstart"}):(e.dispatchEvent({type:"selectend"}),e.dispatchEvent({type:"select"})))}else e.visible=!1}}(),v},this.getStandingMatrix=function(){return u},this.isPresenting=y;var T=new si;this.setAnimationLoop=function(t){T.setAnimationLoop(t),y()&&T.start()},this.submitFrame=function(){y()&&i.submitFrame()},this.dispose=function(){"undefined"!=typeof window&&window.removeEventListener("vrdisplaypresentchange",b)},this.setFrameOfReferenceType=function(){}}function sa(t,e){var n=this,r=null,i=null,o="local-floor",a=null,s=[],u=[];function l(){return null!==r&&null!==i}var c=new qr;c.layers.enable(1),c.viewport=new Pn;var h=new qr;h.layers.enable(2),h.viewport=new Pn;var p=new Jo([c,h]);function f(t){for(var e=0;e<s.length;e++)u[e]===t.inputSource&&s[e].dispatchEvent({type:t.type})}function d(){t.setFramebuffer(null),t.setRenderTarget(t.getRenderTarget()),y.stop(),n.dispatchEvent({type:"sessionend"})}function m(t){i=t,y.setContext(r),y.start(),n.dispatchEvent({type:"sessionstart"})}function g(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.getInverse(t.matrixWorld)}p.layers.enable(1),p.layers.enable(2),this.enabled=!1,this.getController=function(t){var e=s[t];return void 0===e&&((e=new Zo).matrixAutoUpdate=!1,e.visible=!1,s[t]=e),e},this.setFramebufferScaleFactor=function(t){},this.setReferenceSpaceType=function(t){o=t},this.getSession=function(){return r},this.setSession=function(t){null!==(r=t)&&(r.addEventListener("select",f),r.addEventListener("selectstart",f),r.addEventListener("selectend",f),r.addEventListener("end",d),r.updateRenderState({baseLayer:new XRWebGLLayer(r,e)}),r.requestReferenceSpace(o).then(m),u=r.inputSources,r.addEventListener("inputsourceschange",(function(){u=r.inputSources;for(var t=0;t<s.length;t++){s[t].userData.inputSource=u[t]}})))},this.getCamera=function(t){if(l()){var e=t.parent,n=p.cameras;g(p,e);for(var r=0;r<n.length;r++)g(n[r],e);t.matrixWorld.copy(p.matrixWorld);for(var i=t.children,o=(r=0,i.length);r<o;r++)i[r].updateMatrixWorld(!0);return oa(p,c,h),p}return t},this.isPresenting=l;var v=null;var y=new si;y.setAnimationLoop((function(e,n){if(null!==(a=n.getViewerPose(i))){var o=a.views,l=r.renderState.baseLayer;t.setFramebuffer(l.framebuffer);for(var c=0;c<o.length;c++){var h=o[c],f=l.getViewport(h),d=h.transform.inverse.matrix,m=p.cameras[c];m.matrix.fromArray(d).getInverse(m.matrix),m.projectionMatrix.fromArray(h.projectionMatrix),m.viewport.set(f.x,f.y,f.width,f.height),0===c&&p.matrix.copy(m.matrix)}}for(c=0;c<s.length;c++){var g=s[c],y=u[c];if(y){var x=n.getPose(y.targetRaySpace,i);if(null!==x){g.matrix.fromArray(x.transform.matrix),g.matrix.decompose(g.position,g.rotation,g.scale),g.visible=!0;continue}}g.visible=!1}v&&v(e)})),this.setAnimationLoop=function(t){v=t},this.dispose=function(){},this.getStandingMatrix=function(){return new In},this.getDevice=function(){},this.setDevice=function(){},this.setFrameOfReferenceType=function(){},this.submitFrame=function(){}}function ua(t){var e=void 0!==(t=t||{}).canvas?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),n=void 0!==t.context?t.context:null,r=void 0!==t.alpha&&t.alpha,i=void 0===t.depth||t.depth,o=void 0===t.stencil||t.stencil,a=void 0!==t.antialias&&t.antialias,s=void 0===t.premultipliedAlpha||t.premultipliedAlpha,u=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,l=void 0!==t.powerPreference?t.powerPreference:"default",c=void 0!==t.failIfMajorPerformanceCaveat&&t.failIfMajorPerformanceCaveat,h=null,p=null;this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=ut,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var f,d,m,g,v,y,x,_,w,M,S,T,E,A,P,C,L,I,O=this,N=!1,R=null,D=0,k=0,F=null,B=null,U=-1,z={geometry:null,program:null,wireframe:!1},V=null,G=null,j=new Pn,W=new Pn,H=null,X=e.width,Y=e.height,q=1,Z=new Pn(0,0,X,Y),J=new Pn(0,0,X,Y),K=!1,Q=new ri,$=new di,tt=!1,et=!1,nt=new In,rt=new dn;function it(){return null===F?q:1}try{var ot={alpha:r,depth:i,stencil:o,antialias:a,premultipliedAlpha:s,preserveDrawingBuffer:u,powerPreference:l,failIfMajorPerformanceCaveat:c,xrCompatible:!0};if(e.addEventListener("webglcontextlost",ct,!1),e.addEventListener("webglcontextrestored",ht,!1),null===(f=n||e.getContext("webgl",ot)||e.getContext("experimental-webgl",ot)))throw null!==e.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===f.getShaderPrecisionFormat&&(f.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(t){throw t}function at(){d=new mi(f),(m=new fi(f,d,t)).isWebGL2||(d.get("WEBGL_depth_texture"),d.get("OES_texture_float"),d.get("OES_texture_half_float"),d.get("OES_texture_half_float_linear"),d.get("OES_standard_derivatives"),d.get("OES_element_index_uint"),d.get("ANGLE_instanced_arrays")),d.get("OES_texture_float_linear"),I=new qo(f,d,m),(g=new Xo(f,d,I,m)).scissor(W.copy(J).multiplyScalar(q).floor()),g.viewport(j.copy(Z).multiplyScalar(q).floor()),v=new yi(f),y=new No,x=new Yo(f,d,g,y,m,I,v),_=new ui(f),w=new gi(f,_,v),M=new bi(w,v),P=new _i(f),S=new Oo(O,d,m),T=new Fo,E=new Go,A=new hi(O,g,M,s),C=new pi(f,d,v,m),L=new vi(f,d,v,m),v.programs=S.programs,O.capabilities=m,O.extensions=d,O.properties=y,O.renderLists=T,O.state=g,O.info=v}at();var st="undefined"!=typeof navigator&&"xr"in navigator&&"supportsSession"in navigator.xr?new sa(O,f):new aa(O);this.vr=st;var lt=new Ho(O,M,m.maxTextureSize);function ct(t){t.preventDefault(),N=!0}function ht(){N=!1,at()}function pt(t){var e=t.target;e.removeEventListener("dispose",pt),function(t){ft(t),y.remove(t)}(e)}function ft(t){var e=y.get(t).program;t.program=void 0,void 0!==e&&S.releaseProgram(e)}this.shadowMap=lt,this.getContext=function(){return f},this.getContextAttributes=function(){return f.getContextAttributes()},this.forceContextLoss=function(){var t=d.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){var t=d.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return q},this.setPixelRatio=function(t){void 0!==t&&(q=t,this.setSize(X,Y,!1))},this.getSize=function(t){return void 0===t&&(t=new pn),t.set(X,Y)},this.setSize=function(t,n,r){st.isPresenting()||(X=t,Y=n,e.width=Math.floor(t*q),e.height=Math.floor(n*q),!1!==r&&(e.style.width=t+"px",e.style.height=n+"px"),this.setViewport(0,0,t,n))},this.getDrawingBufferSize=function(t){return void 0===t&&(t=new pn),t.set(X*q,Y*q).floor()},this.setDrawingBufferSize=function(t,n,r){X=t,Y=n,q=r,e.width=Math.floor(t*r),e.height=Math.floor(n*r),this.setViewport(0,0,t,n)},this.getCurrentViewport=function(t){return void 0===t&&(t=new Pn),t.copy(j)},this.getViewport=function(t){return t.copy(Z)},this.setViewport=function(t,e,n,r){t.isVector4?Z.set(t.x,t.y,t.z,t.w):Z.set(t,e,n,r),g.viewport(j.copy(Z).multiplyScalar(q).floor())},this.getScissor=function(t){return t.copy(J)},this.setScissor=function(t,e,n,r){t.isVector4?J.set(t.x,t.y,t.z,t.w):J.set(t,e,n,r),g.scissor(W.copy(J).multiplyScalar(q).floor())},this.getScissorTest=function(){return K},this.setScissorTest=function(t){g.setScissorTest(K=t)},this.getClearColor=function(){return A.getClearColor()},this.setClearColor=function(){A.setClearColor.apply(A,arguments)},this.getClearAlpha=function(){return A.getClearAlpha()},this.setClearAlpha=function(){A.setClearAlpha.apply(A,arguments)},this.clear=function(t,e,n){var r=0;(void 0===t||t)&&(r|=16384),(void 0===e||e)&&(r|=256),(void 0===n||n)&&(r|=1024),f.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",ct,!1),e.removeEventListener("webglcontextrestored",ht,!1),T.dispose(),E.dispose(),y.dispose(),M.dispose(),st.dispose(),mt.stop()},this.renderBufferImmediate=function(t,e){g.initAttributes();var n=y.get(t);t.hasPositions&&!n.position&&(n.position=f.createBuffer()),t.hasNormals&&!n.normal&&(n.normal=f.createBuffer()),t.hasUvs&&!n.uv&&(n.uv=f.createBuffer()),t.hasColors&&!n.color&&(n.color=f.createBuffer());var r=e.getAttributes();t.hasPositions&&(f.bindBuffer(34962,n.position),f.bufferData(34962,t.positionArray,35048),g.enableAttribute(r.position),f.vertexAttribPointer(r.position,3,5126,!1,0,0)),t.hasNormals&&(f.bindBuffer(34962,n.normal),f.bufferData(34962,t.normalArray,35048),g.enableAttribute(r.normal),f.vertexAttribPointer(r.normal,3,5126,!1,0,0)),t.hasUvs&&(f.bindBuffer(34962,n.uv),f.bufferData(34962,t.uvArray,35048),g.enableAttribute(r.uv),f.vertexAttribPointer(r.uv,2,5126,!1,0,0)),t.hasColors&&(f.bindBuffer(34962,n.color),f.bufferData(34962,t.colorArray,35048),g.enableAttribute(r.color),f.vertexAttribPointer(r.color,3,5126,!1,0,0)),g.disableUnusedAttributes(),f.drawArrays(4,0,t.count),t.count=0},this.renderBufferDirect=function(t,e,n,r,i,o){var a=i.isMesh&&i.matrixWorld.determinant()<0;g.setMaterial(r,a);var s=_t(t,e,r,i),u=!1;z.geometry===n.id&&z.program===s.id&&z.wireframe===(!0===r.wireframe)||(z.geometry=n.id,z.program=s.id,z.wireframe=!0===r.wireframe,u=!0),i.morphTargetInfluences&&(P.update(i,n,r,s),u=!0);var l,c=n.index,h=n.attributes.position,p=1;!0===r.wireframe&&(c=w.getWireframeAttribute(n),p=2);var v=C;null!==c&&(l=_.get(c),(v=L).setIndex(l)),u&&(!function(t,e,n){if(n&&n.isInstancedBufferGeometry&&!m.isWebGL2&&null===d.get("ANGLE_instanced_arrays"))return;g.initAttributes();var r=n.attributes,i=e.getAttributes(),o=t.defaultAttributeValues;for(var a in i){var s=i[a];if(s>=0){var u=r[a];if(void 0!==u){var l=u.normalized,c=u.itemSize,h=_.get(u);if(void 0===h)continue;var p=h.buffer,v=h.type,y=h.bytesPerElement;if(u.isInterleavedBufferAttribute){var x=u.data,b=x.stride,w=u.offset;x&&x.isInstancedInterleavedBuffer?(g.enableAttributeAndDivisor(s,x.meshPerAttribute),void 0===n.maxInstancedCount&&(n.maxInstancedCount=x.meshPerAttribute*x.count)):g.enableAttribute(s),f.bindBuffer(34962,p),f.vertexAttribPointer(s,c,v,l,b*y,w*y)}else u.isInstancedBufferAttribute?(g.enableAttributeAndDivisor(s,u.meshPerAttribute),void 0===n.maxInstancedCount&&(n.maxInstancedCount=u.meshPerAttribute*u.count)):g.enableAttribute(s),f.bindBuffer(34962,p),f.vertexAttribPointer(s,c,v,l,0,0)}else if(void 0!==o){var M=o[a];if(void 0!==M)switch(M.length){case 2:f.vertexAttrib2fv(s,M);break;case 3:f.vertexAttrib3fv(s,M);break;case 4:f.vertexAttrib4fv(s,M);break;default:f.vertexAttrib1fv(s,M)}}}}g.disableUnusedAttributes()}(r,s,n),null!==c&&f.bindBuffer(34963,l.buffer));var y=1/0;null!==c?y=c.count:void 0!==h&&(y=h.count);var x=n.drawRange.start*p,b=n.drawRange.count*p,M=null!==o?o.start*p:0,S=null!==o?o.count*p:1/0,T=Math.max(x,M),E=Math.min(y,x+b,M+S)-1,A=Math.max(0,E-T+1);if(0!==A){if(i.isMesh)if(!0===r.wireframe)g.setLineWidth(r.wireframeLinewidth*it()),v.setMode(1);else switch(i.drawMode){case Ne:v.setMode(4);break;case Re:v.setMode(5);break;case De:v.setMode(6)}else if(i.isLine){var I=r.linewidth;void 0===I&&(I=1),g.setLineWidth(I*it()),i.isLineSegments?v.setMode(1):i.isLineLoop?v.setMode(2):v.setMode(3)}else i.isPoints?v.setMode(0):i.isSprite&&v.setMode(4);n&&n.isInstancedBufferGeometry?n.maxInstancedCount>0&&v.renderInstances(n,T,A):v.render(T,A)}},this.compile=function(t,e){(p=E.get(t,e)).init(),t.traverse((function(t){t.isLight&&(p.pushLight(t),t.castShadow&&p.pushShadow(t))})),p.setupLights(e),t.traverse((function(e){if(e.material)if(Array.isArray(e.material))for(var n=0;n<e.material.length;n++)xt(e.material[n],t.fog,e);else xt(e.material,t.fog,e)}))};var dt=null;var mt=new si;function gt(t,e,n,r){if(!1!==t.visible){if(t.layers.test(e.layers))if(t.isGroup)n=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(e);else if(t.isLight)p.pushLight(t),t.castShadow&&p.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||Q.intersectsSprite(t)){r&&rt.setFromMatrixPosition(t.matrixWorld).applyMatrix4(nt);var i=M.update(t);(o=t.material).visible&&h.push(t,i,o,n,rt.z,null)}}else if(t.isImmediateRenderObject)r&&rt.setFromMatrixPosition(t.matrixWorld).applyMatrix4(nt),h.push(t,null,t.material,n,rt.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.update(),!t.frustumCulled||Q.intersectsObject(t))){r&&rt.setFromMatrixPosition(t.matrixWorld).applyMatrix4(nt);i=M.update(t);var o=t.material;if(Array.isArray(o))for(var a=i.groups,s=0,u=a.length;s<u;s++){var l=a[s],c=o[l.materialIndex];c&&c.visible&&h.push(t,i,c,n,rt.z,l)}else o.visible&&h.push(t,i,o,n,rt.z,null)}var f=t.children;for(s=0,u=f.length;s<u;s++)gt(f[s],e,n,r)}}function vt(t,e,n,r){for(var i=0,o=t.length;i<o;i++){var a=t[i],s=a.object,u=a.geometry,l=void 0===r?a.material:r,c=a.group;if(n.isArrayCamera){G=n;for(var h=n.cameras,f=0,d=h.length;f<d;f++){var m=h[f];s.layers.test(m.layers)&&(g.viewport(j.copy(m.viewport)),p.setupLights(m),yt(s,e,m,u,l,c))}}else G=null,yt(s,e,n,u,l,c)}}function yt(t,e,n,r,i,o){if(t.onBeforeRender(O,e,n,r,i,o),p=E.get(e,G||n),t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),t.isImmediateRenderObject){g.setMaterial(i);var a=_t(n,e.fog,i,t);z.geometry=null,z.program=null,z.wireframe=!1,function(t,e){t.render((function(t){O.renderBufferImmediate(t,e)}))}(t,a)}else O.renderBufferDirect(n,e.fog,r,i,t,o);t.onAfterRender(O,e,n,r,i,o),p=E.get(e,G||n)}function xt(t,e,n){var r=y.get(t),i=p.state.lights,o=p.state.shadowsArray,a=i.state.version,s=S.getParameters(t,i.state,o,e,$.numPlanes,$.numIntersection,n),u=S.getProgramCode(t,s),l=r.program,c=!0;if(void 0===l)t.addEventListener("dispose",pt);else if(l.code!==u)ft(t);else if(r.lightsStateVersion!==a)r.lightsStateVersion=a,c=!1;else{if(void 0!==s.shaderID)return;c=!1}if(c){if(s.shaderID){var h=ai[s.shaderID];r.shader={name:t.type,uniforms:Vr(h.uniforms),vertexShader:h.vertexShader,fragmentShader:h.fragmentShader}}else r.shader={name:t.type,uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader};t.onBeforeCompile(r.shader,O),u=S.getProgramCode(t,s),l=S.acquireProgram(t,r.shader,s,u),r.program=l,t.program=l}var f=l.getAttributes();if(t.morphTargets){t.numSupportedMorphTargets=0;for(var d=0;d<O.maxMorphTargets;d++)f["morphTarget"+d]>=0&&t.numSupportedMorphTargets++}if(t.morphNormals){t.numSupportedMorphNormals=0;for(d=0;d<O.maxMorphNormals;d++)f["morphNormal"+d]>=0&&t.numSupportedMorphNormals++}var m=r.shader.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(r.numClippingPlanes=$.numPlanes,r.numIntersection=$.numIntersection,m.clippingPlanes=$.uniform),r.fog=e,r.lightsStateVersion=a,t.lights&&(m.ambientLightColor.value=i.state.ambient,m.lightProbe.value=i.state.probe,m.directionalLights.value=i.state.directional,m.spotLights.value=i.state.spot,m.rectAreaLights.value=i.state.rectArea,m.pointLights.value=i.state.point,m.hemisphereLights.value=i.state.hemi,m.directionalShadowMap.value=i.state.directionalShadowMap,m.directionalShadowMatrix.value=i.state.directionalShadowMatrix,m.spotShadowMap.value=i.state.spotShadowMap,m.spotShadowMatrix.value=i.state.spotShadowMatrix,m.pointShadowMap.value=i.state.pointShadowMap,m.pointShadowMatrix.value=i.state.pointShadowMatrix);var g=r.program.getUniforms(),v=xo.seqWithValue(g.seq,m);r.uniformsList=v}function _t(t,e,n,r){x.resetTextureUnits();var i=y.get(n),o=p.state.lights;if(tt&&(et||t!==V)){var a=t===V&&n.id===U;$.setState(n.clippingPlanes,n.clipIntersection,n.clipShadows,t,i,a)}!1===n.needsUpdate&&(void 0===i.program||n.fog&&i.fog!==e||n.lights&&i.lightsStateVersion!==o.state.version?n.needsUpdate=!0:void 0===i.numClippingPlanes||i.numClippingPlanes===$.numPlanes&&i.numIntersection===$.numIntersection||(n.needsUpdate=!0)),n.needsUpdate&&(xt(n,e,r),n.needsUpdate=!1);var s,u,l=!1,c=!1,h=!1,d=i.program,v=d.getUniforms(),_=i.shader.uniforms;if(g.useProgram(d.program)&&(l=!0,c=!0,h=!0),n.id!==U&&(U=n.id,c=!0),l||V!==t){if(v.setValue(f,"projectionMatrix",t.projectionMatrix),m.logarithmicDepthBuffer&&v.setValue(f,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),V!==t&&(V=t,c=!0,h=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshStandardMaterial||n.envMap){var w=v.map.cameraPosition;void 0!==w&&w.setValue(f,rt.setFromMatrixPosition(t.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.skinning)&&v.setValue(f,"viewMatrix",t.matrixWorldInverse)}if(n.skinning){v.setOptional(f,r,"bindMatrix"),v.setOptional(f,r,"bindMatrixInverse");var M=r.skeleton;if(M){var S=M.bones;if(m.floatVertexTextures){if(void 0===M.boneTexture){var T=Math.sqrt(4*S.length);T=hn.ceilPowerOfTwo(T),T=Math.max(T,4);var E=new Float32Array(T*T*4);E.set(M.boneMatrices);var A=new ei(E,T,T,qt,zt);A.needsUpdate=!0,M.boneMatrices=E,M.boneTexture=A,M.boneTextureSize=T}v.setValue(f,"boneTexture",M.boneTexture,x),v.setValue(f,"boneTextureSize",M.boneTextureSize)}else v.setOptional(f,M,"boneMatrices")}}return c&&(v.setValue(f,"toneMappingExposure",O.toneMappingExposure),v.setValue(f,"toneMappingWhitePoint",O.toneMappingWhitePoint),n.lights&&(u=h,(s=_).ambientLightColor.needsUpdate=u,s.lightProbe.needsUpdate=u,s.directionalLights.needsUpdate=u,s.pointLights.needsUpdate=u,s.spotLights.needsUpdate=u,s.rectAreaLights.needsUpdate=u,s.hemisphereLights.needsUpdate=u),e&&n.fog&&function(t,e){t.fogColor.value.copy(e.color),e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)}(_,e),n.isMeshBasicMaterial?bt(_,n):n.isMeshLambertMaterial?(bt(_,n),function(t,e){e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap)}(_,n)):n.isMeshPhongMaterial?(bt(_,n),n.isMeshToonMaterial?function(t,e){wt(t,e),e.gradientMap&&(t.gradientMap.value=e.gradientMap)}(_,n):wt(_,n)):n.isMeshStandardMaterial?(bt(_,n),n.isMeshPhysicalMaterial?function(t,e){Mt(t,e),t.reflectivity.value=e.reflectivity,t.clearCoat.value=e.clearCoat,t.clearCoatRoughness.value=e.clearCoatRoughness}(_,n):Mt(_,n)):n.isMeshMatcapMaterial?(bt(_,n),function(t,e){e.matcap&&(t.matcap.value=e.matcap);e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===b&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===b&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(_,n)):n.isMeshDepthMaterial?(bt(_,n),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(_,n)):n.isMeshDistanceMaterial?(bt(_,n),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias);t.referencePosition.value.copy(e.referencePosition),t.nearDistance.value=e.nearDistance,t.farDistance.value=e.farDistance}(_,n)):n.isMeshNormalMaterial?(bt(_,n),function(t,e){e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===b&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===b&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(_,n)):n.isLineBasicMaterial?(function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity}(_,n),n.isLineDashedMaterial&&function(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}(_,n)):n.isPointsMaterial?function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.size.value=e.size*q,t.scale.value=.5*Y,t.map.value=e.map,null!==e.map&&(!0===e.map.matrixAutoUpdate&&e.map.updateMatrix(),t.uvTransform.value.copy(e.map.matrix))}(_,n):n.isSpriteMaterial?function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.rotation.value=e.rotation,t.map.value=e.map,null!==e.map&&(!0===e.map.matrixAutoUpdate&&e.map.updateMatrix(),t.uvTransform.value.copy(e.map.matrix))}(_,n):n.isShadowMaterial&&(_.color.value.copy(n.color),_.opacity.value=n.opacity),void 0!==_.ltc_1&&(_.ltc_1.value=oi.LTC_1),void 0!==_.ltc_2&&(_.ltc_2.value=oi.LTC_2),xo.upload(f,i.uniformsList,_,x)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(xo.upload(f,i.uniformsList,_,x),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&v.setValue(f,"center",r.center),v.setValue(f,"modelViewMatrix",r.modelViewMatrix),v.setValue(f,"normalMatrix",r.normalMatrix),v.setValue(f,"modelMatrix",r.matrixWorld),d}function bt(t,e){var n;t.opacity.value=e.opacity,e.color&&t.diffuse.value.copy(e.color),e.emissive&&t.emissive.value.copy(e.emissive).multiplyScalar(e.emissiveIntensity),e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.specularMap&&(t.specularMap.value=e.specularMap),e.envMap&&(t.envMap.value=e.envMap,t.flipEnvMap.value=e.envMap.isCubeTexture?-1:1,t.reflectivity.value=e.reflectivity,t.refractionRatio.value=e.refractionRatio,t.maxMipLevel.value=y.get(e.envMap).__maxMipLevel),e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.aoMap&&(t.aoMap.value=e.aoMap,t.aoMapIntensity.value=e.aoMapIntensity),e.map?n=e.map:e.specularMap?n=e.specularMap:e.displacementMap?n=e.displacementMap:e.normalMap?n=e.normalMap:e.bumpMap?n=e.bumpMap:e.roughnessMap?n=e.roughnessMap:e.metalnessMap?n=e.metalnessMap:e.alphaMap?n=e.alphaMap:e.emissiveMap&&(n=e.emissiveMap),void 0!==n&&(n.isWebGLRenderTarget&&(n=n.texture),!0===n.matrixAutoUpdate&&n.updateMatrix(),t.uvTransform.value.copy(n.matrix))}function wt(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===b&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===b&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}function Mt(t,e){t.roughness.value=e.roughness,t.metalness.value=e.metalness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap),e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===b&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===b&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),e.envMap&&(t.envMapIntensity.value=e.envMapIntensity)}mt.setAnimationLoop((function(t){st.isPresenting()||dt&&dt(t)})),"undefined"!=typeof window&&mt.setContext(window),this.setAnimationLoop=function(t){dt=t,st.setAnimationLoop(t),mt.start()},this.render=function(t,e){var n,r;if(void 0!==arguments[2]&&(n=arguments[2]),void 0!==arguments[3]&&(r=arguments[3]),e&&e.isCamera&&!N){z.geometry=null,z.program=null,z.wireframe=!1,U=-1,V=null,!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),st.enabled&&(e=st.getCamera(e)),(p=E.get(t,e)).init(),t.onBeforeRender(O,t,e,n||F),nt.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),Q.setFromMatrix(nt),et=this.localClippingEnabled,tt=$.init(this.clippingPlanes,et,e),(h=T.get(t,e)).init(),gt(t,e,0,O.sortObjects),!0===O.sortObjects&&h.sort(),tt&&$.beginShadows();var i=p.state.shadowsArray;lt.render(i,t,e),p.setupLights(e),tt&&$.endShadows(),this.info.autoReset&&this.info.reset(),void 0!==n&&this.setRenderTarget(n),A.render(h,t,e,r);var o=h.opaque,a=h.transparent;if(t.overrideMaterial){var s=t.overrideMaterial;o.length&&vt(o,t,e,s),a.length&&vt(a,t,e,s)}else o.length&&vt(o,t,e),a.length&&vt(a,t,e);t.onAfterRender(O,t,e),null!==F&&(x.updateRenderTargetMipmap(F),x.updateMultisampleRenderTarget(F)),g.buffers.depth.setTest(!0),g.buffers.depth.setMask(!0),g.buffers.color.setMask(!0),g.setPolygonOffset(!1),st.enabled&&st.submitFrame(),h=null,p=null}},this.setFramebuffer=function(t){R!==t&&f.bindFramebuffer(36160,t),R=t},this.getActiveCubeFace=function(){return D},this.getActiveMipmapLevel=function(){return k},this.getRenderTarget=function(){return F},this.setRenderTarget=function(t,e,n){F=t,D=e,k=n,t&&void 0===y.get(t).__webglFramebuffer&&x.setupRenderTarget(t);var r=R,i=!1;if(t){var o=y.get(t).__webglFramebuffer;t.isWebGLRenderTargetCube?(r=o[e||0],i=!0):r=t.isWebGLMultisampleRenderTarget?y.get(t).__webglMultisampledFramebuffer:o,j.copy(t.viewport),W.copy(t.scissor),H=t.scissorTest}else j.copy(Z).multiplyScalar(q).floor(),W.copy(J).multiplyScalar(q).floor(),H=K;if(B!==r&&(f.bindFramebuffer(36160,r),B=r),g.viewport(j),g.scissor(W),g.setScissorTest(H),i){var a=y.get(t.texture);f.framebufferTexture2D(36160,36064,34069+(e||0),a.__webglTexture,n||0)}},this.readRenderTargetPixels=function(t,e,n,r,i,o,a){if(t&&t.isWebGLRenderTarget){var s=y.get(t).__webglFramebuffer;if(t.isWebGLRenderTargetCube&&void 0!==a&&(s=s[a]),s){var u=!1;s!==B&&(f.bindFramebuffer(36160,s),u=!0);try{var l=t.texture,c=l.format,h=l.type;if(c!==qt&&I.convert(c)!==f.getParameter(35739))return;if(!(h===Rt||I.convert(h)===f.getParameter(35738)||h===zt&&(m.isWebGL2||d.get("OES_texture_float")||d.get("WEBGL_color_buffer_float"))||h===Vt&&(m.isWebGL2?d.get("EXT_color_buffer_float"):d.get("EXT_color_buffer_half_float"))))return;36053===f.checkFramebufferStatus(36160)&&e>=0&&e<=t.width-r&&n>=0&&n<=t.height-i&&f.readPixels(e,n,r,i,I.convert(c),I.convert(h),o)}finally{u&&f.bindFramebuffer(36160,B)}}}},this.copyFramebufferToTexture=function(t,e,n){var r=e.image.width,i=e.image.height,o=I.convert(e.format);x.setTexture2D(e,0),f.copyTexImage2D(3553,n||0,o,t.x,t.y,r,i,0)},this.copyTextureToTexture=function(t,e,n,r){var i=e.image.width,o=e.image.height,a=I.convert(n.format),s=I.convert(n.type);x.setTexture2D(n,0),e.isDataTexture?f.texSubImage2D(3553,r||0,t.x,t.y,i,o,a,s,e.image.data):f.texSubImage2D(3553,r||0,t.x,t.y,a,s,e.image)},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function la(t,e){this.name="",this.color=new hr(t),this.density=void 0!==e?e:25e-5}function ca(t,e,n){this.name="",this.color=new hr(t),this.near=void 0!==e?e:1,this.far=void 0!==n?n:1e3}function ha(t,e){this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function pa(t,e,n,r){this.data=t,this.itemSize=e,this.offset=n,this.normalized=!0===r}function fa(t){vr.call(this),this.type="SpriteMaterial",this.color=new hr(16777215),this.map=null,this.rotation=0,this.sizeAttenuation=!0,this.lights=!1,this.transparent=!0,this.setValues(t)}function da(t){if(er.call(this),this.type="Sprite",void 0===Ko){Ko=new Dr;var e=new ha(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);Ko.setIndex([0,1,2,0,2,3]),Ko.addAttribute("position",new pa(e,3,0,!1)),Ko.addAttribute("uv",new pa(e,2,3,!1))}this.geometry=Ko,this.material=void 0!==t?t:new fa,this.center=new pn(.5,.5)}function ma(){er.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}function ga(t,e){t&&t.isGeometry,kr.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new In,this.bindMatrixInverse=new In}function va(t,e){if(t=t||[],this.bones=t.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else{this.boneInverses=[];for(var n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new In)}}function ya(){er.call(this),this.type="Bone"}function xa(t){vr.call(this),this.type="LineBasicMaterial",this.color=new hr(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(t)}function _a(t,e,n){er.call(this),this.type="Line",this.geometry=void 0!==t?t:new Dr,this.material=void 0!==e?e:new xa({color:16777215*Math.random()})}function ba(t,e){_a.call(this,t,e),this.type="LineSegments"}function wa(t,e){_a.call(this,t,e),this.type="LineLoop"}function Ma(t){vr.call(this),this.type="PointsMaterial",this.color=new hr(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.lights=!1,this.setValues(t)}function Sa(t,e){er.call(this),this.type="Points",this.geometry=void 0!==t?t:new Dr,this.material=void 0!==e?e:new Ma({color:16777215*Math.random()}),this.updateMorphTargets()}function Ta(t,e,n,r,i,o,a,s,u){An.call(this,t,e,n,r,i,o,a,s,u),this.format=void 0!==a?a:Yt,this.minFilter=void 0!==o?o:Ct,this.magFilter=void 0!==i?i:Ct,this.generateMipmaps=!1}function Ea(t,e,n,r,i,o,a,s,u,l,c,h){An.call(this,null,o,a,s,u,l,r,i,c,h),this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}function Aa(t,e,n,r,i,o,a,s,u){An.call(this,t,e,n,r,i,o,a,s,u),this.needsUpdate=!0}function Pa(t,e,n,r,i,o,a,s,u,l){if((l=void 0!==l?l:Qt)!==Qt&&l!==$t)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&l===Qt&&(n=Ft),void 0===n&&l===$t&&(n=Ht),An.call(this,null,r,i,o,a,s,l,n,u),this.image={width:t,height:e},this.magFilter=void 0!==a?a:St,this.minFilter=void 0!==s?s:St,this.flipY=!1,this.generateMipmaps=!1}function Ca(t){Dr.call(this),this.type="WireframeGeometry";var e,n,r,i,o,a,s,u,l,c,h=[],p=[0,0],f={},d=["a","b","c"];if(t&&t.isGeometry){var m=t.faces;for(e=0,r=m.length;e<r;e++){var g=m[e];for(n=0;n<3;n++)s=g[d[n]],u=g[d[(n+1)%3]],p[0]=Math.min(s,u),p[1]=Math.max(s,u),void 0===f[l=p[0]+","+p[1]]&&(f[l]={index1:p[0],index2:p[1]})}for(l in f)a=f[l],c=t.vertices[a.index1],h.push(c.x,c.y,c.z),c=t.vertices[a.index2],h.push(c.x,c.y,c.z)}else if(t&&t.isBufferGeometry){var v,y,x,_,b,w,M;if(c=new dn,null!==t.index){for(v=t.attributes.position,y=t.index,0===(x=t.groups).length&&(x=[{start:0,count:y.count,materialIndex:0}]),i=0,o=x.length;i<o;++i)for(e=b=(_=x[i]).start,r=b+_.count;e<r;e+=3)for(n=0;n<3;n++)s=y.getX(e+n),u=y.getX(e+(n+1)%3),p[0]=Math.min(s,u),p[1]=Math.max(s,u),void 0===f[l=p[0]+","+p[1]]&&(f[l]={index1:p[0],index2:p[1]});for(l in f)a=f[l],c.fromBufferAttribute(v,a.index1),h.push(c.x,c.y,c.z),c.fromBufferAttribute(v,a.index2),h.push(c.x,c.y,c.z)}else for(e=0,r=(v=t.attributes.position).count/3;e<r;e++)for(n=0;n<3;n++)w=3*e+n,c.fromBufferAttribute(v,w),h.push(c.x,c.y,c.z),M=3*e+(n+1)%3,c.fromBufferAttribute(v,M),h.push(c.x,c.y,c.z)}this.addAttribute("position",new Ar(h,3))}function La(t,e,n){Br.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:n},this.fromBufferGeometry(new Ia(t,e,n)),this.mergeVertices()}function Ia(t,e,n){Dr.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:e,stacks:n};var r,i,o=[],a=[],s=[],u=[],l=1e-5,c=new dn,h=new dn,p=new dn,f=new dn,d=new dn;t.length;var m=e+1;for(r=0;r<=n;r++){var g=r/n;for(i=0;i<=e;i++){var v=i/e;t(v,g,h),a.push(h.x,h.y,h.z),v-l>=0?(t(v-l,g,p),f.subVectors(h,p)):(t(v+l,g,p),f.subVectors(p,h)),g-l>=0?(t(v,g-l,p),d.subVectors(h,p)):(t(v,g+l,p),d.subVectors(p,h)),c.crossVectors(f,d).normalize(),s.push(c.x,c.y,c.z),u.push(v,g)}}for(r=0;r<n;r++)for(i=0;i<e;i++){var y=r*m+i,x=r*m+i+1,_=(r+1)*m+i+1,b=(r+1)*m+i;o.push(y,x,b),o.push(x,_,b)}this.setIndex(o),this.addAttribute("position",new Ar(a,3)),this.addAttribute("normal",new Ar(s,3)),this.addAttribute("uv",new Ar(u,2))}function Oa(t,e,n,r){Br.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:r},this.fromBufferGeometry(new Na(t,e,n,r)),this.mergeVertices()}function Na(t,e,n,r){Dr.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:r},n=n||1;var i=[],o=[];function a(t,e,n,r){var i,o,a=Math.pow(2,r),u=[];for(i=0;i<=a;i++){u[i]=[];var l=t.clone().lerp(n,i/a),c=e.clone().lerp(n,i/a),h=a-i;for(o=0;o<=h;o++)u[i][o]=0===o&&i===a?l:l.clone().lerp(c,o/h)}for(i=0;i<a;i++)for(o=0;o<2*(a-i)-1;o++){var p=Math.floor(o/2);o%2==0?(s(u[i][p+1]),s(u[i+1][p]),s(u[i][p])):(s(u[i][p+1]),s(u[i+1][p+1]),s(u[i+1][p]))}}function s(t){i.push(t.x,t.y,t.z)}function u(e,n){var r=3*e;n.x=t[r+0],n.y=t[r+1],n.z=t[r+2]}function l(t,e,n,r){r<0&&1===t.x&&(o[e]=t.x-1),0===n.x&&0===n.z&&(o[e]=r/2/Math.PI+.5)}function c(t){return Math.atan2(t.z,-t.x)}function h(t){return Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))}!function(t){for(var n=new dn,r=new dn,i=new dn,o=0;o<e.length;o+=3)u(e[o+0],n),u(e[o+1],r),u(e[o+2],i),a(n,r,i,t)}(r=r||0),function(t){for(var e=new dn,n=0;n<i.length;n+=3)e.x=i[n+0],e.y=i[n+1],e.z=i[n+2],e.normalize().multiplyScalar(t),i[n+0]=e.x,i[n+1]=e.y,i[n+2]=e.z}(n),function(){for(var t=new dn,e=0;e<i.length;e+=3){t.x=i[e+0],t.y=i[e+1],t.z=i[e+2];var n=c(t)/2/Math.PI+.5,r=h(t)/Math.PI+.5;o.push(n,1-r)}(function(){for(var t=new dn,e=new dn,n=new dn,r=new dn,a=new pn,s=new pn,u=new pn,h=0,p=0;h<i.length;h+=9,p+=6){t.set(i[h+0],i[h+1],i[h+2]),e.set(i[h+3],i[h+4],i[h+5]),n.set(i[h+6],i[h+7],i[h+8]),a.set(o[p+0],o[p+1]),s.set(o[p+2],o[p+3]),u.set(o[p+4],o[p+5]),r.copy(t).add(e).add(n).divideScalar(3);var f=c(r);l(a,p+0,t,f),l(s,p+2,e,f),l(u,p+4,n,f)}})(),function(){for(var t=0;t<o.length;t+=6){var e=o[t+0],n=o[t+2],r=o[t+4],i=Math.max(e,n,r),a=Math.min(e,n,r);i>.9&&a<.1&&(e<.2&&(o[t+0]+=1),n<.2&&(o[t+2]+=1),r<.2&&(o[t+4]+=1))}}()}(),this.addAttribute("position",new Ar(i,3)),this.addAttribute("normal",new Ar(i.slice(),3)),this.addAttribute("uv",new Ar(o,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}function Ra(t,e){Br.call(this),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Da(t,e)),this.mergeVertices()}function Da(t,e){Na.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e),this.type="TetrahedronBufferGeometry",this.parameters={radius:t,detail:e}}function ka(t,e){Br.call(this),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Fa(t,e)),this.mergeVertices()}function Fa(t,e){Na.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e),this.type="OctahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Ba(t,e){Br.call(this),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Ua(t,e)),this.mergeVertices()}function Ua(t,e){var n=(1+Math.sqrt(5))/2,r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1];Na.call(this,r,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronBufferGeometry",this.parameters={radius:t,detail:e}}function za(t,e){Br.call(this),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Va(t,e)),this.mergeVertices()}function Va(t,e){var n=(1+Math.sqrt(5))/2,r=1/n,i=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r];Na.call(this,i,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e),this.type="DodecahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Ga(t,e,n,r,i,o){Br.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:r,closed:i};var a=new ja(t,e,n,r,i);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals,this.fromBufferGeometry(a),this.mergeVertices()}function ja(t,e,n,r,i){Dr.call(this),this.type="TubeBufferGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:r,closed:i},e=e||64,n=n||1,r=r||8,i=i||!1;var o=t.computeFrenetFrames(e,i);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;var a,s,u=new dn,l=new dn,c=new pn,h=new dn,p=[],f=[],d=[],m=[];function g(i){h=t.getPointAt(i/e,h);var a=o.normals[i],c=o.binormals[i];for(s=0;s<=r;s++){var d=s/r*Math.PI*2,m=Math.sin(d),g=-Math.cos(d);l.x=g*a.x+m*c.x,l.y=g*a.y+m*c.y,l.z=g*a.z+m*c.z,l.normalize(),f.push(l.x,l.y,l.z),u.x=h.x+n*l.x,u.y=h.y+n*l.y,u.z=h.z+n*l.z,p.push(u.x,u.y,u.z)}}!function(){for(a=0;a<e;a++)g(a);g(!1===i?e:0),function(){for(a=0;a<=e;a++)for(s=0;s<=r;s++)c.x=a/e,c.y=s/r,d.push(c.x,c.y)}(),function(){for(s=1;s<=e;s++)for(a=1;a<=r;a++){var t=(r+1)*(s-1)+(a-1),n=(r+1)*s+(a-1),i=(r+1)*s+a,o=(r+1)*(s-1)+a;m.push(t,n,o),m.push(n,i,o)}}()}(),this.setIndex(m),this.addAttribute("position",new Ar(p,3)),this.addAttribute("normal",new Ar(f,3)),this.addAttribute("uv",new Ar(d,2))}function Wa(t,e,n,r,i,o,a){Br.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:r,p:i,q:o},this.fromBufferGeometry(new Ha(t,e,n,r,i,o)),this.mergeVertices()}function Ha(t,e,n,r,i,o){Dr.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:r,p:i,q:o},t=t||1,e=e||.4,n=Math.floor(n)||64,r=Math.floor(r)||8,i=i||2,o=o||3;var a,s,u=[],l=[],c=[],h=[],p=new dn,f=new dn,d=new dn,m=new dn,g=new dn,v=new dn,y=new dn;for(a=0;a<=n;++a){var x=a/n*i*Math.PI*2;for(A(x,i,o,t,d),A(x+.01,i,o,t,m),v.subVectors(m,d),y.addVectors(m,d),g.crossVectors(v,y),y.crossVectors(g,v),g.normalize(),y.normalize(),s=0;s<=r;++s){var _=s/r*Math.PI*2,b=-e*Math.cos(_),w=e*Math.sin(_);p.x=d.x+(b*y.x+w*g.x),p.y=d.y+(b*y.y+w*g.y),p.z=d.z+(b*y.z+w*g.z),l.push(p.x,p.y,p.z),f.subVectors(p,d).normalize(),c.push(f.x,f.y,f.z),h.push(a/n),h.push(s/r)}}for(s=1;s<=n;s++)for(a=1;a<=r;a++){var M=(r+1)*(s-1)+(a-1),S=(r+1)*s+(a-1),T=(r+1)*s+a,E=(r+1)*(s-1)+a;u.push(M,S,E),u.push(S,T,E)}function A(t,e,n,r,i){var o=Math.cos(t),a=Math.sin(t),s=n/e*t,u=Math.cos(s);i.x=r*(2+u)*.5*o,i.y=r*(2+u)*a*.5,i.z=r*Math.sin(s)*.5}this.setIndex(u),this.addAttribute("position",new Ar(l,3)),this.addAttribute("normal",new Ar(c,3)),this.addAttribute("uv",new Ar(h,2))}function Xa(t,e,n,r,i){Br.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:r,arc:i},this.fromBufferGeometry(new Ya(t,e,n,r,i)),this.mergeVertices()}function Ya(t,e,n,r,i){Dr.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:r,arc:i},t=t||1,e=e||.4,n=Math.floor(n)||8,r=Math.floor(r)||6,i=i||2*Math.PI;var o,a,s=[],u=[],l=[],c=[],h=new dn,p=new dn,f=new dn;for(o=0;o<=n;o++)for(a=0;a<=r;a++){var d=a/r*i,m=o/n*Math.PI*2;p.x=(t+e*Math.cos(m))*Math.cos(d),p.y=(t+e*Math.cos(m))*Math.sin(d),p.z=e*Math.sin(m),u.push(p.x,p.y,p.z),h.x=t*Math.cos(d),h.y=t*Math.sin(d),f.subVectors(p,h).normalize(),l.push(f.x,f.y,f.z),c.push(a/r),c.push(o/n)}for(o=1;o<=n;o++)for(a=1;a<=r;a++){var g=(r+1)*o+a-1,v=(r+1)*(o-1)+a-1,y=(r+1)*(o-1)+a,x=(r+1)*o+a;s.push(g,v,x),s.push(v,y,x)}this.setIndex(s),this.addAttribute("position",new Ar(u,3)),this.addAttribute("normal",new Ar(l,3)),this.addAttribute("uv",new Ar(c,2))}Object.assign(aa.prototype,r.prototype),Object.assign(sa.prototype,r.prototype),Object.assign(la.prototype,{isFogExp2:!0,clone:function(){return new la(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),Object.assign(ca.prototype,{isFog:!0,clone:function(){return new ca(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),Object.defineProperty(ha.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(ha.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setArray:function(t){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");return this.count=void 0!==t?t.length/this.stride:0,this.array=t,this},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.dynamic=t.dynamic,this},copyAt:function(t,e,n){t*=this.stride,n*=e.stride;for(var r=0,i=this.stride;r<i;r++)this.array[t+r]=e.array[n+r];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(t){return this.onUploadCallback=t,this}}),Object.defineProperties(pa.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(pa.prototype,{isInterleavedBufferAttribute:!0,setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this},setXYZ:function(t,e,n,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this},setXYZW:function(t,e,n,r,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this.data.array[t+3]=i,this}}),fa.prototype=Object.create(vr.prototype),fa.prototype.constructor=fa,fa.prototype.isSpriteMaterial=!0,fa.prototype.copy=function(t){return vr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this},da.prototype=Object.assign(Object.create(er.prototype),{constructor:da,isSprite:!0,raycast:function(){var t=new dn,e=new dn,n=new dn,r=new pn,i=new pn,o=new In,a=new dn,s=new dn,u=new dn,l=new pn,c=new pn,h=new pn;function p(t,e,n,a,s,u){r.subVectors(t,n).addScalar(.5).multiply(a),void 0!==s?(i.x=u*r.x-s*r.y,i.y=s*r.x+u*r.y):i.copy(r),t.copy(e),t.x+=i.x,t.y+=i.y,t.applyMatrix4(o)}return function(r,i){e.setFromMatrixScale(this.matrixWorld),o.copy(r._camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(r._camera.matrixWorldInverse,this.matrixWorld),n.setFromMatrixPosition(this.modelViewMatrix),r._camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&e.multiplyScalar(-n.z);var f,d,m=this.material.rotation;0!==m&&(d=Math.cos(m),f=Math.sin(m));var g=this.center;p(a.set(-.5,-.5,0),n,g,e,f,d),p(s.set(.5,-.5,0),n,g,e,f,d),p(u.set(.5,.5,0),n,g,e,f,d),l.set(0,0),c.set(1,0),h.set(1,1);var v=r.ray.intersectTriangle(a,s,u,!1,t);if(null!==v||(p(s.set(-.5,.5,0),n,g,e,f,d),c.set(0,1),null!==(v=r.ray.intersectTriangle(a,u,s,!1,t)))){var y=r.ray.origin.distanceTo(t);y<r.near||y>r.far||i.push({distance:y,point:t.clone(),uv:ar.getUV(t,a,s,u,l,c,h,new pn),face:null,object:this})}}}(),clone:function(){return new this.constructor(this.material).copy(this)},copy:function(t){return er.prototype.copy.call(this,t),void 0!==t.center&&this.center.copy(t.center),this}}),ma.prototype=Object.assign(Object.create(er.prototype),{constructor:ma,isLOD:!0,copy:function(t){er.prototype.copy.call(this,t,!1);for(var e=t.levels,n=0,r=e.length;n<r;n++){var i=e[n];this.addLevel(i.object.clone(),i.distance)}return this},addLevel:function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var n=this.levels,r=0;r<n.length&&!(e<n[r].distance);r++);return n.splice(r,0,{distance:e,object:t}),this.add(t),this},getObjectForDistance:function(t){for(var e=this.levels,n=1,r=e.length;n<r&&!(t<e[n].distance);n++);return e[n-1].object},raycast:(Qo=new dn,function(t,e){Qo.setFromMatrixPosition(this.matrixWorld);var n=t.ray.origin.distanceTo(Qo);this.getObjectForDistance(n).raycast(t,e)}),update:function(){var t=new dn,e=new dn;return function(n){var r=this.levels;if(r.length>1){t.setFromMatrixPosition(n.matrixWorld),e.setFromMatrixPosition(this.matrixWorld);var i=t.distanceTo(e);r[0].object.visible=!0;for(var o=1,a=r.length;o<a&&i>=r[o].distance;o++)r[o-1].object.visible=!1,r[o].object.visible=!0;for(;o<a;o++)r[o].object.visible=!1}}}(),toJSON:function(t){var e=er.prototype.toJSON.call(this,t);e.object.levels=[];for(var n=this.levels,r=0,i=n.length;r<i;r++){var o=n[r];e.object.levels.push({object:o.object.uuid,distance:o.distance})}return e}}),ga.prototype=Object.assign(Object.create(kr.prototype),{constructor:ga,isSkinnedMesh:!0,bind:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var t=new Pn,e=this.geometry.attributes.skinWeight,n=0,r=e.count;n<r;n++){t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.w=e.getW(n);var i=1/t.manhattanLength();i!==1/0?t.multiplyScalar(i):t.set(1,0,0,0),e.setXYZW(n,t.x,t.y,t.z,t.w)}},updateMatrixWorld:function(t){kr.prototype.updateMatrixWorld.call(this,t),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode&&this.bindMatrixInverse.getInverse(this.bindMatrix)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Object.assign(va.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t=0,e=this.bones.length;t<e;t++){var n=new In;this.bones[t]&&n.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(n)}},pose:function(){var t,e,n;for(e=0,n=this.bones.length;e<n;e++)(t=this.bones[e])&&t.matrixWorld.getInverse(this.boneInverses[e]);for(e=0,n=this.bones.length;e<n;e++)(t=this.bones[e])&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},update:($o=new In,ta=new In,function(){for(var t=this.bones,e=this.boneInverses,n=this.boneMatrices,r=this.boneTexture,i=0,o=t.length;i<o;i++){var a=t[i]?t[i].matrixWorld:ta;$o.multiplyMatrices(a,e[i]),$o.toArray(n,16*i)}void 0!==r&&(r.needsUpdate=!0)}),clone:function(){return new va(this.bones,this.boneInverses)},getBoneByName:function(t){for(var e=0,n=this.bones.length;e<n;e++){var r=this.bones[e];if(r.name===t)return r}}}),ya.prototype=Object.assign(Object.create(er.prototype),{constructor:ya,isBone:!0}),xa.prototype=Object.create(vr.prototype),xa.prototype.constructor=xa,xa.prototype.isLineBasicMaterial=!0,xa.prototype.copy=function(t){return vr.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this},_a.prototype=Object.assign(Object.create(er.prototype),{constructor:_a,isLine:!0,computeLineDistances:(ea=new dn,na=new dn,function(){var t=this.geometry;if(t.isBufferGeometry){if(null===t.index){for(var e=t.attributes.position,n=[0],r=1,i=e.count;r<i;r++)ea.fromBufferAttribute(e,r-1),na.fromBufferAttribute(e,r),n[r]=n[r-1],n[r]+=ea.distanceTo(na);t.addAttribute("lineDistance",new Ar(n,1))}}else if(t.isGeometry){var o=t.vertices;for((n=t.lineDistances)[0]=0,r=1,i=o.length;r<i;r++)n[r]=n[r-1],n[r]+=o[r-1].distanceTo(o[r])}return this}),raycast:function(){var t=new In,e=new or,n=new ir;return function(r,i){var o=r.linePrecision,a=this.geometry,s=this.matrixWorld;if(null===a.boundingSphere&&a.computeBoundingSphere(),n.copy(a.boundingSphere),n.applyMatrix4(s),n.radius+=o,!1!==r.ray.intersectsSphere(n)){t.getInverse(s),e.copy(r.ray).applyMatrix4(t);var u=o/((this.scale.x+this.scale.y+this.scale.z)/3),l=u*u,c=new dn,h=new dn,p=new dn,f=new dn,d=this&&this.isLineSegments?2:1;if(a.isBufferGeometry){var m=a.index,g=a.attributes.position.array;if(null!==m)for(var v=m.array,y=0,x=v.length-1;y<x;y+=d){var _=v[y],b=v[y+1];if(c.fromArray(g,3*_),h.fromArray(g,3*b),!(e.distanceSqToSegment(c,h,f,p)>l))f.applyMatrix4(this.matrixWorld),(S=r.ray.origin.distanceTo(f))<r.near||S>r.far||i.push({distance:S,point:p.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}else for(y=0,x=g.length/3-1;y<x;y+=d){if(c.fromArray(g,3*y),h.fromArray(g,3*y+3),!(e.distanceSqToSegment(c,h,f,p)>l))f.applyMatrix4(this.matrixWorld),(S=r.ray.origin.distanceTo(f))<r.near||S>r.far||i.push({distance:S,point:p.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}else if(a.isGeometry){var w=a.vertices,M=w.length;for(y=0;y<M-1;y+=d){var S;if(!(e.distanceSqToSegment(w[y],w[y+1],f,p)>l))f.applyMatrix4(this.matrixWorld),(S=r.ray.origin.distanceTo(f))<r.near||S>r.far||i.push({distance:S,point:p.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),ba.prototype=Object.assign(Object.create(_a.prototype),{constructor:ba,isLineSegments:!0,computeLineDistances:function(){var t=new dn,e=new dn;return function(){var n=this.geometry;if(n.isBufferGeometry){if(null===n.index){for(var r=n.attributes.position,i=[],o=0,a=r.count;o<a;o+=2)t.fromBufferAttribute(r,o),e.fromBufferAttribute(r,o+1),i[o]=0===o?0:i[o-1],i[o+1]=i[o]+t.distanceTo(e);n.addAttribute("lineDistance",new Ar(i,1))}}else if(n.isGeometry){var s=n.vertices;for(i=n.lineDistances,o=0,a=s.length;o<a;o+=2)t.copy(s[o]),e.copy(s[o+1]),i[o]=0===o?0:i[o-1],i[o+1]=i[o]+t.distanceTo(e)}return this}}()}),wa.prototype=Object.assign(Object.create(_a.prototype),{constructor:wa,isLineLoop:!0}),Ma.prototype=Object.create(vr.prototype),Ma.prototype.constructor=Ma,Ma.prototype.isPointsMaterial=!0,Ma.prototype.copy=function(t){return vr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this},Sa.prototype=Object.assign(Object.create(er.prototype),{constructor:Sa,isPoints:!0,raycast:function(){var t=new In,e=new or,n=new ir;return function(r,i){var o=this,a=this.geometry,s=this.matrixWorld,u=r.params.Points.threshold;if(null===a.boundingSphere&&a.computeBoundingSphere(),n.copy(a.boundingSphere),n.applyMatrix4(s),n.radius+=u,!1!==r.ray.intersectsSphere(n)){t.getInverse(s),e.copy(r.ray).applyMatrix4(t);var l=u/((this.scale.x+this.scale.y+this.scale.z)/3),c=l*l,h=new dn,p=new dn;if(a.isBufferGeometry){var f=a.index,d=a.attributes.position.array;if(null!==f)for(var m=f.array,g=0,v=m.length;g<v;g++){var y=m[g];h.fromArray(d,3*y),b(h,y)}else{g=0;for(var x=d.length/3;g<x;g++)h.fromArray(d,3*g),b(h,g)}}else{var _=a.vertices;for(g=0,x=_.length;g<x;g++)b(_[g],g)}}function b(t,n){var a=e.distanceSqToPoint(t);if(a<c){e.closestPointToPoint(t,p),p.applyMatrix4(s);var u=r.ray.origin.distanceTo(p);if(u<r.near||u>r.far)return;i.push({distance:u,distanceToRay:Math.sqrt(a),point:p.clone(),index:n,face:null,object:o})}}}}(),updateMorphTargets:function(){var t,e,n,r=this.geometry;if(r.isBufferGeometry){var i=r.morphAttributes,o=Object.keys(i);if(o.length>0){var a=i[o[0]];if(void 0!==a)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=a.length;t<e;t++)n=a[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}else{var s=r.morphTargets;void 0!==s&&s.length}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Ta.prototype=Object.assign(Object.create(An.prototype),{constructor:Ta,isVideoTexture:!0,update:function(){var t=this.image;t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),Ea.prototype=Object.create(An.prototype),Ea.prototype.constructor=Ea,Ea.prototype.isCompressedTexture=!0,Aa.prototype=Object.create(An.prototype),Aa.prototype.constructor=Aa,Aa.prototype.isCanvasTexture=!0,Pa.prototype=Object.create(An.prototype),Pa.prototype.constructor=Pa,Pa.prototype.isDepthTexture=!0,Ca.prototype=Object.create(Dr.prototype),Ca.prototype.constructor=Ca,La.prototype=Object.create(Br.prototype),La.prototype.constructor=La,Ia.prototype=Object.create(Dr.prototype),Ia.prototype.constructor=Ia,Oa.prototype=Object.create(Br.prototype),Oa.prototype.constructor=Oa,Na.prototype=Object.create(Dr.prototype),Na.prototype.constructor=Na,Ra.prototype=Object.create(Br.prototype),Ra.prototype.constructor=Ra,Da.prototype=Object.create(Na.prototype),Da.prototype.constructor=Da,ka.prototype=Object.create(Br.prototype),ka.prototype.constructor=ka,Fa.prototype=Object.create(Na.prototype),Fa.prototype.constructor=Fa,Ba.prototype=Object.create(Br.prototype),Ba.prototype.constructor=Ba,Ua.prototype=Object.create(Na.prototype),Ua.prototype.constructor=Ua,za.prototype=Object.create(Br.prototype),za.prototype.constructor=za,Va.prototype=Object.create(Na.prototype),Va.prototype.constructor=Va,Ga.prototype=Object.create(Br.prototype),Ga.prototype.constructor=Ga,ja.prototype=Object.create(Dr.prototype),ja.prototype.constructor=ja,ja.prototype.toJSON=function(){var t=Dr.prototype.toJSON.call(this);return t.path=this.parameters.path.toJSON(),t},Wa.prototype=Object.create(Br.prototype),Wa.prototype.constructor=Wa,Ha.prototype=Object.create(Dr.prototype),Ha.prototype.constructor=Ha,Xa.prototype=Object.create(Br.prototype),Xa.prototype.constructor=Xa,Ya.prototype=Object.create(Dr.prototype),Ya.prototype.constructor=Ya;var qa=function(t,e,n){n=n||2;var r,i,o,a,s,u,l,c=e&&e.length,h=c?e[0]*n:t.length,p=Za(t,0,h,n,!0),f=[];if(!p||p.next===p.prev)return f;if(c&&(p=function(t,e,n,r){var i,o,a,s=[];for(i=0,o=e.length;i<o;i++)(a=Za(t,e[i]*r,i<o-1?e[i+1]*r:t.length,r,!1))===a.next&&(a.steiner=!0),s.push(os(a));for(s.sort(ns),i=0;i<s.length;i++)rs(s[i],n),n=Ja(n,n.next);return n}(t,e,p,n)),t.length>80*n){r=o=t[0],i=a=t[1];for(var d=n;d<h;d+=n)(s=t[d])<r&&(r=s),(u=t[d+1])<i&&(i=u),s>o&&(o=s),u>a&&(a=u);l=0!==(l=Math.max(o-r,a-i))?1/l:0}return Ka(p,f,n,r,i,l),f};function Za(t,e,n,r,i){var o,a;if(i===function(t,e,n,r){for(var i=0,o=e,a=n-r;o<n;o+=r)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}(t,e,n,r)>0)for(o=e;o<n;o+=r)a=fs(o,t[o],t[o+1],a);else for(o=n-r;o>=e;o-=r)a=fs(o,t[o],t[o+1],a);return a&&ls(a,a.next)&&(ds(a),a=a.next),a}function Ja(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!ls(r,r.next)&&0!==us(r.prev,r,r.next))r=r.next;else{if(ds(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function Ka(t,e,n,r,i,o,a){if(t){!a&&o&&function(t,e,n,r){var i=t;do{null===i.z&&(i.z=is(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,o,a,s,u,l=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,r=n,s=0,e=0;e<l&&(s++,r=r.nextZ);e++);for(u=l;s>0||u>0&&r;)0!==s&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,u--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,l*=2}while(a>1)}(i)}(t,r,i,o);for(var s,u,l=t;t.prev!==t.next;)if(s=t.prev,u=t.next,o?$a(t,r,i,o):Qa(t))e.push(s.i/n),e.push(t.i/n),e.push(u.i/n),ds(t),t=u.next,l=u.next;else if((t=u)===l){a?1===a?Ka(t=ts(t,e,n),e,n,r,i,o,2):2===a&&es(t,e,n,r,i,o):Ka(Ja(t),e,n,r,i,o,1);break}}}function Qa(t){var e=t.prev,n=t,r=t.next;if(us(e,n,r)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(as(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&us(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function $a(t,e,n,r){var i=t.prev,o=t,a=t.next;if(us(i,o,a)>=0)return!1;for(var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,u=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,l=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,c=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,h=is(s,u,e,n,r),p=is(l,c,e,n,r),f=t.prevZ,d=t.nextZ;f&&f.z>=h&&d&&d.z<=p;){if(f!==t.prev&&f!==t.next&&as(i.x,i.y,o.x,o.y,a.x,a.y,f.x,f.y)&&us(f.prev,f,f.next)>=0)return!1;if(f=f.prevZ,d!==t.prev&&d!==t.next&&as(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&us(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;f&&f.z>=h;){if(f!==t.prev&&f!==t.next&&as(i.x,i.y,o.x,o.y,a.x,a.y,f.x,f.y)&&us(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;d&&d.z<=p;){if(d!==t.prev&&d!==t.next&&as(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&us(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function ts(t,e,n){var r=t;do{var i=r.prev,o=r.next.next;!ls(i,o)&&cs(i,r,r.next,o)&&hs(i,o)&&hs(o,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(o.i/n),ds(r),ds(r.next),r=t=o),r=r.next}while(r!==t);return r}function es(t,e,n,r,i,o){var a=t;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&ss(a,s)){var u=ps(a,s);return a=Ja(a,a.next),u=Ja(u,u.next),Ka(a,e,n,r,i,o),void Ka(u,e,n,r,i,o)}s=s.next}a=a.next}while(a!==t)}function ns(t,e){return t.x-e.x}function rs(t,e){if(e=function(t,e){var n,r=e,i=t.x,o=t.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a){if(a=s,s===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===a)return n.prev;var u,l=n,c=n.x,h=n.y,p=1/0;r=n.next;for(;r!==l;)i>=r.x&&r.x>=c&&i!==r.x&&as(o<h?i:a,o,c,h,o<h?a:i,o,r.x,r.y)&&((u=Math.abs(o-r.y)/(i-r.x))<p||u===p&&r.x>n.x)&&hs(r,t)&&(n=r,p=u),r=r.next;return n}(t,e),e){var n=ps(e,t);Ja(n,n.next)}}function is(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function os(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function as(t,e,n,r,i,o,a,s){return(i-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(r-s)-(n-a)*(e-s)>=0&&(n-a)*(o-s)-(i-a)*(r-s)>=0}function ss(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&cs(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&hs(t,e)&&hs(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)}function us(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function ls(t,e){return t.x===e.x&&t.y===e.y}function cs(t,e,n,r){return!!(ls(t,n)&&ls(e,r)||ls(t,r)&&ls(n,e))||us(t,e,n)>0!=us(t,e,r)>0&&us(n,r,t)>0!=us(n,r,e)>0}function hs(t,e){return us(t.prev,t,t.next)<0?us(t,e,t.next)>=0&&us(t,t.prev,e)>=0:us(t,e,t.prev)<0||us(t,t.next,e)<0}function ps(t,e){var n=new ms(t.i,t.x,t.y),r=new ms(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function fs(t,e,n,r){var i=new ms(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function ds(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function ms(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var gs={area:function(t){for(var e=t.length,n=0,r=e-1,i=0;i<e;r=i++)n+=t[r].x*t[i].y-t[i].x*t[r].y;return.5*n},isClockWise:function(t){return gs.area(t)<0},triangulateShape:function(t,e){var n=[],r=[],i=[];vs(t),ys(n,t);var o=t.length;e.forEach(vs);for(var a=0;a<e.length;a++)r.push(o),o+=e[a].length,ys(n,e[a]);var s=qa(n,r);for(a=0;a<s.length;a+=3)i.push(s.slice(a,a+3));return i}};function vs(t){var e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function ys(t,e){for(var n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}function xs(t,e){Br.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},this.fromBufferGeometry(new _s(t,e)),this.mergeVertices()}function _s(t,e){Dr.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];for(var n=this,r=[],i=[],o=0,a=t.length;o<a;o++){s(t[o])}function s(t){var o=[],a=void 0!==e.curveSegments?e.curveSegments:12,s=void 0!==e.steps?e.steps:1,u=void 0!==e.depth?e.depth:100,l=void 0===e.bevelEnabled||e.bevelEnabled,c=void 0!==e.bevelThickness?e.bevelThickness:6,h=void 0!==e.bevelSize?e.bevelSize:c-2,p=void 0!==e.bevelOffset?e.bevelOffset:0,f=void 0!==e.bevelSegments?e.bevelSegments:3,d=e.extrudePath,m=void 0!==e.UVGenerator?e.UVGenerator:bs;void 0!==e.amount&&(u=e.amount);var g,v,y,x,_,b,w,M,S=!1;d&&(g=d.getSpacedPoints(s),S=!0,l=!1,v=d.computeFrenetFrames(s,!1),y=new dn,x=new dn,_=new dn),l||(f=0,c=0,h=0,p=0);var T=t.extractPoints(a),E=T.shape,A=T.holes;if(!gs.isClockWise(E))for(E=E.reverse(),w=0,M=A.length;w<M;w++)b=A[w],gs.isClockWise(b)&&(A[w]=b.reverse());var P=gs.triangulateShape(E,A),C=E;for(w=0,M=A.length;w<M;w++)b=A[w],E=E.concat(b);function L(t,e,n){return e.clone().multiplyScalar(n).add(t)}var I,O,N,R,D,k,F=E.length,B=P.length;function U(t,e,n){var r,i,o,a=t.x-e.x,s=t.y-e.y,u=n.x-t.x,l=n.y-t.y,c=a*a+s*s,h=a*l-s*u;if(Math.abs(h)>Number.EPSILON){var p=Math.sqrt(c),f=Math.sqrt(u*u+l*l),d=e.x-s/p,m=e.y+a/p,g=((n.x-l/f-d)*l-(n.y+u/f-m)*u)/(a*l-s*u),v=(r=d+a*g-t.x)*r+(i=m+s*g-t.y)*i;if(v<=2)return new pn(r,i);o=Math.sqrt(v/2)}else{var y=!1;a>Number.EPSILON?u>Number.EPSILON&&(y=!0):a<-Number.EPSILON?u<-Number.EPSILON&&(y=!0):Math.sign(s)===Math.sign(l)&&(y=!0),y?(r=-s,i=a,o=Math.sqrt(c)):(r=a,i=s,o=Math.sqrt(c/2))}return new pn(r/o,i/o)}for(var z=[],V=0,G=C.length,j=G-1,W=V+1;V<G;V++,j++,W++)j===G&&(j=0),W===G&&(W=0),z[V]=U(C[V],C[j],C[W]);var H,X,Y=[],q=z.concat();for(w=0,M=A.length;w<M;w++){for(b=A[w],H=[],V=0,j=(G=b.length)-1,W=V+1;V<G;V++,j++,W++)j===G&&(j=0),W===G&&(W=0),H[V]=U(b[V],b[j],b[W]);Y.push(H),q=q.concat(H)}for(I=0;I<f;I++){for(N=I/f,R=c*Math.cos(N*Math.PI/2),O=h*Math.sin(N*Math.PI/2)+p,V=0,G=C.length;V<G;V++)J((D=L(C[V],z[V],O)).x,D.y,-R);for(w=0,M=A.length;w<M;w++)for(b=A[w],H=Y[w],V=0,G=b.length;V<G;V++)J((D=L(b[V],H[V],O)).x,D.y,-R)}for(O=h+p,V=0;V<F;V++)D=l?L(E[V],q[V],O):E[V],S?(x.copy(v.normals[0]).multiplyScalar(D.x),y.copy(v.binormals[0]).multiplyScalar(D.y),_.copy(g[0]).add(x).add(y),J(_.x,_.y,_.z)):J(D.x,D.y,0);for(X=1;X<=s;X++)for(V=0;V<F;V++)D=l?L(E[V],q[V],O):E[V],S?(x.copy(v.normals[X]).multiplyScalar(D.x),y.copy(v.binormals[X]).multiplyScalar(D.y),_.copy(g[X]).add(x).add(y),J(_.x,_.y,_.z)):J(D.x,D.y,u/s*X);for(I=f-1;I>=0;I--){for(N=I/f,R=c*Math.cos(N*Math.PI/2),O=h*Math.sin(N*Math.PI/2)+p,V=0,G=C.length;V<G;V++)J((D=L(C[V],z[V],O)).x,D.y,u+R);for(w=0,M=A.length;w<M;w++)for(b=A[w],H=Y[w],V=0,G=b.length;V<G;V++)D=L(b[V],H[V],O),S?J(D.x,D.y+g[s-1].y,g[s-1].x+R):J(D.x,D.y,u+R)}function Z(t,e){var n,r;for(V=t.length;--V>=0;){n=V,(r=V-1)<0&&(r=t.length-1);var i=0,o=s+2*f;for(i=0;i<o;i++){var a=F*i,u=F*(i+1);Q(e+n+a,e+r+a,e+r+u,e+n+u)}}}function J(t,e,n){o.push(t),o.push(e),o.push(n)}function K(t,e,i){$(t),$(e),$(i);var o=r.length/3,a=m.generateTopUV(n,r,o-3,o-2,o-1);tt(a[0]),tt(a[1]),tt(a[2])}function Q(t,e,i,o){$(t),$(e),$(o),$(e),$(i),$(o);var a=r.length/3,s=m.generateSideWallUV(n,r,a-6,a-3,a-2,a-1);tt(s[0]),tt(s[1]),tt(s[3]),tt(s[1]),tt(s[2]),tt(s[3])}function $(t){r.push(o[3*t+0]),r.push(o[3*t+1]),r.push(o[3*t+2])}function tt(t){i.push(t.x),i.push(t.y)}!function(){var t=r.length/3;if(l){var e=0,i=F*e;for(V=0;V<B;V++)K((k=P[V])[2]+i,k[1]+i,k[0]+i);for(i=F*(e=s+2*f),V=0;V<B;V++)K((k=P[V])[0]+i,k[1]+i,k[2]+i)}else{for(V=0;V<B;V++)K((k=P[V])[2],k[1],k[0]);for(V=0;V<B;V++)K((k=P[V])[0]+F*s,k[1]+F*s,k[2]+F*s)}n.addGroup(t,r.length/3-t,0)}(),function(){var t=r.length/3,e=0;for(Z(C,e),e+=C.length,w=0,M=A.length;w<M;w++)Z(b=A[w],e),e+=b.length;n.addGroup(t,r.length/3-t,1)}()}this.addAttribute("position",new Ar(r,3)),this.addAttribute("uv",new Ar(i,2)),this.computeVertexNormals()}xs.prototype=Object.create(Br.prototype),xs.prototype.constructor=xs,xs.prototype.toJSON=function(){var t=Br.prototype.toJSON.call(this);return ws(this.parameters.shapes,this.parameters.options,t)},_s.prototype=Object.create(Dr.prototype),_s.prototype.constructor=_s,_s.prototype.toJSON=function(){var t=Dr.prototype.toJSON.call(this);return ws(this.parameters.shapes,this.parameters.options,t)};var bs={generateTopUV:function(t,e,n,r,i){var o=e[3*n],a=e[3*n+1],s=e[3*r],u=e[3*r+1],l=e[3*i],c=e[3*i+1];return[new pn(o,a),new pn(s,u),new pn(l,c)]},generateSideWallUV:function(t,e,n,r,i,o){var a=e[3*n],s=e[3*n+1],u=e[3*n+2],l=e[3*r],c=e[3*r+1],h=e[3*r+2],p=e[3*i],f=e[3*i+1],d=e[3*i+2],m=e[3*o],g=e[3*o+1],v=e[3*o+2];return Math.abs(s-c)<.01?[new pn(a,1-u),new pn(l,1-h),new pn(p,1-d),new pn(m,1-v)]:[new pn(s,1-u),new pn(c,1-h),new pn(f,1-d),new pn(g,1-v)]}};function ws(t,e,n){if(n.shapes=[],Array.isArray(t))for(var r=0,i=t.length;r<i;r++){var o=t[r];n.shapes.push(o.uuid)}else n.shapes.push(t.uuid);return void 0!==e.extrudePath&&(n.options.extrudePath=e.extrudePath.toJSON()),n}function Ms(t,e){Br.call(this),this.type="TextGeometry",this.parameters={text:t,parameters:e},this.fromBufferGeometry(new Ss(t,e)),this.mergeVertices()}function Ss(t,e){var n=(e=e||{}).font;if(!n||!n.isFont)return new Br;var r=n.generateShapes(t,e.size);e.depth=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),_s.call(this,r,e),this.type="TextBufferGeometry"}function Ts(t,e,n,r,i,o,a){Br.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:a},this.fromBufferGeometry(new Es(t,e,n,r,i,o,a)),this.mergeVertices()}function Es(t,e,n,r,i,o,a){Dr.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:a},t=t||1,e=Math.max(3,Math.floor(e)||8),n=Math.max(2,Math.floor(n)||6),r=void 0!==r?r:0,i=void 0!==i?i:2*Math.PI,o=void 0!==o?o:0,a=void 0!==a?a:Math.PI;var s,u,l=Math.min(o+a,Math.PI),c=0,h=[],p=new dn,f=new dn,d=[],m=[],g=[],v=[];for(u=0;u<=n;u++){var y=[],x=u/n,_=0;for(0==u&&0==o?_=.5/e:u==n&&l==Math.PI&&(_=-.5/e),s=0;s<=e;s++){var b=s/e;p.x=-t*Math.cos(r+b*i)*Math.sin(o+x*a),p.y=t*Math.cos(o+x*a),p.z=t*Math.sin(r+b*i)*Math.sin(o+x*a),m.push(p.x,p.y,p.z),f.copy(p).normalize(),g.push(f.x,f.y,f.z),v.push(b+_,1-x),y.push(c++)}h.push(y)}for(u=0;u<n;u++)for(s=0;s<e;s++){var w=h[u][s+1],M=h[u][s],S=h[u+1][s],T=h[u+1][s+1];(0!==u||o>0)&&d.push(w,M,T),(u!==n-1||l<Math.PI)&&d.push(M,S,T)}this.setIndex(d),this.addAttribute("position",new Ar(m,3)),this.addAttribute("normal",new Ar(g,3)),this.addAttribute("uv",new Ar(v,2))}function As(t,e,n,r,i,o){Br.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:o},this.fromBufferGeometry(new Ps(t,e,n,r,i,o)),this.mergeVertices()}function Ps(t,e,n,r,i,o){Dr.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:o},t=t||.5,e=e||1,i=void 0!==i?i:0,o=void 0!==o?o:2*Math.PI,n=void 0!==n?Math.max(3,n):8;var a,s,u,l=[],c=[],h=[],p=[],f=t,d=(e-t)/(r=void 0!==r?Math.max(1,r):1),m=new dn,g=new pn;for(s=0;s<=r;s++){for(u=0;u<=n;u++)a=i+u/n*o,m.x=f*Math.cos(a),m.y=f*Math.sin(a),c.push(m.x,m.y,m.z),h.push(0,0,1),g.x=(m.x/e+1)/2,g.y=(m.y/e+1)/2,p.push(g.x,g.y);f+=d}for(s=0;s<r;s++){var v=s*(n+1);for(u=0;u<n;u++){var y=a=u+v,x=a+n+1,_=a+n+2,b=a+1;l.push(y,x,b),l.push(x,_,b)}}this.setIndex(l),this.addAttribute("position",new Ar(c,3)),this.addAttribute("normal",new Ar(h,3)),this.addAttribute("uv",new Ar(p,2))}function Cs(t,e,n,r){Br.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:r},this.fromBufferGeometry(new Ls(t,e,n,r)),this.mergeVertices()}function Ls(t,e,n,r){Dr.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:r},e=Math.floor(e)||12,n=n||0,r=r||2*Math.PI,r=hn.clamp(r,0,2*Math.PI);var i,o,a,s=[],u=[],l=[],c=1/e,h=new dn,p=new pn;for(o=0;o<=e;o++){var f=n+o*c*r,d=Math.sin(f),m=Math.cos(f);for(a=0;a<=t.length-1;a++)h.x=t[a].x*d,h.y=t[a].y,h.z=t[a].x*m,u.push(h.x,h.y,h.z),p.x=o/e,p.y=a/(t.length-1),l.push(p.x,p.y)}for(o=0;o<e;o++)for(a=0;a<t.length-1;a++){var g=i=a+o*t.length,v=i+t.length,y=i+t.length+1,x=i+1;s.push(g,v,x),s.push(v,y,x)}if(this.setIndex(s),this.addAttribute("position",new Ar(u,3)),this.addAttribute("uv",new Ar(l,2)),this.computeVertexNormals(),r===2*Math.PI){var _=this.attributes.normal.array,b=new dn,w=new dn,M=new dn;for(i=e*t.length*3,o=0,a=0;o<t.length;o++,a+=3)b.x=_[a+0],b.y=_[a+1],b.z=_[a+2],w.x=_[i+a+0],w.y=_[i+a+1],w.z=_[i+a+2],M.addVectors(b,w).normalize(),_[a+0]=_[i+a+0]=M.x,_[a+1]=_[i+a+1]=M.y,_[a+2]=_[i+a+2]=M.z}}function Is(t,e){Br.call(this),this.type="ShapeGeometry","object"==typeof e&&(e=e.curveSegments),this.parameters={shapes:t,curveSegments:e},this.fromBufferGeometry(new Os(t,e)),this.mergeVertices()}function Os(t,e){Dr.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:e},e=e||12;var n=[],r=[],i=[],o=[],a=0,s=0;if(!1===Array.isArray(t))l(t);else for(var u=0;u<t.length;u++)l(t[u]),this.addGroup(a,s,u),a+=s,s=0;function l(t){var a,u,l,c=r.length/3,h=t.extractPoints(e),p=h.shape,f=h.holes;for(!1===gs.isClockWise(p)&&(p=p.reverse()),a=0,u=f.length;a<u;a++)l=f[a],!0===gs.isClockWise(l)&&(f[a]=l.reverse());var d=gs.triangulateShape(p,f);for(a=0,u=f.length;a<u;a++)l=f[a],p=p.concat(l);for(a=0,u=p.length;a<u;a++){var m=p[a];r.push(m.x,m.y,0),i.push(0,0,1),o.push(m.x,m.y)}for(a=0,u=d.length;a<u;a++){var g=d[a],v=g[0]+c,y=g[1]+c,x=g[2]+c;n.push(v,y,x),s+=3}}this.setIndex(n),this.addAttribute("position",new Ar(r,3)),this.addAttribute("normal",new Ar(i,3)),this.addAttribute("uv",new Ar(o,2))}function Ns(t,e){if(e.shapes=[],Array.isArray(t))for(var n=0,r=t.length;n<r;n++){var i=t[n];e.shapes.push(i.uuid)}else e.shapes.push(t.uuid);return e}function Rs(t,e){Dr.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:e},e=void 0!==e?e:1;var n,r,i,o,a=[],s=Math.cos(hn.DEG2RAD*e),u=[0,0],l={},c=["a","b","c"];t.isBufferGeometry?(o=new Br).fromBufferGeometry(t):o=t.clone(),o.mergeVertices(),o.computeFaceNormals();for(var h=o.vertices,p=o.faces,f=0,d=p.length;f<d;f++)for(var m=p[f],g=0;g<3;g++)n=m[c[g]],r=m[c[(g+1)%3]],u[0]=Math.min(n,r),u[1]=Math.max(n,r),void 0===l[i=u[0]+","+u[1]]?l[i]={index1:u[0],index2:u[1],face1:f,face2:void 0}:l[i].face2=f;for(i in l){var v=l[i];if(void 0===v.face2||p[v.face1].normal.dot(p[v.face2].normal)<=s){var y=h[v.index1];a.push(y.x,y.y,y.z),y=h[v.index2],a.push(y.x,y.y,y.z)}}this.addAttribute("position",new Ar(a,3))}function Ds(t,e,n,r,i,o,a,s){Br.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s},this.fromBufferGeometry(new ks(t,e,n,r,i,o,a,s)),this.mergeVertices()}function ks(t,e,n,r,i,o,a,s){Dr.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s};var u=this;t=void 0!==t?t:1,e=void 0!==e?e:1,n=n||1,r=Math.floor(r)||8,i=Math.floor(i)||1,o=void 0!==o&&o,a=void 0!==a?a:0,s=void 0!==s?s:2*Math.PI;var l=[],c=[],h=[],p=[],f=0,d=[],m=n/2,g=0;function v(n){var i,o,d,v=new pn,y=new dn,x=0,_=!0===n?t:e,b=!0===n?1:-1;for(o=f,i=1;i<=r;i++)c.push(0,m*b,0),h.push(0,b,0),p.push(.5,.5),f++;for(d=f,i=0;i<=r;i++){var w=i/r*s+a,M=Math.cos(w),S=Math.sin(w);y.x=_*S,y.y=m*b,y.z=_*M,c.push(y.x,y.y,y.z),h.push(0,b,0),v.x=.5*M+.5,v.y=.5*S*b+.5,p.push(v.x,v.y),f++}for(i=0;i<r;i++){var T=o+i,E=d+i;!0===n?l.push(E,E+1,T):l.push(E+1,E,T),x+=3}u.addGroup(g,x,!0===n?1:2),g+=x}!function(){var o,v,y=new dn,x=new dn,_=0,b=(e-t)/n;for(v=0;v<=i;v++){var w=[],M=v/i,S=M*(e-t)+t;for(o=0;o<=r;o++){var T=o/r,E=T*s+a,A=Math.sin(E),P=Math.cos(E);x.x=S*A,x.y=-M*n+m,x.z=S*P,c.push(x.x,x.y,x.z),y.set(A,b,P).normalize(),h.push(y.x,y.y,y.z),p.push(T,1-M),w.push(f++)}d.push(w)}for(o=0;o<r;o++)for(v=0;v<i;v++){var C=d[v][o],L=d[v+1][o],I=d[v+1][o+1],O=d[v][o+1];l.push(C,L,O),l.push(L,I,O),_+=6}u.addGroup(g,_,0),g+=_}(),!1===o&&(t>0&&v(!0),e>0&&v(!1)),this.setIndex(l),this.addAttribute("position",new Ar(c,3)),this.addAttribute("normal",new Ar(h,3)),this.addAttribute("uv",new Ar(p,2))}function Fs(t,e,n,r,i,o,a){Ds.call(this,0,t,e,n,r,i,o,a),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:a}}function Bs(t,e,n,r,i,o,a){ks.call(this,0,t,e,n,r,i,o,a),this.type="ConeBufferGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:a}}function Us(t,e,n,r){Br.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:r},this.fromBufferGeometry(new zs(t,e,n,r)),this.mergeVertices()}function zs(t,e,n,r){Dr.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:r},t=t||1,e=void 0!==e?Math.max(3,e):8,n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI;var i,o,a=[],s=[],u=[],l=[],c=new dn,h=new pn;for(s.push(0,0,0),u.push(0,0,1),l.push(.5,.5),o=0,i=3;o<=e;o++,i+=3){var p=n+o/e*r;c.x=t*Math.cos(p),c.y=t*Math.sin(p),s.push(c.x,c.y,c.z),u.push(0,0,1),h.x=(s[i]/t+1)/2,h.y=(s[i+1]/t+1)/2,l.push(h.x,h.y)}for(i=1;i<=e;i++)a.push(i,i+1,0);this.setIndex(a),this.addAttribute("position",new Ar(s,3)),this.addAttribute("normal",new Ar(u,3)),this.addAttribute("uv",new Ar(l,2))}Ms.prototype=Object.create(Br.prototype),Ms.prototype.constructor=Ms,Ss.prototype=Object.create(_s.prototype),Ss.prototype.constructor=Ss,Ts.prototype=Object.create(Br.prototype),Ts.prototype.constructor=Ts,Es.prototype=Object.create(Dr.prototype),Es.prototype.constructor=Es,As.prototype=Object.create(Br.prototype),As.prototype.constructor=As,Ps.prototype=Object.create(Dr.prototype),Ps.prototype.constructor=Ps,Cs.prototype=Object.create(Br.prototype),Cs.prototype.constructor=Cs,Ls.prototype=Object.create(Dr.prototype),Ls.prototype.constructor=Ls,Is.prototype=Object.create(Br.prototype),Is.prototype.constructor=Is,Is.prototype.toJSON=function(){var t=Br.prototype.toJSON.call(this);return Ns(this.parameters.shapes,t)},Os.prototype=Object.create(Dr.prototype),Os.prototype.constructor=Os,Os.prototype.toJSON=function(){var t=Dr.prototype.toJSON.call(this);return Ns(this.parameters.shapes,t)},Rs.prototype=Object.create(Dr.prototype),Rs.prototype.constructor=Rs,Ds.prototype=Object.create(Br.prototype),Ds.prototype.constructor=Ds,ks.prototype=Object.create(Dr.prototype),ks.prototype.constructor=ks,Fs.prototype=Object.create(Ds.prototype),Fs.prototype.constructor=Fs,Bs.prototype=Object.create(ks.prototype),Bs.prototype.constructor=Bs,Us.prototype=Object.create(Br.prototype),Us.prototype.constructor=Us,zs.prototype=Object.create(Dr.prototype),zs.prototype.constructor=zs;var Vs=Object.freeze({WireframeGeometry:Ca,ParametricGeometry:La,ParametricBufferGeometry:Ia,TetrahedronGeometry:Ra,TetrahedronBufferGeometry:Da,OctahedronGeometry:ka,OctahedronBufferGeometry:Fa,IcosahedronGeometry:Ba,IcosahedronBufferGeometry:Ua,DodecahedronGeometry:za,DodecahedronBufferGeometry:Va,PolyhedronGeometry:Oa,PolyhedronBufferGeometry:Na,TubeGeometry:Ga,TubeBufferGeometry:ja,TorusKnotGeometry:Wa,TorusKnotBufferGeometry:Ha,TorusGeometry:Xa,TorusBufferGeometry:Ya,TextGeometry:Ms,TextBufferGeometry:Ss,SphereGeometry:Ts,SphereBufferGeometry:Es,RingGeometry:As,RingBufferGeometry:Ps,PlaneGeometry:li,PlaneBufferGeometry:ci,LatheGeometry:Cs,LatheBufferGeometry:Ls,ShapeGeometry:Is,ShapeBufferGeometry:Os,ExtrudeGeometry:xs,ExtrudeBufferGeometry:_s,EdgesGeometry:Rs,ConeGeometry:Fs,ConeBufferGeometry:Bs,CylinderGeometry:Ds,CylinderBufferGeometry:ks,CircleGeometry:Us,CircleBufferGeometry:zs,BoxGeometry:Ur,BoxBufferGeometry:zr});function Gs(t){vr.call(this),this.type="ShadowMaterial",this.color=new hr(0),this.transparent=!0,this.setValues(t)}function js(t){Xr.call(this,t),this.type="RawShaderMaterial"}function Ws(t){vr.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new hr(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new hr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Xe,this.normalScale=new pn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Hs(t){Ws.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(t)}function Xs(t){vr.call(this),this.type="MeshPhongMaterial",this.color=new hr(16777215),this.specular=new hr(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new hr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Xe,this.normalScale=new pn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=it,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Ys(t){Xs.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(t)}function qs(t){vr.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Xe,this.normalScale=new pn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Zs(t){vr.call(this),this.type="MeshLambertMaterial",this.color=new hr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new hr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=it,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Js(t){vr.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new hr(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Xe,this.normalScale=new pn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.lights=!1,this.setValues(t)}function Ks(t){xa.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}Gs.prototype=Object.create(vr.prototype),Gs.prototype.constructor=Gs,Gs.prototype.isShadowMaterial=!0,Gs.prototype.copy=function(t){return vr.prototype.copy.call(this,t),this.color.copy(t.color),this},js.prototype=Object.create(Xr.prototype),js.prototype.constructor=js,js.prototype.isRawShaderMaterial=!0,Ws.prototype=Object.create(vr.prototype),Ws.prototype.constructor=Ws,Ws.prototype.isMeshStandardMaterial=!0,Ws.prototype.copy=function(t){return vr.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Hs.prototype=Object.create(Ws.prototype),Hs.prototype.constructor=Hs,Hs.prototype.isMeshPhysicalMaterial=!0,Hs.prototype.copy=function(t){return Ws.prototype.copy.call(this,t),this.defines={PHYSICAL:""},this.reflectivity=t.reflectivity,this.clearCoat=t.clearCoat,this.clearCoatRoughness=t.clearCoatRoughness,this},Xs.prototype=Object.create(vr.prototype),Xs.prototype.constructor=Xs,Xs.prototype.isMeshPhongMaterial=!0,Xs.prototype.copy=function(t){return vr.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Ys.prototype=Object.create(Xs.prototype),Ys.prototype.constructor=Ys,Ys.prototype.isMeshToonMaterial=!0,Ys.prototype.copy=function(t){return Xs.prototype.copy.call(this,t),this.gradientMap=t.gradientMap,this},qs.prototype=Object.create(vr.prototype),qs.prototype.constructor=qs,qs.prototype.isMeshNormalMaterial=!0,qs.prototype.copy=function(t){return vr.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Zs.prototype=Object.create(vr.prototype),Zs.prototype.constructor=Zs,Zs.prototype.isMeshLambertMaterial=!0,Zs.prototype.copy=function(t){return vr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Js.prototype=Object.create(vr.prototype),Js.prototype.constructor=Js,Js.prototype.isMeshMatcapMaterial=!0,Js.prototype.copy=function(t){return vr.prototype.copy.call(this,t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Ks.prototype=Object.create(xa.prototype),Ks.prototype.constructor=Ks,Ks.prototype.isLineDashedMaterial=!0,Ks.prototype.copy=function(t){return xa.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var Qs=Object.freeze({ShadowMaterial:Gs,SpriteMaterial:fa,RawShaderMaterial:js,ShaderMaterial:Xr,PointsMaterial:Ma,MeshPhysicalMaterial:Hs,MeshStandardMaterial:Ws,MeshPhongMaterial:Xs,MeshToonMaterial:Ys,MeshNormalMaterial:qs,MeshLambertMaterial:Zs,MeshDepthMaterial:jo,MeshDistanceMaterial:Wo,MeshBasicMaterial:yr,MeshMatcapMaterial:Js,LineDashedMaterial:Ks,LineBasicMaterial:xa,Material:vr}),$s={arraySlice:function(t,e,n){return $s.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==n?n:t.length)):t.slice(e,n)},convertArray:function(t,e,n){return!t||!n&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){for(var e=t.length,n=new Array(e),r=0;r!==e;++r)n[r]=r;return n.sort((function(e,n){return t[e]-t[n]})),n},sortedArray:function(t,e,n){for(var r=t.length,i=new t.constructor(r),o=0,a=0;a!==r;++o)for(var s=n[o]*e,u=0;u!==e;++u)i[a++]=t[s+u];return i},flattenJSON:function(t,e,n,r){for(var i=1,o=t[0];void 0!==o&&void 0===o[r];)o=t[i++];if(void 0!==o){var a=o[r];if(void 0!==a)if(Array.isArray(a))do{void 0!==(a=o[r])&&(e.push(o.time),n.push.apply(n,a)),o=t[i++]}while(void 0!==o);else if(void 0!==a.toArray)do{void 0!==(a=o[r])&&(e.push(o.time),a.toArray(n,n.length)),o=t[i++]}while(void 0!==o);else do{void 0!==(a=o[r])&&(e.push(o.time),n.push(a)),o=t[i++]}while(void 0!==o)}}};function tu(t,e,n,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new e.constructor(n),this.sampleValues=e,this.valueSize=n}function eu(t,e,n,r){tu.call(this,t,e,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function nu(t,e,n,r){tu.call(this,t,e,n,r)}function ru(t,e,n,r){tu.call(this,t,e,n,r)}function iu(t,e,n,r){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=$s.convertArray(e,this.TimeBufferType),this.values=$s.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}function ou(t,e,n){iu.call(this,t,e,n)}function au(t,e,n,r){iu.call(this,t,e,n,r)}function su(t,e,n,r){iu.call(this,t,e,n,r)}function uu(t,e,n,r){tu.call(this,t,e,n,r)}function lu(t,e,n,r){iu.call(this,t,e,n,r)}function cu(t,e,n,r){iu.call(this,t,e,n,r)}function hu(t,e,n,r){iu.call(this,t,e,n,r)}function pu(t,e,n){this.name=t,this.tracks=n,this.duration=void 0!==e?e:-1,this.uuid=hn.generateUUID(),this.duration<0&&this.resetDuration()}function fu(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var e=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return su;case"vector":case"vector2":case"vector3":case"vector4":return hu;case"color":return au;case"quaternion":return lu;case"bool":case"boolean":return ou;case"string":return cu}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(t.type);if(void 0===t.times){var n=[],r=[];$s.flattenJSON(t.keys,n,r,"value"),t.times=n,t.values=r}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}Object.assign(tu.prototype,{evaluate:function(t){var e=this.parameterPositions,n=this._cachedIndex,r=e[n],i=e[n-1];t:{e:{var o;n:{r:if(!(t<r)){for(var a=n+2;;){if(void 0===r){if(t<i)break r;return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,t,i)}if(n===a)break;if(i=r,t<(r=e[++n]))break e}o=e.length;break n}if(t>=i)break t;var s=e[1];t<s&&(n=2,i=s);for(a=n-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,t,r);if(n===a)break;if(r=i,t>=(i=e[--n-1]))break e}o=n,n=0}for(;n<o;){var u=n+o>>>1;t<e[u]?o=u:n=u+1}if(r=e[n],void 0===(i=e[n-1]))return this._cachedIndex=0,this.beforeStart_(0,t,r);if(void 0===r)return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,i,t)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,t,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){for(var e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=t*r,o=0;o!==r;++o)e[o]=n[i+o];return e},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),
//!\ DECLARE ALIAS AFTER assign prototype !
Object.assign(tu.prototype,{beforeStart_:tu.prototype.copySampleValue_,afterEnd_:tu.prototype.copySampleValue_}),eu.prototype=Object.assign(Object.create(tu.prototype),{constructor:eu,DefaultSettings_:{endingStart:Le,endingEnd:Le},intervalChanged_:function(t,e,n){var r=this.parameterPositions,i=t-2,o=t+1,a=r[i],s=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case Ie:i=t,a=2*e-n;break;case Oe:a=e+r[i=r.length-2]-r[i+1];break;default:i=t,a=n}if(void 0===s)switch(this.getSettings_().endingEnd){case Ie:o=t,s=2*n-e;break;case Oe:o=1,s=n+r[1]-r[0];break;default:o=t-1,s=e}var u=.5*(n-e),l=this.valueSize;this._weightPrev=u/(e-a),this._weightNext=u/(s-n),this._offsetPrev=i*l,this._offsetNext=o*l},interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,u=s-a,l=this._offsetPrev,c=this._offsetNext,h=this._weightPrev,p=this._weightNext,f=(n-e)/(r-e),d=f*f,m=d*f,g=-h*m+2*h*d-h*f,v=(1+h)*m+(-1.5-2*h)*d+(-.5+h)*f+1,y=(-1-p)*m+(1.5+p)*d+.5*f,x=p*m-p*d,_=0;_!==a;++_)i[_]=g*o[l+_]+v*o[u+_]+y*o[s+_]+x*o[c+_];return i}}),nu.prototype=Object.assign(Object.create(tu.prototype),{constructor:nu,interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,u=s-a,l=(n-e)/(r-e),c=1-l,h=0;h!==a;++h)i[h]=o[u+h]*c+o[s+h]*l;return i}}),ru.prototype=Object.assign(Object.create(tu.prototype),{constructor:ru,interpolate_:function(t){return this.copySampleValue_(t-1)}}),Object.assign(iu,{toJSON:function(t){var e,n=t.constructor;if(void 0!==n.toJSON)e=n.toJSON(t);else{e={name:t.name,times:$s.convertArray(t.times,Array),values:$s.convertArray(t.values,Array)};var r=t.getInterpolation();r!==t.DefaultInterpolation&&(e.interpolation=r)}return e.type=t.ValueTypeName,e}}),Object.assign(iu.prototype,{constructor:iu,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:Pe,InterpolantFactoryMethodDiscrete:function(t){return new ru(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new nu(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new eu(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){var e;switch(t){case Ae:e=this.InterpolantFactoryMethodDiscrete;break;case Pe:e=this.InterpolantFactoryMethodLinear;break;case Ce:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return this}return this.createInterpolant=e,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Ae;case this.InterpolantFactoryMethodLinear:return Pe;case this.InterpolantFactoryMethodSmooth:return Ce}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var e=this.times,n=0,r=e.length;n!==r;++n)e[n]+=t;return this},scale:function(t){if(1!==t)for(var e=this.times,n=0,r=e.length;n!==r;++n)e[n]*=t;return this},trim:function(t,e){for(var n=this.times,r=n.length,i=0,o=r-1;i!==r&&n[i]<t;)++i;for(;-1!==o&&n[o]>e;)--o;if(++o,0!==i||o!==r){i>=o&&(i=(o=Math.max(o,1))-1);var a=this.getValueSize();this.times=$s.arraySlice(n,i,o),this.values=$s.arraySlice(this.values,i*a,o*a)}return this},validate:function(){var t=!0,e=this.getValueSize();e-Math.floor(e)!=0&&(t=!1);var n=this.times,r=this.values,i=n.length;0===i&&(t=!1);for(var o=null,a=0;a!==i;a++){var s=n[a];if("number"==typeof s&&isNaN(s)){t=!1;break}if(null!==o&&o>s){t=!1;break}o=s}if(void 0!==r&&$s.isTypedArray(r)){a=0;for(var u=r.length;a!==u;++a){var l=r[a];if(isNaN(l)){t=!1;break}}}return t},optimize:function(){for(var t=this.times,e=this.values,n=this.getValueSize(),r=this.getInterpolation()===Ce,i=1,o=t.length-1,a=1;a<o;++a){var s=!1,u=t[a];if(u!==t[a+1]&&(1!==a||u!==u[0]))if(r)s=!0;else for(var l=a*n,c=l-n,h=l+n,p=0;p!==n;++p){var f=e[l+p];if(f!==e[c+p]||f!==e[h+p]){s=!0;break}}if(s){if(a!==i){t[i]=t[a];var d=a*n,m=i*n;for(p=0;p!==n;++p)e[m+p]=e[d+p]}++i}}if(o>0){t[i]=t[o];for(d=o*n,m=i*n,p=0;p!==n;++p)e[m+p]=e[d+p];++i}return i!==t.length&&(this.times=$s.arraySlice(t,0,i),this.values=$s.arraySlice(e,0,i*n)),this},clone:function(){var t=$s.arraySlice(this.times,0),e=$s.arraySlice(this.values,0),n=new(0,this.constructor)(this.name,t,e);return n.createInterpolant=this.createInterpolant,n}}),ou.prototype=Object.assign(Object.create(iu.prototype),{constructor:ou,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:Ae,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),au.prototype=Object.assign(Object.create(iu.prototype),{constructor:au,ValueTypeName:"color"}),su.prototype=Object.assign(Object.create(iu.prototype),{constructor:su,ValueTypeName:"number"}),uu.prototype=Object.assign(Object.create(tu.prototype),{constructor:uu,interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,u=(n-e)/(r-e),l=s+a;s!==l;s+=4)fn.slerpFlat(i,0,o,s-a,o,s,u);return i}}),lu.prototype=Object.assign(Object.create(iu.prototype),{constructor:lu,ValueTypeName:"quaternion",DefaultInterpolation:Pe,InterpolantFactoryMethodLinear:function(t){return new uu(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),cu.prototype=Object.assign(Object.create(iu.prototype),{constructor:cu,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:Ae,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),hu.prototype=Object.assign(Object.create(iu.prototype),{constructor:hu,ValueTypeName:"vector"}),Object.assign(pu,{parse:function(t){for(var e=[],n=t.tracks,r=1/(t.fps||1),i=0,o=n.length;i!==o;++i)e.push(fu(n[i]).scale(r));return new pu(t.name,t.duration,e)},toJSON:function(t){for(var e=[],n=t.tracks,r={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid},i=0,o=n.length;i!==o;++i)e.push(iu.toJSON(n[i]));return r},CreateFromMorphTargetSequence:function(t,e,n,r){for(var i=e.length,o=[],a=0;a<i;a++){var s=[],u=[];s.push((a+i-1)%i,a,(a+1)%i),u.push(0,1,0);var l=$s.getKeyframeOrder(s);s=$s.sortedArray(s,1,l),u=$s.sortedArray(u,1,l),r||0!==s[0]||(s.push(i),u.push(u[0])),o.push(new su(".morphTargetInfluences["+e[a].name+"]",s,u).scale(1/n))}return new pu(t,-1,o)},findByName:function(t,e){var n=t;if(!Array.isArray(t)){var r=t;n=r.geometry&&r.geometry.animations||r.animations}for(var i=0;i<n.length;i++)if(n[i].name===e)return n[i];return null},CreateClipsFromMorphTargetSequences:function(t,e,n){for(var r={},i=/^([\w-]*?)([\d]+)$/,o=0,a=t.length;o<a;o++){var s=t[o],u=s.name.match(i);if(u&&u.length>1){var l=r[h=u[1]];l||(r[h]=l=[]),l.push(s)}}var c=[];for(var h in r)c.push(pu.CreateFromMorphTargetSequence(h,r[h],e,n));return c},parseAnimation:function(t,e){if(!t)return null;for(var n=function(t,e,n,r,i){if(0!==n.length){var o=[],a=[];$s.flattenJSON(n,o,a,r),0!==o.length&&i.push(new t(e,o,a))}},r=[],i=t.name||"default",o=t.length||-1,a=t.fps||30,s=t.hierarchy||[],u=0;u<s.length;u++){var l=s[u].keys;if(l&&0!==l.length)if(l[0].morphTargets){for(var c={},h=0;h<l.length;h++)if(l[h].morphTargets)for(var p=0;p<l[h].morphTargets.length;p++)c[l[h].morphTargets[p]]=-1;for(var f in c){var d=[],m=[];for(p=0;p!==l[h].morphTargets.length;++p){var g=l[h];d.push(g.time),m.push(g.morphTarget===f?1:0)}r.push(new su(".morphTargetInfluence["+f+"]",d,m))}o=c.length*(a||1)}else{var v=".bones["+e[u].name+"]";n(hu,v+".position",l,"pos",r),n(lu,v+".quaternion",l,"rot",r),n(hu,v+".scale",l,"scl",r)}}return 0===r.length?null:new pu(i,o,r)}}),Object.assign(pu.prototype,{resetDuration:function(){for(var t=0,e=0,n=this.tracks.length;e!==n;++e){var r=this.tracks[e];t=Math.max(t,r.times[r.times.length-1])}return this.duration=t,this},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},validate:function(){for(var t=!0,e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this},clone:function(){for(var t=[],e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new pu(this.name,this.duration,t)}});var du={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};function mu(t,e,n){var r=this,i=!1,o=0,a=0,s=void 0;this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){a++,!1===i&&void 0!==r.onStart&&r.onStart(t,o,a),i=!0},this.itemEnd=function(t){o++,void 0!==r.onProgress&&r.onProgress(t,o,a),o===a&&(i=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(t){void 0!==r.onError&&r.onError(t)},this.resolveURL=function(t){return s?s(t):t},this.setURLModifier=function(t){return s=t,this}}var gu=new mu,vu={};function yu(t){this.manager=void 0!==t?t:gu}function xu(t){this.manager=void 0!==t?t:gu}function _u(t){this.manager=void 0!==t?t:gu,this._parser=null}function bu(t){this.manager=void 0!==t?t:gu,this._parser=null}function wu(t){this.manager=void 0!==t?t:gu}function Mu(t){this.manager=void 0!==t?t:gu}function Su(t){this.manager=void 0!==t?t:gu}function Tu(){this.type="Curve",this.arcLengthDivisions=200}function Eu(t,e,n,r,i,o,a,s){Tu.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=e||0,this.xRadius=n||1,this.yRadius=r||1,this.aStartAngle=i||0,this.aEndAngle=o||2*Math.PI,this.aClockwise=a||!1,this.aRotation=s||0}function Au(t,e,n,r,i,o){Eu.call(this,t,e,n,n,r,i,o),this.type="ArcCurve"}function Pu(){var t=0,e=0,n=0,r=0;function i(i,o,a,s){t=i,e=a,n=-3*i+3*o-2*a-s,r=2*i-2*o+a+s}return{initCatmullRom:function(t,e,n,r,o){i(e,n,o*(n-t),o*(r-e))},initNonuniformCatmullRom:function(t,e,n,r,o,a,s){var u=(e-t)/o-(n-t)/(o+a)+(n-e)/a,l=(n-e)/a-(r-e)/(a+s)+(r-n)/s;i(e,n,u*=a,l*=a)},calc:function(i){var o=i*i;return t+e*i+n*o+r*(o*i)}}}Object.assign(yu.prototype,{load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,o=du.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout((function(){e&&e(o),i.manager.itemEnd(t)}),0),o;if(void 0===vu[t]){var a=t.match(/^data:(.*?)(;base64)?,(.*)$/);if(a){var s=a[1],u=!!a[2],l=a[3];l=decodeURIComponent(l),u&&(l=atob(l));try{var c,h=(this.responseType||"").toLowerCase();switch(h){case"arraybuffer":case"blob":for(var p=new Uint8Array(l.length),f=0;f<l.length;f++)p[f]=l.charCodeAt(f);c="blob"===h?new Blob([p.buffer],{type:s}):p.buffer;break;case"document":var d=new DOMParser;c=d.parseFromString(l,s);break;case"json":c=JSON.parse(l);break;default:c=l}setTimeout((function(){e&&e(c),i.manager.itemEnd(t)}),0)}catch(e){setTimeout((function(){r&&r(e),i.manager.itemError(t),i.manager.itemEnd(t)}),0)}}else{vu[t]=[],vu[t].push({onLoad:e,onProgress:n,onError:r});var m=new XMLHttpRequest;for(var g in m.open("GET",t,!0),m.addEventListener("load",(function(e){var n=this.response;du.add(t,n);var r=vu[t];if(delete vu[t],200===this.status||0===this.status){this.status;for(var o=0,a=r.length;o<a;o++){(s=r[o]).onLoad&&s.onLoad(n)}i.manager.itemEnd(t)}else{for(o=0,a=r.length;o<a;o++){var s;(s=r[o]).onError&&s.onError(e)}i.manager.itemError(t),i.manager.itemEnd(t)}}),!1),m.addEventListener("progress",(function(e){for(var n=vu[t],r=0,i=n.length;r<i;r++){var o=n[r];o.onProgress&&o.onProgress(e)}}),!1),m.addEventListener("error",(function(e){var n=vu[t];delete vu[t];for(var r=0,o=n.length;r<o;r++){var a=n[r];a.onError&&a.onError(e)}i.manager.itemError(t),i.manager.itemEnd(t)}),!1),m.addEventListener("abort",(function(e){var n=vu[t];delete vu[t];for(var r=0,o=n.length;r<o;r++){var a=n[r];a.onError&&a.onError(e)}i.manager.itemError(t),i.manager.itemEnd(t)}),!1),void 0!==this.responseType&&(m.responseType=this.responseType),void 0!==this.withCredentials&&(m.withCredentials=this.withCredentials),m.overrideMimeType&&m.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)m.setRequestHeader(g,this.requestHeader[g]);m.send(null)}return i.manager.itemStart(t),m}vu[t].push({onLoad:e,onProgress:n,onError:r})},setPath:function(t){return this.path=t,this},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}}),Object.assign(xu.prototype,{load:function(t,e,n,r){var i=this,o=new yu(i.manager);o.setPath(i.path),o.load(t,(function(t){e(i.parse(JSON.parse(t)))}),n,r)},parse:function(t){for(var e=[],n=0;n<t.length;n++){var r=pu.parse(t[n]);e.push(r)}return e},setPath:function(t){return this.path=t,this}}),Object.assign(_u.prototype,{load:function(t,e,n,r){var i=this,o=[],a=new Ea;a.image=o;var s=new yu(this.manager);function u(u){s.load(t[u],(function(t){var n=i._parser(t,!0);o[u]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},6===(l+=1)&&(1===n.mipmapCount&&(a.minFilter=Ct),a.format=n.format,a.needsUpdate=!0,e&&e(a))}),n,r)}if(s.setPath(this.path),s.setResponseType("arraybuffer"),Array.isArray(t))for(var l=0,c=0,h=t.length;c<h;++c)u(c);else s.load(t,(function(t){var n=i._parser(t,!0);if(n.isCubemap)for(var r=n.mipmaps.length/n.mipmapCount,s=0;s<r;s++){o[s]={mipmaps:[]};for(var u=0;u<n.mipmapCount;u++)o[s].mipmaps.push(n.mipmaps[s*n.mipmapCount+u]),o[s].format=n.format,o[s].width=n.width,o[s].height=n.height}else a.image.width=n.width,a.image.height=n.height,a.mipmaps=n.mipmaps;1===n.mipmapCount&&(a.minFilter=Ct),a.format=n.format,a.needsUpdate=!0,e&&e(a)}),n,r);return a},setPath:function(t){return this.path=t,this}}),Object.assign(bu.prototype,{load:function(t,e,n,r){var i=this,o=new ei,a=new yu(this.manager);return a.setResponseType("arraybuffer"),a.setPath(this.path),a.load(t,(function(t){var n=i._parser(t);n&&(void 0!==n.image?o.image=n.image:void 0!==n.data&&(o.image.width=n.width,o.image.height=n.height,o.image.data=n.data),o.wrapS=void 0!==n.wrapS?n.wrapS:wt,o.wrapT=void 0!==n.wrapT?n.wrapT:wt,o.magFilter=void 0!==n.magFilter?n.magFilter:Ct,o.minFilter=void 0!==n.minFilter?n.minFilter:Ot,o.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.format&&(o.format=n.format),void 0!==n.type&&(o.type=n.type),void 0!==n.mipmaps&&(o.mipmaps=n.mipmaps),1===n.mipmapCount&&(o.minFilter=Ct),o.needsUpdate=!0,e&&e(o,n))}),n,r),o},setPath:function(t){return this.path=t,this}}),Object.assign(wu.prototype,{crossOrigin:"anonymous",load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,o=du.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout((function(){e&&e(o),i.manager.itemEnd(t)}),0),o;var a=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){a.removeEventListener("load",s,!1),a.removeEventListener("error",u,!1),du.add(t,this),e&&e(this),i.manager.itemEnd(t)}function u(e){a.removeEventListener("load",s,!1),a.removeEventListener("error",u,!1),r&&r(e),i.manager.itemError(t),i.manager.itemEnd(t)}return a.addEventListener("load",s,!1),a.addEventListener("error",u,!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),i.manager.itemStart(t),a.src=t,a},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(Mu.prototype,{crossOrigin:"anonymous",load:function(t,e,n,r){var i=new wi,o=new wu(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);var a=0;function s(n){o.load(t[n],(function(t){i.images[n]=t,6===++a&&(i.needsUpdate=!0,e&&e(i))}),void 0,r)}for(var u=0;u<t.length;++u)s(u);return i},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(Su.prototype,{crossOrigin:"anonymous",load:function(t,e,n,r){var i=new An,o=new wu(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(t,(function(n){i.image=n;var r=t.search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/);i.format=r?Yt:qt,i.needsUpdate=!0,void 0!==e&&e(i)}),n,r),i},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(Tu.prototype,{getPoint:function(){return null},getPointAt:function(t,e){var n=this.getUtoTmapping(t);return this.getPoint(n,e)},getPoints:function(t){void 0===t&&(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return e},getSpacedPoints:function(t){void 0===t&&(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,n,r=[],i=this.getPoint(0),o=0;for(r.push(0),n=1;n<=t;n++)o+=(e=this.getPoint(n/t)).distanceTo(i),r.push(o),i=e;return this.cacheArcLengths=r,r},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){var n,r=this.getLengths(),i=0,o=r.length;n=e||t*r[o-1];for(var a,s=0,u=o-1;s<=u;)if((a=r[i=Math.floor(s+(u-s)/2)]-n)<0)s=i+1;else{if(!(a>0)){u=i;break}u=i-1}if(r[i=u]===n)return i/(o-1);var l=r[i];return(i+(n-l)/(r[i+1]-l))/(o-1)},getTangent:function(t){var e=1e-4,n=t-e,r=t+e;n<0&&(n=0),r>1&&(r=1);var i=this.getPoint(n);return this.getPoint(r).clone().sub(i).normalize()},getTangentAt:function(t){var e=this.getUtoTmapping(t);return this.getTangent(e)},computeFrenetFrames:function(t,e){var n,r,i,o=new dn,a=[],s=[],u=[],l=new dn,c=new In;for(n=0;n<=t;n++)r=n/t,a[n]=this.getTangentAt(r),a[n].normalize();s[0]=new dn,u[0]=new dn;var h=Number.MAX_VALUE,p=Math.abs(a[0].x),f=Math.abs(a[0].y),d=Math.abs(a[0].z);for(p<=h&&(h=p,o.set(1,0,0)),f<=h&&(h=f,o.set(0,1,0)),d<=h&&o.set(0,0,1),l.crossVectors(a[0],o).normalize(),s[0].crossVectors(a[0],l),u[0].crossVectors(a[0],s[0]),n=1;n<=t;n++)s[n]=s[n-1].clone(),u[n]=u[n-1].clone(),l.crossVectors(a[n-1],a[n]),l.length()>Number.EPSILON&&(l.normalize(),i=Math.acos(hn.clamp(a[n-1].dot(a[n]),-1,1)),s[n].applyMatrix4(c.makeRotationAxis(l,i))),u[n].crossVectors(a[n],s[n]);if(!0===e)for(i=Math.acos(hn.clamp(s[0].dot(s[t]),-1,1)),i/=t,a[0].dot(l.crossVectors(s[0],s[t]))>0&&(i=-i),n=1;n<=t;n++)s[n].applyMatrix4(c.makeRotationAxis(a[n],i*n)),u[n].crossVectors(a[n],s[n]);return{tangents:a,normals:s,binormals:u}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){var t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),Eu.prototype=Object.create(Tu.prototype),Eu.prototype.constructor=Eu,Eu.prototype.isEllipseCurve=!0,Eu.prototype.getPoint=function(t,e){for(var n=e||new pn,r=2*Math.PI,i=this.aEndAngle-this.aStartAngle,o=Math.abs(i)<Number.EPSILON;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=o?0:r),!0!==this.aClockwise||o||(i===r?i=-r:i-=r);var a=this.aStartAngle+t*i,s=this.aX+this.xRadius*Math.cos(a),u=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){var l=Math.cos(this.aRotation),c=Math.sin(this.aRotation),h=s-this.aX,p=u-this.aY;s=h*l-p*c+this.aX,u=h*c+p*l+this.aY}return n.set(s,u)},Eu.prototype.copy=function(t){return Tu.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},Eu.prototype.toJSON=function(){var t=Tu.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},Eu.prototype.fromJSON=function(t){return Tu.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},Au.prototype=Object.create(Eu.prototype),Au.prototype.constructor=Au,Au.prototype.isArcCurve=!0;var Cu=new dn,Lu=new Pu,Iu=new Pu,Ou=new Pu;function Nu(t,e,n,r){Tu.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=e||!1,this.curveType=n||"centripetal",this.tension=r||.5}function Ru(t,e,n,r,i){var o=.5*(r-e),a=.5*(i-n),s=t*t;return(2*n-2*r+o+a)*(t*s)+(-3*n+3*r-2*o-a)*s+o*t+n}function Du(t,e,n,r){return function(t,e){var n=1-t;return n*n*e}(t,e)+function(t,e){return 2*(1-t)*t*e}(t,n)+function(t,e){return t*t*e}(t,r)}function ku(t,e,n,r,i){return function(t,e){var n=1-t;return n*n*n*e}(t,e)+function(t,e){var n=1-t;return 3*n*n*t*e}(t,n)+function(t,e){return 3*(1-t)*t*t*e}(t,r)+function(t,e){return t*t*t*e}(t,i)}function Fu(t,e,n,r){Tu.call(this),this.type="CubicBezierCurve",this.v0=t||new pn,this.v1=e||new pn,this.v2=n||new pn,this.v3=r||new pn}function Bu(t,e,n,r){Tu.call(this),this.type="CubicBezierCurve3",this.v0=t||new dn,this.v1=e||new dn,this.v2=n||new dn,this.v3=r||new dn}function Uu(t,e){Tu.call(this),this.type="LineCurve",this.v1=t||new pn,this.v2=e||new pn}function zu(t,e){Tu.call(this),this.type="LineCurve3",this.v1=t||new dn,this.v2=e||new dn}function Vu(t,e,n){Tu.call(this),this.type="QuadraticBezierCurve",this.v0=t||new pn,this.v1=e||new pn,this.v2=n||new pn}function Gu(t,e,n){Tu.call(this),this.type="QuadraticBezierCurve3",this.v0=t||new dn,this.v1=e||new dn,this.v2=n||new dn}function ju(t){Tu.call(this),this.type="SplineCurve",this.points=t||[]}Nu.prototype=Object.create(Tu.prototype),Nu.prototype.constructor=Nu,Nu.prototype.isCatmullRomCurve3=!0,Nu.prototype.getPoint=function(t,e){var n,r,i,o,a=e||new dn,s=this.points,u=s.length,l=(u-(this.closed?0:1))*t,c=Math.floor(l),h=l-c;if(this.closed?c+=c>0?0:(Math.floor(Math.abs(c)/u)+1)*u:0===h&&c===u-1&&(c=u-2,h=1),this.closed||c>0?n=s[(c-1)%u]:(Cu.subVectors(s[0],s[1]).add(s[0]),n=Cu),r=s[c%u],i=s[(c+1)%u],this.closed||c+2<u?o=s[(c+2)%u]:(Cu.subVectors(s[u-1],s[u-2]).add(s[u-1]),o=Cu),"centripetal"===this.curveType||"chordal"===this.curveType){var p="chordal"===this.curveType?.5:.25,f=Math.pow(n.distanceToSquared(r),p),d=Math.pow(r.distanceToSquared(i),p),m=Math.pow(i.distanceToSquared(o),p);d<1e-4&&(d=1),f<1e-4&&(f=d),m<1e-4&&(m=d),Lu.initNonuniformCatmullRom(n.x,r.x,i.x,o.x,f,d,m),Iu.initNonuniformCatmullRom(n.y,r.y,i.y,o.y,f,d,m),Ou.initNonuniformCatmullRom(n.z,r.z,i.z,o.z,f,d,m)}else"catmullrom"===this.curveType&&(Lu.initCatmullRom(n.x,r.x,i.x,o.x,this.tension),Iu.initCatmullRom(n.y,r.y,i.y,o.y,this.tension),Ou.initCatmullRom(n.z,r.z,i.z,o.z,this.tension));return a.set(Lu.calc(h),Iu.calc(h),Ou.calc(h)),a},Nu.prototype.copy=function(t){Tu.prototype.copy.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push(r.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},Nu.prototype.toJSON=function(){var t=Tu.prototype.toJSON.call(this);t.points=[];for(var e=0,n=this.points.length;e<n;e++){var r=this.points[e];t.points.push(r.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},Nu.prototype.fromJSON=function(t){Tu.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push((new dn).fromArray(r))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},Fu.prototype=Object.create(Tu.prototype),Fu.prototype.constructor=Fu,Fu.prototype.isCubicBezierCurve=!0,Fu.prototype.getPoint=function(t,e){var n=e||new pn,r=this.v0,i=this.v1,o=this.v2,a=this.v3;return n.set(ku(t,r.x,i.x,o.x,a.x),ku(t,r.y,i.y,o.y,a.y)),n},Fu.prototype.copy=function(t){return Tu.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},Fu.prototype.toJSON=function(){var t=Tu.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},Fu.prototype.fromJSON=function(t){return Tu.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},Bu.prototype=Object.create(Tu.prototype),Bu.prototype.constructor=Bu,Bu.prototype.isCubicBezierCurve3=!0,Bu.prototype.getPoint=function(t,e){var n=e||new dn,r=this.v0,i=this.v1,o=this.v2,a=this.v3;return n.set(ku(t,r.x,i.x,o.x,a.x),ku(t,r.y,i.y,o.y,a.y),ku(t,r.z,i.z,o.z,a.z)),n},Bu.prototype.copy=function(t){return Tu.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},Bu.prototype.toJSON=function(){var t=Tu.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},Bu.prototype.fromJSON=function(t){return Tu.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},Uu.prototype=Object.create(Tu.prototype),Uu.prototype.constructor=Uu,Uu.prototype.isLineCurve=!0,Uu.prototype.getPoint=function(t,e){var n=e||new pn;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n},Uu.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},Uu.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},Uu.prototype.copy=function(t){return Tu.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Uu.prototype.toJSON=function(){var t=Tu.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Uu.prototype.fromJSON=function(t){return Tu.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},zu.prototype=Object.create(Tu.prototype),zu.prototype.constructor=zu,zu.prototype.isLineCurve3=!0,zu.prototype.getPoint=function(t,e){var n=e||new dn;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n},zu.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},zu.prototype.copy=function(t){return Tu.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},zu.prototype.toJSON=function(){var t=Tu.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},zu.prototype.fromJSON=function(t){return Tu.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},Vu.prototype=Object.create(Tu.prototype),Vu.prototype.constructor=Vu,Vu.prototype.isQuadraticBezierCurve=!0,Vu.prototype.getPoint=function(t,e){var n=e||new pn,r=this.v0,i=this.v1,o=this.v2;return n.set(Du(t,r.x,i.x,o.x),Du(t,r.y,i.y,o.y)),n},Vu.prototype.copy=function(t){return Tu.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Vu.prototype.toJSON=function(){var t=Tu.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Vu.prototype.fromJSON=function(t){return Tu.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},Gu.prototype=Object.create(Tu.prototype),Gu.prototype.constructor=Gu,Gu.prototype.isQuadraticBezierCurve3=!0,Gu.prototype.getPoint=function(t,e){var n=e||new dn,r=this.v0,i=this.v1,o=this.v2;return n.set(Du(t,r.x,i.x,o.x),Du(t,r.y,i.y,o.y),Du(t,r.z,i.z,o.z)),n},Gu.prototype.copy=function(t){return Tu.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Gu.prototype.toJSON=function(){var t=Tu.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Gu.prototype.fromJSON=function(t){return Tu.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},ju.prototype=Object.create(Tu.prototype),ju.prototype.constructor=ju,ju.prototype.isSplineCurve=!0,ju.prototype.getPoint=function(t,e){var n=e||new pn,r=this.points,i=(r.length-1)*t,o=Math.floor(i),a=i-o,s=r[0===o?o:o-1],u=r[o],l=r[o>r.length-2?r.length-1:o+1],c=r[o>r.length-3?r.length-1:o+2];return n.set(Ru(a,s.x,u.x,l.x,c.x),Ru(a,s.y,u.y,l.y,c.y)),n},ju.prototype.copy=function(t){Tu.prototype.copy.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push(r.clone())}return this},ju.prototype.toJSON=function(){var t=Tu.prototype.toJSON.call(this);t.points=[];for(var e=0,n=this.points.length;e<n;e++){var r=this.points[e];t.points.push(r.toArray())}return t},ju.prototype.fromJSON=function(t){Tu.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push((new pn).fromArray(r))}return this};var Wu=Object.freeze({ArcCurve:Au,CatmullRomCurve3:Nu,CubicBezierCurve:Fu,CubicBezierCurve3:Bu,EllipseCurve:Eu,LineCurve:Uu,LineCurve3:zu,QuadraticBezierCurve:Vu,QuadraticBezierCurve3:Gu,SplineCurve:ju});function Hu(){Tu.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function Xu(t){Hu.call(this),this.type="Path",this.currentPoint=new pn,t&&this.setFromPoints(t)}function Yu(t){Xu.call(this,t),this.uuid=hn.generateUUID(),this.type="Shape",this.holes=[]}function qu(t,e){er.call(this),this.type="Light",this.color=new hr(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0}function Zu(t,e,n){qu.call(this,t,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(er.DefaultUp),this.updateMatrix(),this.groundColor=new hr(e)}function Ju(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new pn(512,512),this.map=null,this.matrix=new In}function Ku(){Ju.call(this,new qr(50,1,.5,500))}function Qu(t,e,n,r,i,o){qu.call(this,t,e),this.type="SpotLight",this.position.copy(er.DefaultUp),this.updateMatrix(),this.target=new er,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==r?r:Math.PI/3,this.penumbra=void 0!==i?i:0,this.decay=void 0!==o?o:1,this.shadow=new Ku}function $u(t,e,n,r){qu.call(this,t,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==r?r:1,this.shadow=new Ju(new qr(90,1,.5,500))}function tl(t,e,n,r,i,o){Yr.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0!==t?t:-1,this.right=void 0!==e?e:1,this.top=void 0!==n?n:1,this.bottom=void 0!==r?r:-1,this.near=void 0!==i?i:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()}function el(){Ju.call(this,new tl(-5,5,5,-5,.5,500))}function nl(t,e){qu.call(this,t,e),this.type="DirectionalLight",this.position.copy(er.DefaultUp),this.updateMatrix(),this.target=new er,this.shadow=new el}function rl(t,e){qu.call(this,t,e),this.type="AmbientLight",this.castShadow=void 0}function il(t,e,n,r){qu.call(this,t,e),this.type="RectAreaLight",this.width=void 0!==n?n:10,this.height=void 0!==r?r:10}function ol(t){this.manager=void 0!==t?t:gu,this.textures={}}Hu.prototype=Object.assign(Object.create(Tu.prototype),{constructor:Hu,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new Uu(e,t))},getPoint:function(t){for(var e=t*this.getLength(),n=this.getCurveLengths(),r=0;r<n.length;){if(n[r]>=e){var i=n[r]-e,o=this.curves[r],a=o.getLength(),s=0===a?0:1-i/a;return o.getPointAt(s)}r++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,n=0,r=this.curves.length;n<r;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t},getSpacedPoints:function(t){void 0===t&&(t=40);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e},getPoints:function(t){t=t||12;for(var e,n=[],r=0,i=this.curves;r<i.length;r++)for(var o=i[r],a=o&&o.isEllipseCurve?2*t:o&&(o.isLineCurve||o.isLineCurve3)?1:o&&o.isSplineCurve?t*o.points.length:t,s=o.getPoints(a),u=0;u<s.length;u++){var l=s[u];e&&e.equals(l)||(n.push(l),e=l)}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},copy:function(t){Tu.prototype.copy.call(this,t),this.curves=[];for(var e=0,n=t.curves.length;e<n;e++){var r=t.curves[e];this.curves.push(r.clone())}return this.autoClose=t.autoClose,this},toJSON:function(){var t=Tu.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(var e=0,n=this.curves.length;e<n;e++){var r=this.curves[e];t.curves.push(r.toJSON())}return t},fromJSON:function(t){Tu.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(var e=0,n=t.curves.length;e<n;e++){var r=t.curves[e];this.curves.push((new Wu[r.type]).fromJSON(r))}return this}}),Xu.prototype=Object.assign(Object.create(Hu.prototype),{constructor:Xu,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y)},moveTo:function(t,e){this.currentPoint.set(t,e)},lineTo:function(t,e){var n=new Uu(this.currentPoint.clone(),new pn(t,e));this.curves.push(n),this.currentPoint.set(t,e)},quadraticCurveTo:function(t,e,n,r){var i=new Vu(this.currentPoint.clone(),new pn(t,e),new pn(n,r));this.curves.push(i),this.currentPoint.set(n,r)},bezierCurveTo:function(t,e,n,r,i,o){var a=new Fu(this.currentPoint.clone(),new pn(t,e),new pn(n,r),new pn(i,o));this.curves.push(a),this.currentPoint.set(i,o)},splineThru:function(t){var e=new ju([this.currentPoint.clone()].concat(t));this.curves.push(e),this.currentPoint.copy(t[t.length-1])},arc:function(t,e,n,r,i,o){var a=this.currentPoint.x,s=this.currentPoint.y;this.absarc(t+a,e+s,n,r,i,o)},absarc:function(t,e,n,r,i,o){this.absellipse(t,e,n,n,r,i,o)},ellipse:function(t,e,n,r,i,o,a,s){var u=this.currentPoint.x,l=this.currentPoint.y;this.absellipse(t+u,e+l,n,r,i,o,a,s)},absellipse:function(t,e,n,r,i,o,a,s){var u=new Eu(t,e,n,r,i,o,a,s);if(this.curves.length>0){var l=u.getPoint(0);l.equals(this.currentPoint)||this.lineTo(l.x,l.y)}this.curves.push(u);var c=u.getPoint(1);this.currentPoint.copy(c)},copy:function(t){return Hu.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){var t=Hu.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return Hu.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}}),Yu.prototype=Object.assign(Object.create(Xu.prototype),{constructor:Yu,getPointsHoles:function(t){for(var e=[],n=0,r=this.holes.length;n<r;n++)e[n]=this.holes[n].getPoints(t);return e},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){Xu.prototype.copy.call(this,t),this.holes=[];for(var e=0,n=t.holes.length;e<n;e++){var r=t.holes[e];this.holes.push(r.clone())}return this},toJSON:function(){var t=Xu.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(var e=0,n=this.holes.length;e<n;e++){var r=this.holes[e];t.holes.push(r.toJSON())}return t},fromJSON:function(t){Xu.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(var e=0,n=t.holes.length;e<n;e++){var r=t.holes[e];this.holes.push((new Xu).fromJSON(r))}return this}}),qu.prototype=Object.assign(Object.create(er.prototype),{constructor:qu,isLight:!0,copy:function(t){return er.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){var e=er.prototype.toJSON.call(this,t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}),Zu.prototype=Object.assign(Object.create(qu.prototype),{constructor:Zu,isHemisphereLight:!0,copy:function(t){return qu.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),Object.assign(Ju.prototype,{copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t={};return 0!==this.bias&&(t.bias=this.bias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),Ku.prototype=Object.assign(Object.create(Ju.prototype),{constructor:Ku,isSpotLightShadow:!0,update:function(t){var e=this.camera,n=2*hn.RAD2DEG*t.angle,r=this.mapSize.width/this.mapSize.height,i=t.distance||e.far;n===e.fov&&r===e.aspect&&i===e.far||(e.fov=n,e.aspect=r,e.far=i,e.updateProjectionMatrix())}}),Qu.prototype=Object.assign(Object.create(qu.prototype),{constructor:Qu,isSpotLight:!0,copy:function(t){return qu.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),$u.prototype=Object.assign(Object.create(qu.prototype),{constructor:$u,isPointLight:!0,copy:function(t){return qu.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),tl.prototype=Object.assign(Object.create(Yr.prototype),{constructor:tl,isOrthographicCamera:!0,copy:function(t,e){return Yr.prototype.copy.call(this,t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,e,n,r,i,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,i=n-t,o=n+t,a=r+e,s=r-e;if(null!==this.view&&this.view.enabled){var u=this.zoom/(this.view.width/this.view.fullWidth),l=this.zoom/(this.view.height/this.view.fullHeight),c=(this.right-this.left)/this.view.width,h=(this.top-this.bottom)/this.view.height;o=(i+=c*(this.view.offsetX/u))+c*(this.view.width/u),s=(a-=h*(this.view.offsetY/l))-h*(this.view.height/l)}this.projectionMatrix.makeOrthographic(i,o,a,s,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){var e=er.prototype.toJSON.call(this,t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}),el.prototype=Object.assign(Object.create(Ju.prototype),{constructor:el}),nl.prototype=Object.assign(Object.create(qu.prototype),{constructor:nl,isDirectionalLight:!0,copy:function(t){return qu.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),rl.prototype=Object.assign(Object.create(qu.prototype),{constructor:rl,isAmbientLight:!0}),il.prototype=Object.assign(Object.create(qu.prototype),{constructor:il,isRectAreaLight:!0,copy:function(t){return qu.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){var e=qu.prototype.toJSON.call(this,t);return e.object.width=this.width,e.object.height=this.height,e}}),Object.assign(ol.prototype,{load:function(t,e,n,r){var i=this,o=new yu(i.manager);o.setPath(i.path),o.load(t,(function(t){e(i.parse(JSON.parse(t)))}),n,r)},parse:function(t){var e=this.textures;function n(t){return e[t],e[t]}var r=new Qs[t.type];if(void 0!==t.uuid&&(r.uuid=t.uuid),void 0!==t.name&&(r.name=t.name),void 0!==t.color&&r.color.setHex(t.color),void 0!==t.roughness&&(r.roughness=t.roughness),void 0!==t.metalness&&(r.metalness=t.metalness),void 0!==t.emissive&&r.emissive.setHex(t.emissive),void 0!==t.specular&&r.specular.setHex(t.specular),void 0!==t.shininess&&(r.shininess=t.shininess),void 0!==t.clearCoat&&(r.clearCoat=t.clearCoat),void 0!==t.clearCoatRoughness&&(r.clearCoatRoughness=t.clearCoatRoughness),void 0!==t.vertexColors&&(r.vertexColors=t.vertexColors),void 0!==t.fog&&(r.fog=t.fog),void 0!==t.flatShading&&(r.flatShading=t.flatShading),void 0!==t.blending&&(r.blending=t.blending),void 0!==t.combine&&(r.combine=t.combine),void 0!==t.side&&(r.side=t.side),void 0!==t.opacity&&(r.opacity=t.opacity),void 0!==t.transparent&&(r.transparent=t.transparent),void 0!==t.alphaTest&&(r.alphaTest=t.alphaTest),void 0!==t.depthTest&&(r.depthTest=t.depthTest),void 0!==t.depthWrite&&(r.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(r.colorWrite=t.colorWrite),void 0!==t.wireframe&&(r.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(r.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(r.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(r.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(r.rotation=t.rotation),1!==t.linewidth&&(r.linewidth=t.linewidth),void 0!==t.dashSize&&(r.dashSize=t.dashSize),void 0!==t.gapSize&&(r.gapSize=t.gapSize),void 0!==t.scale&&(r.scale=t.scale),void 0!==t.polygonOffset&&(r.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(r.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(r.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.skinning&&(r.skinning=t.skinning),void 0!==t.morphTargets&&(r.morphTargets=t.morphTargets),void 0!==t.morphNormals&&(r.morphNormals=t.morphNormals),void 0!==t.dithering&&(r.dithering=t.dithering),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.uniforms)for(var i in t.uniforms){var o=t.uniforms[i];switch(r.uniforms[i]={},o.type){case"t":r.uniforms[i].value=n(o.value);break;case"c":r.uniforms[i].value=(new hr).setHex(o.value);break;case"v2":r.uniforms[i].value=(new pn).fromArray(o.value);break;case"v3":r.uniforms[i].value=(new dn).fromArray(o.value);break;case"v4":r.uniforms[i].value=(new Pn).fromArray(o.value);break;case"m3":r.uniforms[i].value=(new mn).fromArray(o.value);case"m4":r.uniforms[i].value=(new In).fromArray(o.value);break;default:r.uniforms[i].value=o.value}}if(void 0!==t.defines&&(r.defines=t.defines),void 0!==t.vertexShader&&(r.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(r.fragmentShader=t.fragmentShader),void 0!==t.extensions)for(var a in t.extensions)r.extensions[a]=t.extensions[a];if(void 0!==t.shading&&(r.flatShading=1===t.shading),void 0!==t.size&&(r.size=t.size),void 0!==t.sizeAttenuation&&(r.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(r.map=n(t.map)),void 0!==t.matcap&&(r.matcap=n(t.matcap)),void 0!==t.alphaMap&&(r.alphaMap=n(t.alphaMap),r.transparent=!0),void 0!==t.bumpMap&&(r.bumpMap=n(t.bumpMap)),void 0!==t.bumpScale&&(r.bumpScale=t.bumpScale),void 0!==t.normalMap&&(r.normalMap=n(t.normalMap)),void 0!==t.normalMapType&&(r.normalMapType=t.normalMapType),void 0!==t.normalScale){var s=t.normalScale;!1===Array.isArray(s)&&(s=[s,s]),r.normalScale=(new pn).fromArray(s)}return void 0!==t.displacementMap&&(r.displacementMap=n(t.displacementMap)),void 0!==t.displacementScale&&(r.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(r.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(r.roughnessMap=n(t.roughnessMap)),void 0!==t.metalnessMap&&(r.metalnessMap=n(t.metalnessMap)),void 0!==t.emissiveMap&&(r.emissiveMap=n(t.emissiveMap)),void 0!==t.emissiveIntensity&&(r.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(r.specularMap=n(t.specularMap)),void 0!==t.envMap&&(r.envMap=n(t.envMap)),void 0!==t.envMapIntensity&&(r.envMapIntensity=t.envMapIntensity),void 0!==t.reflectivity&&(r.reflectivity=t.reflectivity),void 0!==t.refractionRatio&&(r.refractionRatio=t.refractionRatio),void 0!==t.lightMap&&(r.lightMap=n(t.lightMap)),void 0!==t.lightMapIntensity&&(r.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(r.aoMap=n(t.aoMap)),void 0!==t.aoMapIntensity&&(r.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(r.gradientMap=n(t.gradientMap)),r},setPath:function(t){return this.path=t,this},setTextures:function(t){return this.textures=t,this}});var al={decodeText:function(t){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);for(var e="",n=0,r=t.length;n<r;n++)e+=String.fromCharCode(t[n]);try{return decodeURIComponent(escape(e))}catch(t){return e}},extractUrlBase:function(t){var e=t.lastIndexOf("/");return-1===e?"./":t.substr(0,e+1)}};function sl(){Dr.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function ul(t,e,n,r){"number"==typeof n&&(r=n,n=!1),xr.call(this,t,e,n),this.meshPerAttribute=r||1}function ll(t){this.manager=void 0!==t?t:gu}sl.prototype=Object.assign(Object.create(Dr.prototype),{constructor:sl,isInstancedBufferGeometry:!0,copy:function(t){return Dr.prototype.copy.call(this,t),this.maxInstancedCount=t.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t=Dr.prototype.toJSON.call(this);return t.maxInstancedCount=this.maxInstancedCount,t.isInstancedBufferGeometry=!0,t}}),ul.prototype=Object.assign(Object.create(xr.prototype),{constructor:ul,isInstancedBufferAttribute:!0,copy:function(t){return xr.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},toJSON:function(){var t=xr.prototype.toJSON.call(this);return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}),Object.assign(ll.prototype,{load:function(t,e,n,r){var i=this,o=new yu(i.manager);o.setPath(i.path),o.load(t,(function(t){e(i.parse(JSON.parse(t)))}),n,r)},parse:function(t){var e=t.isInstancedBufferGeometry?new sl:new Dr,n=t.data.index;if(void 0!==n){var r=new cl[n.type](n.array);e.setIndex(new xr(r,1))}var i=t.data.attributes;for(var o in i){var a=i[o],s=(r=new cl[a.type](a.array),new(a.isInstancedBufferAttribute?ul:xr)(r,a.itemSize,a.normalized));void 0!==a.name&&(s.name=a.name),e.addAttribute(o,s)}var u=t.data.morphAttributes;if(u)for(var o in u){for(var l=u[o],c=[],h=0,p=l.length;h<p;h++){a=l[h],s=new xr(r=new cl[a.type](a.array),a.itemSize,a.normalized);void 0!==a.name&&(s.name=a.name),c.push(s)}e.morphAttributes[o]=c}var f=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==f){h=0;for(var d=f.length;h!==d;++h){var m=f[h];e.addGroup(m.start,m.count,m.materialIndex)}}var g=t.data.boundingSphere;if(void 0!==g){var v=new dn;void 0!==g.center&&v.fromArray(g.center),e.boundingSphere=new ir(v,g.radius)}return t.name&&(e.name=t.name),t.userData&&(e.userData=t.userData),e},setPath:function(t){return this.path=t,this}});var cl={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function hl(t){this.manager=void 0!==t?t:gu,this.resourcePath=""}Object.assign(hl.prototype,{crossOrigin:"anonymous",load:function(t,e,n,r){var i=this,o=void 0===this.path?al.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||o;var a=new yu(i.manager);a.setPath(this.path),a.load(t,(function(t){var n=null;try{n=JSON.parse(t)}catch(t){return void(void 0!==r&&r(t))}var o=n.metadata;void 0!==o&&void 0!==o.type&&"geometry"!==o.type.toLowerCase()&&i.parse(n,e)}),n,r)},setPath:function(t){return this.path=t,this},setResourcePath:function(t){return this.resourcePath=t,this},setCrossOrigin:function(t){return this.crossOrigin=t,this},parse:function(t,e){var n=this.parseShape(t.shapes),r=this.parseGeometries(t.geometries,n),i=this.parseImages(t.images,(function(){void 0!==e&&e(s)})),o=this.parseTextures(t.textures,i),a=this.parseMaterials(t.materials,o),s=this.parseObject(t.object,r,a);return t.animations&&(s.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0!==e&&e(s),s},parseShape:function(t){var e={};if(void 0!==t)for(var n=0,r=t.length;n<r;n++){var i=(new Yu).fromJSON(t[n]);e[i.uuid]=i}return e},parseGeometries:function(t,e){var n={};if(void 0!==t)for(var r=new ll,i=0,o=t.length;i<o;i++){var a,s=t[i];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":a=new Vs[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":a=new Vs[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":a=new Vs[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":a=new Vs[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":a=new Vs[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":a=new Vs[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":a=new Vs[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":a=new Vs[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":a=new Vs[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":a=new Vs[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"TubeGeometry":case"TubeBufferGeometry":a=new Vs[s.type]((new Wu[s.path.type]).fromJSON(s.path),s.tubularSegments,s.radius,s.radialSegments,s.closed);break;case"LatheGeometry":case"LatheBufferGeometry":a=new Vs[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":a=new Vs[s.type](s.vertices,s.indices,s.radius,s.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var u=[],l=0,c=s.shapes.length;l<c;l++){var h=e[s.shapes[l]];u.push(h)}a=new Vs[s.type](u,s.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(u=[],l=0,c=s.shapes.length;l<c;l++){h=e[s.shapes[l]];u.push(h)}var p=s.options.extrudePath;void 0!==p&&(s.options.extrudePath=(new Wu[p.type]).fromJSON(p)),a=new Vs[s.type](u,s.options);break;case"BufferGeometry":case"InstancedBufferGeometry":a=r.parse(s);break;case"Geometry":if("THREE"in window&&"LegacyJSONLoader"in THREE)a=(new THREE.LegacyJSONLoader).parse(s,this.resourcePath).geometry;break;default:continue}a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),!0===a.isBufferGeometry&&void 0!==s.userData&&(a.userData=s.userData),n[s.uuid]=a}return n},parseMaterials:function(t,e){var n={},r={};if(void 0!==t){var i=new ol;i.setTextures(e);for(var o=0,a=t.length;o<a;o++){var s=t[o];if("MultiMaterial"===s.type){for(var u=[],l=0;l<s.materials.length;l++){var c=s.materials[l];void 0===n[c.uuid]&&(n[c.uuid]=i.parse(c)),u.push(n[c.uuid])}r[s.uuid]=u}else void 0===n[s.uuid]&&(n[s.uuid]=i.parse(s)),r[s.uuid]=n[s.uuid]}}return r},parseAnimations:function(t){for(var e=[],n=0;n<t.length;n++){var r=t[n],i=pu.parse(r);void 0!==r.uuid&&(i.uuid=r.uuid),e.push(i)}return e},parseImages:function(t,e){var n=this,r={};function i(t){return n.manager.itemStart(t),o.load(t,(function(){n.manager.itemEnd(t)}),void 0,(function(){n.manager.itemError(t),n.manager.itemEnd(t)}))}if(void 0!==t&&t.length>0){var o=new wu(new mu(e));o.setCrossOrigin(this.crossOrigin);for(var a=0,s=t.length;a<s;a++){var u=t[a],l=u.url;if(Array.isArray(l)){r[u.uuid]=[];for(var c=0,h=l.length;c<h;c++){var p=l[c],f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(p)?p:n.resourcePath+p;r[u.uuid].push(i(f))}}else{f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u.url)?u.url:n.resourcePath+u.url;r[u.uuid]=i(f)}}}return r},parseTextures:function(t,e){function n(t,e){return"number"==typeof t?t:e[t]}var r={};if(void 0!==t)for(var i=0,o=t.length;i<o;i++){var a,s=t[i];s.image,e[s.image],(a=Array.isArray(e[s.image])?new wi(e[s.image]):new An(e[s.image])).needsUpdate=!0,a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),void 0!==s.mapping&&(a.mapping=n(s.mapping,vl)),void 0!==s.offset&&a.offset.fromArray(s.offset),void 0!==s.repeat&&a.repeat.fromArray(s.repeat),void 0!==s.center&&a.center.fromArray(s.center),void 0!==s.rotation&&(a.rotation=s.rotation),void 0!==s.wrap&&(a.wrapS=n(s.wrap[0],yl),a.wrapT=n(s.wrap[1],yl)),void 0!==s.format&&(a.format=s.format),void 0!==s.type&&(a.type=s.type),void 0!==s.encoding&&(a.encoding=s.encoding),void 0!==s.minFilter&&(a.minFilter=n(s.minFilter,xl)),void 0!==s.magFilter&&(a.magFilter=n(s.magFilter,xl)),void 0!==s.anisotropy&&(a.anisotropy=s.anisotropy),void 0!==s.flipY&&(a.flipY=s.flipY),void 0!==s.premultiplyAlpha&&(a.premultiplyAlpha=s.premultiplyAlpha),void 0!==s.unpackAlignment&&(a.unpackAlignment=s.unpackAlignment),r[s.uuid]=a}return r},parseObject:function(t,e,n){var r;function i(t){return e[t],e[t]}function o(t){if(void 0!==t){if(Array.isArray(t)){for(var e=[],r=0,i=t.length;r<i;r++){var o=t[r];n[o],e.push(n[o])}return e}return n[t],n[t]}}switch(t.type){case"Scene":r=new nr,void 0!==t.background&&Number.isInteger(t.background)&&(r.background=new hr(t.background)),void 0!==t.fog&&("Fog"===t.fog.type?r.fog=new ca(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(r.fog=new la(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":r=new qr(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(r.focus=t.focus),void 0!==t.zoom&&(r.zoom=t.zoom),void 0!==t.filmGauge&&(r.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(r.filmOffset=t.filmOffset),void 0!==t.view&&(r.view=Object.assign({},t.view));break;case"OrthographicCamera":r=new tl(t.left,t.right,t.top,t.bottom,t.near,t.far),void 0!==t.zoom&&(r.zoom=t.zoom),void 0!==t.view&&(r.view=Object.assign({},t.view));break;case"AmbientLight":r=new rl(t.color,t.intensity);break;case"DirectionalLight":r=new nl(t.color,t.intensity);break;case"PointLight":r=new $u(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":r=new il(t.color,t.intensity,t.width,t.height);break;case"SpotLight":r=new Qu(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":r=new Zu(t.color,t.groundColor,t.intensity);break;case"SkinnedMesh":case"Mesh":var a=i(t.geometry),s=o(t.material);r=a.bones&&a.bones.length>0?new ga(a,s):new kr(a,s),void 0!==t.drawMode&&r.setDrawMode(t.drawMode);break;case"LOD":r=new ma;break;case"Line":r=new _a(i(t.geometry),o(t.material),t.mode);break;case"LineLoop":r=new wa(i(t.geometry),o(t.material));break;case"LineSegments":r=new ba(i(t.geometry),o(t.material));break;case"PointCloud":case"Points":r=new Sa(i(t.geometry),o(t.material));break;case"Sprite":r=new da(o(t.material));break;case"Group":r=new Zo;break;default:r=new er}if(r.uuid=t.uuid,void 0!==t.name&&(r.name=t.name),void 0!==t.matrix?(r.matrix.fromArray(t.matrix),void 0!==t.matrixAutoUpdate&&(r.matrixAutoUpdate=t.matrixAutoUpdate),r.matrixAutoUpdate&&r.matrix.decompose(r.position,r.quaternion,r.scale)):(void 0!==t.position&&r.position.fromArray(t.position),void 0!==t.rotation&&r.rotation.fromArray(t.rotation),void 0!==t.quaternion&&r.quaternion.fromArray(t.quaternion),void 0!==t.scale&&r.scale.fromArray(t.scale)),void 0!==t.castShadow&&(r.castShadow=t.castShadow),void 0!==t.receiveShadow&&(r.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(r.shadow.bias=t.shadow.bias),void 0!==t.shadow.radius&&(r.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&r.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(r.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.frustumCulled&&(r.frustumCulled=t.frustumCulled),void 0!==t.renderOrder&&(r.renderOrder=t.renderOrder),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.layers&&(r.layers.mask=t.layers),void 0!==t.children)for(var u=t.children,l=0;l<u.length;l++)r.add(this.parseObject(u[l],e,n));if("LOD"===t.type)for(var c=t.levels,h=0;h<c.length;h++){var p=c[h],f=r.getObjectByProperty("uuid",p.object);void 0!==f&&r.addLevel(f,p.distance)}return r}});var pl,fl,dl,ml,gl,vl={UVMapping:ft,CubeReflectionMapping:dt,CubeRefractionMapping:mt,EquirectangularReflectionMapping:gt,EquirectangularRefractionMapping:vt,SphericalReflectionMapping:yt,CubeUVReflectionMapping:xt,CubeUVRefractionMapping:_t},yl={RepeatWrapping:bt,ClampToEdgeWrapping:wt,MirroredRepeatWrapping:Mt},xl={NearestFilter:St,NearestMipmapNearestFilter:Tt,NearestMipmapLinearFilter:At,LinearFilter:Ct,LinearMipmapNearestFilter:Lt,LinearMipmapLinearFilter:Ot};function _l(t){this.manager=void 0!==t?t:gu,this.options=void 0}function bl(){this.type="ShapePath",this.color=new hr,this.subPaths=[],this.currentPath=null}function wl(t){this.type="Font",this.data=t}function Ml(t,e,n,r,i){var o=i.glyphs[t]||i.glyphs["?"];if(o){var a,s,u,l,c,h,p,f,d=new bl;if(o.o)for(var m=o._cachedOutline||(o._cachedOutline=o.o.split(" ")),g=0,v=m.length;g<v;){switch(m[g++]){case"m":a=m[g++]*e+n,s=m[g++]*e+r,d.moveTo(a,s);break;case"l":a=m[g++]*e+n,s=m[g++]*e+r,d.lineTo(a,s);break;case"q":u=m[g++]*e+n,l=m[g++]*e+r,c=m[g++]*e+n,h=m[g++]*e+r,d.quadraticCurveTo(c,h,u,l);break;case"b":u=m[g++]*e+n,l=m[g++]*e+r,c=m[g++]*e+n,h=m[g++]*e+r,p=m[g++]*e+n,f=m[g++]*e+r,d.bezierCurveTo(c,h,p,f,u,l)}}return{offsetX:o.ha*e,path:d}}}function Sl(t){this.manager=void 0!==t?t:gu}function Tl(){}_l.prototype={constructor:_l,setOptions:function(t){return this.options=t,this},load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,o=du.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout((function(){e&&e(o),i.manager.itemEnd(t)}),0),o;fetch(t).then((function(t){return t.blob()})).then((function(t){return void 0===i.options?createImageBitmap(t):createImageBitmap(t,i.options)})).then((function(n){du.add(t,n),e&&e(n),i.manager.itemEnd(t)})).catch((function(e){r&&r(e),i.manager.itemError(t),i.manager.itemEnd(t)})),i.manager.itemStart(t)},setCrossOrigin:function(){return this},setPath:function(t){return this.path=t,this}},Object.assign(bl.prototype,{moveTo:function(t,e){this.currentPath=new Xu,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e)},lineTo:function(t,e){this.currentPath.lineTo(t,e)},quadraticCurveTo:function(t,e,n,r){this.currentPath.quadraticCurveTo(t,e,n,r)},bezierCurveTo:function(t,e,n,r,i,o){this.currentPath.bezierCurveTo(t,e,n,r,i,o)},splineThru:function(t){this.currentPath.splineThru(t)},toShapes:function(t,e){function n(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n],o=new Yu;o.curves=i.curves,e.push(o)}return e}function r(t,e){for(var n=e.length,r=!1,i=n-1,o=0;o<n;i=o++){var a=e[i],s=e[o],u=s.x-a.x,l=s.y-a.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(a=e[o],u=-u,s=e[i],l=-l),t.y<a.y||t.y>s.y)continue;if(t.y===a.y){if(t.x===a.x)return!0}else{var c=l*(t.x-a.x)-u*(t.y-a.y);if(0===c)return!0;if(c<0)continue;r=!r}}else{if(t.y!==a.y)continue;if(s.x<=t.x&&t.x<=a.x||a.x<=t.x&&t.x<=s.x)return!0}}return r}var i=gs.isClockWise,o=this.subPaths;if(0===o.length)return[];if(!0===e)return n(o);var a,s,u,l=[];if(1===o.length)return s=o[0],(u=new Yu).curves=s.curves,l.push(u),l;var c=!i(o[0].getPoints());c=t?!c:c;var h,p,f=[],d=[],m=[],g=0;d[g]=void 0,m[g]=[];for(var v=0,y=o.length;v<y;v++)a=i(h=(s=o[v]).getPoints()),(a=t?!a:a)?(!c&&d[g]&&g++,d[g]={s:new Yu,p:h},d[g].s.curves=s.curves,c&&g++,m[g]=[]):m[g].push({h:s,p:h[0]});if(!d[0])return n(o);if(d.length>1){for(var x=!1,_=[],b=0,w=d.length;b<w;b++)f[b]=[];for(b=0,w=d.length;b<w;b++)for(var M=m[b],S=0;S<M.length;S++){for(var T=M[S],E=!0,A=0;A<d.length;A++)r(T.p,d[A].p)&&(b!==A&&_.push({froms:b,tos:A,hole:S}),E?(E=!1,f[A].push(T)):x=!0);E&&f[b].push(T)}_.length>0&&(x||(m=f))}v=0;for(var P=d.length;v<P;v++){u=d[v].s,l.push(u);for(var C=0,L=(p=m[v]).length;C<L;C++)u.holes.push(p[C].h)}return l}}),Object.assign(wl.prototype,{isFont:!0,generateShapes:function(t,e){void 0===e&&(e=100);for(var n=[],r=function(t,e,n){for(var r=Array.from?Array.from(t):String(t).split(""),i=e/n.resolution,o=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*i,a=[],s=0,u=0,l=0;l<r.length;l++){var c=r[l];if("\n"===c)s=0,u-=o;else{var h=Ml(c,i,s,u,n);s+=h.offsetX,a.push(h.path)}}return a}(t,e,this.data),i=0,o=r.length;i<o;i++)Array.prototype.push.apply(n,r[i].toShapes());return n}}),Object.assign(Sl.prototype,{load:function(t,e,n,r){var i=this,o=new yu(this.manager);o.setPath(this.path),o.load(t,(function(t){var n;try{n=JSON.parse(t)}catch(e){n=JSON.parse(t.substring(65,t.length-2))}var r=i.parse(n);e&&e(r)}),n,r)},parse:function(t){return new wl(t)},setPath:function(t){return this.path=t,this}}),Tl.Handlers={handlers:[],add:function(t,e){this.handlers.push(t,e)},get:function(t){for(var e=this.handlers,n=0,r=e.length;n<r;n+=2){var i=e[n],o=e[n+1];if(i.test(t))return o}return null}},Object.assign(Tl.prototype,{crossOrigin:"anonymous",onLoadStart:function(){},onLoadProgress:function(){},onLoadComplete:function(){},initMaterials:function(t,e,n){for(var r=[],i=0;i<t.length;++i)r[i]=this.createMaterial(t[i],e,n);return r},createMaterial:(pl={NoBlending:P,NormalBlending:C,AdditiveBlending:L,SubtractiveBlending:I,MultiplyBlending:O,CustomBlending:N},fl=new hr,dl=new Su,ml=new ol,function(t,e,n){var r={};function i(t,i,o,a,s){var u,l=e+t,c=Tl.Handlers.get(l);null!==c?u=c.load(l):(dl.setCrossOrigin(n),u=dl.load(l)),void 0!==i&&(u.repeat.fromArray(i),1!==i[0]&&(u.wrapS=bt),1!==i[1]&&(u.wrapT=bt)),void 0!==o&&u.offset.fromArray(o),void 0!==a&&("repeat"===a[0]&&(u.wrapS=bt),"mirror"===a[0]&&(u.wrapS=Mt),"repeat"===a[1]&&(u.wrapT=bt),"mirror"===a[1]&&(u.wrapT=Mt)),void 0!==s&&(u.anisotropy=s);var h=hn.generateUUID();return r[h]=u,h}var o={uuid:hn.generateUUID(),type:"MeshLambertMaterial"};for(var a in t){var s=t[a];switch(a){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":case"colorAmbient":case"mapAmbient":case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":default:break;case"DbgName":o.name=s;break;case"blending":o.blending=pl[s];break;case"colorDiffuse":o.color=fl.fromArray(s).getHex();break;case"colorSpecular":o.specular=fl.fromArray(s).getHex();break;case"colorEmissive":o.emissive=fl.fromArray(s).getHex();break;case"specularCoef":o.shininess=s;break;case"shading":"basic"===s.toLowerCase()&&(o.type="MeshBasicMaterial"),"phong"===s.toLowerCase()&&(o.type="MeshPhongMaterial"),"standard"===s.toLowerCase()&&(o.type="MeshStandardMaterial");break;case"mapDiffuse":o.map=i(s,t.mapDiffuseRepeat,t.mapDiffuseOffset,t.mapDiffuseWrap,t.mapDiffuseAnisotropy);break;case"mapEmissive":o.emissiveMap=i(s,t.mapEmissiveRepeat,t.mapEmissiveOffset,t.mapEmissiveWrap,t.mapEmissiveAnisotropy);break;case"mapLight":o.lightMap=i(s,t.mapLightRepeat,t.mapLightOffset,t.mapLightWrap,t.mapLightAnisotropy);break;case"mapAO":o.aoMap=i(s,t.mapAORepeat,t.mapAOOffset,t.mapAOWrap,t.mapAOAnisotropy);break;case"mapBump":o.bumpMap=i(s,t.mapBumpRepeat,t.mapBumpOffset,t.mapBumpWrap,t.mapBumpAnisotropy);break;case"mapBumpScale":o.bumpScale=s;break;case"mapNormal":o.normalMap=i(s,t.mapNormalRepeat,t.mapNormalOffset,t.mapNormalWrap,t.mapNormalAnisotropy);break;case"mapNormalFactor":o.normalScale=s;break;case"mapSpecular":o.specularMap=i(s,t.mapSpecularRepeat,t.mapSpecularOffset,t.mapSpecularWrap,t.mapSpecularAnisotropy);break;case"mapMetalness":o.metalnessMap=i(s,t.mapMetalnessRepeat,t.mapMetalnessOffset,t.mapMetalnessWrap,t.mapMetalnessAnisotropy);break;case"mapRoughness":o.roughnessMap=i(s,t.mapRoughnessRepeat,t.mapRoughnessOffset,t.mapRoughnessWrap,t.mapRoughnessAnisotropy);break;case"mapAlpha":o.alphaMap=i(s,t.mapAlphaRepeat,t.mapAlphaOffset,t.mapAlphaWrap,t.mapAlphaAnisotropy);break;case"flipSided":o.side=b;break;case"doubleSided":o.side=w;break;case"transparency":o.opacity=s;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":o[a]=s;break;case"vertexColors":!0===s&&(o.vertexColors=A),"face"===s&&(o.vertexColors=E)}}return"MeshBasicMaterial"===o.type&&delete o.emissive,"MeshPhongMaterial"!==o.type&&delete o.specular,o.opacity<1&&(o.transparent=!0),ml.setTextures(r),ml.parse(o)})});var El={getContext:function(){return void 0===gl&&(gl=new(window.AudioContext||window.webkitAudioContext)),gl},setContext:function(t){gl=t}};function Al(t){this.manager=void 0!==t?t:gu}function Pl(){this.coefficients=[];for(var t=0;t<9;t++)this.coefficients.push(new dn)}function Cl(t,e){qu.call(this,void 0,e),this.sh=void 0!==t?t:new Pl}function Ll(t,e,n){Cl.call(this,void 0,n);var r=(new hr).set(t),i=(new hr).set(e),o=new dn(r.r,r.g,r.b),a=new dn(i.r,i.g,i.b),s=Math.sqrt(Math.PI),u=s*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(a).multiplyScalar(s),this.sh.coefficients[1].copy(o).sub(a).multiplyScalar(u)}function Il(t,e){Cl.call(this,void 0,e);var n=(new hr).set(t);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}function Ol(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new qr,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new qr,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function Nl(t){this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function Rl(){er.call(this),this.type="AudioListener",this.context=El.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0}function Dl(t){er.call(this),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.startTime=0,this.offset=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function kl(t){Dl.call(this,t),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}function Fl(t,e){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==e?e:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}function Bl(t,e,n){this.binding=t,this.valueSize=n;var r,i=Float64Array;switch(e){case"quaternion":r=this._slerp;break;case"string":case"bool":i=Array,r=this._select;break;default:r=this._lerp}this.buffer=new i(4*n),this._mixBufferRegion=r,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}Object.assign(Al.prototype,{load:function(t,e,n,r){var i=new yu(this.manager);i.setResponseType("arraybuffer"),i.setPath(this.path),i.load(t,(function(t){var n=t.slice(0);El.getContext().decodeAudioData(n,(function(t){e(t)}))}),n,r)},setPath:function(t){return this.path=t,this}}),Object.assign(Pl.prototype,{isSphericalHarmonics3:!0,set:function(t){for(var e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this},zero:function(){for(var t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this},getAt:function(t,e){var n=t.x,r=t.y,i=t.z,o=this.coefficients;return e.copy(o[0]).multiplyScalar(.282095),e.addScale(o[1],.488603*r),e.addScale(o[2],.488603*i),e.addScale(o[3],.488603*n),e.addScale(o[4],n*r*1.092548),e.addScale(o[5],r*i*1.092548),e.addScale(o[6],.315392*(3*i*i-1)),e.addScale(o[7],n*i*1.092548),e.addScale(o[8],.546274*(n*n-r*r)),e},getIrradianceAt:function(t,e){var n=t.x,r=t.y,i=t.z,o=this.coefficients;return e.copy(o[0]).multiplyScalar(.886227),e.addScale(o[1],1.023328*r),e.addScale(o[2],1.023328*i),e.addScale(o[3],1.023328*n),e.addScale(o[4],.858086*n*r),e.addScale(o[5],.858086*r*i),e.addScale(o[6],.743125*i*i-.247708),e.addScale(o[7],.858086*n*i),e.addScale(o[8],.429043*(n*n-r*r)),e},add:function(t){for(var e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this},scale:function(t){for(var e=0;e<9;e++)this.coefficients[e].multiplyScalar(t);return this},lerp:function(t,e){for(var n=0;n<9;n++)this.coefficients[n].lerp(t.coefficients[n],e);return this},equals:function(t){for(var e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0},copy:function(t){return this.set(t.coefficients)},clone:function(){return(new this.constructor).copy(this)},fromArray:function(t){for(var e=this.coefficients,n=0;n<9;n++)e[n].fromArray(t,3*n);return this},toArray:function(){for(var t=[],e=this.coefficients,n=0;n<9;n++)e[n].toArray(t,3*n);return t}}),Object.assign(Pl,{getBasisAt:function(t,e){var n=t.x,r=t.y,i=t.z;e[0]=.282095,e[1]=.488603*r,e[2]=.488603*i,e[3]=.488603*n,e[4]=1.092548*n*r,e[5]=1.092548*r*i,e[6]=.315392*(3*i*i-1),e[7]=1.092548*n*i,e[8]=.546274*(n*n-r*r)}}),Cl.prototype=Object.assign(Object.create(qu.prototype),{constructor:Cl,isLightProbe:!0,copy:function(t){return qu.prototype.copy.call(this,t),this.sh.copy(t.sh),this.intensity=t.intensity,this},toJSON:function(t){return qu.prototype.toJSON.call(this,t)}}),Ll.prototype=Object.assign(Object.create(Cl.prototype),{constructor:Ll,isHemisphereLightProbe:!0,copy:function(t){return Cl.prototype.copy.call(this,t),this},toJSON:function(t){return Cl.prototype.toJSON.call(this,t)}}),Il.prototype=Object.assign(Object.create(Cl.prototype),{constructor:Il,isAmbientLightProbe:!0,copy:function(t){return Cl.prototype.copy.call(this,t),this},toJSON:function(t){return Cl.prototype.toJSON.call(this,t)}}),Object.assign(Ol.prototype,{update:function(){var t,e,n,r,i,o,a,s,u=new In,l=new In;return function(c){if(t!==this||e!==c.focus||n!==c.fov||r!==c.aspect*this.aspect||i!==c.near||o!==c.far||a!==c.zoom||s!==this.eyeSep){t=this,e=c.focus,n=c.fov,r=c.aspect*this.aspect,i=c.near,o=c.far,a=c.zoom;var h,p,f=c.projectionMatrix.clone(),d=(s=this.eyeSep/2)*i/e,m=i*Math.tan(hn.DEG2RAD*n*.5)/a;l.elements[12]=-s,u.elements[12]=s,h=-m*r+d,p=m*r+d,f.elements[0]=2*i/(p-h),f.elements[8]=(p+h)/(p-h),this.cameraL.projectionMatrix.copy(f),h=-m*r-d,p=m*r-d,f.elements[0]=2*i/(p-h),f.elements[8]=(p+h)/(p-h),this.cameraR.projectionMatrix.copy(f)}this.cameraL.matrixWorld.copy(c.matrixWorld).multiply(l),this.cameraR.matrixWorld.copy(c.matrixWorld).multiply(u)}}()}),Object.assign(Nl.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var e=("undefined"==typeof performance?Date:performance).now();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}}),Rl.prototype=Object.assign(Object.create(er.prototype),{constructor:Rl,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(t){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this},updateMatrixWorld:function(){var t=new dn,e=new fn,n=new dn,r=new dn,i=new Nl;return function(o){er.prototype.updateMatrixWorld.call(this,o);var a=this.context.listener,s=this.up;if(this.timeDelta=i.getDelta(),this.matrixWorld.decompose(t,e,n),r.set(0,0,-1).applyQuaternion(e),a.positionX){var u=this.context.currentTime+this.timeDelta;a.positionX.linearRampToValueAtTime(t.x,u),a.positionY.linearRampToValueAtTime(t.y,u),a.positionZ.linearRampToValueAtTime(t.z,u),a.forwardX.linearRampToValueAtTime(r.x,u),a.forwardY.linearRampToValueAtTime(r.y,u),a.forwardZ.linearRampToValueAtTime(r.z,u),a.upX.linearRampToValueAtTime(s.x,u),a.upY.linearRampToValueAtTime(s.y,u),a.upZ.linearRampToValueAtTime(s.z,u)}else a.setPosition(t.x,t.y,t.z),a.setOrientation(r.x,r.y,r.z,s.x,s.y,s.z)}}()}),Dl.prototype=Object.assign(Object.create(er.prototype),{constructor:Dl,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setMediaElementSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this},setBuffer:function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0!==this.isPlaying&&!1!==this.hasPlaybackControl){var t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.onended=this.onEnded.bind(this),this.startTime=this.context.currentTime,t.start(this.startTime,this.offset),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this.source.stop(),this.source.onended=null,this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this},stop:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.source.onended=null,this.offset=0,this.isPlaying=!1,this},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t||(t=[]),!0===this.isPlaying?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},setDetune:function(t){if(this.detune=t,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1!==this.hasPlaybackControl&&this.loop},setLoop:function(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}}),kl.prototype=Object.assign(Object.create(Dl.prototype),{constructor:kl,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){return this.panner.refDistance=t,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){return this.panner.rolloffFactor=t,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){return this.panner.distanceModel=t,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){return this.panner.maxDistance=t,this},setDirectionalCone:function(t,e,n){return this.panner.coneInnerAngle=t,this.panner.coneOuterAngle=e,this.panner.coneOuterGain=n,this},updateMatrixWorld:function(){var t=new dn,e=new fn,n=new dn,r=new dn;return function(i){if(er.prototype.updateMatrixWorld.call(this,i),!0!==this.hasPlaybackControl||!1!==this.isPlaying){this.matrixWorld.decompose(t,e,n),r.set(0,0,1).applyQuaternion(e);var o=this.panner;if(o.positionX){var a=this.context.currentTime+this.listener.timeDelta;o.positionX.linearRampToValueAtTime(t.x,a),o.positionY.linearRampToValueAtTime(t.y,a),o.positionZ.linearRampToValueAtTime(t.z,a),o.orientationX.linearRampToValueAtTime(r.x,a),o.orientationY.linearRampToValueAtTime(r.y,a),o.orientationZ.linearRampToValueAtTime(r.z,a)}else o.setPosition(t.x,t.y,t.z),o.setOrientation(r.x,r.y,r.z)}}}()}),Object.assign(Fl.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var t=0,e=this.getFrequencyData(),n=0;n<e.length;n++)t+=e[n];return t/e.length}}),Object.assign(Bl.prototype,{accumulate:function(t,e){var n=this.buffer,r=this.valueSize,i=t*r+r,o=this.cumulativeWeight;if(0===o){for(var a=0;a!==r;++a)n[i+a]=n[a];o=e}else{var s=e/(o+=e);this._mixBufferRegion(n,i,0,s,r)}this.cumulativeWeight=o},apply:function(t){var e=this.valueSize,n=this.buffer,r=t*e+e,i=this.cumulativeWeight,o=this.binding;if(this.cumulativeWeight=0,i<1){var a=3*e;this._mixBufferRegion(n,r,a,1-i,e)}for(var s=e,u=e+e;s!==u;++s)if(n[s]!==n[s+e]){o.setValue(n,r);break}},saveOriginalState:function(){var t=this.binding,e=this.buffer,n=this.valueSize,r=3*n;t.getValue(e,r);for(var i=n,o=r;i!==o;++i)e[i]=e[r+i%n];this.cumulativeWeight=0},restoreOriginalState:function(){var t=3*this.valueSize;this.binding.setValue(this.buffer,t)},_select:function(t,e,n,r,i){if(r>=.5)for(var o=0;o!==i;++o)t[e+o]=t[n+o]},_slerp:function(t,e,n,r){fn.slerpFlat(t,e,t,e,t,n,r)},_lerp:function(t,e,n,r,i){for(var o=1-r,a=0;a!==i;++a){var s=e+a;t[s]=t[s]*o+t[n+a]*r}}});var Ul,zl,Vl,Gl,jl,Wl,Hl,Xl,Yl,ql,Zl,Jl,Kl,Ql,$l,tc="\\[\\]\\.:\\/";function ec(t,e,n){var r=n||nc.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,r)}function nc(t,e,n){this.path=e,this.parsedPath=n||nc.parseTrackName(e),this.node=nc.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function rc(){this.uuid=hn.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var e=0,n=arguments.length;e!==n;++e)t[arguments[e].uuid]=e;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var r=this;this.stats={objects:{get total(){return r._objects.length},get inUse(){return this.total-r.nCachedObjects_}},get bindingsPerObject(){return r._bindings.length}}}function ic(t,e,n){this._mixer=t,this._clip=e,this._localRoot=n||null;for(var r=e.tracks,i=r.length,o=new Array(i),a={endingStart:Le,endingEnd:Le},s=0;s!==i;++s){var u=r[s].createInterpolant(null);o[s]=u,u.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(i),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Te,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function oc(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function ac(t){"string"==typeof t&&(t=arguments[1]),this.value=t}function sc(t,e,n){ha.call(this,t,e),this.meshPerAttribute=n||1}function uc(t,e,n,r){this.ray=new or(t,e),this.near=n||0,this.far=r||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return this.Points}}})}function lc(t,e){return t.distance-e.distance}function cc(t,e,n,r){if(!1!==t.visible&&(t.raycast(e,n),!0===r))for(var i=t.children,o=0,a=i.length;o<a;o++)cc(i[o],e,n,!0)}function hc(t,e,n){return this.radius=void 0!==t?t:1,this.phi=void 0!==e?e:0,this.theta=void 0!==n?n:0,this}function pc(t,e,n){return this.radius=void 0!==t?t:1,this.theta=void 0!==e?e:0,this.y=void 0!==n?n:0,this}function fc(t,e){this.min=void 0!==t?t:new pn(1/0,1/0),this.max=void 0!==e?e:new pn(-1/0,-1/0)}function dc(t,e){this.start=void 0!==t?t:new dn,this.end=void 0!==e?e:new dn}function mc(t){er.call(this),this.material=t,this.render=function(){}}function gc(t,e,n,r){this.object=t,this.size=void 0!==e?e:1;var i=void 0!==n?n:16711680,o=void 0!==r?r:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=3*s.faces.length:s&&s.isBufferGeometry&&(a=s.attributes.normal.count);var u=new Dr,l=new Ar(2*a*3,3);u.addAttribute("position",l),ba.call(this,u,new xa({color:i,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function vc(t,e){er.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e;for(var n=new Dr,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],i=0,o=1;i<32;i++,o++){var a=i/32*Math.PI*2,s=o/32*Math.PI*2;r.push(Math.cos(a),Math.sin(a),1,Math.cos(s),Math.sin(s),1)}n.addAttribute("position",new Ar(r,3));var u=new xa({fog:!1});this.cone=new ba(n,u),this.add(this.cone),this.update()}function yc(t){var e=[];t&&t.isBone&&e.push(t);for(var n=0;n<t.children.length;n++)e.push.apply(e,yc(t.children[n]));return e}function xc(t){for(var e=yc(t),n=new Dr,r=[],i=[],o=new hr(0,0,1),a=new hr(0,1,0),s=0;s<e.length;s++){var u=e[s];u.parent&&u.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(o.r,o.g,o.b),i.push(a.r,a.g,a.b))}n.addAttribute("position",new Ar(r,3)),n.addAttribute("color",new Ar(i,3));var l=new xa({vertexColors:A,depthTest:!1,depthWrite:!1,transparent:!0});ba.call(this,n,l),this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}function _c(t,e,n){this.light=t,this.light.updateMatrixWorld(),this.color=n;var r=new Es(e,4,2),i=new yr({wireframe:!0,fog:!1});kr.call(this,r,i),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function bc(t,e){this.type="RectAreaLightHelper",this.light=t,this.color=e;var n=new Dr;n.addAttribute("position",new Ar([1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),n.computeBoundingSphere();var r=new xa({fog:!1});_a.call(this,n,r);var i=new Dr;i.addAttribute("position",new Ar([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),i.computeBoundingSphere(),this.add(new kr(i,new yr({side:b,fog:!1}))),this.update()}function wc(t,e,n){er.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;var r=new Fa(e);r.rotateY(.5*Math.PI),this.material=new yr({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=A);var i=r.getAttribute("position"),o=new Float32Array(3*i.count);r.addAttribute("color",new xr(o,3)),this.add(new kr(r,this.material)),this.update()}function Mc(t,e){this.lightProbe=t,this.size=e;var n={GAMMA_OUTPUT:""},r=new Xr({defines:n,uniforms:{sh:{value:this.lightProbe.sh.coefficients},intensity:{value:this.lightProbe.intensity}},vertexShader:["varying vec3 vNormal;","void main() {","\tvNormal = normalize( normalMatrix * normal );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#define RECIPROCAL_PI 0.318309886","vec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {","\t// matrix is assumed to be orthogonal","\treturn normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );","}","vec3 linearToOutput( in vec3 a ) {","\t#ifdef GAMMA_OUTPUT","\t\treturn pow( a, vec3( 1.0 / float( GAMMA_FACTOR ) ) );","\t#else","\t\treturn a;","\t#endif","}","// source: https://graphics.stanford.edu/papers/envmap/envmap.pdf","vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {","\t// normal is assumed to have unit length","\tfloat x = normal.x, y = normal.y, z = normal.z;","\t// band 0","\tvec3 result = shCoefficients[ 0 ] * 0.886227;","\t// band 1","\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;","\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;","\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;","\t// band 2","\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;","\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;","\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );","\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;","\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );","\treturn result;","}","uniform vec3 sh[ 9 ]; // sh coefficients","uniform float intensity; // light probe intensity","varying vec3 vNormal;","void main() {","\tvec3 normal = normalize( vNormal );","\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );","\tvec3 irradiance = shGetIrradianceAt( worldNormal, sh );","\tvec3 outgoingLight = RECIPROCAL_PI * irradiance * intensity;","\toutgoingLight = linearToOutput( outgoingLight );","\tgl_FragColor = vec4( outgoingLight, 1.0 );","}"].join("\n")}),i=new Es(1,32,16);kr.call(this,i,r),this.onBeforeRender()}function Sc(t,e,n,r){t=t||10,e=e||10,n=new hr(void 0!==n?n:4473924),r=new hr(void 0!==r?r:8947848);for(var i=e/2,o=t/e,a=t/2,s=[],u=[],l=0,c=0,h=-a;l<=e;l++,h+=o){s.push(-a,0,h,a,0,h),s.push(h,0,-a,h,0,a);var p=l===i?n:r;p.toArray(u,c),c+=3,p.toArray(u,c),c+=3,p.toArray(u,c),c+=3,p.toArray(u,c),c+=3}var f=new Dr;f.addAttribute("position",new Ar(s,3)),f.addAttribute("color",new Ar(u,3));var d=new xa({vertexColors:A});ba.call(this,f,d)}function Tc(t,e,n,r,i,o){t=t||10,e=e||16,n=n||8,r=r||64,i=new hr(void 0!==i?i:4473924),o=new hr(void 0!==o?o:8947848);var a,s,u,l,c,h,p,f=[],d=[];for(l=0;l<=e;l++)u=l/e*(2*Math.PI),a=Math.sin(u)*t,s=Math.cos(u)*t,f.push(0,0,0),f.push(a,0,s),p=1&l?i:o,d.push(p.r,p.g,p.b),d.push(p.r,p.g,p.b);for(l=0;l<=n;l++)for(p=1&l?i:o,h=t-t/n*l,c=0;c<r;c++)u=c/r*(2*Math.PI),a=Math.sin(u)*h,s=Math.cos(u)*h,f.push(a,0,s),d.push(p.r,p.g,p.b),u=(c+1)/r*(2*Math.PI),a=Math.sin(u)*h,s=Math.cos(u)*h,f.push(a,0,s),d.push(p.r,p.g,p.b);var m=new Dr;m.addAttribute("position",new Ar(f,3)),m.addAttribute("color",new Ar(d,3));var g=new xa({vertexColors:A});ba.call(this,m,g)}function Ec(t,e,n,r){this.audio=t,this.range=e||1,this.divisionsInnerAngle=n||16,this.divisionsOuterAngle=r||2;var i=new Dr,o=this.divisionsInnerAngle+2*this.divisionsOuterAngle,a=new Float32Array(3*(3*o+3));i.addAttribute("position",new xr(a,3));var s=new xa({color:65280}),u=new xa({color:16776960});_a.call(this,i,[u,s]),this.update()}function Ac(t,e,n,r){this.object=t,this.size=void 0!==e?e:1;var i=void 0!==n?n:16776960,o=void 0!==r?r:1,a=0,s=this.object.geometry;s&&s.isGeometry&&(a=s.faces.length);var u=new Dr,l=new Ar(2*a*3,3);u.addAttribute("position",l),ba.call(this,u,new xa({color:i,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function Pc(t,e,n){er.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===e&&(e=1);var r=new Dr;r.addAttribute("position",new Ar([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));var i=new xa({fog:!1});this.lightPlane=new _a(r,i),this.add(this.lightPlane),(r=new Dr).addAttribute("position",new Ar([0,0,0,0,0,1],3)),this.targetLine=new _a(r,i),this.add(this.targetLine),this.update()}function Cc(t){var e=new Dr,n=new xa({color:16777215,vertexColors:E}),r=[],i=[],o={},a=new hr(16755200),s=new hr(16711680),u=new hr(43775),l=new hr(16777215),c=new hr(3355443);function h(t,e,n){p(t,n),p(e,n)}function p(t,e){r.push(0,0,0),i.push(e.r,e.g,e.b),void 0===o[t]&&(o[t]=[]),o[t].push(r.length/3-1)}h("n1","n2",a),h("n2","n4",a),h("n4","n3",a),h("n3","n1",a),h("f1","f2",a),h("f2","f4",a),h("f4","f3",a),h("f3","f1",a),h("n1","f1",a),h("n2","f2",a),h("n3","f3",a),h("n4","f4",a),h("p","n1",s),h("p","n2",s),h("p","n3",s),h("p","n4",s),h("u1","u2",u),h("u2","u3",u),h("u3","u1",u),h("c","t",l),h("p","c",c),h("cn1","cn2",c),h("cn3","cn4",c),h("cf1","cf2",c),h("cf3","cf4",c),e.addAttribute("position",new Ar(r,3)),e.addAttribute("color",new Ar(i,3)),ba.call(this,e,n),this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()}function Lc(t,e){this.object=t,void 0===e&&(e=16776960);var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),i=new Dr;i.setIndex(new xr(n,1)),i.addAttribute("position",new xr(r,3)),ba.call(this,i,new xa({color:e})),this.matrixAutoUpdate=!1,this.update()}function Ic(t,e){this.type="Box3Helper",this.box=t,e=e||16776960;var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Dr;r.setIndex(new xr(n,1)),r.addAttribute("position",new Ar([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),ba.call(this,r,new xa({color:e})),this.geometry.computeBoundingSphere()}function Oc(t,e,n){this.type="PlaneHelper",this.plane=t,this.size=void 0===e?1:e;var r=void 0!==n?n:16776960,i=new Dr;i.addAttribute("position",new Ar([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),i.computeBoundingSphere(),_a.call(this,i,new xa({color:r}));var o=new Dr;o.addAttribute("position",new Ar([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),o.computeBoundingSphere(),this.add(new kr(o,new yr({color:r,opacity:.2,transparent:!0,depthWrite:!1})))}function Nc(t,e,n,r,i,o){er.call(this),void 0===t&&(t=new dn(0,0,1)),void 0===e&&(e=new dn(0,0,0)),void 0===n&&(n=1),void 0===r&&(r=16776960),void 0===i&&(i=.2*n),void 0===o&&(o=.2*i),void 0===Jl&&((Jl=new Dr).addAttribute("position",new Ar([0,0,0,0,1,0],3)),(Kl=new ks(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(e),this.line=new _a(Jl,new xa({color:r})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new kr(Kl,new yr({color:r})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(n,i,o)}function Rc(t){var e=[0,0,0,t=t||1,0,0,0,0,0,0,t,0,0,0,0,0,0,t],n=new Dr;n.addAttribute("position",new Ar(e,3)),n.addAttribute("color",new Ar([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var r=new xa({vertexColors:A});ba.call(this,n,r)}function Dc(t,e,n,r,i,o,a){return new mr(t,e,n,i,o,a)}Object.assign(ec.prototype,{getValue:function(t,e){this.bind();var n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(t,e)},setValue:function(t,e){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}}),Object.assign(nc,{Composite:ec,create:function(t,e,n){return t&&t.isAnimationObjectGroup?new nc.Composite(t,e,n):new nc(t,e,n)},sanitizeNodeName:(Yl=new RegExp("["+tc+"]","g"),function(t){return t.replace(/\s/g,"_").replace(Yl,"")}),parseTrackName:(Ul="[^"+tc+"]",zl="[^"+tc.replace("\\.","")+"]",Vl=/((?:WC+[\/:])*)/.source.replace("WC",Ul),Gl=/(WCOD+)?/.source.replace("WCOD",zl),jl=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Ul),Wl=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Ul),Hl=new RegExp("^"+Vl+Gl+jl+Wl+"$"),Xl=["material","materials","bones"],function(t){var e=Hl.exec(t);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);var n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var i=n.nodeName.substring(r+1);-1!==Xl.indexOf(i)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=i)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n}),findNode:function(t,e){if(!e||""===e||"root"===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){var n=t.skeleton.getBoneByName(e);if(void 0!==n)return n}if(t.children){var r=function(t){for(var n=0;n<t.length;n++){var i=t[n];if(i.name===e||i.uuid===e)return i;var o=r(i.children);if(o)return o}return null},i=r(t.children);if(i)return i}return null}}),Object.assign(nc.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)t[e++]=n[r]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.targetObject[this.propertyName]=t[e]},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++]},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,n=e.objectName,r=e.propertyName,i=e.propertyIndex;if(t||(t=nc.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(n){var o=e.objectIndex;switch(n){case"materials":if(!t.material)return;if(!t.material.materials)return;t=t.material.materials;break;case"bones":if(!t.skeleton)return;t=t.skeleton.bones;for(var a=0;a<t.length;a++)if(t[a].name===o){o=a;break}break;default:if(void 0===t[n])return;t=t[n]}if(void 0!==o){if(void 0===t[o])return;t=t[o]}}var s=t[r];if(void 0!==s){var u=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?u=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(u=this.Versioning.MatrixWorldNeedsUpdate);var l=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!t.geometry)return;if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes)return;for(a=0;a<this.node.geometry.morphAttributes.position.length;a++)if(t.geometry.morphAttributes.position[a].name===i){i=a;break}}else{if(!t.geometry.morphTargets)return;for(a=0;a<this.node.geometry.morphTargets.length;a++)if(t.geometry.morphTargets[a].name===i){i=a;break}}}l=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else void 0!==s.fromArray&&void 0!==s.toArray?(l=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(l=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=r;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][u]}else e.nodeName}},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),
//!\ DECLARE ALIAS AFTER assign prototype !
Object.assign(nc.prototype,{_getValue_unbound:nc.prototype.getValue,_setValue_unbound:nc.prototype.setValue}),Object.assign(rc.prototype,{isAnimationObjectGroup:!0,add:function(){for(var t=this._objects,e=t.length,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._paths,o=this._parsedPaths,a=this._bindings,s=a.length,u=0,l=arguments.length;u!==l;++u){var c=arguments[u],h=c.uuid,p=r[h];if(void 0===p){p=e++,r[h]=p,t.push(c);for(var f=0,d=s;f!==d;++f)a[f].push(new nc(c,i[f],o[f]))}else if(p<n){t[p];var m=--n,g=t[m];r[g.uuid]=p,t[p]=g,r[h]=m,t[m]=c;for(f=0,d=s;f!==d;++f){var v=a[f],y=v[m],x=v[p];v[p]=y,void 0===x&&(x=new nc(c,i[f],o[f])),v[m]=x}}else t[p]}this.nCachedObjects_=n},remove:function(){for(var t=this._objects,e=this.nCachedObjects_,n=this._indicesByUUID,r=this._bindings,i=r.length,o=0,a=arguments.length;o!==a;++o){var s=arguments[o],u=s.uuid,l=n[u];if(void 0!==l&&l>=e){var c=e++,h=t[c];n[h.uuid]=l,t[l]=h,n[u]=c,t[c]=s;for(var p=0,f=i;p!==f;++p){var d=r[p],m=d[c],g=d[l];d[l]=m,d[c]=g}}}this.nCachedObjects_=e},uncache:function(){for(var t=this._objects,e=t.length,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._bindings,o=i.length,a=0,s=arguments.length;a!==s;++a){var u=arguments[a].uuid,l=r[u];if(void 0!==l)if(delete r[u],l<n){var c=--n,h=t[c],p=t[v=--e];r[h.uuid]=l,t[l]=h,r[p.uuid]=c,t[c]=p,t.pop();for(var f=0,d=o;f!==d;++f){var m=(y=i[f])[c],g=y[v];y[l]=m,y[c]=g,y.pop()}}else{var v;r[(p=t[v=--e]).uuid]=l,t[l]=p,t.pop();for(f=0,d=o;f!==d;++f){var y;(y=i[f])[l]=y[v],y.pop()}}}this.nCachedObjects_=n},subscribe_:function(t,e){var n=this._bindingsIndicesByPath,r=n[t],i=this._bindings;if(void 0!==r)return i[r];var o=this._paths,a=this._parsedPaths,s=this._objects,u=s.length,l=this.nCachedObjects_,c=new Array(u);r=i.length,n[t]=r,o.push(t),a.push(e),i.push(c);for(var h=l,p=s.length;h!==p;++h){var f=s[h];c[h]=new nc(f,t,e)}return c},unsubscribe_:function(t){var e=this._bindingsIndicesByPath,n=e[t];if(void 0!==n){var r=this._paths,i=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a];e[t[a]]=n,o[n]=s,o.pop(),i[n]=i[a],i.pop(),r[n]=r[a],r.pop()}}}),Object.assign(ic.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,e){return this.loop=t,this.repetitions=e,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){var r=this._clip.duration,i=t._clip.duration,o=i/r,a=r/i;t.warp(1,o,e),this.warp(a,1,e)}return this},crossFadeTo:function(t,e,n){return t.crossFadeFrom(this,e,n)},stopFading:function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,e,n){var r=this._mixer,i=r.time,o=this._timeScaleInterpolant,a=this.timeScale;null===o&&(o=r._lendControlInterpolant(),this._timeScaleInterpolant=o);var s=o.parameterPositions,u=o.sampleValues;return s[0]=i,s[1]=i+n,u[0]=t/a,u[1]=e/a,this},stopWarping:function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,e,n,r){if(this.enabled){var i=this._startTime;if(null!==i){var o=(t-i)*n;if(o<0||0===n)return;this._startTime=null,e=n*o}e*=this._updateTimeScale(t);var a=this._updateTime(e),s=this._updateWeight(t);if(s>0)for(var u=this._interpolants,l=this._propertyBindings,c=0,h=u.length;c!==h;++c)u[c].evaluate(a),l[c].accumulate(r,s)}else this._updateWeight(t)},_updateWeight:function(t){var e=0;if(this.enabled){e=this.weight;var n=this._weightInterpolant;if(null!==n){var r=n.evaluate(t)[0];e*=r,t>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=e,e},_updateTimeScale:function(t){var e=0;if(!this.paused){e=this.timeScale;var n=this._timeScaleInterpolant;if(null!==n)e*=n.evaluate(t)[0],t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}return this._effectiveTimeScale=e,e},_updateTime:function(t){var e=this.time+t,n=this._clip.duration,r=this.loop,i=this._loopCount,o=r===Ee;if(0===t)return-1===i?e:o&&1==(1&i)?n-e:e;if(r===Se){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(e>=n)e=n;else{if(!(e<0)){this.time=e;break t}e=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=e,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(-1===i&&(t>=0?(i=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),e>=n||e<0){var a=Math.floor(e/n);e-=n*a,i+=Math.abs(a);var s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,e=t>0?n:0,this.time=e,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===s){var u=t<0;this._setEndings(u,!u,o)}else this._setEndings(!1,!1,o);this._loopCount=i,this.time=e,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=e;if(o&&1==(1&i))return n-e}return e},_setEndings:function(t,e,n){var r=this._interpolantSettings;n?(r.endingStart=Ie,r.endingEnd=Ie):(r.endingStart=t?this.zeroSlopeAtStart?Ie:Le:Oe,r.endingEnd=e?this.zeroSlopeAtEnd?Ie:Le:Oe)},_scheduleFading:function(t,e,n){var r=this._mixer,i=r.time,o=this._weightInterpolant;null===o&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);var a=o.parameterPositions,s=o.sampleValues;return a[0]=i,s[0]=e,a[1]=i+t,s[1]=n,this}}),oc.prototype=Object.assign(Object.create(r.prototype),{constructor:oc,_bindAction:function(t,e){var n=t._localRoot||this._root,r=t._clip.tracks,i=r.length,o=t._propertyBindings,a=t._interpolants,s=n.uuid,u=this._bindingsByRootAndName,l=u[s];void 0===l&&(l={},u[s]=l);for(var c=0;c!==i;++c){var h=r[c],p=h.name,f=l[p];if(void 0!==f)o[c]=f;else{if(void 0!==(f=o[c])){null===f._cacheIndex&&(++f.referenceCount,this._addInactiveBinding(f,s,p));continue}var d=e&&e._propertyBindings[c].binding.parsedPath;++(f=new Bl(nc.create(n,p,d),h.ValueTypeName,h.getValueSize())).referenceCount,this._addInactiveBinding(f,s,p),o[c]=f}a[c].resultBuffer=f.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){var e=(t._localRoot||this._root).uuid,n=t._clip.uuid,r=this._actionsByClip[n];this._bindAction(t,r&&r.knownActions[0]),this._addInactiveAction(t,n,e)}for(var i=t._propertyBindings,o=0,a=i.length;o!==a;++o){var s=i[o];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,n=0,r=e.length;n!==r;++n){var i=e[n];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){var e=t._cacheIndex;return null!==e&&e<this._nActiveActions},_addInactiveAction:function(t,e,n){var r=this._actions,i=this._actionsByClip,o=i[e];if(void 0===o)o={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,i[e]=o;else{var a=o.knownActions;t._byClipCacheIndex=a.length,a.push(t)}t._cacheIndex=r.length,r.push(t),o.actionByRoot[n]=t},_removeInactiveAction:function(t){var e=this._actions,n=e[e.length-1],r=t._cacheIndex;n._cacheIndex=r,e[r]=n,e.pop(),t._cacheIndex=null;var i=t._clip.uuid,o=this._actionsByClip,a=o[i],s=a.knownActions,u=s[s.length-1],l=t._byClipCacheIndex;u._byClipCacheIndex=l,s[l]=u,s.pop(),t._byClipCacheIndex=null,delete a.actionByRoot[(t._localRoot||this._root).uuid],0===s.length&&delete o[i],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){for(var e=t._propertyBindings,n=0,r=e.length;n!==r;++n){var i=e[n];0==--i.referenceCount&&this._removeInactiveBinding(i)}},_lendAction:function(t){var e=this._actions,n=t._cacheIndex,r=this._nActiveActions++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_takeBackAction:function(t){var e=this._actions,n=t._cacheIndex,r=--this._nActiveActions,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_addInactiveBinding:function(t,e,n){var r=this._bindingsByRootAndName,i=r[e],o=this._bindings;void 0===i&&(i={},r[e]=i),i[n]=t,t._cacheIndex=o.length,o.push(t)},_removeInactiveBinding:function(t){var e=this._bindings,n=t.binding,r=n.rootNode.uuid,i=n.path,o=this._bindingsByRootAndName,a=o[r],s=e[e.length-1],u=t._cacheIndex;s._cacheIndex=u,e[u]=s,e.pop(),delete a[i],0===Object.keys(a).length&&delete o[r]},_lendBinding:function(t){var e=this._bindings,n=t._cacheIndex,r=this._nActiveBindings++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_takeBackBinding:function(t){var e=this._bindings,n=t._cacheIndex,r=--this._nActiveBindings,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_lendControlInterpolant:function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,n=t[e];return void 0===n&&((n=new nu(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=e,t[e]=n),n},_takeBackControlInterpolant:function(t){var e=this._controlInterpolants,n=t.__cacheIndex,r=--this._nActiveControlInterpolants,i=e[r];t.__cacheIndex=r,e[r]=t,i.__cacheIndex=n,e[n]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,e){var n=e||this._root,r=n.uuid,i="string"==typeof t?pu.findByName(n,t):t,o=null!==i?i.uuid:t,a=this._actionsByClip[o],s=null;if(void 0!==a){var u=a.actionByRoot[r];if(void 0!==u)return u;s=a.knownActions[0],null===i&&(i=s._clip)}if(null===i)return null;var l=new ic(this,i,e);return this._bindAction(l,s),this._addInactiveAction(l,o,r),l},existingAction:function(t,e){var n=e||this._root,r=n.uuid,i="string"==typeof t?pu.findByName(n,t):t,o=i?i.uuid:t,a=this._actionsByClip[o];return void 0!==a&&a.actionByRoot[r]||null},stopAllAction:function(){var t=this._actions,e=this._nActiveActions,n=this._bindings,r=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var i=0;i!==e;++i)t[i].reset();for(i=0;i!==r;++i)n[i].useCount=0;return this},update:function(t){t*=this.timeScale;for(var e=this._actions,n=this._nActiveActions,r=this.time+=t,i=Math.sign(t),o=this._accuIndex^=1,a=0;a!==n;++a){e[a]._update(r,t,i,o)}var s=this._bindings,u=this._nActiveBindings;for(a=0;a!==u;++a)s[a].apply(o);return this},getRoot:function(){return this._root},uncacheClip:function(t){var e=this._actions,n=t.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){for(var o=i.knownActions,a=0,s=o.length;a!==s;++a){var u=o[a];this._deactivateAction(u);var l=u._cacheIndex,c=e[e.length-1];u._cacheIndex=null,u._byClipCacheIndex=null,c._cacheIndex=l,e[l]=c,e.pop(),this._removeInactiveBindingsForAction(u)}delete r[n]}},uncacheRoot:function(t){var e=t.uuid,n=this._actionsByClip;for(var r in n){var i=n[r].actionByRoot[e];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var o=this._bindingsByRootAndName[e];if(void 0!==o)for(var a in o){var s=o[a];s.restoreOriginalState(),this._removeInactiveBinding(s)}},uncacheAction:function(t,e){var n=this.existingAction(t,e);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}),ac.prototype.clone=function(){return new ac(void 0===this.value.clone?this.value:this.value.clone())},sc.prototype=Object.assign(Object.create(ha.prototype),{constructor:sc,isInstancedInterleavedBuffer:!0,copy:function(t){return ha.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),Object.assign(uc.prototype,{linePrecision:1,set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this._camera=e):e&&e.isOrthographicCamera&&(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this._camera=e)},intersectObject:function(t,e,n){var r=n||[];return cc(t,this,r,e),r.sort(lc),r},intersectObjects:function(t,e,n){var r=n||[];if(!1===Array.isArray(t))return r;for(var i=0,o=t.length;i<o;i++)cc(t[i],this,r,e);return r.sort(lc),r}}),Object.assign(hc.prototype,{set:function(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},makeSafe:function(){var t=1e-6;return this.phi=Math.max(t,Math.min(Math.PI-t,this.phi)),this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,e,n){return this.radius=Math.sqrt(t*t+e*e+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,n),this.phi=Math.acos(hn.clamp(e/this.radius,-1,1))),this}}),Object.assign(pc.prototype,{set:function(t,e,n){return this.radius=t,this.theta=e,this.y=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,e,n){return this.radius=Math.sqrt(t*t+n*n),this.theta=Math.atan2(t,n),this.y=e,this}}),Object.assign(fc.prototype,{set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new pn;return function(e,n){var r=t.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){return void 0===t&&(t=new pn),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(t=new pn),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,e){return void 0===e&&(e=new pn),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,e){return void 0===e&&(e=new pn),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new pn;return function(e){return t.copy(e).clamp(this.min,this.max).sub(e).length()}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}),Object.assign(dc.prototype,{set:function(t,e){return this.start.copy(t),this.end.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){return void 0===t&&(t=new dn),t.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return void 0===t&&(t=new dn),t.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){return void 0===e&&(e=new dn),this.delta(e).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(t,e){void 0===ql&&(ql=new dn,Zl=new dn),ql.subVectors(t,this.start),Zl.subVectors(this.end,this.start);var n=Zl.dot(Zl),r=Zl.dot(ql)/n;return e&&(r=hn.clamp(r,0,1)),r},closestPointToPoint:function(t,e,n){var r=this.closestPointToPointParameter(t,e);return void 0===n&&(n=new dn),this.delta(n).multiplyScalar(r).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}}),mc.prototype=Object.create(er.prototype),mc.prototype.constructor=mc,mc.prototype.isImmediateRenderObject=!0,gc.prototype=Object.create(ba.prototype),gc.prototype.constructor=gc,gc.prototype.update=function(){var t=new dn,e=new dn,n=new mn;return function(){var r=["a","b","c"];this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);var i=this.object.matrixWorld,o=this.geometry.attributes.position,a=this.object.geometry;if(a&&a.isGeometry)for(var s=a.vertices,u=a.faces,l=0,c=0,h=u.length;c<h;c++)for(var p=u[c],f=0,d=p.vertexNormals.length;f<d;f++){var m=s[p[r[f]]],g=p.vertexNormals[f];t.copy(m).applyMatrix4(i),e.copy(g).applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),o.setXYZ(l,t.x,t.y,t.z),l+=1,o.setXYZ(l,e.x,e.y,e.z),l+=1}else if(a&&a.isBufferGeometry){var v=a.attributes.position,y=a.attributes.normal;for(l=0,f=0,d=v.count;f<d;f++)t.set(v.getX(f),v.getY(f),v.getZ(f)).applyMatrix4(i),e.set(y.getX(f),y.getY(f),y.getZ(f)),e.applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),o.setXYZ(l,t.x,t.y,t.z),l+=1,o.setXYZ(l,e.x,e.y,e.z),l+=1}o.needsUpdate=!0}}(),vc.prototype=Object.create(er.prototype),vc.prototype.constructor=vc,vc.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},vc.prototype.update=function(){var t=new dn;return function(){this.light.updateMatrixWorld();var e=this.light.distance?this.light.distance:1e3,n=e*Math.tan(this.light.angle);this.cone.scale.set(n,n,e),t.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(t),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}(),xc.prototype=Object.create(ba.prototype),xc.prototype.constructor=xc,xc.prototype.updateMatrixWorld=function(){var t=new dn,e=new In,n=new In;return function(r){var i=this.bones,o=this.geometry,a=o.getAttribute("position");n.getInverse(this.root.matrixWorld);for(var s=0,u=0;s<i.length;s++){var l=i[s];l.parent&&l.parent.isBone&&(e.multiplyMatrices(n,l.matrixWorld),t.setFromMatrixPosition(e),a.setXYZ(u,t.x,t.y,t.z),e.multiplyMatrices(n,l.parent.matrixWorld),t.setFromMatrixPosition(e),a.setXYZ(u+1,t.x,t.y,t.z),u+=2)}o.getAttribute("position").needsUpdate=!0,er.prototype.updateMatrixWorld.call(this,r)}}(),_c.prototype=Object.create(kr.prototype),_c.prototype.constructor=_c,_c.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},_c.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},bc.prototype=Object.create(_a.prototype),bc.prototype.constructor=bc,bc.prototype.update=function(){if(this.scale.set(.5*this.light.width,.5*this.light.height,1),void 0!==this.color)this.material.color.set(this.color),this.children[0].material.color.set(this.color);else{this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);var t=this.material.color,e=Math.max(t.r,t.g,t.b);e>1&&t.multiplyScalar(1/e),this.children[0].material.color.copy(this.material.color)}},bc.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()},wc.prototype=Object.create(er.prototype),wc.prototype.constructor=wc,wc.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},wc.prototype.update=function(){var t=new dn,e=new hr,n=new hr;return function(){var r=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var i=r.geometry.getAttribute("color");e.copy(this.light.color),n.copy(this.light.groundColor);for(var o=0,a=i.count;o<a;o++){var s=o<a/2?e:n;i.setXYZ(o,s.r,s.g,s.b)}i.needsUpdate=!0}r.lookAt(t.setFromMatrixPosition(this.light.matrixWorld).negate())}}(),Mc.prototype=Object.create(kr.prototype),Mc.prototype.constructor=Mc,Mc.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Mc.prototype.onBeforeRender=function(){this.position.copy(this.lightProbe.position),this.scale.set(1,1,1).multiplyScalar(this.size),this.material.uniforms.intensity.value=this.lightProbe.intensity},Sc.prototype=Object.assign(Object.create(ba.prototype),{constructor:Sc,copy:function(t){return ba.prototype.copy.call(this,t),this.geometry.copy(t.geometry),this.material.copy(t.material),this},clone:function(){return(new this.constructor).copy(this)}}),Tc.prototype=Object.create(ba.prototype),Tc.prototype.constructor=Tc,Ec.prototype=Object.create(_a.prototype),Ec.prototype.constructor=Ec,Ec.prototype.update=function(){var t,e,n=this.audio,r=this.range,i=this.divisionsInnerAngle,o=this.divisionsOuterAngle,a=hn.degToRad(n.panner.coneInnerAngle),s=hn.degToRad(n.panner.coneOuterAngle),u=a/2,l=s/2,c=0,h=0,p=this.geometry,f=p.attributes.position;function d(n,i,o,a){var s=(i-n)/o;for(f.setXYZ(c,0,0,0),h++,t=n;t<i;t+=s)e=c+h,f.setXYZ(e,Math.sin(t)*r,0,Math.cos(t)*r),f.setXYZ(e+1,Math.sin(Math.min(t+s,i))*r,0,Math.cos(Math.min(t+s,i))*r),f.setXYZ(e+2,0,0,0),h+=3;p.addGroup(c,h,a),c+=h,h=0}p.clearGroups(),d(-l,-u,o,0),d(-u,u,i,1),d(u,l,o,0),f.needsUpdate=!0,a===s&&(this.material[0].visible=!1)},Ec.prototype.dispose=function(){this.geometry.dispose(),this.material[0].dispose(),this.material[1].dispose()},Ac.prototype=Object.create(ba.prototype),Ac.prototype.constructor=Ac,Ac.prototype.update=function(){var t=new dn,e=new dn,n=new mn;return function(){this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);for(var r=this.object.matrixWorld,i=this.geometry.attributes.position,o=this.object.geometry,a=o.vertices,s=o.faces,u=0,l=0,c=s.length;l<c;l++){var h=s[l],p=h.normal;t.copy(a[h.a]).add(a[h.b]).add(a[h.c]).divideScalar(3).applyMatrix4(r),e.copy(p).applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),i.setXYZ(u,t.x,t.y,t.z),u+=1,i.setXYZ(u,e.x,e.y,e.z),u+=1}i.needsUpdate=!0}}(),Pc.prototype=Object.create(er.prototype),Pc.prototype.constructor=Pc,Pc.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},Pc.prototype.update=function(){var t=new dn,e=new dn,n=new dn;return function(){t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),n.subVectors(e,t),this.lightPlane.lookAt(e),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(e),this.targetLine.scale.z=n.length()}}(),Cc.prototype=Object.create(ba.prototype),Cc.prototype.constructor=Cc,Cc.prototype.update=function(){var t,e,n=new dn,r=new Yr;function i(i,o,a,s){n.set(o,a,s).unproject(r);var u=e[i];if(void 0!==u)for(var l=t.getAttribute("position"),c=0,h=u.length;c<h;c++)l.setXYZ(u[c],n.x,n.y,n.z)}return function(){t=this.geometry,e=this.pointMap;r.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),i("c",0,0,-1),i("t",0,0,1),i("n1",-1,-1,-1),i("n2",1,-1,-1),i("n3",-1,1,-1),i("n4",1,1,-1),i("f1",-1,-1,1),i("f2",1,-1,1),i("f3",-1,1,1),i("f4",1,1,1),i("u1",.7,1.1,-1),i("u2",-.7,1.1,-1),i("u3",0,2,-1),i("cf1",-1,0,1),i("cf2",1,0,1),i("cf3",0,-1,1),i("cf4",0,1,1),i("cn1",-1,0,-1),i("cn2",1,0,-1),i("cn3",0,-1,-1),i("cn4",0,1,-1),t.getAttribute("position").needsUpdate=!0}}(),Lc.prototype=Object.create(ba.prototype),Lc.prototype.constructor=Lc,Lc.prototype.update=function(){var t=new rr;return function(e){if(void 0!==this.object&&t.setFromObject(this.object),!t.isEmpty()){var n=t.min,r=t.max,i=this.geometry.attributes.position,o=i.array;o[0]=r.x,o[1]=r.y,o[2]=r.z,o[3]=n.x,o[4]=r.y,o[5]=r.z,o[6]=n.x,o[7]=n.y,o[8]=r.z,o[9]=r.x,o[10]=n.y,o[11]=r.z,o[12]=r.x,o[13]=r.y,o[14]=n.z,o[15]=n.x,o[16]=r.y,o[17]=n.z,o[18]=n.x,o[19]=n.y,o[20]=n.z,o[21]=r.x,o[22]=n.y,o[23]=n.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),Lc.prototype.setFromObject=function(t){return this.object=t,this.update(),this},Lc.prototype.copy=function(t){return ba.prototype.copy.call(this,t),this.object=t.object,this},Lc.prototype.clone=function(){return(new this.constructor).copy(this)},Ic.prototype=Object.create(ba.prototype),Ic.prototype.constructor=Ic,Ic.prototype.updateMatrixWorld=function(t){var e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),er.prototype.updateMatrixWorld.call(this,t))},Oc.prototype=Object.create(_a.prototype),Oc.prototype.constructor=Oc,Oc.prototype.updateMatrixWorld=function(t){var e=-this.plane.constant;Math.abs(e)<1e-8&&(e=1e-8),this.scale.set(.5*this.size,.5*this.size,e),this.children[0].material.side=e<0?b:_,this.lookAt(this.plane.normal),er.prototype.updateMatrixWorld.call(this,t)},Nc.prototype=Object.create(er.prototype),Nc.prototype.constructor=Nc,Nc.prototype.setDirection=($l=new dn,function(t){t.y>.99999?this.quaternion.set(0,0,0,1):t.y<-.99999?this.quaternion.set(1,0,0,0):($l.set(t.z,0,-t.x).normalize(),Ql=Math.acos(t.y),this.quaternion.setFromAxisAngle($l,Ql))}),Nc.prototype.setLength=function(t,e,n){void 0===e&&(e=.2*t),void 0===n&&(n=.2*e),this.line.scale.set(1,Math.max(0,t-e),1),this.line.updateMatrix(),this.cone.scale.set(n,e,n),this.cone.position.y=t,this.cone.updateMatrix()},Nc.prototype.setColor=function(t){this.line.material.color.set(t),this.cone.material.color.set(t)},Nc.prototype.copy=function(t){return er.prototype.copy.call(this,t,!1),this.line.copy(t.line),this.cone.copy(t.cone),this},Nc.prototype.clone=function(){return(new this.constructor).copy(this)},Rc.prototype=Object.create(ba.prototype),Rc.prototype.constructor=Rc;var kc=0,Fc=1;function Bc(t){return t}function Uc(t){return void 0===t&&(t=[]),t.isMultiMaterial=!0,t.materials=t,t.clone=function(){return t.slice()},t}function zc(t,e){return new Sa(t,e)}function Vc(t){return new da(t)}function Gc(t,e){return new Sa(t,e)}function jc(t){return new Ma(t)}function Wc(t){return new Ma(t)}function Hc(t){return new Ma(t)}function Xc(t,e,n){return new dn(t,e,n)}function Yc(t,e){return new xr(t,e).setDynamic(!0)}function qc(t,e){return new _r(t,e)}function Zc(t,e){return new br(t,e)}function Jc(t,e){return new wr(t,e)}function Kc(t,e){return new Mr(t,e)}function Qc(t,e){return new Sr(t,e)}function $c(t,e){return new Tr(t,e)}function th(t,e){return new Er(t,e)}function eh(t,e){return new Ar(t,e)}function nh(t,e){return new Pr(t,e)}function rh(t){Nu.call(this,t),this.type="catmullrom",this.closed=!0}function ih(t){Nu.call(this,t),this.type="catmullrom"}function oh(t){Nu.call(this,t),this.type="catmullrom"}function ah(t){return new Rc(t)}function sh(t,e){return new Lc(t,e)}function uh(t,e){return new ba(new Rs(t.geometry),new xa({color:void 0!==e?e:16777215}))}function lh(t,e){return new ba(new Ca(t.geometry),new xa({color:void 0!==e?e:16777215}))}function ch(t){return new yu(t)}function hh(t){return new bu(t)}Tu.create=function(t,e){return t.prototype=Object.create(Tu.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},Object.assign(Hu.prototype,{createPointsGeometry:function(t){var e=this.getPoints(t);return this.createGeometry(e)},createSpacedPointsGeometry:function(t){var e=this.getSpacedPoints(t);return this.createGeometry(e)},createGeometry:function(t){for(var e=new Br,n=0,r=t.length;n<r;n++){var i=t[n];e.vertices.push(new dn(i.x,i.y,i.z||0))}return e}}),Object.assign(Xu.prototype,{fromPoints:function(t){this.setFromPoints(t)}}),rh.prototype=Object.create(Nu.prototype),ih.prototype=Object.create(Nu.prototype),oh.prototype=Object.create(Nu.prototype),Object.assign(oh.prototype,{initFromArray:function(){},getControlPointsArray:function(){},reparametrizeByArcLength:function(){}}),Sc.prototype.setColors=function(){},xc.prototype.update=function(){},Object.assign(Tl.prototype,{extractUrlBase:function(t){return al.extractUrlBase(t)}}),Object.assign(hl.prototype,{setTexturePath:function(t){return this.setResourcePath(t)}}),Object.assign(fc.prototype,{center:function(t){return this.getCenter(t)},empty:function(){return this.isEmpty()},isIntersectionBox:function(t){return this.intersectsBox(t)},size:function(t){return this.getSize(t)}}),Object.assign(rr.prototype,{center:function(t){return this.getCenter(t)},empty:function(){return this.isEmpty()},isIntersectionBox:function(t){return this.intersectsBox(t)},isIntersectionSphere:function(t){return this.intersectsSphere(t)},size:function(t){return this.getSize(t)}}),dc.prototype.center=function(t){return this.getCenter(t)},Object.assign(hn,{random16:function(){return Math.random()},nearestPowerOfTwo:function(t){return hn.floorPowerOfTwo(t)},nextPowerOfTwo:function(t){return hn.ceilPowerOfTwo(t)}}),Object.assign(mn.prototype,{flattenToArrayOffset:function(t,e){return this.toArray(t,e)},multiplyVector3:function(t){return t.applyMatrix3(this)},multiplyVector3Array:function(){},applyToBuffer:function(t){return this.applyToBufferAttribute(t)},applyToVector3Array:function(){}}),Object.assign(In.prototype,{extractPosition:function(t){return this.copyPosition(t)},flattenToArrayOffset:function(t,e){return this.toArray(t,e)},getPosition:function(){var t;return function(){return void 0===t&&(t=new dn),t.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(t){return this.makeRotationFromQuaternion(t)},multiplyToArray:function(){},multiplyVector3:function(t){return t.applyMatrix4(this)},multiplyVector4:function(t){return t.applyMatrix4(this)},multiplyVector3Array:function(){},rotateAxis:function(t){t.transformDirection(this)},crossVector:function(t){return t.applyMatrix4(this)},translate:function(){},rotateX:function(){},rotateY:function(){},rotateZ:function(){},rotateByAxis:function(){},applyToBuffer:function(t){return this.applyToBufferAttribute(t)},applyToVector3Array:function(){},makeFrustum:function(t,e,n,r,i,o){return this.makePerspective(t,e,r,n,i,o)}}),ni.prototype.isIntersectionLine=function(t){return this.intersectsLine(t)},fn.prototype.multiplyVector3=function(t){return t.applyQuaternion(this)},Object.assign(or.prototype,{isIntersectionBox:function(t){return this.intersectsBox(t)},isIntersectionPlane:function(t){return this.intersectsPlane(t)},isIntersectionSphere:function(t){return this.intersectsSphere(t)}}),Object.assign(ar.prototype,{area:function(){return this.getArea()},barycoordFromPoint:function(t,e){return this.getBarycoord(t,e)},midpoint:function(t){return this.getMidpoint(t)},normal:function(t){return this.getNormal(t)},plane:function(t){return this.getPlane(t)}}),Object.assign(ar,{barycoordFromPoint:function(t,e,n,r,i){return ar.getBarycoord(t,e,n,r,i)},normal:function(t,e,n,r){return ar.getNormal(t,e,n,r)}}),Object.assign(Yu.prototype,{extractAllPoints:function(t){return this.extractPoints(t)},extrude:function(t){return new xs(this,t)},makeGeometry:function(t){return new Is(this,t)}}),Object.assign(pn.prototype,{fromAttribute:function(t,e,n){return this.fromBufferAttribute(t,e,n)},distanceToManhattan:function(t){return this.manhattanDistanceTo(t)},lengthManhattan:function(){return this.manhattanLength()}}),Object.assign(dn.prototype,{setEulerFromRotationMatrix:function(){},setEulerFromQuaternion:function(){},getPositionFromMatrix:function(t){return this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return this.setFromMatrixColumn(e,t)},applyProjection:function(t){return this.applyMatrix4(t)},fromAttribute:function(t,e,n){return this.fromBufferAttribute(t,e,n)},distanceToManhattan:function(t){return this.manhattanDistanceTo(t)},lengthManhattan:function(){return this.manhattanLength()}}),Object.assign(Pn.prototype,{fromAttribute:function(t,e,n){return this.fromBufferAttribute(t,e,n)},lengthManhattan:function(){return this.manhattanLength()}}),Object.assign(Br.prototype,{computeTangents:function(){},computeLineDistances:function(){}}),Object.assign(er.prototype,{getChildByName:function(t){return this.getObjectByName(t)},renderDepth:function(){},translate:function(t,e){return this.translateOnAxis(e,t)},getWorldRotation:function(){}}),Object.defineProperties(er.prototype,{eulerOrder:{get:function(){return this.rotation.order},set:function(t){this.rotation.order=t}},useQuaternion:{get:function(){},set:function(){}}}),Object.defineProperties(ma.prototype,{objects:{get:function(){return this.levels}}}),Object.defineProperty(va.prototype,"useVertexTexture",{get:function(){},set:function(){}}),ga.prototype.initBones=function(){},Object.defineProperty(Tu.prototype,"__arcLengthDivisions",{get:function(){return this.arcLengthDivisions},set:function(t){this.arcLengthDivisions=t}}),qr.prototype.setLens=function(t,e){void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(qu.prototype,{onlyShadow:{set:function(){}},shadowCameraFov:{set:function(t){this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){}},shadowBias:{set:function(t){this.shadow.bias=t}},shadowDarkness:{set:function(){}},shadowMapWidth:{set:function(t){this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){this.shadow.mapSize.height=t}}}),Object.defineProperties(xr.prototype,{length:{get:function(){return this.array.length}},copyIndicesArray:function(){}}),Object.assign(Dr.prototype,{addIndex:function(t){this.setIndex(t)},addDrawCall:function(t,e,n){this.addGroup(t,e)},clearDrawCalls:function(){this.clearGroups()},computeTangents:function(){},computeOffsets:function(){}}),Object.defineProperties(Dr.prototype,{drawcalls:{get:function(){return this.groups}},offsets:{get:function(){return this.groups}}}),Object.assign(_s.prototype,{getArrays:function(){},addShapeList:function(){},addShape:function(){}}),Object.defineProperties(ac.prototype,{dynamic:{set:function(){}},onUpdate:{value:function(){return this}}}),Object.defineProperties(vr.prototype,{wrapAround:{get:function(){},set:function(){}},overdraw:{get:function(){},set:function(){}},wrapRGB:{get:function(){return new hr}},shading:{get:function(){},set:function(t){this.flatShading=t===M}}}),Object.defineProperties(Xs.prototype,{metal:{get:function(){return!1},set:function(){}}}),Object.defineProperties(Xr.prototype,{derivatives:{get:function(){return this.extensions.derivatives},set:function(t){this.extensions.derivatives=t}}}),Object.assign(ua.prototype,{clearTarget:function(t,e,n,r){this.setRenderTarget(t),this.clear(e,n,r)},animate:function(t){this.setAnimationLoop(t)},getCurrentRenderTarget:function(){return this.getRenderTarget()},getMaxAnisotropy:function(){return this.capabilities.getMaxAnisotropy()},getPrecision:function(){return this.capabilities.precision},resetGLState:function(){return this.state.reset()},supportsFloatTextures:function(){return this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return this.capabilities.vertexTextures},supportsInstancedArrays:function(){return this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){this.setScissorTest(t)},initMaterial:function(){},addPrePlugin:function(){},addPostPlugin:function(){},updateShadowMap:function(){},setFaceCulling:function(){},allocTextureUnit:function(){},setTexture:function(){},setTexture2D:function(){},setTextureCube:function(){},getActiveMipMapLevel:function(){return this.getActiveMipmapLevel()}}),Object.defineProperties(ua.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){this.shadowMap.type=t}},shadowMapCullFace:{get:function(){},set:function(){}},context:{get:function(){return this.getContext()}}}),Object.defineProperties(Ho.prototype,{cullFace:{get:function(){},set:function(){}},renderReverseSided:{get:function(){},set:function(){}},renderSingleSided:{get:function(){},set:function(){}}}),Object.defineProperties(ti.prototype,{activeCubeFace:{set:function(){}},activeMipMapLevel:{set:function(){}}}),Object.defineProperties(Cn.prototype,{wrapS:{get:function(){return this.texture.wrapS},set:function(t){this.texture.wrapS=t}},wrapT:{get:function(){return this.texture.wrapT},set:function(t){this.texture.wrapT=t}},magFilter:{get:function(){return this.texture.magFilter},set:function(t){this.texture.magFilter=t}},minFilter:{get:function(){return this.texture.minFilter},set:function(t){this.texture.minFilter=t}},anisotropy:{get:function(){return this.texture.anisotropy},set:function(t){this.texture.anisotropy=t}},offset:{get:function(){return this.texture.offset},set:function(t){this.texture.offset=t}},repeat:{get:function(){return this.texture.repeat},set:function(t){this.texture.repeat=t}},format:{get:function(){return this.texture.format},set:function(t){this.texture.format=t}},type:{get:function(){return this.texture.type},set:function(t){this.texture.type=t}},generateMipmaps:{get:function(){return this.texture.generateMipmaps},set:function(t){this.texture.generateMipmaps=t}}}),Object.defineProperties(aa.prototype,{standing:{set:function(){}},userHeight:{set:function(){}}}),Dl.prototype.load=function(t){var e=this;return(new Al).load(t,(function(t){e.setBuffer(t)})),this},Fl.prototype.getData=function(){return this.getFrequencyData()},$r.prototype.updateCubeMap=function(t,e){return this.update(t,e)};var ph={merge:function(t,e,n){var r;e.isMesh&&(e.matrixAutoUpdate&&e.updateMatrix(),r=e.matrix,e=e.geometry),t.merge(e,r,n)},center:function(t){return t.center()}};function fh(){}function dh(){}Tn.crossOrigin=void 0,Tn.loadTexture=function(t,e,n,r){var i=new Su;i.setCrossOrigin(this.crossOrigin);var o=i.load(t,n,void 0,r);return e&&(o.mapping=e),o},Tn.loadTextureCube=function(t,e,n,r){var i=new Mu;i.setCrossOrigin(this.crossOrigin);var o=i.load(t,n,void 0,r);return e&&(o.mapping=e),o},Tn.loadCompressedTexture=function(){},Tn.loadCompressedTextureCube=function(){};var mh={createMultiMaterialObject:function(){},detach:function(){},attach:function(){}};function gh(){}},94134:function(t,e,n){"use strict";n.r(e),n.d(e,{WEBGL:function(){return r}});var r={isWebGLAvailable:function(){try{var t=document.createElement("canvas");return!(!window.WebGLRenderingContext||!t.getContext("webgl")&&!t.getContext("experimental-webgl"))}catch(t){return!1}},isWebGL2Available:function(){try{var t=document.createElement("canvas");return!(!window.WebGL2RenderingContext||!t.getContext("webgl2"))}catch(t){return!1}},getWebGLErrorMessage:function(){return this.getErrorMessage(1)},getWebGL2ErrorMessage:function(){return this.getErrorMessage(2)},getErrorMessage:function(t){var e={1:window.WebGLRenderingContext,2:window.WebGL2RenderingContext},n='Your $0 does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">$1</a>',r=document.createElement("div");return r.id="webglmessage",r.style.fontFamily="monospace",r.style.fontSize="13px",r.style.fontWeight="normal",r.style.textAlign="center",r.style.background="#fff",r.style.color="#000",r.style.padding="1.5em",r.style.width="400px",r.style.margin="5em auto 0",n=(n=e[t]?n.replace("$0","graphics card"):n.replace("$0","browser")).replace("$1",{1:"WebGL",2:"WebGL 2"}[t]),r.innerHTML=n,r}}},88441:function(t,e){"use strict";
/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const n="150",r=0,i=1,o=2,a=1,s=2,u=3,l=0,c=1,h=2,p=0,f=1,d=2,m=3,g=4,v=5,y=100,x=101,_=102,b=103,w=104,M=200,S=201,T=202,E=203,A=204,P=205,C=206,L=207,I=208,O=209,N=210,R=0,D=1,k=2,F=3,B=4,U=5,z=6,V=7,G=0,j=1,W=2,H=0,X=1,Y=2,q=3,Z=4,J=5,K=300,Q=301,$=302,tt=303,et=304,nt=306,rt=1e3,it=1001,ot=1002,at=1003,st=1004,ut=1005,lt=1006,ct=1007,ht=1008,pt=1009,ft=1010,dt=1011,mt=1012,gt=1013,vt=1014,yt=1015,xt=1016,_t=1017,bt=1018,wt=1020,Mt=1021,St=1023,Tt=1024,Et=1025,At=1026,Pt=1027,Ct=1028,Lt=1029,It=1030,Ot=1031,Nt=1033,Rt=33776,Dt=33777,kt=33778,Ft=33779,Bt=35840,Ut=35841,zt=35842,Vt=35843,Gt=36196,jt=37492,Wt=37496,Ht=37808,Xt=37809,Yt=37810,qt=37811,Zt=37812,Jt=37813,Kt=37814,Qt=37815,$t=37816,te=37817,ee=37818,ne=37819,re=37820,ie=37821,oe=36492,ae=36283,se=36284,ue=36285,le=36286,ce=2300,he=2301,pe=2302,fe=2400,de=2401,me=2402,ge=2500,ve=2501,ye=3e3,xe=3001,_e=3201,be=0,we=1,Me="srgb",Se="srgb-linear",Te="display-p3",Ee=7680,Ae=35044,Pe="300 es",Ce=1035;class Le{addEventListener(t,e){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)}hasEventListener(t,e){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)}removeEventListener(t,e){if(void 0===this._listeners)return;const n=this._listeners[t];if(void 0!==n){const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}dispatchEvent(t){if(void 0===this._listeners)return;const e=this._listeners[t.type];if(void 0!==e){t.target=this;const n=e.slice(0);for(let e=0,r=n.length;e<r;e++)n[e].call(this,t);t.target=null}}}const Ie=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let Oe=1234567;const Ne=Math.PI/180,Re=180/Math.PI;function De(){const t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(Ie[255&t]+Ie[t>>8&255]+Ie[t>>16&255]+Ie[t>>24&255]+"-"+Ie[255&e]+Ie[e>>8&255]+"-"+Ie[e>>16&15|64]+Ie[e>>24&255]+"-"+Ie[63&n|128]+Ie[n>>8&255]+"-"+Ie[n>>16&255]+Ie[n>>24&255]+Ie[255&r]+Ie[r>>8&255]+Ie[r>>16&255]+Ie[r>>24&255]).toLowerCase()}function ke(t,e,n){return Math.max(e,Math.min(n,t))}function Fe(t,e){return(t%e+e)%e}function Be(t,e,n){return(1-n)*t+n*e}function Ue(t){return 0==(t&t-1)&&0!==t}function ze(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function Ve(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function Ge(t,e){switch(e.constructor){case Float32Array:return t;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function je(t,e){switch(e.constructor){case Float32Array:return t;case Uint16Array:return Math.round(65535*t);case Uint8Array:return Math.round(255*t);case Int16Array:return Math.round(32767*t);case Int8Array:return Math.round(127*t);default:throw new Error("Invalid component type.")}}const We={DEG2RAD:Ne,RAD2DEG:Re,generateUUID:De,clamp:ke,euclideanModulo:Fe,mapLinear:function(t,e,n,r,i){return r+(t-e)*(i-r)/(n-e)},inverseLerp:function(t,e,n){return t!==e?(n-t)/(e-t):0},lerp:Be,damp:function(t,e,n,r){return Be(t,e,1-Math.exp(-n*r))},pingpong:function(t,e=1){return e-Math.abs(Fe(t,2*e)-e)},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},seededRandom:function(t){void 0!==t&&(Oe=t);let e=Oe+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296},degToRad:function(t){return t*Ne},radToDeg:function(t){return t*Re},isPowerOfTwo:Ue,ceilPowerOfTwo:ze,floorPowerOfTwo:Ve,setQuaternionFromProperEuler:function(t,e,n,r,i){const o=Math.cos,a=Math.sin,s=o(n/2),u=a(n/2),l=o((e+r)/2),c=a((e+r)/2),h=o((e-r)/2),p=a((e-r)/2),f=o((r-e)/2),d=a((r-e)/2);switch(i){case"XYX":t.set(s*c,u*h,u*p,s*l);break;case"YZY":t.set(u*p,s*c,u*h,s*l);break;case"ZXZ":t.set(u*h,u*p,s*c,s*l);break;case"XZX":t.set(s*c,u*d,u*f,s*l);break;case"YXY":t.set(u*f,s*c,u*d,s*l);break;case"ZYZ":t.set(u*d,u*f,s*c,s*l)}},normalize:je,denormalize:Ge};class He{constructor(t=0,e=0){He.prototype.isVector2=!0,this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,n=this.y,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6],this.y=r[1]*e+r[4]*n+r[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y;return e*e+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const n=Math.cos(e),r=Math.sin(e),i=this.x-t.x,o=this.y-t.y;return this.x=i*n-o*r+t.x,this.y=i*r+o*n+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Xe{constructor(){Xe.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(t,e,n,r,i,o,a,s,u){const l=this.elements;return l[0]=t,l[1]=r,l[2]=a,l[3]=e,l[4]=i,l[5]=s,l[6]=n,l[7]=o,l[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this}extractBasis(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,r=e.elements,i=this.elements,o=n[0],a=n[3],s=n[6],u=n[1],l=n[4],c=n[7],h=n[2],p=n[5],f=n[8],d=r[0],m=r[3],g=r[6],v=r[1],y=r[4],x=r[7],_=r[2],b=r[5],w=r[8];return i[0]=o*d+a*v+s*_,i[3]=o*m+a*y+s*b,i[6]=o*g+a*x+s*w,i[1]=u*d+l*v+c*_,i[4]=u*m+l*y+c*b,i[7]=u*g+l*x+c*w,i[2]=h*d+p*v+f*_,i[5]=h*m+p*y+f*b,i[8]=h*g+p*x+f*w,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],l=t[8];return e*o*l-e*a*u-n*i*l+n*a*s+r*i*u-r*o*s}invert(){const t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],l=t[8],c=l*o-a*u,h=a*s-l*i,p=u*i-o*s,f=e*c+n*h+r*p;if(0===f)return this.set(0,0,0,0,0,0,0,0,0);const d=1/f;return t[0]=c*d,t[1]=(r*u-l*n)*d,t[2]=(a*n-r*o)*d,t[3]=h*d,t[4]=(l*e-r*s)*d,t[5]=(r*i-a*e)*d,t[6]=p*d,t[7]=(n*s-u*e)*d,t[8]=(o*e-n*i)*d,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,n,r,i,o,a){const s=Math.cos(i),u=Math.sin(i);return this.set(n*s,n*u,-n*(s*o+u*a)+o+t,-r*u,r*s,-r*(-u*o+s*a)+a+e,0,0,1),this}scale(t,e){return this.premultiply(Ye.makeScale(t,e)),this}rotate(t){return this.premultiply(Ye.makeRotation(-t)),this}translate(t,e){return this.premultiply(Ye.makeTranslation(t,e)),this}makeTranslation(t,e){return this.set(1,0,t,0,1,e,0,0,1),this}makeRotation(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,n,e,0,0,0,1),this}makeScale(t,e){return this.set(t,0,0,0,e,0,0,0,1),this}equals(t){const e=this.elements,n=t.elements;for(let t=0;t<9;t++)if(e[t]!==n[t])return!1;return!0}fromArray(t,e=0){for(let n=0;n<9;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}clone(){return(new this.constructor).fromArray(this.elements)}}const Ye=new Xe;function qe(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}const Ze={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function Je(t,e){return new Ze[t](e)}function Ke(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}class Qe{constructor(t=0,e=0,n=0,r=1){this.isQuaternion=!0,this._x=t,this._y=e,this._z=n,this._w=r}static slerpFlat(t,e,n,r,i,o,a){let s=n[r+0],u=n[r+1],l=n[r+2],c=n[r+3];const h=i[o+0],p=i[o+1],f=i[o+2],d=i[o+3];if(0===a)return t[e+0]=s,t[e+1]=u,t[e+2]=l,void(t[e+3]=c);if(1===a)return t[e+0]=h,t[e+1]=p,t[e+2]=f,void(t[e+3]=d);if(c!==d||s!==h||u!==p||l!==f){let t=1-a;const e=s*h+u*p+l*f+c*d,n=e>=0?1:-1,r=1-e*e;if(r>Number.EPSILON){const i=Math.sqrt(r),o=Math.atan2(i,e*n);t=Math.sin(t*o)/i,a=Math.sin(a*o)/i}const i=a*n;if(s=s*t+h*i,u=u*t+p*i,l=l*t+f*i,c=c*t+d*i,t===1-a){const t=1/Math.sqrt(s*s+u*u+l*l+c*c);s*=t,u*=t,l*=t,c*=t}}t[e]=s,t[e+1]=u,t[e+2]=l,t[e+3]=c}static multiplyQuaternionsFlat(t,e,n,r,i,o){const a=n[r],s=n[r+1],u=n[r+2],l=n[r+3],c=i[o],h=i[o+1],p=i[o+2],f=i[o+3];return t[e]=a*f+l*c+s*p-u*h,t[e+1]=s*f+l*h+u*c-a*p,t[e+2]=u*f+l*p+a*h-s*c,t[e+3]=l*f-a*c-s*h-u*p,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){const n=t._x,r=t._y,i=t._z,o=t._order,a=Math.cos,s=Math.sin,u=a(n/2),l=a(r/2),c=a(i/2),h=s(n/2),p=s(r/2),f=s(i/2);switch(o){case"XYZ":this._x=h*l*c+u*p*f,this._y=u*p*c-h*l*f,this._z=u*l*f+h*p*c,this._w=u*l*c-h*p*f;break;case"YXZ":this._x=h*l*c+u*p*f,this._y=u*p*c-h*l*f,this._z=u*l*f-h*p*c,this._w=u*l*c+h*p*f;break;case"ZXY":this._x=h*l*c-u*p*f,this._y=u*p*c+h*l*f,this._z=u*l*f+h*p*c,this._w=u*l*c-h*p*f;break;case"ZYX":this._x=h*l*c-u*p*f,this._y=u*p*c+h*l*f,this._z=u*l*f-h*p*c,this._w=u*l*c+h*p*f;break;case"YZX":this._x=h*l*c+u*p*f,this._y=u*p*c+h*l*f,this._z=u*l*f-h*p*c,this._w=u*l*c-h*p*f;break;case"XZY":this._x=h*l*c-u*p*f,this._y=u*p*c-h*l*f,this._z=u*l*f+h*p*c,this._w=u*l*c+h*p*f}return!1!==e&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,n=e[0],r=e[4],i=e[8],o=e[1],a=e[5],s=e[9],u=e[2],l=e[6],c=e[10],h=n+a+c;if(h>0){const t=.5/Math.sqrt(h+1);this._w=.25/t,this._x=(l-s)*t,this._y=(i-u)*t,this._z=(o-r)*t}else if(n>a&&n>c){const t=2*Math.sqrt(1+n-a-c);this._w=(l-s)/t,this._x=.25*t,this._y=(r+o)/t,this._z=(i+u)/t}else if(a>c){const t=2*Math.sqrt(1+a-n-c);this._w=(i-u)/t,this._x=(r+o)/t,this._y=.25*t,this._z=(s+l)/t}else{const t=2*Math.sqrt(1+c-n-a);this._w=(o-r)/t,this._x=(i+u)/t,this._y=(s+l)/t,this._z=.25*t}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let n=t.dot(e)+1;return n<Number.EPSILON?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(ke(this.dot(t),-1,1)))}rotateTowards(t,e){const n=this.angleTo(t);if(0===n)return this;const r=Math.min(1,e/n);return this.slerp(t,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const n=t._x,r=t._y,i=t._z,o=t._w,a=e._x,s=e._y,u=e._z,l=e._w;return this._x=n*l+o*a+r*u-i*s,this._y=r*l+o*s+i*a-n*u,this._z=i*l+o*u+n*s-r*a,this._w=o*l-n*a-r*s-i*u,this._onChangeCallback(),this}slerp(t,e){if(0===e)return this;if(1===e)return this.copy(t);const n=this._x,r=this._y,i=this._z,o=this._w;let a=o*t._w+n*t._x+r*t._y+i*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=o,this._x=n,this._y=r,this._z=i,this;const s=1-a*a;if(s<=Number.EPSILON){const t=1-e;return this._w=t*o+e*this._w,this._x=t*n+e*this._x,this._y=t*r+e*this._y,this._z=t*i+e*this._z,this.normalize(),this._onChangeCallback(),this}const u=Math.sqrt(s),l=Math.atan2(u,a),c=Math.sin((1-e)*l)/u,h=Math.sin(e*l)/u;return this._w=o*c+this._w*h,this._x=n*c+this._x*h,this._y=r*c+this._y*h,this._z=i*c+this._z*h,this._onChangeCallback(),this}slerpQuaternions(t,e,n){return this.copy(t).slerp(e,n)}random(){const t=Math.random(),e=Math.sqrt(1-t),n=Math.sqrt(t),r=2*Math.PI*Math.random(),i=2*Math.PI*Math.random();return this.set(e*Math.cos(r),n*Math.sin(i),n*Math.cos(i),e*Math.sin(r))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class $e{constructor(t=0,e=0,n=0){$e.prototype.isVector3=!0,this.x=t,this.y=e,this.z=n}set(t,e,n){return void 0===n&&(n=this.z),this.x=t,this.y=e,this.z=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return this.applyQuaternion(en.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(en.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6]*r,this.y=i[1]*e+i[4]*n+i[7]*r,this.z=i[2]*e+i[5]*n+i[8]*r,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,n=this.y,r=this.z,i=t.elements,o=1/(i[3]*e+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*e+i[4]*n+i[8]*r+i[12])*o,this.y=(i[1]*e+i[5]*n+i[9]*r+i[13])*o,this.z=(i[2]*e+i[6]*n+i[10]*r+i[14])*o,this}applyQuaternion(t){const e=this.x,n=this.y,r=this.z,i=t.x,o=t.y,a=t.z,s=t.w,u=s*e+o*r-a*n,l=s*n+a*e-i*r,c=s*r+i*n-o*e,h=-i*e-o*n-a*r;return this.x=u*s+h*-i+l*-a-c*-o,this.y=l*s+h*-o+c*-i-u*-a,this.z=c*s+h*-a+u*-o-l*-i,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[4]*n+i[8]*r,this.y=i[1]*e+i[5]*n+i[9]*r,this.z=i[2]*e+i[6]*n+i[10]*r,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,e){const n=t.x,r=t.y,i=t.z,o=e.x,a=e.y,s=e.z;return this.x=r*s-i*a,this.y=i*o-n*s,this.z=n*a-r*o,this}projectOnVector(t){const e=t.lengthSq();if(0===e)return this.set(0,0,0);const n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)}projectOnPlane(t){return tn.copy(this).projectOnVector(t),this.sub(tn)}reflect(t){return this.sub(tn.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(ke(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return e*e+n*n+r*r}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,n){const r=Math.sin(e)*t;return this.x=r*Math.sin(n),this.y=Math.cos(e)*t,this.z=r*Math.cos(n),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=r,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,4*e)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,3*e)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=2*(Math.random()-.5),e=Math.random()*Math.PI*2,n=Math.sqrt(1-t**2);return this.x=n*Math.cos(e),this.y=n*Math.sin(e),this.z=t,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const tn=new $e,en=new Qe;function nn(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function rn(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}const on=(new Xe).fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),an=(new Xe).fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]),sn=new $e;const un={[Se]:t=>t,[Me]:t=>t.convertSRGBToLinear(),[Te]:function(t){return t.convertSRGBToLinear(),sn.set(t.r,t.g,t.b).applyMatrix3(an),t.setRGB(sn.x,sn.y,sn.z)}},ln={[Se]:t=>t,[Me]:t=>t.convertLinearToSRGB(),[Te]:function(t){return sn.set(t.r,t.g,t.b).applyMatrix3(on),t.setRGB(sn.x,sn.y,sn.z).convertLinearToSRGB()}},cn={enabled:!1,get legacyMode(){return!this.enabled},set legacyMode(t){this.enabled=!t},get workingColorSpace(){return Se},set workingColorSpace(t){},convert:function(t,e,n){if(!1===this.enabled||e===n||!e||!n)return t;const r=un[e],i=ln[n];if(void 0===r||void 0===i)throw new Error(`Unsupported color space conversion, "${e}" to "${n}".`);return i(r(t))},fromWorkingColorSpace:function(t,e){return this.convert(t,this.workingColorSpace,e)},toWorkingColorSpace:function(t,e){return this.convert(t,e,this.workingColorSpace)}};let hn;class pn{static getDataURL(t){if(/^data:/i.test(t.src))return t.src;if("undefined"==typeof HTMLCanvasElement)return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{void 0===hn&&(hn=Ke("canvas")),hn.width=t.width,hn.height=t.height;const n=hn.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=hn}return e.width>2048||e.height>2048?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}static sRGBToLinear(t){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){const e=Ke("canvas");e.width=t.width,e.height=t.height;const n=e.getContext("2d");n.drawImage(t,0,0,t.width,t.height);const r=n.getImageData(0,0,t.width,t.height),i=r.data;for(let t=0;t<i.length;t++)i[t]=255*nn(i[t]/255);return n.putImageData(r,0,0),e}if(t.data){const e=t.data.slice(0);for(let t=0;t<e.length;t++)e instanceof Uint8Array||e instanceof Uint8ClampedArray?e[t]=Math.floor(255*nn(e[t]/255)):e[t]=nn(e[t]);return{data:e,width:t.width,height:t.height}}return t}}class fn{constructor(t=null){this.isSource=!0,this.uuid=De(),this.data=t,this.version=0}set needsUpdate(t){!0===t&&this.version++}toJSON(t){const e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.images[this.uuid])return t.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(null!==r){let t;if(Array.isArray(r)){t=[];for(let e=0,n=r.length;e<n;e++)r[e].isDataTexture?t.push(dn(r[e].image)):t.push(dn(r[e]))}else t=dn(r);n.url=t}return e||(t.images[this.uuid]=n),n}}function dn(t){return"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?pn.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:{}}let mn=0;class gn extends Le{constructor(t=gn.DEFAULT_IMAGE,e=gn.DEFAULT_MAPPING,n=it,r=it,i=lt,o=ht,a=St,s=pt,u=gn.DEFAULT_ANISOTROPY,l=ye){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:mn++}),this.uuid=De(),this.name="",this.source=new fn(t),this.mipmaps=[],this.mapping=e,this.wrapS=n,this.wrapT=r,this.magFilter=i,this.minFilter=o,this.anisotropy=u,this.format=a,this.internalFormat=null,this.type=s,this.offset=new He(0,0),this.repeat=new He(1,1),this.center=new He(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Xe,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=l,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),e||(t.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==K)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case rt:t.x=t.x-Math.floor(t.x);break;case it:t.x=t.x<0?0:1;break;case ot:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case rt:t.y=t.y-Math.floor(t.y);break;case it:t.y=t.y<0?0:1;break;case ot:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}}gn.DEFAULT_IMAGE=null,gn.DEFAULT_MAPPING=K,gn.DEFAULT_ANISOTROPY=1;class vn{constructor(t=0,e=0,n=0,r=1){vn.prototype.isVector4=!0,this.x=t,this.y=e,this.z=n,this.w=r}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,n,r){return this.x=t,this.y=e,this.z=n,this.w=r,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,n=this.y,r=this.z,i=this.w,o=t.elements;return this.x=o[0]*e+o[4]*n+o[8]*r+o[12]*i,this.y=o[1]*e+o[5]*n+o[9]*r+o[13]*i,this.z=o[2]*e+o[6]*n+o[10]*r+o[14]*i,this.w=o[3]*e+o[7]*n+o[11]*r+o[15]*i,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,n,r,i;const o=.01,a=.1,s=t.elements,u=s[0],l=s[4],c=s[8],h=s[1],p=s[5],f=s[9],d=s[2],m=s[6],g=s[10];if(Math.abs(l-h)<o&&Math.abs(c-d)<o&&Math.abs(f-m)<o){if(Math.abs(l+h)<a&&Math.abs(c+d)<a&&Math.abs(f+m)<a&&Math.abs(u+p+g-3)<a)return this.set(1,0,0,0),this;e=Math.PI;const t=(u+1)/2,s=(p+1)/2,v=(g+1)/2,y=(l+h)/4,x=(c+d)/4,_=(f+m)/4;return t>s&&t>v?t<o?(n=0,r=.707106781,i=.707106781):(n=Math.sqrt(t),r=y/n,i=x/n):s>v?s<o?(n=.707106781,r=0,i=.707106781):(r=Math.sqrt(s),n=y/r,i=_/r):v<o?(n=.707106781,r=.707106781,i=0):(i=Math.sqrt(v),n=x/i,r=_/i),this.set(n,r,i,e),this}let v=Math.sqrt((m-f)*(m-f)+(c-d)*(c-d)+(h-l)*(h-l));return Math.abs(v)<.001&&(v=1),this.x=(m-f)/v,this.y=(c-d)/v,this.z=(h-l)/v,this.w=Math.acos((u+p+g-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this.w=t.w+(e.w-t.w)*n,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class yn extends Le{constructor(t=1,e=1,n={}){super(),this.isWebGLRenderTarget=!0,this.width=t,this.height=e,this.depth=1,this.scissor=new vn(0,0,t,e),this.scissorTest=!1,this.viewport=new vn(0,0,t,e);const r={width:t,height:e,depth:1};this.texture=new gn(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.internalFormat=void 0!==n.internalFormat?n.internalFormat:null,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:lt,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null,this.samples=void 0!==n.samples?n.samples:0}setSize(t,e,n=1){this.width===t&&this.height===e&&this.depth===n||(this.width=t,this.height=e,this.depth=n,this.texture.image.width=t,this.texture.image.height=e,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)}clone(){return(new this.constructor).copy(this)}copy(t){this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.texture.isRenderTargetTexture=!0;const e=Object.assign({},t.texture.image);return this.texture.source=new fn(e),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,null!==t.depthTexture&&(this.depthTexture=t.depthTexture.clone()),this.samples=t.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class xn extends gn{constructor(t=null,e=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:t,width:e,height:n,depth:r},this.magFilter=at,this.minFilter=at,this.wrapR=it,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class _n extends gn{constructor(t=null,e=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:t,width:e,height:n,depth:r},this.magFilter=at,this.minFilter=at,this.wrapR=it,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class bn{constructor(t=new $e(1/0,1/0,1/0),e=new $e(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){let e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0;for(let s=0,u=t.length;s<u;s+=3){const u=t[s],l=t[s+1],c=t[s+2];u<e&&(e=u),l<n&&(n=l),c<r&&(r=c),u>i&&(i=u),l>o&&(o=l),c>a&&(a=c)}return this.min.set(e,n,r),this.max.set(i,o,a),this}setFromBufferAttribute(t){let e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0;for(let s=0,u=t.count;s<u;s++){const u=t.getX(s),l=t.getY(s),c=t.getZ(s);u<e&&(e=u),l<n&&(n=l),c<r&&(r=c),u>i&&(i=u),l>o&&(o=l),c>a&&(a=c)}return this.min.set(e,n,r),this.max.set(i,o,a),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=Mn.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}setFromObject(t,e=!1){return this.makeEmpty(),this.expandByObject(t,e)}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,e=!1){t.updateWorldMatrix(!1,!1);const n=t.geometry;if(void 0!==n)if(e&&null!=n.attributes&&void 0!==n.attributes.position){const e=n.attributes.position;for(let n=0,r=e.count;n<r;n++)Mn.fromBufferAttribute(e,n).applyMatrix4(t.matrixWorld),this.expandByPoint(Mn)}else null===n.boundingBox&&n.computeBoundingBox(),Sn.copy(n.boundingBox),Sn.applyMatrix4(t.matrixWorld),this.union(Sn);const r=t.children;for(let t=0,n=r.length;t<n;t++)this.expandByObject(r[t],e);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,Mn),Mn.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(In),On.subVectors(this.max,In),Tn.subVectors(t.a,In),En.subVectors(t.b,In),An.subVectors(t.c,In),Pn.subVectors(En,Tn),Cn.subVectors(An,En),Ln.subVectors(Tn,An);let e=[0,-Pn.z,Pn.y,0,-Cn.z,Cn.y,0,-Ln.z,Ln.y,Pn.z,0,-Pn.x,Cn.z,0,-Cn.x,Ln.z,0,-Ln.x,-Pn.y,Pn.x,0,-Cn.y,Cn.x,0,-Ln.y,Ln.x,0];return!!Dn(e,Tn,En,An,On)&&(e=[1,0,0,0,1,0,0,0,1],!!Dn(e,Tn,En,An,On)&&(Nn.crossVectors(Pn,Cn),e=[Nn.x,Nn.y,Nn.z],Dn(e,Tn,En,An,On)))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return this.clampPoint(t,Mn).distanceTo(t)}getBoundingSphere(t){return this.isEmpty()?t.makeEmpty():(this.getCenter(t.center),t.radius=.5*this.getSize(Mn).length()),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()||(wn[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),wn[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),wn[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),wn[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),wn[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),wn[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),wn[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),wn[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(wn)),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}const wn=[new $e,new $e,new $e,new $e,new $e,new $e,new $e,new $e],Mn=new $e,Sn=new bn,Tn=new $e,En=new $e,An=new $e,Pn=new $e,Cn=new $e,Ln=new $e,In=new $e,On=new $e,Nn=new $e,Rn=new $e;function Dn(t,e,n,r,i){for(let o=0,a=t.length-3;o<=a;o+=3){Rn.fromArray(t,o);const a=i.x*Math.abs(Rn.x)+i.y*Math.abs(Rn.y)+i.z*Math.abs(Rn.z),s=e.dot(Rn),u=n.dot(Rn),l=r.dot(Rn);if(Math.max(-Math.max(s,u,l),Math.min(s,u,l))>a)return!1}return!0}const kn=new bn,Fn=new $e,Bn=new $e;class Un{constructor(t=new $e,e=-1){this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const n=this.center;void 0!==e?n.copy(e):kn.setFromPoints(t).getCenter(n);let r=0;for(let e=0,i=t.length;e<i;e++)r=Math.max(r,n.distanceToSquared(t[e]));return this.radius=Math.sqrt(r),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const n=this.center.distanceToSquared(t);return e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){if(this.isEmpty())return this.center.copy(t),this.radius=0,this;Fn.subVectors(t,this.center);const e=Fn.lengthSq();if(e>this.radius*this.radius){const t=Math.sqrt(e),n=.5*(t-this.radius);this.center.addScaledVector(Fn,n/t),this.radius+=n}return this}union(t){return t.isEmpty()?this:this.isEmpty()?(this.copy(t),this):(!0===this.center.equals(t.center)?this.radius=Math.max(this.radius,t.radius):(Bn.subVectors(t.center,this.center).setLength(t.radius),this.expandByPoint(Fn.copy(t.center).add(Bn)),this.expandByPoint(Fn.copy(t.center).sub(Bn))),this)}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const zn=new $e,Vn=new $e,Gn=new $e,jn=new $e,Wn=new $e,Hn=new $e,Xn=new $e;class Yn{constructor(t=new $e,e=new $e(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.origin).addScaledVector(this.direction,t)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,zn)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);const n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=zn.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(zn.copy(this.origin).addScaledVector(this.direction,e),zn.distanceToSquared(t))}distanceSqToSegment(t,e,n,r){Vn.copy(t).add(e).multiplyScalar(.5),Gn.copy(e).sub(t).normalize(),jn.copy(this.origin).sub(Vn);const i=.5*t.distanceTo(e),o=-this.direction.dot(Gn),a=jn.dot(this.direction),s=-jn.dot(Gn),u=jn.lengthSq(),l=Math.abs(1-o*o);let c,h,p,f;if(l>0)if(c=o*s-a,h=o*a-s,f=i*l,c>=0)if(h>=-f)if(h<=f){const t=1/l;c*=t,h*=t,p=c*(c+o*h+2*a)+h*(o*c+h+2*s)+u}else h=i,c=Math.max(0,-(o*h+a)),p=-c*c+h*(h+2*s)+u;else h=-i,c=Math.max(0,-(o*h+a)),p=-c*c+h*(h+2*s)+u;else h<=-f?(c=Math.max(0,-(-o*i+a)),h=c>0?-i:Math.min(Math.max(-i,-s),i),p=-c*c+h*(h+2*s)+u):h<=f?(c=0,h=Math.min(Math.max(-i,-s),i),p=h*(h+2*s)+u):(c=Math.max(0,-(o*i+a)),h=c>0?i:Math.min(Math.max(-i,-s),i),p=-c*c+h*(h+2*s)+u);else h=o>0?-i:i,c=Math.max(0,-(o*h+a)),p=-c*c+h*(h+2*s)+u;return n&&n.copy(this.origin).addScaledVector(this.direction,c),r&&r.copy(Vn).addScaledVector(Gn,h),p}intersectSphere(t,e){zn.subVectors(t.center,this.origin);const n=zn.dot(this.direction),r=zn.dot(zn)-n*n,i=t.radius*t.radius;if(r>i)return null;const o=Math.sqrt(i-r),a=n-o,s=n+o;return s<0?null:a<0?this.at(s,e):this.at(a,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null}intersectPlane(t,e){const n=this.distanceToPlane(t);return null===n?null:this.at(n,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);if(0===e)return!0;return t.normal.dot(this.direction)*e<0}intersectBox(t,e){let n,r,i,o,a,s;const u=1/this.direction.x,l=1/this.direction.y,c=1/this.direction.z,h=this.origin;return u>=0?(n=(t.min.x-h.x)*u,r=(t.max.x-h.x)*u):(n=(t.max.x-h.x)*u,r=(t.min.x-h.x)*u),l>=0?(i=(t.min.y-h.y)*l,o=(t.max.y-h.y)*l):(i=(t.max.y-h.y)*l,o=(t.min.y-h.y)*l),n>o||i>r?null:((i>n||isNaN(n))&&(n=i),(o<r||isNaN(r))&&(r=o),c>=0?(a=(t.min.z-h.z)*c,s=(t.max.z-h.z)*c):(a=(t.max.z-h.z)*c,s=(t.min.z-h.z)*c),n>s||a>r?null:((a>n||n!=n)&&(n=a),(s<r||r!=r)&&(r=s),r<0?null:this.at(n>=0?n:r,e)))}intersectsBox(t){return null!==this.intersectBox(t,zn)}intersectTriangle(t,e,n,r,i){Wn.subVectors(e,t),Hn.subVectors(n,t),Xn.crossVectors(Wn,Hn);let o,a=this.direction.dot(Xn);if(a>0){if(r)return null;o=1}else{if(!(a<0))return null;o=-1,a=-a}jn.subVectors(this.origin,t);const s=o*this.direction.dot(Hn.crossVectors(jn,Hn));if(s<0)return null;const u=o*this.direction.dot(Wn.cross(jn));if(u<0)return null;if(s+u>a)return null;const l=-o*jn.dot(Xn);return l<0?null:this.at(l/a,i)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class qn{constructor(){qn.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(t,e,n,r,i,o,a,s,u,l,c,h,p,f,d,m){const g=this.elements;return g[0]=t,g[4]=e,g[8]=n,g[12]=r,g[1]=i,g[5]=o,g[9]=a,g[13]=s,g[2]=u,g[6]=l,g[10]=c,g[14]=h,g[3]=p,g[7]=f,g[11]=d,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new qn).fromArray(this.elements)}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this}copyPosition(t){const e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,n=t.elements,r=1/Zn.setFromMatrixColumn(t,0).length(),i=1/Zn.setFromMatrixColumn(t,1).length(),o=1/Zn.setFromMatrixColumn(t,2).length();return e[0]=n[0]*r,e[1]=n[1]*r,e[2]=n[2]*r,e[3]=0,e[4]=n[4]*i,e[5]=n[5]*i,e[6]=n[6]*i,e[7]=0,e[8]=n[8]*o,e[9]=n[9]*o,e[10]=n[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){const e=this.elements,n=t.x,r=t.y,i=t.z,o=Math.cos(n),a=Math.sin(n),s=Math.cos(r),u=Math.sin(r),l=Math.cos(i),c=Math.sin(i);if("XYZ"===t.order){const t=o*l,n=o*c,r=a*l,i=a*c;e[0]=s*l,e[4]=-s*c,e[8]=u,e[1]=n+r*u,e[5]=t-i*u,e[9]=-a*s,e[2]=i-t*u,e[6]=r+n*u,e[10]=o*s}else if("YXZ"===t.order){const t=s*l,n=s*c,r=u*l,i=u*c;e[0]=t+i*a,e[4]=r*a-n,e[8]=o*u,e[1]=o*c,e[5]=o*l,e[9]=-a,e[2]=n*a-r,e[6]=i+t*a,e[10]=o*s}else if("ZXY"===t.order){const t=s*l,n=s*c,r=u*l,i=u*c;e[0]=t-i*a,e[4]=-o*c,e[8]=r+n*a,e[1]=n+r*a,e[5]=o*l,e[9]=i-t*a,e[2]=-o*u,e[6]=a,e[10]=o*s}else if("ZYX"===t.order){const t=o*l,n=o*c,r=a*l,i=a*c;e[0]=s*l,e[4]=r*u-n,e[8]=t*u+i,e[1]=s*c,e[5]=i*u+t,e[9]=n*u-r,e[2]=-u,e[6]=a*s,e[10]=o*s}else if("YZX"===t.order){const t=o*s,n=o*u,r=a*s,i=a*u;e[0]=s*l,e[4]=i-t*c,e[8]=r*c+n,e[1]=c,e[5]=o*l,e[9]=-a*l,e[2]=-u*l,e[6]=n*c+r,e[10]=t-i*c}else if("XZY"===t.order){const t=o*s,n=o*u,r=a*s,i=a*u;e[0]=s*l,e[4]=-c,e[8]=u*l,e[1]=t*c+i,e[5]=o*l,e[9]=n*c-r,e[2]=r*c-n,e[6]=a*l,e[10]=i*c+t}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(Kn,t,Qn)}lookAt(t,e,n){const r=this.elements;return er.subVectors(t,e),0===er.lengthSq()&&(er.z=1),er.normalize(),$n.crossVectors(n,er),0===$n.lengthSq()&&(1===Math.abs(n.z)?er.x+=1e-4:er.z+=1e-4,er.normalize(),$n.crossVectors(n,er)),$n.normalize(),tr.crossVectors(er,$n),r[0]=$n.x,r[4]=tr.x,r[8]=er.x,r[1]=$n.y,r[5]=tr.y,r[9]=er.y,r[2]=$n.z,r[6]=tr.z,r[10]=er.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,r=e.elements,i=this.elements,o=n[0],a=n[4],s=n[8],u=n[12],l=n[1],c=n[5],h=n[9],p=n[13],f=n[2],d=n[6],m=n[10],g=n[14],v=n[3],y=n[7],x=n[11],_=n[15],b=r[0],w=r[4],M=r[8],S=r[12],T=r[1],E=r[5],A=r[9],P=r[13],C=r[2],L=r[6],I=r[10],O=r[14],N=r[3],R=r[7],D=r[11],k=r[15];return i[0]=o*b+a*T+s*C+u*N,i[4]=o*w+a*E+s*L+u*R,i[8]=o*M+a*A+s*I+u*D,i[12]=o*S+a*P+s*O+u*k,i[1]=l*b+c*T+h*C+p*N,i[5]=l*w+c*E+h*L+p*R,i[9]=l*M+c*A+h*I+p*D,i[13]=l*S+c*P+h*O+p*k,i[2]=f*b+d*T+m*C+g*N,i[6]=f*w+d*E+m*L+g*R,i[10]=f*M+d*A+m*I+g*D,i[14]=f*S+d*P+m*O+g*k,i[3]=v*b+y*T+x*C+_*N,i[7]=v*w+y*E+x*L+_*R,i[11]=v*M+y*A+x*I+_*D,i[15]=v*S+y*P+x*O+_*k,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[4],r=t[8],i=t[12],o=t[1],a=t[5],s=t[9],u=t[13],l=t[2],c=t[6],h=t[10],p=t[14];return t[3]*(+i*s*c-r*u*c-i*a*h+n*u*h+r*a*p-n*s*p)+t[7]*(+e*s*p-e*u*h+i*o*h-r*o*p+r*u*l-i*s*l)+t[11]*(+e*u*c-e*a*p-i*o*c+n*o*p+i*a*l-n*u*l)+t[15]*(-r*a*l-e*s*c+e*a*h+r*o*c-n*o*h+n*s*l)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,n){const r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=e,r[14]=n),this}invert(){const t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],l=t[8],c=t[9],h=t[10],p=t[11],f=t[12],d=t[13],m=t[14],g=t[15],v=c*m*u-d*h*u+d*s*p-a*m*p-c*s*g+a*h*g,y=f*h*u-l*m*u-f*s*p+o*m*p+l*s*g-o*h*g,x=l*d*u-f*c*u+f*a*p-o*d*p-l*a*g+o*c*g,_=f*c*s-l*d*s-f*a*h+o*d*h+l*a*m-o*c*m,b=e*v+n*y+r*x+i*_;if(0===b)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const w=1/b;return t[0]=v*w,t[1]=(d*h*i-c*m*i-d*r*p+n*m*p+c*r*g-n*h*g)*w,t[2]=(a*m*i-d*s*i+d*r*u-n*m*u-a*r*g+n*s*g)*w,t[3]=(c*s*i-a*h*i-c*r*u+n*h*u+a*r*p-n*s*p)*w,t[4]=y*w,t[5]=(l*m*i-f*h*i+f*r*p-e*m*p-l*r*g+e*h*g)*w,t[6]=(f*s*i-o*m*i-f*r*u+e*m*u+o*r*g-e*s*g)*w,t[7]=(o*h*i-l*s*i+l*r*u-e*h*u-o*r*p+e*s*p)*w,t[8]=x*w,t[9]=(f*c*i-l*d*i-f*n*p+e*d*p+l*n*g-e*c*g)*w,t[10]=(o*d*i-f*a*i+f*n*u-e*d*u-o*n*g+e*a*g)*w,t[11]=(l*a*i-o*c*i-l*n*u+e*c*u+o*n*p-e*a*p)*w,t[12]=_*w,t[13]=(l*d*r-f*c*r+f*n*h-e*d*h-l*n*m+e*c*m)*w,t[14]=(f*a*r-o*d*r-f*n*s+e*d*s+o*n*m-e*a*m)*w,t[15]=(o*c*r-l*a*r+l*n*s-e*c*s-o*n*h+e*a*h)*w,this}scale(t){const e=this.elements,n=t.x,r=t.y,i=t.z;return e[0]*=n,e[4]*=r,e[8]*=i,e[1]*=n,e[5]*=r,e[9]*=i,e[2]*=n,e[6]*=r,e[10]*=i,e[3]*=n,e[7]*=r,e[11]*=i,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,r))}makeTranslation(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const n=Math.cos(e),r=Math.sin(e),i=1-n,o=t.x,a=t.y,s=t.z,u=i*o,l=i*a;return this.set(u*o+n,u*a-r*s,u*s+r*a,0,u*a+r*s,l*a+n,l*s-r*o,0,u*s-r*a,l*s+r*o,i*s*s+n,0,0,0,0,1),this}makeScale(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this}makeShear(t,e,n,r,i,o){return this.set(1,n,i,0,t,1,o,0,e,r,1,0,0,0,0,1),this}compose(t,e,n){const r=this.elements,i=e._x,o=e._y,a=e._z,s=e._w,u=i+i,l=o+o,c=a+a,h=i*u,p=i*l,f=i*c,d=o*l,m=o*c,g=a*c,v=s*u,y=s*l,x=s*c,_=n.x,b=n.y,w=n.z;return r[0]=(1-(d+g))*_,r[1]=(p+x)*_,r[2]=(f-y)*_,r[3]=0,r[4]=(p-x)*b,r[5]=(1-(h+g))*b,r[6]=(m+v)*b,r[7]=0,r[8]=(f+y)*w,r[9]=(m-v)*w,r[10]=(1-(h+d))*w,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this}decompose(t,e,n){const r=this.elements;let i=Zn.set(r[0],r[1],r[2]).length();const o=Zn.set(r[4],r[5],r[6]).length(),a=Zn.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),t.x=r[12],t.y=r[13],t.z=r[14],Jn.copy(this);const s=1/i,u=1/o,l=1/a;return Jn.elements[0]*=s,Jn.elements[1]*=s,Jn.elements[2]*=s,Jn.elements[4]*=u,Jn.elements[5]*=u,Jn.elements[6]*=u,Jn.elements[8]*=l,Jn.elements[9]*=l,Jn.elements[10]*=l,e.setFromRotationMatrix(Jn),n.x=i,n.y=o,n.z=a,this}makePerspective(t,e,n,r,i,o){const a=this.elements,s=2*i/(e-t),u=2*i/(n-r),l=(e+t)/(e-t),c=(n+r)/(n-r),h=-(o+i)/(o-i),p=-2*o*i/(o-i);return a[0]=s,a[4]=0,a[8]=l,a[12]=0,a[1]=0,a[5]=u,a[9]=c,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=p,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(t,e,n,r,i,o){const a=this.elements,s=1/(e-t),u=1/(n-r),l=1/(o-i),c=(e+t)*s,h=(n+r)*u,p=(o+i)*l;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-c,a[1]=0,a[5]=2*u,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*l,a[14]=-p,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(t){const e=this.elements,n=t.elements;for(let t=0;t<16;t++)if(e[t]!==n[t])return!1;return!0}fromArray(t,e=0){for(let n=0;n<16;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}const Zn=new $e,Jn=new qn,Kn=new $e(0,0,0),Qn=new $e(1,1,1),$n=new $e,tr=new $e,er=new $e,nr=new qn,rr=new Qe;class ir{constructor(t=0,e=0,n=0,r=ir.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=e,this._z=n,this._order=r}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,n,r=this._order){return this._x=t,this._y=e,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,n=!0){const r=t.elements,i=r[0],o=r[4],a=r[8],s=r[1],u=r[5],l=r[9],c=r[2],h=r[6],p=r[10];switch(e){case"XYZ":this._y=Math.asin(ke(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-l,p),this._z=Math.atan2(-o,i)):(this._x=Math.atan2(h,u),this._z=0);break;case"YXZ":this._x=Math.asin(-ke(l,-1,1)),Math.abs(l)<.9999999?(this._y=Math.atan2(a,p),this._z=Math.atan2(s,u)):(this._y=Math.atan2(-c,i),this._z=0);break;case"ZXY":this._x=Math.asin(ke(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-c,p),this._z=Math.atan2(-o,u)):(this._y=0,this._z=Math.atan2(s,i));break;case"ZYX":this._y=Math.asin(-ke(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(h,p),this._z=Math.atan2(s,i)):(this._x=0,this._z=Math.atan2(-o,u));break;case"YZX":this._z=Math.asin(ke(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-l,u),this._y=Math.atan2(-c,i)):(this._x=0,this._y=Math.atan2(a,p));break;case"XZY":this._z=Math.asin(-ke(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(h,u),this._y=Math.atan2(a,i)):(this._x=Math.atan2(-l,p),this._y=0)}return this._order=e,!0===n&&this._onChangeCallback(),this}setFromQuaternion(t,e,n){return nr.makeRotationFromQuaternion(t),this.setFromRotationMatrix(nr,e,n)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return rr.setFromEuler(this),this.setFromQuaternion(rr,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}ir.DEFAULT_ORDER="XYZ";class or{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return 0!=(this.mask&t.mask)}isEnabled(t){return 0!=(this.mask&(1<<t|0))}}let ar=0;const sr=new $e,ur=new Qe,lr=new qn,cr=new $e,hr=new $e,pr=new $e,fr=new Qe,dr=new $e(1,0,0),mr=new $e(0,1,0),gr=new $e(0,0,1),vr={type:"added"},yr={type:"removed"};class xr extends Le{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:ar++}),this.uuid=De(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=xr.DEFAULT_UP.clone();const t=new $e,e=new ir,n=new Qe,r=new $e(1,1,1);e._onChange((function(){n.setFromEuler(e,!1)})),n._onChange((function(){e.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new qn},normalMatrix:{value:new Xe}}),this.matrix=new qn,this.matrixWorld=new qn,this.matrixAutoUpdate=xr.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=xr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new or,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return ur.setFromAxisAngle(t,e),this.quaternion.multiply(ur),this}rotateOnWorldAxis(t,e){return ur.setFromAxisAngle(t,e),this.quaternion.premultiply(ur),this}rotateX(t){return this.rotateOnAxis(dr,t)}rotateY(t){return this.rotateOnAxis(mr,t)}rotateZ(t){return this.rotateOnAxis(gr,t)}translateOnAxis(t,e){return sr.copy(t).applyQuaternion(this.quaternion),this.position.add(sr.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(dr,t)}translateY(t){return this.translateOnAxis(mr,t)}translateZ(t){return this.translateOnAxis(gr,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(lr.copy(this.matrixWorld).invert())}lookAt(t,e,n){t.isVector3?cr.copy(t):cr.set(t,e,n);const r=this.parent;this.updateWorldMatrix(!0,!1),hr.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?lr.lookAt(hr,cr,this.up):lr.lookAt(cr,hr,this.up),this.quaternion.setFromRotationMatrix(lr),r&&(lr.extractRotation(r.matrixWorld),ur.setFromRotationMatrix(lr),this.quaternion.premultiply(ur.invert()))}add(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return t===this||t&&t.isObject3D&&(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(vr)),this}remove(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}const e=this.children.indexOf(t);return-1!==e&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(yr)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const e=this.children[t];e.parent=null,e.dispatchEvent(yr)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),lr.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),lr.multiply(t.parent.matrixWorld)),t.applyMatrix4(lr),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let n=0,r=this.children.length;n<r;n++){const r=this.children[n].getObjectByProperty(t,e);if(void 0!==r)return r}}getObjectsByProperty(t,e){let n=[];this[t]===e&&n.push(this);for(let r=0,i=this.children.length;r<i;r++){const i=this.children[r].getObjectsByProperty(t,e);i.length>0&&(n=n.concat(i))}return n}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(hr,t,pr),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(hr,fr,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].traverseVisible(t)}traverseAncestors(t){const e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let n=0,r=e.length;n<r;n++){const r=e[n];!0!==r.matrixWorldAutoUpdate&&!0!==t||r.updateMatrixWorld(t)}}updateWorldMatrix(t,e){const n=this.parent;if(!0===t&&null!==n&&!0===n.matrixWorldAutoUpdate&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e){const t=this.children;for(let e=0,n=t.length;e<n;e++){const n=t[e];!0===n.matrixWorldAutoUpdate&&n.updateWorldMatrix(!1,!0)}}}toJSON(t){const e=void 0===t||"string"==typeof t,n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const r={};function i(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(r.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=i(t.geometries,this.geometry);const e=this.geometry.parameters;if(void 0!==e&&void 0!==e.shapes){const n=e.shapes;if(Array.isArray(n))for(let e=0,r=n.length;e<r;e++){const r=n[e];i(t.shapes,r)}else i(t.shapes,n)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(i(t.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const e=[];for(let n=0,r=this.material.length;n<r;n++)e.push(i(t.materials,this.material[n]));r.material=e}else r.material=i(t.materials,this.material);if(this.children.length>0){r.children=[];for(let e=0;e<this.children.length;e++)r.children.push(this.children[e].toJSON(t).object)}if(this.animations.length>0){r.animations=[];for(let e=0;e<this.animations.length;e++){const n=this.animations[e];r.animations.push(i(t.animations,n))}}if(e){const e=o(t.geometries),r=o(t.materials),i=o(t.textures),a=o(t.images),s=o(t.shapes),u=o(t.skeletons),l=o(t.animations),c=o(t.nodes);e.length>0&&(n.geometries=e),r.length>0&&(n.materials=r),i.length>0&&(n.textures=i),a.length>0&&(n.images=a),s.length>0&&(n.shapes=s),u.length>0&&(n.skeletons=u),l.length>0&&(n.animations=l),c.length>0&&(n.nodes=c)}return n.object=r,n;function o(t){const e=[];for(const n in t){const r=t[n];delete r.metadata,e.push(r)}return e}}clone(t){return(new this.constructor).copy(this,t)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(let e=0;e<t.children.length;e++){const n=t.children[e];this.add(n.clone())}return this}}xr.DEFAULT_UP=new $e(0,1,0),xr.DEFAULT_MATRIX_AUTO_UPDATE=!0,xr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const _r=new $e,br=new $e,wr=new $e,Mr=new $e,Sr=new $e,Tr=new $e,Er=new $e,Ar=new $e,Pr=new $e,Cr=new $e;class Lr{constructor(t=new $e,e=new $e,n=new $e){this.a=t,this.b=e,this.c=n}static getNormal(t,e,n,r){r.subVectors(n,e),_r.subVectors(t,e),r.cross(_r);const i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}static getBarycoord(t,e,n,r,i){_r.subVectors(r,e),br.subVectors(n,e),wr.subVectors(t,e);const o=_r.dot(_r),a=_r.dot(br),s=_r.dot(wr),u=br.dot(br),l=br.dot(wr),c=o*u-a*a;if(0===c)return i.set(-2,-1,-1);const h=1/c,p=(u*s-a*l)*h,f=(o*l-a*s)*h;return i.set(1-p-f,f,p)}static containsPoint(t,e,n,r){return this.getBarycoord(t,e,n,r,Mr),Mr.x>=0&&Mr.y>=0&&Mr.x+Mr.y<=1}static getUV(t,e,n,r,i,o,a,s){return this.getBarycoord(t,e,n,r,Mr),s.set(0,0),s.addScaledVector(i,Mr.x),s.addScaledVector(o,Mr.y),s.addScaledVector(a,Mr.z),s}static isFrontFacing(t,e,n,r){return _r.subVectors(n,e),br.subVectors(t,e),_r.cross(br).dot(r)<0}set(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this}setFromPointsAndIndices(t,e,n,r){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[r]),this}setFromAttributeAndIndices(t,e,n,r){return this.a.fromBufferAttribute(t,e),this.b.fromBufferAttribute(t,n),this.c.fromBufferAttribute(t,r),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return _r.subVectors(this.c,this.b),br.subVectors(this.a,this.b),.5*_r.cross(br).length()}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return Lr.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return Lr.getBarycoord(t,this.a,this.b,this.c,e)}getUV(t,e,n,r,i){return Lr.getUV(t,this.a,this.b,this.c,e,n,r,i)}containsPoint(t){return Lr.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return Lr.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){const n=this.a,r=this.b,i=this.c;let o,a;Sr.subVectors(r,n),Tr.subVectors(i,n),Ar.subVectors(t,n);const s=Sr.dot(Ar),u=Tr.dot(Ar);if(s<=0&&u<=0)return e.copy(n);Pr.subVectors(t,r);const l=Sr.dot(Pr),c=Tr.dot(Pr);if(l>=0&&c<=l)return e.copy(r);const h=s*c-l*u;if(h<=0&&s>=0&&l<=0)return o=s/(s-l),e.copy(n).addScaledVector(Sr,o);Cr.subVectors(t,i);const p=Sr.dot(Cr),f=Tr.dot(Cr);if(f>=0&&p<=f)return e.copy(i);const d=p*u-s*f;if(d<=0&&u>=0&&f<=0)return a=u/(u-f),e.copy(n).addScaledVector(Tr,a);const m=l*f-p*c;if(m<=0&&c-l>=0&&p-f>=0)return Er.subVectors(i,r),a=(c-l)/(c-l+(p-f)),e.copy(r).addScaledVector(Er,a);const g=1/(m+d+h);return o=d*g,a=h*g,e.copy(n).addScaledVector(Sr,o).addScaledVector(Tr,a)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}let Ir=0;class Or extends Le{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Ir++}),this.uuid=De(),this.name="",this.type="Material",this.blending=f,this.side=l,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=A,this.blendDst=P,this.blendEquation=y,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=F,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Ee,this.stencilZFail=Ee,this.stencilZPass=Ee,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(void 0!==t)for(const e in t){const n=t[e];if(void 0===n)continue;const r=this[e];void 0!==r&&(r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[e]=n)}}toJSON(t){const e=void 0===t||"string"==typeof t;e&&(t={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(t){const e=[];for(const n in t){const r=t[n];delete r.metadata,e.push(r)}return e}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(t).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(t).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==f&&(n.blending=this.blending),this.side!==l&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.forceSinglePass&&(n.forceSinglePass=this.forceSinglePass),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),e){const e=r(t.textures),i=r(t.images);e.length>0&&(n.textures=e),i.length>0&&(n.images=i)}return n}clone(){return(new this.constructor).copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let n=null;if(null!==e){const t=e.length;n=new Array(t);for(let r=0;r!==t;++r)n[r]=e[r].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.forceSinglePass=t.forceSinglePass,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){!0===t&&this.version++}}const Nr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Rr={h:0,s:0,l:0},Dr={h:0,s:0,l:0};function kr(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}class Fr{constructor(t,e,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}set(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,e=Me){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,cn.toWorkingColorSpace(this,e),this}setRGB(t,e,n,r=cn.workingColorSpace){return this.r=t,this.g=e,this.b=n,cn.toWorkingColorSpace(this,r),this}setHSL(t,e,n,r=cn.workingColorSpace){if(t=Fe(t,1),e=ke(e,0,1),n=ke(n,0,1),0===e)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+e):n+e-n*e,i=2*n-r;this.r=kr(i,r,t+1/3),this.g=kr(i,r,t),this.b=kr(i,r,t-1/3)}return cn.toWorkingColorSpace(this,r),this}setStyle(t,e=Me){function n(t){void 0!==t&&parseFloat(t)}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(t)){let t;const i=r[1],o=r[2];switch(i){case"rgb":case"rgba":if(t=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(t[1],10))/255,this.g=Math.min(255,parseInt(t[2],10))/255,this.b=Math.min(255,parseInt(t[3],10))/255,cn.toWorkingColorSpace(this,e),n(t[4]),this;if(t=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(t[1],10))/100,this.g=Math.min(100,parseInt(t[2],10))/100,this.b=Math.min(100,parseInt(t[3],10))/100,cn.toWorkingColorSpace(this,e),n(t[4]),this;break;case"hsl":case"hsla":if(t=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o)){const r=parseFloat(t[1])/360,i=parseFloat(t[2])/100,o=parseFloat(t[3])/100;return n(t[4]),this.setHSL(r,i,o,e)}}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(t)){const t=r[1],n=t.length;if(3===n)return this.r=parseInt(t.charAt(0)+t.charAt(0),16)/255,this.g=parseInt(t.charAt(1)+t.charAt(1),16)/255,this.b=parseInt(t.charAt(2)+t.charAt(2),16)/255,cn.toWorkingColorSpace(this,e),this;if(6===n)return this.r=parseInt(t.charAt(0)+t.charAt(1),16)/255,this.g=parseInt(t.charAt(2)+t.charAt(3),16)/255,this.b=parseInt(t.charAt(4)+t.charAt(5),16)/255,cn.toWorkingColorSpace(this,e),this}else if(t&&t.length>0)return this.setColorName(t,e);return this}setColorName(t,e=Me){const n=Nr[t.toLowerCase()];return void 0!==n&&this.setHex(n,e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=nn(t.r),this.g=nn(t.g),this.b=nn(t.b),this}copyLinearToSRGB(t){return this.r=rn(t.r),this.g=rn(t.g),this.b=rn(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=Me){return cn.fromWorkingColorSpace(Br.copy(this),t),ke(255*Br.r,0,255)<<16^ke(255*Br.g,0,255)<<8^ke(255*Br.b,0,255)<<0}getHexString(t=Me){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,e=cn.workingColorSpace){cn.fromWorkingColorSpace(Br.copy(this),e);const n=Br.r,r=Br.g,i=Br.b,o=Math.max(n,r,i),a=Math.min(n,r,i);let s,u;const l=(a+o)/2;if(a===o)s=0,u=0;else{const t=o-a;switch(u=l<=.5?t/(o+a):t/(2-o-a),o){case n:s=(r-i)/t+(r<i?6:0);break;case r:s=(i-n)/t+2;break;case i:s=(n-r)/t+4}s/=6}return t.h=s,t.s=u,t.l=l,t}getRGB(t,e=cn.workingColorSpace){return cn.fromWorkingColorSpace(Br.copy(this),e),t.r=Br.r,t.g=Br.g,t.b=Br.b,t}getStyle(t=Me){cn.fromWorkingColorSpace(Br.copy(this),t);const e=Br.r,n=Br.g,r=Br.b;return t!==Me?`color(${t} ${e.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${255*e|0},${255*n|0},${255*r|0})`}offsetHSL(t,e,n){return this.getHSL(Rr),Rr.h+=t,Rr.s+=e,Rr.l+=n,this.setHSL(Rr.h,Rr.s,Rr.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,n){return this.r=t.r+(e.r-t.r)*n,this.g=t.g+(e.g-t.g)*n,this.b=t.b+(e.b-t.b)*n,this}lerpHSL(t,e){this.getHSL(Rr),t.getHSL(Dr);const n=Be(Rr.h,Dr.h,e),r=Be(Rr.s,Dr.s,e),i=Be(Rr.l,Dr.l,e);return this.setHSL(n,r,i),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Br=new Fr;Fr.NAMES=Nr;class Ur extends Or{constructor(t){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Fr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=G,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}const zr=new $e,Vr=new He;class Gr{constructor(t,e,n=!1){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=n,this.usage=Ae,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this}copyAt(t,e,n){t*=this.itemSize,n*=e.itemSize;for(let r=0,i=this.itemSize;r<i;r++)this.array[t+r]=e.array[n+r];return this}copyArray(t){return this.array.set(t),this}applyMatrix3(t){if(2===this.itemSize)for(let e=0,n=this.count;e<n;e++)Vr.fromBufferAttribute(this,e),Vr.applyMatrix3(t),this.setXY(e,Vr.x,Vr.y);else if(3===this.itemSize)for(let e=0,n=this.count;e<n;e++)zr.fromBufferAttribute(this,e),zr.applyMatrix3(t),this.setXYZ(e,zr.x,zr.y,zr.z);return this}applyMatrix4(t){for(let e=0,n=this.count;e<n;e++)zr.fromBufferAttribute(this,e),zr.applyMatrix4(t),this.setXYZ(e,zr.x,zr.y,zr.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)zr.fromBufferAttribute(this,e),zr.applyNormalMatrix(t),this.setXYZ(e,zr.x,zr.y,zr.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)zr.fromBufferAttribute(this,e),zr.transformDirection(t),this.setXYZ(e,zr.x,zr.y,zr.z);return this}set(t,e=0){return this.array.set(t,e),this}getX(t){let e=this.array[t*this.itemSize];return this.normalized&&(e=Ge(e,this.array)),e}setX(t,e){return this.normalized&&(e=je(e,this.array)),this.array[t*this.itemSize]=e,this}getY(t){let e=this.array[t*this.itemSize+1];return this.normalized&&(e=Ge(e,this.array)),e}setY(t,e){return this.normalized&&(e=je(e,this.array)),this.array[t*this.itemSize+1]=e,this}getZ(t){let e=this.array[t*this.itemSize+2];return this.normalized&&(e=Ge(e,this.array)),e}setZ(t,e){return this.normalized&&(e=je(e,this.array)),this.array[t*this.itemSize+2]=e,this}getW(t){let e=this.array[t*this.itemSize+3];return this.normalized&&(e=Ge(e,this.array)),e}setW(t,e){return this.normalized&&(e=je(e,this.array)),this.array[t*this.itemSize+3]=e,this}setXY(t,e,n){return t*=this.itemSize,this.normalized&&(e=je(e,this.array),n=je(n,this.array)),this.array[t+0]=e,this.array[t+1]=n,this}setXYZ(t,e,n,r){return t*=this.itemSize,this.normalized&&(e=je(e,this.array),n=je(n,this.array),r=je(r,this.array)),this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this}setXYZW(t,e,n,r,i){return t*=this.itemSize,this.normalized&&(e=je(e,this.array),n=je(n,this.array),r=je(r,this.array),i=je(i,this.array)),this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this.array[t+3]=i,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(t.name=this.name),this.usage!==Ae&&(t.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(t.updateRange=this.updateRange),t}copyColorsArray(){}copyVector2sArray(){}copyVector3sArray(){}copyVector4sArray(){}}class jr extends Gr{constructor(t,e,n){super(new Uint16Array(t),e,n)}}class Wr extends Gr{constructor(t,e,n){super(new Uint32Array(t),e,n)}}class Hr extends Gr{constructor(t,e,n){super(new Float32Array(t),e,n)}}let Xr=0;const Yr=new qn,qr=new xr,Zr=new $e,Jr=new bn,Kr=new bn,Qr=new $e;class $r extends Le{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Xr++}),this.uuid=De(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(qe(t)?Wr:jr)(t,1):this.index=t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return void 0!==this.attributes[t]}addGroup(t,e,n=0){this.groups.push({start:t,count:e,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){const e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const e=(new Xe).getNormalMatrix(t);n.applyNormalMatrix(e),n.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(t),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(t){return Yr.makeRotationFromQuaternion(t),this.applyMatrix4(Yr),this}rotateX(t){return Yr.makeRotationX(t),this.applyMatrix4(Yr),this}rotateY(t){return Yr.makeRotationY(t),this.applyMatrix4(Yr),this}rotateZ(t){return Yr.makeRotationZ(t),this.applyMatrix4(Yr),this}translate(t,e,n){return Yr.makeTranslation(t,e,n),this.applyMatrix4(Yr),this}scale(t,e,n){return Yr.makeScale(t,e,n),this.applyMatrix4(Yr),this}lookAt(t){return qr.lookAt(t),qr.updateMatrix(),this.applyMatrix4(qr.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Zr).negate(),this.translate(Zr.x,Zr.y,Zr.z),this}setFromPoints(t){const e=[];for(let n=0,r=t.length;n<r;n++){const r=t[n];e.push(r.x,r.y,r.z||0)}return this.setAttribute("position",new Hr(e,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new bn);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)this.boundingBox.set(new $e(-1/0,-1/0,-1/0),new $e(1/0,1/0,1/0));else{if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(let t=0,n=e.length;t<n;t++){const n=e[t];Jr.setFromBufferAttribute(n),this.morphTargetsRelative?(Qr.addVectors(this.boundingBox.min,Jr.min),this.boundingBox.expandByPoint(Qr),Qr.addVectors(this.boundingBox.max,Jr.max),this.boundingBox.expandByPoint(Qr)):(this.boundingBox.expandByPoint(Jr.min),this.boundingBox.expandByPoint(Jr.max))}}else this.boundingBox.makeEmpty();isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z)}}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Un);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)this.boundingSphere.set(new $e,1/0);else if(t){const n=this.boundingSphere.center;if(Jr.setFromBufferAttribute(t),e)for(let t=0,n=e.length;t<n;t++){const n=e[t];Kr.setFromBufferAttribute(n),this.morphTargetsRelative?(Qr.addVectors(Jr.min,Kr.min),Jr.expandByPoint(Qr),Qr.addVectors(Jr.max,Kr.max),Jr.expandByPoint(Qr)):(Jr.expandByPoint(Kr.min),Jr.expandByPoint(Kr.max))}Jr.getCenter(n);let r=0;for(let e=0,i=t.count;e<i;e++)Qr.fromBufferAttribute(t,e),r=Math.max(r,n.distanceToSquared(Qr));if(e)for(let i=0,o=e.length;i<o;i++){const o=e[i],a=this.morphTargetsRelative;for(let e=0,i=o.count;e<i;e++)Qr.fromBufferAttribute(o,e),a&&(Zr.fromBufferAttribute(t,e),Qr.add(Zr)),r=Math.max(r,n.distanceToSquared(Qr))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)}}computeTangents(){const t=this.index,e=this.attributes;if(null===t||void 0===e.position||void 0===e.normal||void 0===e.uv)return;const n=t.array,r=e.position.array,i=e.normal.array,o=e.uv.array,a=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Gr(new Float32Array(4*a),4));const s=this.getAttribute("tangent").array,u=[],l=[];for(let t=0;t<a;t++)u[t]=new $e,l[t]=new $e;const c=new $e,h=new $e,p=new $e,f=new He,d=new He,m=new He,g=new $e,v=new $e;function y(t,e,n){c.fromArray(r,3*t),h.fromArray(r,3*e),p.fromArray(r,3*n),f.fromArray(o,2*t),d.fromArray(o,2*e),m.fromArray(o,2*n),h.sub(c),p.sub(c),d.sub(f),m.sub(f);const i=1/(d.x*m.y-m.x*d.y);isFinite(i)&&(g.copy(h).multiplyScalar(m.y).addScaledVector(p,-d.y).multiplyScalar(i),v.copy(p).multiplyScalar(d.x).addScaledVector(h,-m.x).multiplyScalar(i),u[t].add(g),u[e].add(g),u[n].add(g),l[t].add(v),l[e].add(v),l[n].add(v))}let x=this.groups;0===x.length&&(x=[{start:0,count:n.length}]);for(let t=0,e=x.length;t<e;++t){const e=x[t],r=e.start;for(let t=r,i=r+e.count;t<i;t+=3)y(n[t+0],n[t+1],n[t+2])}const _=new $e,b=new $e,w=new $e,M=new $e;function S(t){w.fromArray(i,3*t),M.copy(w);const e=u[t];_.copy(e),_.sub(w.multiplyScalar(w.dot(e))).normalize(),b.crossVectors(M,e);const n=b.dot(l[t])<0?-1:1;s[4*t]=_.x,s[4*t+1]=_.y,s[4*t+2]=_.z,s[4*t+3]=n}for(let t=0,e=x.length;t<e;++t){const e=x[t],r=e.start;for(let t=r,i=r+e.count;t<i;t+=3)S(n[t+0]),S(n[t+1]),S(n[t+2])}}computeVertexNormals(){const t=this.index,e=this.getAttribute("position");if(void 0!==e){let n=this.getAttribute("normal");if(void 0===n)n=new Gr(new Float32Array(3*e.count),3),this.setAttribute("normal",n);else for(let t=0,e=n.count;t<e;t++)n.setXYZ(t,0,0,0);const r=new $e,i=new $e,o=new $e,a=new $e,s=new $e,u=new $e,l=new $e,c=new $e;if(t)for(let h=0,p=t.count;h<p;h+=3){const p=t.getX(h+0),f=t.getX(h+1),d=t.getX(h+2);r.fromBufferAttribute(e,p),i.fromBufferAttribute(e,f),o.fromBufferAttribute(e,d),l.subVectors(o,i),c.subVectors(r,i),l.cross(c),a.fromBufferAttribute(n,p),s.fromBufferAttribute(n,f),u.fromBufferAttribute(n,d),a.add(l),s.add(l),u.add(l),n.setXYZ(p,a.x,a.y,a.z),n.setXYZ(f,s.x,s.y,s.z),n.setXYZ(d,u.x,u.y,u.z)}else for(let t=0,a=e.count;t<a;t+=3)r.fromBufferAttribute(e,t+0),i.fromBufferAttribute(e,t+1),o.fromBufferAttribute(e,t+2),l.subVectors(o,i),c.subVectors(r,i),l.cross(c),n.setXYZ(t+0,l.x,l.y,l.z),n.setXYZ(t+1,l.x,l.y,l.z),n.setXYZ(t+2,l.x,l.y,l.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(){return this}normalizeNormals(){const t=this.attributes.normal;for(let e=0,n=t.count;e<n;e++)Qr.fromBufferAttribute(t,e),Qr.normalize(),t.setXYZ(e,Qr.x,Qr.y,Qr.z)}toNonIndexed(){function t(t,e){const n=t.array,r=t.itemSize,i=t.normalized,o=new n.constructor(e.length*r);let a=0,s=0;for(let i=0,u=e.length;i<u;i++){a=t.isInterleavedBufferAttribute?e[i]*t.data.stride+t.offset:e[i]*r;for(let t=0;t<r;t++)o[s++]=n[a++]}return new Gr(o,r,i)}if(null===this.index)return this;const e=new $r,n=this.index.array,r=this.attributes;for(const i in r){const o=t(r[i],n);e.setAttribute(i,o)}const i=this.morphAttributes;for(const r in i){const o=[],a=i[r];for(let e=0,r=a.length;e<r;e++){const r=t(a[e],n);o.push(r)}e.morphAttributes[r]=o}e.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let t=0,n=o.length;t<n;t++){const n=o[t];e.addGroup(n.start,n.count,n.materialIndex)}return e}toJSON(){const t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){const e=this.parameters;for(const n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};const e=this.index;null!==e&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const n=this.attributes;for(const e in n){const r=n[e];t.data.attributes[e]=r.toJSON(t.data)}const r={};let i=!1;for(const e in this.morphAttributes){const n=this.morphAttributes[e],o=[];for(let e=0,r=n.length;e<r;e++){const r=n[e];o.push(r.toJSON(t.data))}o.length>0&&(r[e]=o,i=!0)}i&&(t.data.morphAttributes=r,t.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(t.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return null!==a&&(t.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),t}clone(){return(new this.constructor).copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const n=t.index;null!==n&&this.setIndex(n.clone(e));const r=t.attributes;for(const t in r){const n=r[t];this.setAttribute(t,n.clone(e))}const i=t.morphAttributes;for(const t in i){const n=[],r=i[t];for(let t=0,i=r.length;t<i;t++)n.push(r[t].clone(e));this.morphAttributes[t]=n}this.morphTargetsRelative=t.morphTargetsRelative;const o=t.groups;for(let t=0,e=o.length;t<e;t++){const e=o[t];this.addGroup(e.start,e.count,e.materialIndex)}const a=t.boundingBox;null!==a&&(this.boundingBox=a.clone());const s=t.boundingSphere;return null!==s&&(this.boundingSphere=s.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const ti=new qn,ei=new Yn,ni=new Un,ri=new $e,ii=new $e,oi=new $e,ai=new $e,si=new $e,ui=new $e,li=new He,ci=new He,hi=new He,pi=new $e,fi=new $e;class di extends xr{constructor(t=new $r,e=new Ur){super(),this.isMesh=!0,this.type="Mesh",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){const n=t[e[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,e=n.length;t<e;t++){const e=n[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[e]=t}}}}getVertexPosition(t,e){const n=this.geometry,r=n.attributes.position,i=n.morphAttributes.position,o=n.morphTargetsRelative;e.fromBufferAttribute(r,t);const a=this.morphTargetInfluences;if(i&&a){ui.set(0,0,0);for(let n=0,r=i.length;n<r;n++){const r=a[n],s=i[n];0!==r&&(si.fromBufferAttribute(s,t),o?ui.addScaledVector(si,r):ui.addScaledVector(si.sub(e),r))}e.add(ui)}return this.isSkinnedMesh&&this.boneTransform(t,e),e}raycast(t,e){const n=this.geometry,r=this.material,i=this.matrixWorld;if(void 0===r)return;if(null===n.boundingSphere&&n.computeBoundingSphere(),ni.copy(n.boundingSphere),ni.applyMatrix4(i),ei.copy(t.ray).recast(t.near),!1===ni.containsPoint(ei.origin)){if(null===ei.intersectSphere(ni,ri))return;if(ei.origin.distanceToSquared(ri)>(t.far-t.near)**2)return}if(ti.copy(i).invert(),ei.copy(t.ray).applyMatrix4(ti),null!==n.boundingBox&&!1===ei.intersectsBox(n.boundingBox))return;let o;const a=n.index,s=n.attributes.position,u=n.attributes.uv,l=n.attributes.uv2,c=n.groups,h=n.drawRange;if(null!==a)if(Array.isArray(r))for(let n=0,i=c.length;n<i;n++){const i=c[n],s=r[i.materialIndex];for(let n=Math.max(i.start,h.start),r=Math.min(a.count,Math.min(i.start+i.count,h.start+h.count));n<r;n+=3){const r=a.getX(n),c=a.getX(n+1),h=a.getX(n+2);o=mi(this,s,t,ei,u,l,r,c,h),o&&(o.faceIndex=Math.floor(n/3),o.face.materialIndex=i.materialIndex,e.push(o))}}else{for(let n=Math.max(0,h.start),i=Math.min(a.count,h.start+h.count);n<i;n+=3){const i=a.getX(n),s=a.getX(n+1),c=a.getX(n+2);o=mi(this,r,t,ei,u,l,i,s,c),o&&(o.faceIndex=Math.floor(n/3),e.push(o))}}else if(void 0!==s)if(Array.isArray(r))for(let n=0,i=c.length;n<i;n++){const i=c[n],a=r[i.materialIndex];for(let n=Math.max(i.start,h.start),r=Math.min(s.count,Math.min(i.start+i.count,h.start+h.count));n<r;n+=3){o=mi(this,a,t,ei,u,l,n,n+1,n+2),o&&(o.faceIndex=Math.floor(n/3),o.face.materialIndex=i.materialIndex,e.push(o))}}else{for(let n=Math.max(0,h.start),i=Math.min(s.count,h.start+h.count);n<i;n+=3){o=mi(this,r,t,ei,u,l,n,n+1,n+2),o&&(o.faceIndex=Math.floor(n/3),e.push(o))}}}}function mi(t,e,n,r,i,o,a,s,u){t.getVertexPosition(a,ii),t.getVertexPosition(s,oi),t.getVertexPosition(u,ai);const h=function(t,e,n,r,i,o,a,s){let u;if(u=e.side===c?r.intersectTriangle(a,o,i,!0,s):r.intersectTriangle(i,o,a,e.side===l,s),null===u)return null;fi.copy(s),fi.applyMatrix4(t.matrixWorld);const h=n.ray.origin.distanceTo(fi);return h<n.near||h>n.far?null:{distance:h,point:fi.clone(),object:t}}(t,e,n,r,ii,oi,ai,pi);if(h){i&&(li.fromBufferAttribute(i,a),ci.fromBufferAttribute(i,s),hi.fromBufferAttribute(i,u),h.uv=Lr.getUV(pi,ii,oi,ai,li,ci,hi,new He)),o&&(li.fromBufferAttribute(o,a),ci.fromBufferAttribute(o,s),hi.fromBufferAttribute(o,u),h.uv2=Lr.getUV(pi,ii,oi,ai,li,ci,hi,new He));const t={a:a,b:s,c:u,normal:new $e,materialIndex:0};Lr.getNormal(ii,oi,ai,t.normal),h.face=t}return h}class gi extends $r{constructor(t=1,e=1,n=1,r=1,i=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:i,depthSegments:o};const a=this;r=Math.floor(r),i=Math.floor(i),o=Math.floor(o);const s=[],u=[],l=[],c=[];let h=0,p=0;function f(t,e,n,r,i,o,f,d,m,g,v){const y=o/m,x=f/g,_=o/2,b=f/2,w=d/2,M=m+1,S=g+1;let T=0,E=0;const A=new $e;for(let o=0;o<S;o++){const a=o*x-b;for(let s=0;s<M;s++){const h=s*y-_;A[t]=h*r,A[e]=a*i,A[n]=w,u.push(A.x,A.y,A.z),A[t]=0,A[e]=0,A[n]=d>0?1:-1,l.push(A.x,A.y,A.z),c.push(s/m),c.push(1-o/g),T+=1}}for(let t=0;t<g;t++)for(let e=0;e<m;e++){const n=h+e+M*t,r=h+e+M*(t+1),i=h+(e+1)+M*(t+1),o=h+(e+1)+M*t;s.push(n,r,o),s.push(r,i,o),E+=6}a.addGroup(p,E,v),p+=E,h+=T}f("z","y","x",-1,-1,n,e,t,o,i,0),f("z","y","x",1,-1,n,e,-t,o,i,1),f("x","z","y",1,1,t,n,e,r,o,2),f("x","z","y",1,-1,t,n,-e,r,o,3),f("x","y","z",1,-1,t,e,n,r,i,4),f("x","y","z",-1,-1,t,e,-n,r,i,5),this.setIndex(s),this.setAttribute("position",new Hr(u,3)),this.setAttribute("normal",new Hr(l,3)),this.setAttribute("uv",new Hr(c,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new gi(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}}function vi(t){const e={};for(const n in t){e[n]={};for(const r in t[n]){const i=t[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?e[n][r]=i.clone():Array.isArray(i)?e[n][r]=i.slice():e[n][r]=i}}return e}function yi(t){const e={};for(let n=0;n<t.length;n++){const r=vi(t[n]);for(const t in r)e[t]=r[t]}return e}function xi(t){return null===t.getRenderTarget()&&t.outputEncoding===xe?Me:Se}const _i={clone:vi,merge:yi};class bi extends Or{constructor(t){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==t&&this.setValues(t)}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=vi(t.uniforms),this.uniformsGroups=function(t){const e=[];for(let n=0;n<t.length;n++)e.push(t[n].clone());return e}(t.uniformsGroups),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.fog=t.fog,this.lights=t.lights,this.clipping=t.clipping,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){const e=super.toJSON(t);e.glslVersion=this.glslVersion,e.uniforms={};for(const n in this.uniforms){const r=this.uniforms[n].value;r&&r.isTexture?e.uniforms[n]={type:"t",value:r.toJSON(t).uuid}:r&&r.isColor?e.uniforms[n]={type:"c",value:r.getHex()}:r&&r.isVector2?e.uniforms[n]={type:"v2",value:r.toArray()}:r&&r.isVector3?e.uniforms[n]={type:"v3",value:r.toArray()}:r&&r.isVector4?e.uniforms[n]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?e.uniforms[n]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?e.uniforms[n]={type:"m4",value:r.toArray()}:e.uniforms[n]={value:r}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;const n={};for(const t in this.extensions)!0===this.extensions[t]&&(n[t]=!0);return Object.keys(n).length>0&&(e.extensions=n),e}}class wi extends xr{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new qn,this.projectionMatrix=new qn,this.projectionMatrixInverse=new qn}copy(t,e){return super.copy(t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class Mi extends wi{constructor(t=50,e=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){const e=.5*this.getFilmHeight()/t;this.fov=2*Re*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan(.5*Ne*this.fov);return.5*this.getFilmHeight()/t}getEffectiveFOV(){return 2*Re*Math.atan(Math.tan(.5*Ne*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(t,e,n,r,i,o){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=this.near;let e=t*Math.tan(.5*Ne*this.fov)/this.zoom,n=2*e,r=this.aspect*n,i=-.5*r;const o=this.view;if(null!==this.view&&this.view.enabled){const t=o.fullWidth,a=o.fullHeight;i+=o.offsetX*r/t,e-=o.offsetY*n/a,r*=o.width/t,n*=o.height/a}const a=this.filmOffset;0!==a&&(i+=t*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,e,e-n,t,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}const Si=-90;class Ti extends xr{constructor(t,e,n){super(),this.type="CubeCamera",this.renderTarget=n;const r=new Mi(Si,1,t,e);r.layers=this.layers,r.up.set(0,1,0),r.lookAt(1,0,0),this.add(r);const i=new Mi(Si,1,t,e);i.layers=this.layers,i.up.set(0,1,0),i.lookAt(-1,0,0),this.add(i);const o=new Mi(Si,1,t,e);o.layers=this.layers,o.up.set(0,0,-1),o.lookAt(0,1,0),this.add(o);const a=new Mi(Si,1,t,e);a.layers=this.layers,a.up.set(0,0,1),a.lookAt(0,-1,0),this.add(a);const s=new Mi(Si,1,t,e);s.layers=this.layers,s.up.set(0,1,0),s.lookAt(0,0,1),this.add(s);const u=new Mi(Si,1,t,e);u.layers=this.layers,u.up.set(0,1,0),u.lookAt(0,0,-1),this.add(u)}update(t,e){null===this.parent&&this.updateMatrixWorld();const n=this.renderTarget,[r,i,o,a,s,u]=this.children,l=t.getRenderTarget(),c=t.toneMapping,h=t.xr.enabled;t.toneMapping=H,t.xr.enabled=!1;const p=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,t.setRenderTarget(n,0),t.render(e,r),t.setRenderTarget(n,1),t.render(e,i),t.setRenderTarget(n,2),t.render(e,o),t.setRenderTarget(n,3),t.render(e,a),t.setRenderTarget(n,4),t.render(e,s),n.texture.generateMipmaps=p,t.setRenderTarget(n,5),t.render(e,u),t.setRenderTarget(l),t.toneMapping=c,t.xr.enabled=h,n.texture.needsPMREMUpdate=!0}}class Ei extends gn{constructor(t,e,n,r,i,o,a,s,u,l){super(t=void 0!==t?t:[],e=void 0!==e?e:Q,n,r,i,o,a,s,u,l),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(t){this.image=t}}class Ai extends yn{constructor(t=1,e={}){super(t,t,e),this.isWebGLCubeRenderTarget=!0;const n={width:t,height:t,depth:1},r=[n,n,n,n,n,n];this.texture=new Ei(r,e.mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==e.generateMipmaps&&e.generateMipmaps,this.texture.minFilter=void 0!==e.minFilter?e.minFilter:lt}fromEquirectangularTexture(t,e){this.texture.type=e.type,this.texture.encoding=e.encoding,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t"},r=new gi(5,5,5),i=new bi({name:"CubemapFromEquirect",uniforms:vi(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:c,blending:p});i.uniforms.tEquirect.value=e;const o=new di(r,i),a=e.minFilter;e.minFilter===ht&&(e.minFilter=lt);return new Ti(1,10,this).update(t,o),e.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(t,e,n,r){const i=t.getRenderTarget();for(let i=0;i<6;i++)t.setRenderTarget(this,i),t.clear(e,n,r);t.setRenderTarget(i)}}const Pi=new $e,Ci=new $e,Li=new Xe;class Ii{constructor(t=new $e(1,0,0),e=0){this.isPlane=!0,this.normal=t,this.constant=e}set(t,e){return this.normal.copy(t),this.constant=e,this}setComponents(t,e,n,r){return this.normal.set(t,e,n),this.constant=r,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,n){const r=Pi.subVectors(n,e).cross(Ci.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(r,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return e.copy(t).addScaledVector(this.normal,-this.distanceToPoint(t))}intersectLine(t,e){const n=t.delta(Pi),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(t.start)?e.copy(t.start):null;const i=-(t.start.dot(this.normal)+this.constant)/r;return i<0||i>1?null:e.copy(t.start).addScaledVector(n,i)}intersectsLine(t){const e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){const n=e||Li.getNormalMatrix(t),r=this.coplanarPoint(Pi).applyMatrix4(t),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const Oi=new Un,Ni=new $e;class Ri{constructor(t=new Ii,e=new Ii,n=new Ii,r=new Ii,i=new Ii,o=new Ii){this.planes=[t,e,n,r,i,o]}set(t,e,n,r,i,o){const a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(n),a[3].copy(r),a[4].copy(i),a[5].copy(o),this}copy(t){const e=this.planes;for(let n=0;n<6;n++)e[n].copy(t.planes[n]);return this}setFromProjectionMatrix(t){const e=this.planes,n=t.elements,r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],l=n[6],c=n[7],h=n[8],p=n[9],f=n[10],d=n[11],m=n[12],g=n[13],v=n[14],y=n[15];return e[0].setComponents(a-r,c-s,d-h,y-m).normalize(),e[1].setComponents(a+r,c+s,d+h,y+m).normalize(),e[2].setComponents(a+i,c+u,d+p,y+g).normalize(),e[3].setComponents(a-i,c-u,d-p,y-g).normalize(),e[4].setComponents(a-o,c-l,d-f,y-v).normalize(),e[5].setComponents(a+o,c+l,d+f,y+v).normalize(),this}intersectsObject(t){const e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),Oi.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(Oi)}intersectsSprite(t){return Oi.center.set(0,0,0),Oi.radius=.7071067811865476,Oi.applyMatrix4(t.matrixWorld),this.intersectsSphere(Oi)}intersectsSphere(t){const e=this.planes,n=t.center,r=-t.radius;for(let t=0;t<6;t++){if(e[t].distanceToPoint(n)<r)return!1}return!0}intersectsBox(t){const e=this.planes;for(let n=0;n<6;n++){const r=e[n];if(Ni.x=r.normal.x>0?t.max.x:t.min.x,Ni.y=r.normal.y>0?t.max.y:t.min.y,Ni.z=r.normal.z>0?t.max.z:t.min.z,r.distanceToPoint(Ni)<0)return!1}return!0}containsPoint(t){const e=this.planes;for(let n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function Di(){let t=null,e=!1,n=null,r=null;function i(e,o){n(e,o),r=t.requestAnimationFrame(i)}return{start:function(){!0!==e&&null!==n&&(r=t.requestAnimationFrame(i),e=!0)},stop:function(){t.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(t){n=t},setContext:function(e){t=e}}}function ki(t,e){const n=e.isWebGL2,r=new WeakMap;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),r.get(t)},remove:function(e){e.isInterleavedBufferAttribute&&(e=e.data);const n=r.get(e);n&&(t.deleteBuffer(n.buffer),r.delete(e))},update:function(e,i){if(e.isGLBufferAttribute){const t=r.get(e);return void((!t||t.version<e.version)&&r.set(e,{buffer:e.buffer,type:e.type,bytesPerElement:e.elementSize,version:e.version}))}e.isInterleavedBufferAttribute&&(e=e.data);const o=r.get(e);void 0===o?r.set(e,function(e,r){const i=e.array,o=e.usage,a=t.createBuffer();let s;if(t.bindBuffer(r,a),t.bufferData(r,i,o),e.onUploadCallback(),i instanceof Float32Array)s=t.FLOAT;else if(i instanceof Uint16Array)if(e.isFloat16BufferAttribute){if(!n)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");s=t.HALF_FLOAT}else s=t.UNSIGNED_SHORT;else if(i instanceof Int16Array)s=t.SHORT;else if(i instanceof Uint32Array)s=t.UNSIGNED_INT;else if(i instanceof Int32Array)s=t.INT;else if(i instanceof Int8Array)s=t.BYTE;else if(i instanceof Uint8Array)s=t.UNSIGNED_BYTE;else{if(!(i instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+i);s=t.UNSIGNED_BYTE}return{buffer:a,type:s,bytesPerElement:i.BYTES_PER_ELEMENT,version:e.version}}(e,i)):o.version<e.version&&(!function(e,r,i){const o=r.array,a=r.updateRange;t.bindBuffer(i,e),-1===a.count?t.bufferSubData(i,0,o):(n?t.bufferSubData(i,a.offset*o.BYTES_PER_ELEMENT,o,a.offset,a.count):t.bufferSubData(i,a.offset*o.BYTES_PER_ELEMENT,o.subarray(a.offset,a.offset+a.count)),a.count=-1),r.onUploadCallback()}(o.buffer,e,i),o.version=e.version)}}}class Fi extends $r{constructor(t=1,e=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r};const i=t/2,o=e/2,a=Math.floor(n),s=Math.floor(r),u=a+1,l=s+1,c=t/a,h=e/s,p=[],f=[],d=[],m=[];for(let t=0;t<l;t++){const e=t*h-o;for(let n=0;n<u;n++){const r=n*c-i;f.push(r,-e,0),d.push(0,0,1),m.push(n/a),m.push(1-t/s)}}for(let t=0;t<s;t++)for(let e=0;e<a;e++){const n=e+u*t,r=e+u*(t+1),i=e+1+u*(t+1),o=e+1+u*t;p.push(n,r,o),p.push(r,i,o)}this.setIndex(p),this.setAttribute("position",new Hr(f,3)),this.setAttribute("normal",new Hr(d,3)),this.setAttribute("uv",new Hr(m,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new Fi(t.width,t.height,t.widthSegments,t.heightSegments)}}const Bi={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\n#ifdef USE_IRIDESCENCE\n\tvec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\t return vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat R21 = R12;\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );\n\t#else\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, vec2 fullSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\t\n\t\tvec2 lodFudge = pow( 1.95, lod ) / fullSize;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec2 fullSize = vec2( textureSize( sampler, 0 ) );\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), fullSize, floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), fullSize, ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},Ui={common:{diffuse:{value:new Fr(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Xe},uv2Transform:{value:new Xe},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new He(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Fr(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Fr(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Xe}},sprite:{diffuse:{value:new Fr(16777215)},opacity:{value:1},center:{value:new He(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Xe}}},zi={basic:{uniforms:yi([Ui.common,Ui.specularmap,Ui.envmap,Ui.aomap,Ui.lightmap,Ui.fog]),vertexShader:Bi.meshbasic_vert,fragmentShader:Bi.meshbasic_frag},lambert:{uniforms:yi([Ui.common,Ui.specularmap,Ui.envmap,Ui.aomap,Ui.lightmap,Ui.emissivemap,Ui.bumpmap,Ui.normalmap,Ui.displacementmap,Ui.fog,Ui.lights,{emissive:{value:new Fr(0)}}]),vertexShader:Bi.meshlambert_vert,fragmentShader:Bi.meshlambert_frag},phong:{uniforms:yi([Ui.common,Ui.specularmap,Ui.envmap,Ui.aomap,Ui.lightmap,Ui.emissivemap,Ui.bumpmap,Ui.normalmap,Ui.displacementmap,Ui.fog,Ui.lights,{emissive:{value:new Fr(0)},specular:{value:new Fr(1118481)},shininess:{value:30}}]),vertexShader:Bi.meshphong_vert,fragmentShader:Bi.meshphong_frag},standard:{uniforms:yi([Ui.common,Ui.envmap,Ui.aomap,Ui.lightmap,Ui.emissivemap,Ui.bumpmap,Ui.normalmap,Ui.displacementmap,Ui.roughnessmap,Ui.metalnessmap,Ui.fog,Ui.lights,{emissive:{value:new Fr(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Bi.meshphysical_vert,fragmentShader:Bi.meshphysical_frag},toon:{uniforms:yi([Ui.common,Ui.aomap,Ui.lightmap,Ui.emissivemap,Ui.bumpmap,Ui.normalmap,Ui.displacementmap,Ui.gradientmap,Ui.fog,Ui.lights,{emissive:{value:new Fr(0)}}]),vertexShader:Bi.meshtoon_vert,fragmentShader:Bi.meshtoon_frag},matcap:{uniforms:yi([Ui.common,Ui.bumpmap,Ui.normalmap,Ui.displacementmap,Ui.fog,{matcap:{value:null}}]),vertexShader:Bi.meshmatcap_vert,fragmentShader:Bi.meshmatcap_frag},points:{uniforms:yi([Ui.points,Ui.fog]),vertexShader:Bi.points_vert,fragmentShader:Bi.points_frag},dashed:{uniforms:yi([Ui.common,Ui.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Bi.linedashed_vert,fragmentShader:Bi.linedashed_frag},depth:{uniforms:yi([Ui.common,Ui.displacementmap]),vertexShader:Bi.depth_vert,fragmentShader:Bi.depth_frag},normal:{uniforms:yi([Ui.common,Ui.bumpmap,Ui.normalmap,Ui.displacementmap,{opacity:{value:1}}]),vertexShader:Bi.meshnormal_vert,fragmentShader:Bi.meshnormal_frag},sprite:{uniforms:yi([Ui.sprite,Ui.fog]),vertexShader:Bi.sprite_vert,fragmentShader:Bi.sprite_frag},background:{uniforms:{uvTransform:{value:new Xe},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Bi.background_vert,fragmentShader:Bi.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Bi.backgroundCube_vert,fragmentShader:Bi.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Bi.cube_vert,fragmentShader:Bi.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Bi.equirect_vert,fragmentShader:Bi.equirect_frag},distanceRGBA:{uniforms:yi([Ui.common,Ui.displacementmap,{referencePosition:{value:new $e},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Bi.distanceRGBA_vert,fragmentShader:Bi.distanceRGBA_frag},shadow:{uniforms:yi([Ui.lights,Ui.fog,{color:{value:new Fr(0)},opacity:{value:1}}]),vertexShader:Bi.shadow_vert,fragmentShader:Bi.shadow_frag}};zi.physical={uniforms:yi([zi.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new He(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new Fr(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new He},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Fr(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Fr(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Bi.meshphysical_vert,fragmentShader:Bi.meshphysical_frag};const Vi={r:0,b:0,g:0};function Gi(t,e,n,r,i,o,a){const s=new Fr(0);let u,h,p=!0===o?0:1,f=null,d=0,m=null;function g(e,n){e.getRGB(Vi,xi(t)),r.buffers.color.setClear(Vi.r,Vi.g,Vi.b,n,a)}return{getClearColor:function(){return s},setClearColor:function(t,e=1){s.set(t),p=e,g(s,p)},getClearAlpha:function(){return p},setClearAlpha:function(t){p=t,g(s,p)},render:function(r,o){let a=!1,v=!0===o.isScene?o.background:null;if(v&&v.isTexture){v=(o.backgroundBlurriness>0?n:e).get(v)}const y=t.xr,x=y.getSession&&y.getSession();x&&"additive"===x.environmentBlendMode&&(v=null),null===v?g(s,p):v&&v.isColor&&(g(v,1),a=!0),(t.autoClear||a)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),v&&(v.isCubeTexture||v.mapping===nt)?(void 0===h&&(h=new di(new gi(1,1,1),new bi({name:"BackgroundCubeMaterial",uniforms:vi(zi.backgroundCube.uniforms),vertexShader:zi.backgroundCube.vertexShader,fragmentShader:zi.backgroundCube.fragmentShader,side:c,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),h.geometry.deleteAttribute("uv"),h.onBeforeRender=function(t,e,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(h.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(h)),h.material.uniforms.envMap.value=v,h.material.uniforms.flipEnvMap.value=v.isCubeTexture&&!1===v.isRenderTargetTexture?-1:1,h.material.uniforms.backgroundBlurriness.value=o.backgroundBlurriness,h.material.uniforms.backgroundIntensity.value=o.backgroundIntensity,h.material.toneMapped=v.encoding!==xe,f===v&&d===v.version&&m===t.toneMapping||(h.material.needsUpdate=!0,f=v,d=v.version,m=t.toneMapping),h.layers.enableAll(),r.unshift(h,h.geometry,h.material,0,0,null)):v&&v.isTexture&&(void 0===u&&(u=new di(new Fi(2,2),new bi({name:"BackgroundMaterial",uniforms:vi(zi.background.uniforms),vertexShader:zi.background.vertexShader,fragmentShader:zi.background.fragmentShader,side:l,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(u)),u.material.uniforms.t2D.value=v,u.material.uniforms.backgroundIntensity.value=o.backgroundIntensity,u.material.toneMapped=v.encoding!==xe,!0===v.matrixAutoUpdate&&v.updateMatrix(),u.material.uniforms.uvTransform.value.copy(v.matrix),f===v&&d===v.version&&m===t.toneMapping||(u.material.needsUpdate=!0,f=v,d=v.version,m=t.toneMapping),u.layers.enableAll(),r.unshift(u,u.geometry,u.material,0,0,null))}}}function ji(t,e,n,r){const i=t.getParameter(t.MAX_VERTEX_ATTRIBS),o=r.isWebGL2?null:e.get("OES_vertex_array_object"),a=r.isWebGL2||null!==o,s={},u=f(null);let l=u,c=!1;function h(e){return r.isWebGL2?t.bindVertexArray(e):o.bindVertexArrayOES(e)}function p(e){return r.isWebGL2?t.deleteVertexArray(e):o.deleteVertexArrayOES(e)}function f(t){const e=[],n=[],r=[];for(let t=0;t<i;t++)e[t]=0,n[t]=0,r[t]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:e,enabledAttributes:n,attributeDivisors:r,object:t,attributes:{},index:null}}function d(){const t=l.newAttributes;for(let e=0,n=t.length;e<n;e++)t[e]=0}function m(t){g(t,0)}function g(n,i){const o=l.newAttributes,a=l.enabledAttributes,s=l.attributeDivisors;if(o[n]=1,0===a[n]&&(t.enableVertexAttribArray(n),a[n]=1),s[n]!==i){(r.isWebGL2?t:e.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,i),s[n]=i}}function v(){const e=l.newAttributes,n=l.enabledAttributes;for(let r=0,i=n.length;r<i;r++)n[r]!==e[r]&&(t.disableVertexAttribArray(r),n[r]=0)}function y(e,n,i,o,a,s){!0!==r.isWebGL2||i!==t.INT&&i!==t.UNSIGNED_INT?t.vertexAttribPointer(e,n,i,o,a,s):t.vertexAttribIPointer(e,n,i,a,s)}function x(){_(),c=!0,l!==u&&(l=u,h(l.object))}function _(){u.geometry=null,u.program=null,u.wireframe=!1}return{setup:function(i,u,p,x,_){let b=!1;if(a){const e=function(e,n,i){const a=!0===i.wireframe;let u=s[e.id];void 0===u&&(u={},s[e.id]=u);let l=u[n.id];void 0===l&&(l={},u[n.id]=l);let c=l[a];void 0===c&&(c=f(r.isWebGL2?t.createVertexArray():o.createVertexArrayOES()),l[a]=c);return c}(x,p,u);l!==e&&(l=e,h(l.object)),b=function(t,e,n,r){const i=l.attributes,o=e.attributes;let a=0;const s=n.getAttributes();for(const e in s){if(s[e].location>=0){const n=i[e];let r=o[e];if(void 0===r&&("instanceMatrix"===e&&t.instanceMatrix&&(r=t.instanceMatrix),"instanceColor"===e&&t.instanceColor&&(r=t.instanceColor)),void 0===n)return!0;if(n.attribute!==r)return!0;if(r&&n.data!==r.data)return!0;a++}}return l.attributesNum!==a||l.index!==r}(i,x,p,_),b&&function(t,e,n,r){const i={},o=e.attributes;let a=0;const s=n.getAttributes();for(const e in s){if(s[e].location>=0){let n=o[e];void 0===n&&("instanceMatrix"===e&&t.instanceMatrix&&(n=t.instanceMatrix),"instanceColor"===e&&t.instanceColor&&(n=t.instanceColor));const r={};r.attribute=n,n&&n.data&&(r.data=n.data),i[e]=r,a++}}l.attributes=i,l.attributesNum=a,l.index=r}(i,x,p,_)}else{const t=!0===u.wireframe;l.geometry===x.id&&l.program===p.id&&l.wireframe===t||(l.geometry=x.id,l.program=p.id,l.wireframe=t,b=!0)}null!==_&&n.update(_,t.ELEMENT_ARRAY_BUFFER),(b||c)&&(c=!1,function(i,o,a,s){if(!1===r.isWebGL2&&(i.isInstancedMesh||s.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;d();const u=s.attributes,l=a.getAttributes(),c=o.defaultAttributeValues;for(const e in l){const r=l[e];if(r.location>=0){let o=u[e];if(void 0===o&&("instanceMatrix"===e&&i.instanceMatrix&&(o=i.instanceMatrix),"instanceColor"===e&&i.instanceColor&&(o=i.instanceColor)),void 0!==o){const e=o.normalized,a=o.itemSize,u=n.get(o);if(void 0===u)continue;const l=u.buffer,c=u.type,h=u.bytesPerElement;if(o.isInterleavedBufferAttribute){const n=o.data,u=n.stride,p=o.offset;if(n.isInstancedInterleavedBuffer){for(let t=0;t<r.locationSize;t++)g(r.location+t,n.meshPerAttribute);!0!==i.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=n.meshPerAttribute*n.count)}else for(let t=0;t<r.locationSize;t++)m(r.location+t);t.bindBuffer(t.ARRAY_BUFFER,l);for(let t=0;t<r.locationSize;t++)y(r.location+t,a/r.locationSize,c,e,u*h,(p+a/r.locationSize*t)*h)}else{if(o.isInstancedBufferAttribute){for(let t=0;t<r.locationSize;t++)g(r.location+t,o.meshPerAttribute);!0!==i.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=o.meshPerAttribute*o.count)}else for(let t=0;t<r.locationSize;t++)m(r.location+t);t.bindBuffer(t.ARRAY_BUFFER,l);for(let t=0;t<r.locationSize;t++)y(r.location+t,a/r.locationSize,c,e,a*h,a/r.locationSize*t*h)}}else if(void 0!==c){const n=c[e];if(void 0!==n)switch(n.length){case 2:t.vertexAttrib2fv(r.location,n);break;case 3:t.vertexAttrib3fv(r.location,n);break;case 4:t.vertexAttrib4fv(r.location,n);break;default:t.vertexAttrib1fv(r.location,n)}}}}v()}(i,u,p,x),null!==_&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n.get(_).buffer))},reset:x,resetDefaultState:_,dispose:function(){x();for(const t in s){const e=s[t];for(const t in e){const n=e[t];for(const t in n)p(n[t].object),delete n[t];delete e[t]}delete s[t]}},releaseStatesOfGeometry:function(t){if(void 0===s[t.id])return;const e=s[t.id];for(const t in e){const n=e[t];for(const t in n)p(n[t].object),delete n[t];delete e[t]}delete s[t.id]},releaseStatesOfProgram:function(t){for(const e in s){const n=s[e];if(void 0===n[t.id])continue;const r=n[t.id];for(const t in r)p(r[t].object),delete r[t];delete n[t.id]}},initAttributes:d,enableAttribute:m,disableUnusedAttributes:v}}function Wi(t,e,n,r){const i=r.isWebGL2;let o;this.setMode=function(t){o=t},this.render=function(e,r){t.drawArrays(o,e,r),n.update(r,o,1)},this.renderInstances=function(r,a,s){if(0===s)return;let u,l;if(i)u=t,l="drawArraysInstanced";else if(u=e.get("ANGLE_instanced_arrays"),l="drawArraysInstancedANGLE",null===u)return;u[l](o,r,a,s),n.update(a,o,s)}}function Hi(t,e,n){let r;function i(e){if("highp"===e){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const o="undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext;let a=void 0!==n.precision?n.precision:"highp";const s=i(a);s!==a&&(a=s);const u=o||e.has("WEBGL_draw_buffers"),l=!0===n.logarithmicDepthBuffer,c=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),h=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),p=t.getParameter(t.MAX_TEXTURE_SIZE),f=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),d=t.getParameter(t.MAX_VERTEX_ATTRIBS),m=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),g=t.getParameter(t.MAX_VARYING_VECTORS),v=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),y=h>0,x=o||e.has("OES_texture_float");return{isWebGL2:o,drawBuffers:u,getMaxAnisotropy:function(){if(void 0!==r)return r;if(!0===e.has("EXT_texture_filter_anisotropic")){const n=e.get("EXT_texture_filter_anisotropic");r=t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r},getMaxPrecision:i,precision:a,logarithmicDepthBuffer:l,maxTextures:c,maxVertexTextures:h,maxTextureSize:p,maxCubemapSize:f,maxAttributes:d,maxVertexUniforms:m,maxVaryings:g,maxFragmentUniforms:v,vertexTextures:y,floatFragmentTextures:x,floatVertexTextures:y&&x,maxSamples:o?t.getParameter(t.MAX_SAMPLES):0}}function Xi(t){const e=this;let n=null,r=0,i=!1,o=!1;const a=new Ii,s=new Xe,u={value:null,needsUpdate:!1};function l(t,n,r,i){const o=null!==t?t.length:0;let l=null;if(0!==o){if(l=u.value,!0!==i||null===l){const e=r+4*o,i=n.matrixWorldInverse;s.getNormalMatrix(i),(null===l||l.length<e)&&(l=new Float32Array(e));for(let e=0,n=r;e!==o;++e,n+=4)a.copy(t[e]).applyMatrix4(i,s),a.normal.toArray(l,n),l[n+3]=a.constant}u.value=l,u.needsUpdate=!0}return e.numPlanes=o,e.numIntersection=0,l}this.uniform=u,this.numPlanes=0,this.numIntersection=0,this.init=function(t,e){const n=0!==t.length||e||0!==r||i;return i=e,r=t.length,n},this.beginShadows=function(){o=!0,l(null)},this.endShadows=function(){o=!1},this.setGlobalState=function(t,e){n=l(t,e,0)},this.setState=function(a,s,c){const h=a.clippingPlanes,p=a.clipIntersection,f=a.clipShadows,d=t.get(a);if(!i||null===h||0===h.length||o&&!f)o?l(null):function(){u.value!==n&&(u.value=n,u.needsUpdate=r>0);e.numPlanes=r,e.numIntersection=0}();else{const t=o?0:r,e=4*t;let i=d.clippingState||null;u.value=i,i=l(h,s,e,c);for(let t=0;t!==e;++t)i[t]=n[t];d.clippingState=i,this.numIntersection=p?this.numPlanes:0,this.numPlanes+=t}}}function Yi(t){let e=new WeakMap;function n(t,e){return e===tt?t.mapping=Q:e===et&&(t.mapping=$),t}function r(t){const n=t.target;n.removeEventListener("dispose",r);const i=e.get(n);void 0!==i&&(e.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture&&!1===i.isRenderTargetTexture){const o=i.mapping;if(o===tt||o===et){if(e.has(i)){return n(e.get(i).texture,i.mapping)}{const o=i.image;if(o&&o.height>0){const a=new Ai(o.height/2);return a.fromEquirectangularTexture(t,i),e.set(i,a),i.addEventListener("dispose",r),n(a.texture,i.mapping)}return null}}}return i},dispose:function(){e=new WeakMap}}}class qi extends wi{constructor(t=-1,e=1,n=1,r=-1,i=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=r,this.near=i,this.far=o,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this}setViewOffset(t,e,n,r,i,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let i=n-t,o=n+t,a=r+e,s=r-e;if(null!==this.view&&this.view.enabled){const t=(this.right-this.left)/this.view.fullWidth/this.zoom,e=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=t*this.view.offsetX,o=i+t*this.view.width,a-=e*this.view.offsetY,s=a-e*this.view.height}this.projectionMatrix.makeOrthographic(i,o,a,s,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}const Zi=4,Ji=[.125,.215,.35,.446,.526,.582],Ki=20,Qi=new qi,$i=new Fr;let to=null;const eo=(1+Math.sqrt(5))/2,no=1/eo,ro=[new $e(1,1,1),new $e(-1,1,1),new $e(1,1,-1),new $e(-1,1,-1),new $e(0,eo,no),new $e(0,eo,-no),new $e(no,0,eo),new $e(-no,0,eo),new $e(eo,no,0),new $e(-eo,no,0)];class io{constructor(t){this._renderer=t,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(t,e=0,n=.1,r=100){to=this._renderer.getRenderTarget(),this._setSize(256);const i=this._allocateTargets();return i.depthBuffer=!0,this._sceneToCubeUV(t,n,r,i),e>0&&this._blur(i,0,0,e),this._applyPMREM(i),this._cleanup(i),i}fromEquirectangular(t,e=null){return this._fromTexture(t,e)}fromCubemap(t,e=null){return this._fromTexture(t,e)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=uo(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=so(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(t){this._lodMax=Math.floor(Math.log2(t)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let t=0;t<this._lodPlanes.length;t++)this._lodPlanes[t].dispose()}_cleanup(t){this._renderer.setRenderTarget(to),t.scissorTest=!1,ao(t,0,0,t.width,t.height)}_fromTexture(t,e){t.mapping===Q||t.mapping===$?this._setSize(0===t.image.length?16:t.image[0].width||t.image[0].image.width):this._setSize(t.image.width/4),to=this._renderer.getRenderTarget();const n=e||this._allocateTargets();return this._textureToCubeUV(t,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const t=3*Math.max(this._cubeSize,112),e=4*this._cubeSize,n={magFilter:lt,minFilter:lt,generateMipmaps:!1,type:xt,format:St,encoding:ye,depthBuffer:!1},r=oo(t,e,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==t||this._pingPongRenderTarget.height!==e){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=oo(t,e,n);const{_lodMax:r}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function(t){const e=[],n=[],r=[];let i=t;const o=t-Zi+1+Ji.length;for(let a=0;a<o;a++){const o=Math.pow(2,i);n.push(o);let s=1/o;a>t-Zi?s=Ji[a-t+Zi-1]:0===a&&(s=0),r.push(s);const u=1/(o-2),l=-u,c=1+u,h=[l,l,c,l,c,c,l,l,c,c,l,c],p=6,f=6,d=3,m=2,g=1,v=new Float32Array(d*f*p),y=new Float32Array(m*f*p),x=new Float32Array(g*f*p);for(let t=0;t<p;t++){const e=t%3*2/3-1,n=t>2?0:-1,r=[e,n,0,e+2/3,n,0,e+2/3,n+1,0,e,n,0,e+2/3,n+1,0,e,n+1,0];v.set(r,d*f*t),y.set(h,m*f*t);const i=[t,t,t,t,t,t];x.set(i,g*f*t)}const _=new $r;_.setAttribute("position",new Gr(v,d)),_.setAttribute("uv",new Gr(y,m)),_.setAttribute("faceIndex",new Gr(x,g)),e.push(_),i>Zi&&i--}return{lodPlanes:e,sizeLods:n,sigmas:r}}(r)),this._blurMaterial=function(t,e,n){const r=new Float32Array(Ki),i=new $e(0,1,0),o=new bi({name:"SphericalGaussianBlur",defines:{n:Ki,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:lo(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:p,depthTest:!1,depthWrite:!1});return o}(r,t,e)}return r}_compileMaterial(t){const e=new di(this._lodPlanes[0],t);this._renderer.compile(e,Qi)}_sceneToCubeUV(t,e,n,r){const i=new Mi(90,1,e,n),o=[1,-1,1,1,1,1],a=[1,1,1,-1,-1,-1],s=this._renderer,u=s.autoClear,l=s.toneMapping;s.getClearColor($i),s.toneMapping=H,s.autoClear=!1;const h=new Ur({name:"PMREM.Background",side:c,depthWrite:!1,depthTest:!1}),p=new di(new gi,h);let f=!1;const d=t.background;d?d.isColor&&(h.color.copy(d),t.background=null,f=!0):(h.color.copy($i),f=!0);for(let e=0;e<6;e++){const n=e%3;0===n?(i.up.set(0,o[e],0),i.lookAt(a[e],0,0)):1===n?(i.up.set(0,0,o[e]),i.lookAt(0,a[e],0)):(i.up.set(0,o[e],0),i.lookAt(0,0,a[e]));const u=this._cubeSize;ao(r,n*u,e>2?u:0,u,u),s.setRenderTarget(r),f&&s.render(p,i),s.render(t,i)}p.geometry.dispose(),p.material.dispose(),s.toneMapping=l,s.autoClear=u,t.background=d}_textureToCubeUV(t,e){const n=this._renderer,r=t.mapping===Q||t.mapping===$;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=uo()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===t.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=so());const i=r?this._cubemapMaterial:this._equirectMaterial,o=new di(this._lodPlanes[0],i);i.uniforms.envMap.value=t;const a=this._cubeSize;ao(e,0,0,3*a,2*a),n.setRenderTarget(e),n.render(o,Qi)}_applyPMREM(t){const e=this._renderer,n=e.autoClear;e.autoClear=!1;for(let e=1;e<this._lodPlanes.length;e++){const n=Math.sqrt(this._sigmas[e]*this._sigmas[e]-this._sigmas[e-1]*this._sigmas[e-1]),r=ro[(e-1)%ro.length];this._blur(t,e-1,e,n,r)}e.autoClear=n}_blur(t,e,n,r,i){const o=this._pingPongRenderTarget;this._halfBlur(t,o,e,n,r,"latitudinal",i),this._halfBlur(o,t,n,n,r,"longitudinal",i)}_halfBlur(t,e,n,r,i,o,a){const s=this._renderer,u=this._blurMaterial,l=new di(this._lodPlanes[r],u),c=u.uniforms,h=this._sizeLods[n]-1,p=isFinite(i)?Math.PI/(2*h):2*Math.PI/(2*Ki-1),f=i/p,d=isFinite(i)?1+Math.floor(3*f):Ki,m=[];let g=0;for(let t=0;t<Ki;++t){const e=t/f,n=Math.exp(-e*e/2);m.push(n),0===t?g+=n:t<d&&(g+=2*n)}for(let t=0;t<m.length;t++)m[t]=m[t]/g;c.envMap.value=t.texture,c.samples.value=d,c.weights.value=m,c.latitudinal.value="latitudinal"===o,a&&(c.poleAxis.value=a);const{_lodMax:v}=this;c.dTheta.value=p,c.mipInt.value=v-n;const y=this._sizeLods[r];ao(e,3*y*(r>v-Zi?r-v+Zi:0),4*(this._cubeSize-y),3*y,2*y),s.setRenderTarget(e),s.render(l,Qi)}}function oo(t,e,n){const r=new yn(t,e,n);return r.texture.mapping=nt,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function ao(t,e,n,r,i){t.viewport.set(e,n,r,i),t.scissor.set(e,n,r,i)}function so(){return new bi({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:lo(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:p,depthTest:!1,depthWrite:!1})}function uo(){return new bi({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:lo(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:p,depthTest:!1,depthWrite:!1})}function lo(){return"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t"}function co(t){let e=new WeakMap,n=null;function r(t){const n=t.target;n.removeEventListener("dispose",r);const i=e.get(n);void 0!==i&&(e.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture){const o=i.mapping,a=o===tt||o===et,s=o===Q||o===$;if(a||s){if(i.isRenderTargetTexture&&!0===i.needsPMREMUpdate){i.needsPMREMUpdate=!1;let r=e.get(i);return null===n&&(n=new io(t)),r=a?n.fromEquirectangular(i,r):n.fromCubemap(i,r),e.set(i,r),r.texture}if(e.has(i))return e.get(i).texture;{const o=i.image;if(a&&o&&o.height>0||s&&o&&function(t){let e=0;const n=6;for(let r=0;r<n;r++)void 0!==t[r]&&e++;return e===n}(o)){null===n&&(n=new io(t));const o=a?n.fromEquirectangular(i):n.fromCubemap(i);return e.set(i,o),i.addEventListener("dispose",r),o.texture}return null}}}return i},dispose:function(){e=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function ho(t){const e={};function n(n){if(void 0!==e[n])return e[n];let r;switch(n){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=t.getExtension(n)}return e[n]=r,r}return{has:function(t){return null!==n(t)},init:function(t){t.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture")},get:function(t){const e=n(t);return e}}}function po(t,e,n,r){const i={},o=new WeakMap;function a(t){const s=t.target;null!==s.index&&e.remove(s.index);for(const t in s.attributes)e.remove(s.attributes[t]);s.removeEventListener("dispose",a),delete i[s.id];const u=o.get(s);u&&(e.remove(u),o.delete(s)),r.releaseStatesOfGeometry(s),!0===s.isInstancedBufferGeometry&&delete s._maxInstanceCount,n.memory.geometries--}function s(t){const n=[],r=t.index,i=t.attributes.position;let a=0;if(null!==r){const t=r.array;a=r.version;for(let e=0,r=t.length;e<r;e+=3){const r=t[e+0],i=t[e+1],o=t[e+2];n.push(r,i,i,o,o,r)}}else{const t=i.array;a=i.version;for(let e=0,r=t.length/3-1;e<r;e+=3){const t=e+0,r=e+1,i=e+2;n.push(t,r,r,i,i,t)}}const s=new(qe(n)?Wr:jr)(n,1);s.version=a;const u=o.get(t);u&&e.remove(u),o.set(t,s)}return{get:function(t,e){return!0===i[e.id]||(e.addEventListener("dispose",a),i[e.id]=!0,n.memory.geometries++),e},update:function(n){const r=n.attributes;for(const n in r)e.update(r[n],t.ARRAY_BUFFER);const i=n.morphAttributes;for(const n in i){const r=i[n];for(let n=0,i=r.length;n<i;n++)e.update(r[n],t.ARRAY_BUFFER)}},getWireframeAttribute:function(t){const e=o.get(t);if(e){const n=t.index;null!==n&&e.version<n.version&&s(t)}else s(t);return o.get(t)}}}function fo(t,e,n,r){const i=r.isWebGL2;let o,a,s;this.setMode=function(t){o=t},this.setIndex=function(t){a=t.type,s=t.bytesPerElement},this.render=function(e,r){t.drawElements(o,r,a,e*s),n.update(r,o,1)},this.renderInstances=function(r,u,l){if(0===l)return;let c,h;if(i)c=t,h="drawElementsInstanced";else if(c=e.get("ANGLE_instanced_arrays"),h="drawElementsInstancedANGLE",null===c)return;c[h](o,u,a,r*s,l),n.update(u,o,l)}}function mo(t){const e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(n,r,i){switch(e.calls++,r){case t.TRIANGLES:e.triangles+=i*(n/3);break;case t.LINES:e.lines+=i*(n/2);break;case t.LINE_STRIP:e.lines+=i*(n-1);break;case t.LINE_LOOP:e.lines+=i*n;break;case t.POINTS:e.points+=i*n}}}}function go(t,e){return t[0]-e[0]}function vo(t,e){return Math.abs(e[1])-Math.abs(t[1])}function yo(t,e,n){const r={},i=new Float32Array(8),o=new WeakMap,a=new vn,s=[];for(let t=0;t<8;t++)s[t]=[t,0];return{update:function(u,l,c){const h=u.morphTargetInfluences;if(!0===e.isWebGL2){const p=l.morphAttributes.position||l.morphAttributes.normal||l.morphAttributes.color,f=void 0!==p?p.length:0;let d=o.get(l);if(void 0===d||d.count!==f){void 0!==d&&d.texture.dispose();const v=void 0!==l.morphAttributes.position,y=void 0!==l.morphAttributes.normal,x=void 0!==l.morphAttributes.color,_=l.morphAttributes.position||[],b=l.morphAttributes.normal||[],w=l.morphAttributes.color||[];let M=0;!0===v&&(M=1),!0===y&&(M=2),!0===x&&(M=3);let S=l.attributes.position.count*M,T=1;S>e.maxTextureSize&&(T=Math.ceil(S/e.maxTextureSize),S=e.maxTextureSize);const E=new Float32Array(S*T*4*f),A=new xn(E,S,T,f);A.type=yt,A.needsUpdate=!0;const P=4*M;for(let L=0;L<f;L++){const I=_[L],O=b[L],N=w[L],R=S*T*4*L;for(let D=0;D<I.count;D++){const k=D*P;!0===v&&(a.fromBufferAttribute(I,D),E[R+k+0]=a.x,E[R+k+1]=a.y,E[R+k+2]=a.z,E[R+k+3]=0),!0===y&&(a.fromBufferAttribute(O,D),E[R+k+4]=a.x,E[R+k+5]=a.y,E[R+k+6]=a.z,E[R+k+7]=0),!0===x&&(a.fromBufferAttribute(N,D),E[R+k+8]=a.x,E[R+k+9]=a.y,E[R+k+10]=a.z,E[R+k+11]=4===N.itemSize?a.w:1)}}function C(){A.dispose(),o.delete(l),l.removeEventListener("dispose",C)}d={count:f,texture:A,size:new He(S,T)},o.set(l,d),l.addEventListener("dispose",C)}let m=0;for(let F=0;F<h.length;F++)m+=h[F];const g=l.morphTargetsRelative?1:1-m;c.getUniforms().setValue(t,"morphTargetBaseInfluence",g),c.getUniforms().setValue(t,"morphTargetInfluences",h),c.getUniforms().setValue(t,"morphTargetsTexture",d.texture,n),c.getUniforms().setValue(t,"morphTargetsTextureSize",d.size)}else{const B=void 0===h?0:h.length;let U=r[l.id];if(void 0===U||U.length!==B){U=[];for(let W=0;W<B;W++)U[W]=[W,0];r[l.id]=U}for(let H=0;H<B;H++){const X=U[H];X[0]=H,X[1]=h[H]}U.sort(vo);for(let Y=0;Y<8;Y++)Y<B&&U[Y][1]?(s[Y][0]=U[Y][0],s[Y][1]=U[Y][1]):(s[Y][0]=Number.MAX_SAFE_INTEGER,s[Y][1]=0);s.sort(go);const z=l.morphAttributes.position,V=l.morphAttributes.normal;let G=0;for(let q=0;q<8;q++){const Z=s[q],J=Z[0],K=Z[1];J!==Number.MAX_SAFE_INTEGER&&K?(z&&l.getAttribute("morphTarget"+q)!==z[J]&&l.setAttribute("morphTarget"+q,z[J]),V&&l.getAttribute("morphNormal"+q)!==V[J]&&l.setAttribute("morphNormal"+q,V[J]),i[q]=K,G+=K):(z&&!0===l.hasAttribute("morphTarget"+q)&&l.deleteAttribute("morphTarget"+q),V&&!0===l.hasAttribute("morphNormal"+q)&&l.deleteAttribute("morphNormal"+q),i[q]=0)}const j=l.morphTargetsRelative?1:1-G;c.getUniforms().setValue(t,"morphTargetBaseInfluence",j),c.getUniforms().setValue(t,"morphTargetInfluences",i)}}}}function xo(t,e,n,r){let i=new WeakMap;function o(t){const e=t.target;e.removeEventListener("dispose",o),n.remove(e.instanceMatrix),null!==e.instanceColor&&n.remove(e.instanceColor)}return{update:function(a){const s=r.render.frame,u=a.geometry,l=e.get(a,u);return i.get(l)!==s&&(e.update(l),i.set(l,s)),a.isInstancedMesh&&(!1===a.hasEventListener("dispose",o)&&a.addEventListener("dispose",o),n.update(a.instanceMatrix,t.ARRAY_BUFFER),null!==a.instanceColor&&n.update(a.instanceColor,t.ARRAY_BUFFER)),l},dispose:function(){i=new WeakMap}}}const _o=new gn,bo=new xn,wo=new _n,Mo=new Ei,So=[],To=[],Eo=new Float32Array(16),Ao=new Float32Array(9),Po=new Float32Array(4);function Co(t,e,n){const r=t[0];if(r<=0||r>0)return t;const i=e*n;let o=So[i];if(void 0===o&&(o=new Float32Array(i),So[i]=o),0!==e){r.toArray(o,0);for(let r=1,i=0;r!==e;++r)i+=n,t[r].toArray(o,i)}return o}function Lo(t,e){if(t.length!==e.length)return!1;for(let n=0,r=t.length;n<r;n++)if(t[n]!==e[n])return!1;return!0}function Io(t,e){for(let n=0,r=e.length;n<r;n++)t[n]=e[n]}function Oo(t,e){let n=To[e];void 0===n&&(n=new Int32Array(e),To[e]=n);for(let r=0;r!==e;++r)n[r]=t.allocateTextureUnit();return n}function No(t,e){const n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function Ro(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Lo(n,e))return;t.uniform2fv(this.addr,e),Io(n,e)}}function Do(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(void 0!==e.r)n[0]===e.r&&n[1]===e.g&&n[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(Lo(n,e))return;t.uniform3fv(this.addr,e),Io(n,e)}}function ko(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z&&n[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Lo(n,e))return;t.uniform4fv(this.addr,e),Io(n,e)}}function Fo(t,e){const n=this.cache,r=e.elements;if(void 0===r){if(Lo(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),Io(n,e)}else{if(Lo(n,r))return;Po.set(r),t.uniformMatrix2fv(this.addr,!1,Po),Io(n,r)}}function Bo(t,e){const n=this.cache,r=e.elements;if(void 0===r){if(Lo(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),Io(n,e)}else{if(Lo(n,r))return;Ao.set(r),t.uniformMatrix3fv(this.addr,!1,Ao),Io(n,r)}}function Uo(t,e){const n=this.cache,r=e.elements;if(void 0===r){if(Lo(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),Io(n,e)}else{if(Lo(n,r))return;Eo.set(r),t.uniformMatrix4fv(this.addr,!1,Eo),Io(n,r)}}function zo(t,e){const n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function Vo(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y||(t.uniform2i(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Lo(n,e))return;t.uniform2iv(this.addr,e),Io(n,e)}}function Go(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z||(t.uniform3i(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(Lo(n,e))return;t.uniform3iv(this.addr,e),Io(n,e)}}function jo(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z&&n[3]===e.w||(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Lo(n,e))return;t.uniform4iv(this.addr,e),Io(n,e)}}function Wo(t,e){const n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function Ho(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y||(t.uniform2ui(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Lo(n,e))return;t.uniform2uiv(this.addr,e),Io(n,e)}}function Xo(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z||(t.uniform3ui(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(Lo(n,e))return;t.uniform3uiv(this.addr,e),Io(n,e)}}function Yo(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z&&n[3]===e.w||(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Lo(n,e))return;t.uniform4uiv(this.addr,e),Io(n,e)}}function qo(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture2D(e||_o,i)}function Zo(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(e||wo,i)}function Jo(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTextureCube(e||Mo,i)}function Ko(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(e||bo,i)}function Qo(t,e){t.uniform1fv(this.addr,e)}function $o(t,e){const n=Co(e,this.size,2);t.uniform2fv(this.addr,n)}function ta(t,e){const n=Co(e,this.size,3);t.uniform3fv(this.addr,n)}function ea(t,e){const n=Co(e,this.size,4);t.uniform4fv(this.addr,n)}function na(t,e){const n=Co(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function ra(t,e){const n=Co(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function ia(t,e){const n=Co(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function oa(t,e){t.uniform1iv(this.addr,e)}function aa(t,e){t.uniform2iv(this.addr,e)}function sa(t,e){t.uniform3iv(this.addr,e)}function ua(t,e){t.uniform4iv(this.addr,e)}function la(t,e){t.uniform1uiv(this.addr,e)}function ca(t,e){t.uniform2uiv(this.addr,e)}function ha(t,e){t.uniform3uiv(this.addr,e)}function pa(t,e){t.uniform4uiv(this.addr,e)}function fa(t,e,n){const r=this.cache,i=e.length,o=Oo(n,i);Lo(r,o)||(t.uniform1iv(this.addr,o),Io(r,o));for(let t=0;t!==i;++t)n.setTexture2D(e[t]||_o,o[t])}function da(t,e,n){const r=this.cache,i=e.length,o=Oo(n,i);Lo(r,o)||(t.uniform1iv(this.addr,o),Io(r,o));for(let t=0;t!==i;++t)n.setTexture3D(e[t]||wo,o[t])}function ma(t,e,n){const r=this.cache,i=e.length,o=Oo(n,i);Lo(r,o)||(t.uniform1iv(this.addr,o),Io(r,o));for(let t=0;t!==i;++t)n.setTextureCube(e[t]||Mo,o[t])}function ga(t,e,n){const r=this.cache,i=e.length,o=Oo(n,i);Lo(r,o)||(t.uniform1iv(this.addr,o),Io(r,o));for(let t=0;t!==i;++t)n.setTexture2DArray(e[t]||bo,o[t])}class va{constructor(t,e,n){this.id=t,this.addr=n,this.cache=[],this.setValue=function(t){switch(t){case 5126:return No;case 35664:return Ro;case 35665:return Do;case 35666:return ko;case 35674:return Fo;case 35675:return Bo;case 35676:return Uo;case 5124:case 35670:return zo;case 35667:case 35671:return Vo;case 35668:case 35672:return Go;case 35669:case 35673:return jo;case 5125:return Wo;case 36294:return Ho;case 36295:return Xo;case 36296:return Yo;case 35678:case 36198:case 36298:case 36306:case 35682:return qo;case 35679:case 36299:case 36307:return Zo;case 35680:case 36300:case 36308:case 36293:return Jo;case 36289:case 36303:case 36311:case 36292:return Ko}}(e.type)}}class ya{constructor(t,e,n){this.id=t,this.addr=n,this.cache=[],this.size=e.size,this.setValue=function(t){switch(t){case 5126:return Qo;case 35664:return $o;case 35665:return ta;case 35666:return ea;case 35674:return na;case 35675:return ra;case 35676:return ia;case 5124:case 35670:return oa;case 35667:case 35671:return aa;case 35668:case 35672:return sa;case 35669:case 35673:return ua;case 5125:return la;case 36294:return ca;case 36295:return ha;case 36296:return pa;case 35678:case 36198:case 36298:case 36306:case 35682:return fa;case 35679:case 36299:case 36307:return da;case 35680:case 36300:case 36308:case 36293:return ma;case 36289:case 36303:case 36311:case 36292:return ga}}(e.type)}}class xa{constructor(t){this.id=t,this.seq=[],this.map={}}setValue(t,e,n){const r=this.seq;for(let i=0,o=r.length;i!==o;++i){const o=r[i];o.setValue(t,e[o.id],n)}}}const _a=/(\w+)(\])?(\[|\.)?/g;function ba(t,e){t.seq.push(e),t.map[e.id]=e}function wa(t,e,n){const r=t.name,i=r.length;for(_a.lastIndex=0;;){const o=_a.exec(r),a=_a.lastIndex;let s=o[1];const u="]"===o[2],l=o[3];if(u&&(s|=0),void 0===l||"["===l&&a+2===i){ba(n,void 0===l?new va(s,t,e):new ya(s,t,e));break}{let t=n.map[s];void 0===t&&(t=new xa(s),ba(n,t)),n=t}}}class Ma{constructor(t,e){this.seq=[],this.map={};const n=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(let r=0;r<n;++r){const n=t.getActiveUniform(e,r);wa(n,t.getUniformLocation(e,n.name),this)}}setValue(t,e,n,r){const i=this.map[e];void 0!==i&&i.setValue(t,n,r)}setOptional(t,e,n){const r=e[n];void 0!==r&&this.setValue(t,n,r)}static upload(t,e,n,r){for(let i=0,o=e.length;i!==o;++i){const o=e[i],a=n[o.id];!1!==a.needsUpdate&&o.setValue(t,a.value,r)}}static seqWithValue(t,e){const n=[];for(let r=0,i=t.length;r!==i;++r){const i=t[r];i.id in e&&n.push(i)}return n}}function Sa(t,e,n){const r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),r}let Ta=0;function Ea(t,e,n){const r=t.getShaderParameter(e,t.COMPILE_STATUS),i=t.getShaderInfoLog(e).trim();if(r&&""===i)return"";const o=/ERROR: 0:(\d+)/.exec(i);if(o){const r=parseInt(o[1]);return n.toUpperCase()+"\n\n"+i+"\n\n"+function(t,e){const n=t.split("\n"),r=[],i=Math.max(e-6,0),o=Math.min(e+6,n.length);for(let t=i;t<o;t++){const i=t+1;r.push(`${i===e?">":" "} ${i}: ${n[t]}`)}return r.join("\n")}(t.getShaderSource(e),r)}return i}function Aa(t,e){const n=function(t){switch(t){case ye:return["Linear","( value )"];case xe:return["sRGB","( value )"];default:return["Linear","( value )"]}}(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function Pa(t,e){let n;switch(e){case X:n="Linear";break;case Y:n="Reinhard";break;case q:n="OptimizedCineon";break;case Z:n="ACESFilmic";break;case J:n="Custom";break;default:n="Linear"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function Ca(t){return""!==t}function La(t,e){const n=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Ia(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Oa=/^[ \t]*#include +<([\w\d./]+)>/gm;function Na(t){return t.replace(Oa,Ra)}function Ra(t,e){const n=Bi[e];if(void 0===n)throw new Error("Can not resolve #include <"+e+">");return Na(n)}const Da=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function ka(t){return t.replace(Da,Fa)}function Fa(t,e,n,r){let i="";for(let t=parseInt(e);t<parseInt(n);t++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+t+" ]").replace(/UNROLLED_LOOP_INDEX/g,t);return i}function Ba(t){let e="precision "+t.precision+" float;\nprecision "+t.precision+" int;";return"highp"===t.precision?e+="\n#define HIGH_PRECISION":"mediump"===t.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(e+="\n#define LOW_PRECISION"),e}function Ua(t,e,n,r){const i=t.getContext(),o=n.defines;let l=n.vertexShader,c=n.fragmentShader;const h=function(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===a?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===s?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===u&&(e="SHADOWMAP_TYPE_VSM"),e}(n),p=function(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case Q:case $:e="ENVMAP_TYPE_CUBE";break;case nt:e="ENVMAP_TYPE_CUBE_UV"}return e}(n),f=function(t){let e="ENVMAP_MODE_REFLECTION";t.envMap&&t.envMapMode===$&&(e="ENVMAP_MODE_REFRACTION");return e}(n),d=function(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case G:e="ENVMAP_BLENDING_MULTIPLY";break;case j:e="ENVMAP_BLENDING_MIX";break;case W:e="ENVMAP_BLENDING_ADD"}return e}(n),m=function(t){const e=t.envMapCubeUVHeight;if(null===e)return null;const n=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:r,maxMip:n}}(n),g=n.isWebGL2?"":function(t){return[t.extensionDerivatives||t.envMapCubeUVHeight||t.bumpMap||t.tangentSpaceNormalMap||t.clearcoatNormalMap||t.flatShading||"physical"===t.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap||t.transmission)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Ca).join("\n")}(n),v=function(t){const e=[];for(const n in t){const r=t[n];!1!==r&&e.push("#define "+n+" "+r)}return e.join("\n")}(o),y=i.createProgram();let x,_,b=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(x=[v].filter(Ca).join("\n"),x.length>0&&(x+="\n"),_=[g,v].filter(Ca).join("\n"),_.length>0&&(_+="\n")):(x=[Ba(n),"#define SHADER_NAME "+n.shaderName,v,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+f:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphColors&&n.isWebGL2?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+h:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Ca).join("\n"),_=[g,Ba(n),"#define SHADER_NAME "+n.shaderName,v,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+p:"",n.envMap?"#define "+f:"",n.envMap?"#define "+d:"",m?"#define CUBEUV_TEXEL_WIDTH "+m.texelWidth:"",m?"#define CUBEUV_TEXEL_HEIGHT "+m.texelHeight:"",m?"#define CUBEUV_MAX_MIP "+m.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+h:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.useLegacyLights?"#define LEGACY_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==H?"#define TONE_MAPPING":"",n.toneMapping!==H?Bi.tonemapping_pars_fragment:"",n.toneMapping!==H?Pa("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",Bi.encodings_pars_fragment,Aa("linearToOutputTexel",n.outputEncoding),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(Ca).join("\n")),l=Na(l),l=La(l,n),l=Ia(l,n),c=Na(c),c=La(c,n),c=Ia(c,n),l=ka(l),c=ka(c),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(b="#version 300 es\n",x=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+x,_=["#define varying in",n.glslVersion===Pe?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===Pe?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+_);const w=b+x+l,M=b+_+c,S=Sa(i,i.VERTEX_SHADER,w),T=Sa(i,i.FRAGMENT_SHADER,M);if(i.attachShader(y,S),i.attachShader(y,T),void 0!==n.index0AttributeName?i.bindAttribLocation(y,0,n.index0AttributeName):!0===n.morphTargets&&i.bindAttribLocation(y,0,"position"),i.linkProgram(y),t.debug.checkShaderErrors){const t=i.getProgramInfoLog(y).trim(),e=i.getShaderInfoLog(S).trim(),n=i.getShaderInfoLog(T).trim();let r=!0,o=!0;if(!1===i.getProgramParameter(y,i.LINK_STATUS)){r=!1;Ea(i,S,"vertex"),Ea(i,T,"fragment")}else""!==t||""!==e&&""!==n||(o=!1);o&&(this.diagnostics={runnable:r,programLog:t,vertexShader:{log:e,prefix:x},fragmentShader:{log:n,prefix:_}})}let E,A;return i.deleteShader(S),i.deleteShader(T),this.getUniforms=function(){return void 0===E&&(E=new Ma(i,y)),E},this.getAttributes=function(){return void 0===A&&(A=function(t,e){const n={},r=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const r=t.getActiveAttrib(e,i),o=r.name;let a=1;r.type===t.FLOAT_MAT2&&(a=2),r.type===t.FLOAT_MAT3&&(a=3),r.type===t.FLOAT_MAT4&&(a=4),n[o]={type:r.type,location:t.getAttribLocation(e,o),locationSize:a}}return n}(i,y)),A},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(y),this.program=void 0},this.name=n.shaderName,this.id=Ta++,this.cacheKey=e,this.usedTimes=1,this.program=y,this.vertexShader=S,this.fragmentShader=T,this}let za=0;class Va{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(t){const e=t.vertexShader,n=t.fragmentShader,r=this._getShaderStage(e),i=this._getShaderStage(n),o=this._getShaderCacheForMaterial(t);return!1===o.has(r)&&(o.add(r),r.usedTimes++),!1===o.has(i)&&(o.add(i),i.usedTimes++),this}remove(t){const e=this.materialCache.get(t);for(const t of e)t.usedTimes--,0===t.usedTimes&&this.shaderCache.delete(t.code);return this.materialCache.delete(t),this}getVertexShaderID(t){return this._getShaderStage(t.vertexShader).id}getFragmentShaderID(t){return this._getShaderStage(t.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(t){const e=this.materialCache;let n=e.get(t);return void 0===n&&(n=new Set,e.set(t,n)),n}_getShaderStage(t){const e=this.shaderCache;let n=e.get(t);return void 0===n&&(n=new Ga(t),e.set(t,n)),n}}class Ga{constructor(t){this.id=za++,this.code=t,this.usedTimes=0}}function ja(t,e,n,r,i,o,a){const s=new or,u=new Va,l=[],p=i.isWebGL2,d=i.logarithmicDepthBuffer,m=i.vertexTextures;let g=i.precision;const v={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function(o,s,l,y,x){const _=y.fog,b=x.geometry,w=o.isMeshStandardMaterial?y.environment:null,M=(o.isMeshStandardMaterial?n:e).get(o.envMap||w),S=M&&M.mapping===nt?M.image.height:null,T=v[o.type];null!==o.precision&&(g=i.getMaxPrecision(o.precision),o.precision);const E=b.morphAttributes.position||b.morphAttributes.normal||b.morphAttributes.color,A=void 0!==E?E.length:0;let P,C,L,I,O=0;if(void 0!==b.morphAttributes.position&&(O=1),void 0!==b.morphAttributes.normal&&(O=2),void 0!==b.morphAttributes.color&&(O=3),T){const t=zi[T];P=t.vertexShader,C=t.fragmentShader}else P=o.vertexShader,C=o.fragmentShader,u.update(o),L=u.getVertexShaderID(o),I=u.getFragmentShaderID(o);const N=t.getRenderTarget(),R=o.alphaTest>0,D=o.clearcoat>0,k=o.iridescence>0;return{isWebGL2:p,shaderID:T,shaderName:o.type,vertexShader:P,fragmentShader:C,defines:o.defines,customVertexShaderID:L,customFragmentShaderID:I,isRawShaderMaterial:!0===o.isRawShaderMaterial,glslVersion:o.glslVersion,precision:g,instancing:!0===x.isInstancedMesh,instancingColor:!0===x.isInstancedMesh&&null!==x.instanceColor,supportsVertexTextures:m,outputEncoding:null===N?t.outputEncoding:!0===N.isXRRenderTarget?N.texture.encoding:ye,map:!!o.map,matcap:!!o.matcap,envMap:!!M,envMapMode:M&&M.mapping,envMapCubeUVHeight:S,lightMap:!!o.lightMap,aoMap:!!o.aoMap,emissiveMap:!!o.emissiveMap,bumpMap:!!o.bumpMap,normalMap:!!o.normalMap,objectSpaceNormalMap:o.normalMapType===we,tangentSpaceNormalMap:o.normalMapType===be,decodeVideoTexture:!!o.map&&!0===o.map.isVideoTexture&&o.map.encoding===xe,clearcoat:D,clearcoatMap:D&&!!o.clearcoatMap,clearcoatRoughnessMap:D&&!!o.clearcoatRoughnessMap,clearcoatNormalMap:D&&!!o.clearcoatNormalMap,iridescence:k,iridescenceMap:k&&!!o.iridescenceMap,iridescenceThicknessMap:k&&!!o.iridescenceThicknessMap,displacementMap:!!o.displacementMap,roughnessMap:!!o.roughnessMap,metalnessMap:!!o.metalnessMap,specularMap:!!o.specularMap,specularIntensityMap:!!o.specularIntensityMap,specularColorMap:!!o.specularColorMap,opaque:!1===o.transparent&&o.blending===f,alphaMap:!!o.alphaMap,alphaTest:R,gradientMap:!!o.gradientMap,sheen:o.sheen>0,sheenColorMap:!!o.sheenColorMap,sheenRoughnessMap:!!o.sheenRoughnessMap,transmission:o.transmission>0,transmissionMap:!!o.transmissionMap,thicknessMap:!!o.thicknessMap,combine:o.combine,vertexTangents:!!o.normalMap&&!!b.attributes.tangent,vertexColors:o.vertexColors,vertexAlphas:!0===o.vertexColors&&!!b.attributes.color&&4===b.attributes.color.itemSize,vertexUvs:!!(o.map||o.bumpMap||o.normalMap||o.specularMap||o.alphaMap||o.emissiveMap||o.roughnessMap||o.metalnessMap||o.clearcoatMap||o.clearcoatRoughnessMap||o.clearcoatNormalMap||o.iridescenceMap||o.iridescenceThicknessMap||o.displacementMap||o.transmissionMap||o.thicknessMap||o.specularIntensityMap||o.specularColorMap||o.sheenColorMap||o.sheenRoughnessMap),uvsVertexOnly:!(o.map||o.bumpMap||o.normalMap||o.specularMap||o.alphaMap||o.emissiveMap||o.roughnessMap||o.metalnessMap||o.clearcoatNormalMap||o.iridescenceMap||o.iridescenceThicknessMap||o.transmission>0||o.transmissionMap||o.thicknessMap||o.specularIntensityMap||o.specularColorMap||o.sheen>0||o.sheenColorMap||o.sheenRoughnessMap||!o.displacementMap),fog:!!_,useFog:!0===o.fog,fogExp2:_&&_.isFogExp2,flatShading:!!o.flatShading,sizeAttenuation:o.sizeAttenuation,logarithmicDepthBuffer:d,skinning:!0===x.isSkinnedMesh,morphTargets:void 0!==b.morphAttributes.position,morphNormals:void 0!==b.morphAttributes.normal,morphColors:void 0!==b.morphAttributes.color,morphTargetsCount:A,morphTextureStride:O,numDirLights:s.directional.length,numPointLights:s.point.length,numSpotLights:s.spot.length,numSpotLightMaps:s.spotLightMap.length,numRectAreaLights:s.rectArea.length,numHemiLights:s.hemi.length,numDirLightShadows:s.directionalShadowMap.length,numPointLightShadows:s.pointShadowMap.length,numSpotLightShadows:s.spotShadowMap.length,numSpotLightShadowsWithMaps:s.numSpotLightShadowsWithMaps,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:o.dithering,shadowMapEnabled:t.shadowMap.enabled&&l.length>0,shadowMapType:t.shadowMap.type,toneMapping:o.toneMapped?t.toneMapping:H,useLegacyLights:t.useLegacyLights,premultipliedAlpha:o.premultipliedAlpha,doubleSided:o.side===h,flipSided:o.side===c,useDepthPacking:!!o.depthPacking,depthPacking:o.depthPacking||0,index0AttributeName:o.index0AttributeName,extensionDerivatives:o.extensions&&o.extensions.derivatives,extensionFragDepth:o.extensions&&o.extensions.fragDepth,extensionDrawBuffers:o.extensions&&o.extensions.drawBuffers,extensionShaderTextureLOD:o.extensions&&o.extensions.shaderTextureLOD,rendererExtensionFragDepth:p||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:p||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:p||r.has("EXT_shader_texture_lod"),customProgramCacheKey:o.customProgramCacheKey()}},getProgramCacheKey:function(e){const n=[];if(e.shaderID?n.push(e.shaderID):(n.push(e.customVertexShaderID),n.push(e.customFragmentShaderID)),void 0!==e.defines)for(const t in e.defines)n.push(t),n.push(e.defines[t]);return!1===e.isRawShaderMaterial&&(!function(t,e){t.push(e.precision),t.push(e.outputEncoding),t.push(e.envMapMode),t.push(e.envMapCubeUVHeight),t.push(e.combine),t.push(e.vertexUvs),t.push(e.fogExp2),t.push(e.sizeAttenuation),t.push(e.morphTargetsCount),t.push(e.morphAttributeCount),t.push(e.numDirLights),t.push(e.numPointLights),t.push(e.numSpotLights),t.push(e.numSpotLightMaps),t.push(e.numHemiLights),t.push(e.numRectAreaLights),t.push(e.numDirLightShadows),t.push(e.numPointLightShadows),t.push(e.numSpotLightShadows),t.push(e.numSpotLightShadowsWithMaps),t.push(e.shadowMapType),t.push(e.toneMapping),t.push(e.numClippingPlanes),t.push(e.numClipIntersection),t.push(e.depthPacking)}(n,e),function(t,e){s.disableAll(),e.isWebGL2&&s.enable(0);e.supportsVertexTextures&&s.enable(1);e.instancing&&s.enable(2);e.instancingColor&&s.enable(3);e.map&&s.enable(4);e.matcap&&s.enable(5);e.envMap&&s.enable(6);e.lightMap&&s.enable(7);e.aoMap&&s.enable(8);e.emissiveMap&&s.enable(9);e.bumpMap&&s.enable(10);e.normalMap&&s.enable(11);e.objectSpaceNormalMap&&s.enable(12);e.tangentSpaceNormalMap&&s.enable(13);e.clearcoat&&s.enable(14);e.clearcoatMap&&s.enable(15);e.clearcoatRoughnessMap&&s.enable(16);e.clearcoatNormalMap&&s.enable(17);e.iridescence&&s.enable(18);e.iridescenceMap&&s.enable(19);e.iridescenceThicknessMap&&s.enable(20);e.displacementMap&&s.enable(21);e.specularMap&&s.enable(22);e.roughnessMap&&s.enable(23);e.metalnessMap&&s.enable(24);e.gradientMap&&s.enable(25);e.alphaMap&&s.enable(26);e.alphaTest&&s.enable(27);e.vertexColors&&s.enable(28);e.vertexAlphas&&s.enable(29);e.vertexUvs&&s.enable(30);e.vertexTangents&&s.enable(31);e.uvsVertexOnly&&s.enable(32);t.push(s.mask),s.disableAll(),e.fog&&s.enable(0);e.useFog&&s.enable(1);e.flatShading&&s.enable(2);e.logarithmicDepthBuffer&&s.enable(3);e.skinning&&s.enable(4);e.morphTargets&&s.enable(5);e.morphNormals&&s.enable(6);e.morphColors&&s.enable(7);e.premultipliedAlpha&&s.enable(8);e.shadowMapEnabled&&s.enable(9);e.useLegacyLights&&s.enable(10);e.doubleSided&&s.enable(11);e.flipSided&&s.enable(12);e.useDepthPacking&&s.enable(13);e.dithering&&s.enable(14);e.specularIntensityMap&&s.enable(15);e.specularColorMap&&s.enable(16);e.transmission&&s.enable(17);e.transmissionMap&&s.enable(18);e.thicknessMap&&s.enable(19);e.sheen&&s.enable(20);e.sheenColorMap&&s.enable(21);e.sheenRoughnessMap&&s.enable(22);e.decodeVideoTexture&&s.enable(23);e.opaque&&s.enable(24);t.push(s.mask)}(n,e),n.push(t.outputEncoding)),n.push(e.customProgramCacheKey),n.join()},getUniforms:function(t){const e=v[t.type];let n;if(e){const t=zi[e];n=_i.clone(t.uniforms)}else n=t.uniforms;return n},acquireProgram:function(e,n){let r;for(let t=0,e=l.length;t<e;t++){const e=l[t];if(e.cacheKey===n){r=e,++r.usedTimes;break}}return void 0===r&&(r=new Ua(t,n,e,o),l.push(r)),r},releaseProgram:function(t){if(0==--t.usedTimes){const e=l.indexOf(t);l[e]=l[l.length-1],l.pop(),t.destroy()}},releaseShaderCache:function(t){u.remove(t)},programs:l,dispose:function(){u.dispose()}}}function Wa(){let t=new WeakMap;return{get:function(e){let n=t.get(e);return void 0===n&&(n={},t.set(e,n)),n},remove:function(e){t.delete(e)},update:function(e,n,r){t.get(e)[n]=r},dispose:function(){t=new WeakMap}}}function Ha(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function Xa(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function Ya(){const t=[];let e=0;const n=[],r=[],i=[];function o(n,r,i,o,a,s){let u=t[e];return void 0===u?(u={id:n.id,object:n,geometry:r,material:i,groupOrder:o,renderOrder:n.renderOrder,z:a,group:s},t[e]=u):(u.id=n.id,u.object=n,u.geometry=r,u.material=i,u.groupOrder=o,u.renderOrder=n.renderOrder,u.z=a,u.group=s),e++,u}return{opaque:n,transmissive:r,transparent:i,init:function(){e=0,n.length=0,r.length=0,i.length=0},push:function(t,e,a,s,u,l){const c=o(t,e,a,s,u,l);a.transmission>0?r.push(c):!0===a.transparent?i.push(c):n.push(c)},unshift:function(t,e,a,s,u,l){const c=o(t,e,a,s,u,l);a.transmission>0?r.unshift(c):!0===a.transparent?i.unshift(c):n.unshift(c)},finish:function(){for(let n=e,r=t.length;n<r;n++){const e=t[n];if(null===e.id)break;e.id=null,e.object=null,e.geometry=null,e.material=null,e.group=null}},sort:function(t,e){n.length>1&&n.sort(t||Ha),r.length>1&&r.sort(e||Xa),i.length>1&&i.sort(e||Xa)}}}function qa(){let t=new WeakMap;return{get:function(e,n){const r=t.get(e);let i;return void 0===r?(i=new Ya,t.set(e,[i])):n>=r.length?(i=new Ya,r.push(i)):i=r[n],i},dispose:function(){t=new WeakMap}}}function Za(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new $e,color:new Fr};break;case"SpotLight":n={position:new $e,direction:new $e,color:new Fr,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new $e,color:new Fr,distance:0,decay:0};break;case"HemisphereLight":n={direction:new $e,skyColor:new Fr,groundColor:new Fr};break;case"RectAreaLight":n={color:new Fr,position:new $e,halfWidth:new $e,halfHeight:new $e}}return t[e.id]=n,n}}}let Ja=0;function Ka(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function Qa(t,e){const n=new Za,r=function(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let n;switch(e.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new He};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new He,shadowCameraNear:1,shadowCameraFar:1e3}}return t[e.id]=n,n}}}(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let t=0;t<9;t++)i.probe.push(new $e);const o=new $e,a=new qn,s=new qn;return{setup:function(o,a){let s=0,u=0,l=0;for(let t=0;t<9;t++)i.probe[t].set(0,0,0);let c=0,h=0,p=0,f=0,d=0,m=0,g=0,v=0,y=0,x=0;o.sort(Ka);const _=!0===a?Math.PI:1;for(let t=0,e=o.length;t<e;t++){const e=o[t],a=e.color,b=e.intensity,w=e.distance,M=e.shadow&&e.shadow.map?e.shadow.map.texture:null;if(e.isAmbientLight)s+=a.r*b*_,u+=a.g*b*_,l+=a.b*b*_;else if(e.isLightProbe)for(let t=0;t<9;t++)i.probe[t].addScaledVector(e.sh.coefficients[t],b);else if(e.isDirectionalLight){const t=n.get(e);if(t.color.copy(e.color).multiplyScalar(e.intensity*_),e.castShadow){const t=e.shadow,n=r.get(e);n.shadowBias=t.bias,n.shadowNormalBias=t.normalBias,n.shadowRadius=t.radius,n.shadowMapSize=t.mapSize,i.directionalShadow[c]=n,i.directionalShadowMap[c]=M,i.directionalShadowMatrix[c]=e.shadow.matrix,m++}i.directional[c]=t,c++}else if(e.isSpotLight){const t=n.get(e);t.position.setFromMatrixPosition(e.matrixWorld),t.color.copy(a).multiplyScalar(b*_),t.distance=w,t.coneCos=Math.cos(e.angle),t.penumbraCos=Math.cos(e.angle*(1-e.penumbra)),t.decay=e.decay,i.spot[p]=t;const o=e.shadow;if(e.map&&(i.spotLightMap[y]=e.map,y++,o.updateMatrices(e),e.castShadow&&x++),i.spotLightMatrix[p]=o.matrix,e.castShadow){const t=r.get(e);t.shadowBias=o.bias,t.shadowNormalBias=o.normalBias,t.shadowRadius=o.radius,t.shadowMapSize=o.mapSize,i.spotShadow[p]=t,i.spotShadowMap[p]=M,v++}p++}else if(e.isRectAreaLight){const t=n.get(e);t.color.copy(a).multiplyScalar(b),t.halfWidth.set(.5*e.width,0,0),t.halfHeight.set(0,.5*e.height,0),i.rectArea[f]=t,f++}else if(e.isPointLight){const t=n.get(e);if(t.color.copy(e.color).multiplyScalar(e.intensity*_),t.distance=e.distance,t.decay=e.decay,e.castShadow){const t=e.shadow,n=r.get(e);n.shadowBias=t.bias,n.shadowNormalBias=t.normalBias,n.shadowRadius=t.radius,n.shadowMapSize=t.mapSize,n.shadowCameraNear=t.camera.near,n.shadowCameraFar=t.camera.far,i.pointShadow[h]=n,i.pointShadowMap[h]=M,i.pointShadowMatrix[h]=e.shadow.matrix,g++}i.point[h]=t,h++}else if(e.isHemisphereLight){const t=n.get(e);t.skyColor.copy(e.color).multiplyScalar(b*_),t.groundColor.copy(e.groundColor).multiplyScalar(b*_),i.hemi[d]=t,d++}}f>0&&(e.isWebGL2||!0===t.has("OES_texture_float_linear")?(i.rectAreaLTC1=Ui.LTC_FLOAT_1,i.rectAreaLTC2=Ui.LTC_FLOAT_2):!0===t.has("OES_texture_half_float_linear")&&(i.rectAreaLTC1=Ui.LTC_HALF_1,i.rectAreaLTC2=Ui.LTC_HALF_2)),i.ambient[0]=s,i.ambient[1]=u,i.ambient[2]=l;const b=i.hash;b.directionalLength===c&&b.pointLength===h&&b.spotLength===p&&b.rectAreaLength===f&&b.hemiLength===d&&b.numDirectionalShadows===m&&b.numPointShadows===g&&b.numSpotShadows===v&&b.numSpotMaps===y||(i.directional.length=c,i.spot.length=p,i.rectArea.length=f,i.point.length=h,i.hemi.length=d,i.directionalShadow.length=m,i.directionalShadowMap.length=m,i.pointShadow.length=g,i.pointShadowMap.length=g,i.spotShadow.length=v,i.spotShadowMap.length=v,i.directionalShadowMatrix.length=m,i.pointShadowMatrix.length=g,i.spotLightMatrix.length=v+y-x,i.spotLightMap.length=y,i.numSpotLightShadowsWithMaps=x,b.directionalLength=c,b.pointLength=h,b.spotLength=p,b.rectAreaLength=f,b.hemiLength=d,b.numDirectionalShadows=m,b.numPointShadows=g,b.numSpotShadows=v,b.numSpotMaps=y,i.version=Ja++)},setupView:function(t,e){let n=0,r=0,u=0,l=0,c=0;const h=e.matrixWorldInverse;for(let e=0,p=t.length;e<p;e++){const p=t[e];if(p.isDirectionalLight){const t=i.directional[n];t.direction.setFromMatrixPosition(p.matrixWorld),o.setFromMatrixPosition(p.target.matrixWorld),t.direction.sub(o),t.direction.transformDirection(h),n++}else if(p.isSpotLight){const t=i.spot[u];t.position.setFromMatrixPosition(p.matrixWorld),t.position.applyMatrix4(h),t.direction.setFromMatrixPosition(p.matrixWorld),o.setFromMatrixPosition(p.target.matrixWorld),t.direction.sub(o),t.direction.transformDirection(h),u++}else if(p.isRectAreaLight){const t=i.rectArea[l];t.position.setFromMatrixPosition(p.matrixWorld),t.position.applyMatrix4(h),s.identity(),a.copy(p.matrixWorld),a.premultiply(h),s.extractRotation(a),t.halfWidth.set(.5*p.width,0,0),t.halfHeight.set(0,.5*p.height,0),t.halfWidth.applyMatrix4(s),t.halfHeight.applyMatrix4(s),l++}else if(p.isPointLight){const t=i.point[r];t.position.setFromMatrixPosition(p.matrixWorld),t.position.applyMatrix4(h),r++}else if(p.isHemisphereLight){const t=i.hemi[c];t.direction.setFromMatrixPosition(p.matrixWorld),t.direction.transformDirection(h),c++}}},state:i}}function $a(t,e){const n=new Qa(t,e),r=[],i=[];return{init:function(){r.length=0,i.length=0},state:{lightsArray:r,shadowsArray:i,lights:n},setupLights:function(t){n.setup(r,t)},setupLightsView:function(t){n.setupView(r,t)},pushLight:function(t){r.push(t)},pushShadow:function(t){i.push(t)}}}function ts(t,e){let n=new WeakMap;return{get:function(r,i=0){const o=n.get(r);let a;return void 0===o?(a=new $a(t,e),n.set(r,[a])):i>=o.length?(a=new $a(t,e),o.push(a)):a=o[i],a},dispose:function(){n=new WeakMap}}}class es extends Or{constructor(t){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}}class ns extends Or{constructor(t){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new $e,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(t)}copy(t){return super.copy(t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}}const rs="void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",is="uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}";function os(t,e,n){let r=new Ri;const i=new He,o=new He,s=new vn,f=new es({depthPacking:_e}),d=new ns,m={},g=n.maxTextureSize,v={[l]:c,[c]:l,[h]:h},y=new bi({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new He},radius:{value:4}},vertexShader:rs,fragmentShader:is}),x=y.clone();x.defines.HORIZONTAL_PASS=1;const _=new $r;_.setAttribute("position",new Gr(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const b=new di(_,y),w=this;function M(n,r){const o=e.update(b);y.defines.VSM_SAMPLES!==n.blurSamples&&(y.defines.VSM_SAMPLES=n.blurSamples,x.defines.VSM_SAMPLES=n.blurSamples,y.needsUpdate=!0,x.needsUpdate=!0),null===n.mapPass&&(n.mapPass=new yn(i.x,i.y)),y.uniforms.shadow_pass.value=n.map.texture,y.uniforms.resolution.value=n.mapSize,y.uniforms.radius.value=n.radius,t.setRenderTarget(n.mapPass),t.clear(),t.renderBufferDirect(r,null,o,y,b,null),x.uniforms.shadow_pass.value=n.mapPass.texture,x.uniforms.resolution.value=n.mapSize,x.uniforms.radius.value=n.radius,t.setRenderTarget(n.map),t.clear(),t.renderBufferDirect(r,null,o,x,b,null)}function S(e,n,r,i,o,a){let s=null;const l=!0===r.isPointLight?e.customDistanceMaterial:e.customDepthMaterial;if(void 0!==l)s=l;else if(s=!0===r.isPointLight?d:f,t.localClippingEnabled&&!0===n.clipShadows&&Array.isArray(n.clippingPlanes)&&0!==n.clippingPlanes.length||n.displacementMap&&0!==n.displacementScale||n.alphaMap&&n.alphaTest>0||n.map&&n.alphaTest>0){const t=s.uuid,e=n.uuid;let r=m[t];void 0===r&&(r={},m[t]=r);let i=r[e];void 0===i&&(i=s.clone(),r[e]=i),s=i}return s.visible=n.visible,s.wireframe=n.wireframe,s.side=a===u?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:v[n.side],s.alphaMap=n.alphaMap,s.alphaTest=n.alphaTest,s.map=n.map,s.clipShadows=n.clipShadows,s.clippingPlanes=n.clippingPlanes,s.clipIntersection=n.clipIntersection,s.displacementMap=n.displacementMap,s.displacementScale=n.displacementScale,s.displacementBias=n.displacementBias,s.wireframeLinewidth=n.wireframeLinewidth,s.linewidth=n.linewidth,!0===r.isPointLight&&!0===s.isMeshDistanceMaterial&&(s.referencePosition.setFromMatrixPosition(r.matrixWorld),s.nearDistance=i,s.farDistance=o),s}function T(n,i,o,a,s){if(!1===n.visible)return;if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&s===u)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,n.matrixWorld);const r=e.update(n),i=n.material;if(Array.isArray(i)){const e=r.groups;for(let u=0,l=e.length;u<l;u++){const l=e[u],c=i[l.materialIndex];if(c&&c.visible){const e=S(n,c,a,o.near,o.far,s);t.renderBufferDirect(o,null,r,e,n,l)}}}else if(i.visible){const e=S(n,i,a,o.near,o.far,s);t.renderBufferDirect(o,null,r,e,n,null)}}const l=n.children;for(let t=0,e=l.length;t<e;t++)T(l[t],i,o,a,s)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=a,this.render=function(e,n,a){if(!1===w.enabled)return;if(!1===w.autoUpdate&&!1===w.needsUpdate)return;if(0===e.length)return;const l=t.getRenderTarget(),c=t.getActiveCubeFace(),h=t.getActiveMipmapLevel(),f=t.state;f.setBlending(p),f.buffers.color.setClear(1,1,1,1),f.buffers.depth.setTest(!0),f.setScissorTest(!1);for(let l=0,c=e.length;l<c;l++){const c=e[l],h=c.shadow;if(void 0===h)continue;if(!1===h.autoUpdate&&!1===h.needsUpdate)continue;i.copy(h.mapSize);const p=h.getFrameExtents();if(i.multiply(p),o.copy(h.mapSize),(i.x>g||i.y>g)&&(i.x>g&&(o.x=Math.floor(g/p.x),i.x=o.x*p.x,h.mapSize.x=o.x),i.y>g&&(o.y=Math.floor(g/p.y),i.y=o.y*p.y,h.mapSize.y=o.y)),null===h.map){const t=this.type!==u?{minFilter:at,magFilter:at}:{};h.map=new yn(i.x,i.y,t),h.map.texture.name=c.name+".shadowMap",h.camera.updateProjectionMatrix()}t.setRenderTarget(h.map),t.clear();const d=h.getViewportCount();for(let t=0;t<d;t++){const e=h.getViewport(t);s.set(o.x*e.x,o.y*e.y,o.x*e.z,o.y*e.w),f.viewport(s),h.updateMatrices(c,t),r=h.getFrustum(),T(n,a,h.camera,c,this.type)}!0!==h.isPointLightShadow&&this.type===u&&M(h,a),h.needsUpdate=!1}w.needsUpdate=!1,t.setRenderTarget(l,c,h)}}function as(t,e,n){const a=n.isWebGL2;const s=new function(){let e=!1;const n=new vn;let r=null;const i=new vn(0,0,0,0);return{setMask:function(n){r===n||e||(t.colorMask(n,n,n,n),r=n)},setLocked:function(t){e=t},setClear:function(e,r,o,a,s){!0===s&&(e*=a,r*=a,o*=a),n.set(e,r,o,a),!1===i.equals(n)&&(t.clearColor(e,r,o,a),i.copy(n))},reset:function(){e=!1,r=null,i.set(-1,0,0,0)}}},u=new function(){let e=!1,n=null,r=null,i=null;return{setTest:function(e){e?bt(t.DEPTH_TEST):wt(t.DEPTH_TEST)},setMask:function(r){n===r||e||(t.depthMask(r),n=r)},setFunc:function(e){if(r!==e){switch(e){case R:t.depthFunc(t.NEVER);break;case D:t.depthFunc(t.ALWAYS);break;case k:t.depthFunc(t.LESS);break;case F:t.depthFunc(t.LEQUAL);break;case B:t.depthFunc(t.EQUAL);break;case U:t.depthFunc(t.GEQUAL);break;case z:t.depthFunc(t.GREATER);break;case V:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}r=e}},setLocked:function(t){e=t},setClear:function(e){i!==e&&(t.clearDepth(e),i=e)},reset:function(){e=!1,n=null,r=null,i=null}}},l=new function(){let e=!1,n=null,r=null,i=null,o=null,a=null,s=null,u=null,l=null;return{setTest:function(n){e||(n?bt(t.STENCIL_TEST):wt(t.STENCIL_TEST))},setMask:function(r){n===r||e||(t.stencilMask(r),n=r)},setFunc:function(e,n,a){r===e&&i===n&&o===a||(t.stencilFunc(e,n,a),r=e,i=n,o=a)},setOp:function(e,n,r){a===e&&s===n&&u===r||(t.stencilOp(e,n,r),a=e,s=n,u=r)},setLocked:function(t){e=t},setClear:function(e){l!==e&&(t.clearStencil(e),l=e)},reset:function(){e=!1,n=null,r=null,i=null,o=null,a=null,s=null,u=null,l=null}}},G=new WeakMap,j=new WeakMap;let W={},H={},X=new WeakMap,Y=[],q=null,Z=!1,J=null,K=null,Q=null,$=null,tt=null,et=null,nt=null,rt=!1,it=null,ot=null,at=null,st=null,ut=null;const lt=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let ct=!1,ht=0;const pt=t.getParameter(t.VERSION);-1!==pt.indexOf("WebGL")?(ht=parseFloat(/^WebGL (\d)/.exec(pt)[1]),ct=ht>=1):-1!==pt.indexOf("OpenGL ES")&&(ht=parseFloat(/^OpenGL ES (\d)/.exec(pt)[1]),ct=ht>=2);let ft=null,dt={};const mt=t.getParameter(t.SCISSOR_BOX),gt=t.getParameter(t.VIEWPORT),vt=(new vn).fromArray(mt),yt=(new vn).fromArray(gt);function xt(e,n,r){const i=new Uint8Array(4),o=t.createTexture();t.bindTexture(e,o),t.texParameteri(e,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(e,t.TEXTURE_MAG_FILTER,t.NEAREST);for(let e=0;e<r;e++)t.texImage2D(n+e,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,i);return o}const _t={};function bt(e){!0!==W[e]&&(t.enable(e),W[e]=!0)}function wt(e){!1!==W[e]&&(t.disable(e),W[e]=!1)}_t[t.TEXTURE_2D]=xt(t.TEXTURE_2D,t.TEXTURE_2D,1),_t[t.TEXTURE_CUBE_MAP]=xt(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),s.setClear(0,0,0,1),u.setClear(1),l.setClear(0),bt(t.DEPTH_TEST),u.setFunc(F),Et(!1),At(i),bt(t.CULL_FACE),Tt(p);const Mt={[y]:t.FUNC_ADD,[x]:t.FUNC_SUBTRACT,[_]:t.FUNC_REVERSE_SUBTRACT};if(a)Mt[b]=t.MIN,Mt[w]=t.MAX;else{const t=e.get("EXT_blend_minmax");null!==t&&(Mt[b]=t.MIN_EXT,Mt[w]=t.MAX_EXT)}const St={[M]:t.ZERO,[S]:t.ONE,[T]:t.SRC_COLOR,[A]:t.SRC_ALPHA,[N]:t.SRC_ALPHA_SATURATE,[I]:t.DST_COLOR,[C]:t.DST_ALPHA,[E]:t.ONE_MINUS_SRC_COLOR,[P]:t.ONE_MINUS_SRC_ALPHA,[O]:t.ONE_MINUS_DST_COLOR,[L]:t.ONE_MINUS_DST_ALPHA};function Tt(e,n,r,i,o,a,s,u){if(e!==p){if(!1===Z&&(bt(t.BLEND),Z=!0),e===v)o=o||n,a=a||r,s=s||i,n===K&&o===tt||(t.blendEquationSeparate(Mt[n],Mt[o]),K=n,tt=o),r===Q&&i===$&&a===et&&s===nt||(t.blendFuncSeparate(St[r],St[i],St[a],St[s]),Q=r,$=i,et=a,nt=s),J=e,rt=!1;else if(e!==J||u!==rt){if(K===y&&tt===y||(t.blendEquation(t.FUNC_ADD),K=y,tt=y),u)switch(e){case f:t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case d:t.blendFunc(t.ONE,t.ONE);break;case m:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case g:t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA)}else switch(e){case f:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case d:t.blendFunc(t.SRC_ALPHA,t.ONE);break;case m:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case g:t.blendFunc(t.ZERO,t.SRC_COLOR)}Q=null,$=null,et=null,nt=null,J=e,rt=u}}else!0===Z&&(wt(t.BLEND),Z=!1)}function Et(e){it!==e&&(e?t.frontFace(t.CW):t.frontFace(t.CCW),it=e)}function At(e){e!==r?(bt(t.CULL_FACE),e!==ot&&(e===i?t.cullFace(t.BACK):e===o?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):wt(t.CULL_FACE),ot=e}function Pt(e,n,r){e?(bt(t.POLYGON_OFFSET_FILL),st===n&&ut===r||(t.polygonOffset(n,r),st=n,ut=r)):wt(t.POLYGON_OFFSET_FILL)}return{buffers:{color:s,depth:u,stencil:l},enable:bt,disable:wt,bindFramebuffer:function(e,n){return H[e]!==n&&(t.bindFramebuffer(e,n),H[e]=n,a&&(e===t.DRAW_FRAMEBUFFER&&(H[t.FRAMEBUFFER]=n),e===t.FRAMEBUFFER&&(H[t.DRAW_FRAMEBUFFER]=n)),!0)},drawBuffers:function(r,i){let o=Y,a=!1;if(r)if(o=X.get(i),void 0===o&&(o=[],X.set(i,o)),r.isWebGLMultipleRenderTargets){const e=r.texture;if(o.length!==e.length||o[0]!==t.COLOR_ATTACHMENT0){for(let n=0,r=e.length;n<r;n++)o[n]=t.COLOR_ATTACHMENT0+n;o.length=e.length,a=!0}}else o[0]!==t.COLOR_ATTACHMENT0&&(o[0]=t.COLOR_ATTACHMENT0,a=!0);else o[0]!==t.BACK&&(o[0]=t.BACK,a=!0);a&&(n.isWebGL2?t.drawBuffers(o):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(o))},useProgram:function(e){return q!==e&&(t.useProgram(e),q=e,!0)},setBlending:Tt,setMaterial:function(e,n){e.side===h?wt(t.CULL_FACE):bt(t.CULL_FACE);let r=e.side===c;n&&(r=!r),Et(r),e.blending===f&&!1===e.transparent?Tt(p):Tt(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),u.setFunc(e.depthFunc),u.setTest(e.depthTest),u.setMask(e.depthWrite),s.setMask(e.colorWrite);const i=e.stencilWrite;l.setTest(i),i&&(l.setMask(e.stencilWriteMask),l.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),l.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),Pt(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),!0===e.alphaToCoverage?bt(t.SAMPLE_ALPHA_TO_COVERAGE):wt(t.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:Et,setCullFace:At,setLineWidth:function(e){e!==at&&(ct&&t.lineWidth(e),at=e)},setPolygonOffset:Pt,setScissorTest:function(e){e?bt(t.SCISSOR_TEST):wt(t.SCISSOR_TEST)},activeTexture:function(e){void 0===e&&(e=t.TEXTURE0+lt-1),ft!==e&&(t.activeTexture(e),ft=e)},bindTexture:function(e,n,r){void 0===r&&(r=null===ft?t.TEXTURE0+lt-1:ft);let i=dt[r];void 0===i&&(i={type:void 0,texture:void 0},dt[r]=i),i.type===e&&i.texture===n||(ft!==r&&(t.activeTexture(r),ft=r),t.bindTexture(e,n||_t[e]),i.type=e,i.texture=n)},unbindTexture:function(){const e=dt[ft];void 0!==e&&void 0!==e.type&&(t.bindTexture(e.type,null),e.type=void 0,e.texture=void 0)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){}},compressedTexImage3D:function(){try{t.compressedTexImage3D.apply(t,arguments)}catch(t){}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(t){}},texImage3D:function(){try{t.texImage3D.apply(t,arguments)}catch(t){}},updateUBOMapping:function(e,n){let r=j.get(n);void 0===r&&(r=new WeakMap,j.set(n,r));let i=r.get(e);void 0===i&&(i=t.getUniformBlockIndex(n,e.name),r.set(e,i))},uniformBlockBinding:function(e,n){const r=j.get(n).get(e);G.get(n)!==r&&(t.uniformBlockBinding(n,r,e.__bindingPointIndex),G.set(n,r))},texStorage2D:function(){try{t.texStorage2D.apply(t,arguments)}catch(t){}},texStorage3D:function(){try{t.texStorage3D.apply(t,arguments)}catch(t){}},texSubImage2D:function(){try{t.texSubImage2D.apply(t,arguments)}catch(t){}},texSubImage3D:function(){try{t.texSubImage3D.apply(t,arguments)}catch(t){}},compressedTexSubImage2D:function(){try{t.compressedTexSubImage2D.apply(t,arguments)}catch(t){}},compressedTexSubImage3D:function(){try{t.compressedTexSubImage3D.apply(t,arguments)}catch(t){}},scissor:function(e){!1===vt.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),vt.copy(e))},viewport:function(e){!1===yt.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),yt.copy(e))},reset:function(){t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SCISSOR_TEST),t.disable(t.STENCIL_TEST),t.disable(t.SAMPLE_ALPHA_TO_COVERAGE),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.blendFuncSeparate(t.ONE,t.ZERO,t.ONE,t.ZERO),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(t.LESS),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.clearStencil(0),t.cullFace(t.BACK),t.frontFace(t.CCW),t.polygonOffset(0,0),t.activeTexture(t.TEXTURE0),t.bindFramebuffer(t.FRAMEBUFFER,null),!0===a&&(t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.bindFramebuffer(t.READ_FRAMEBUFFER,null)),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),W={},ft=null,dt={},H={},X=new WeakMap,Y=[],q=null,Z=!1,J=null,K=null,Q=null,$=null,tt=null,et=null,nt=null,rt=!1,it=null,ot=null,at=null,st=null,ut=null,vt.set(0,0,t.canvas.width,t.canvas.height),yt.set(0,0,t.canvas.width,t.canvas.height),s.reset(),u.reset(),l.reset()}}}function ss(t,e,n,r,i,o,a){const s=i.isWebGL2,u=(i.maxTextures,i.maxCubemapSize),l=i.maxTextureSize,c=i.maxSamples,h=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,p="undefined"!=typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),f=new WeakMap;let d;const m=new WeakMap;let g=!1;try{g="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(t){}function v(t,e){return g?new OffscreenCanvas(t,e):Ke("canvas")}function y(t,e,n,r){let i=1;if((t.width>r||t.height>r)&&(i=r/Math.max(t.width,t.height)),i<1||!0===e){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){const r=e?Ve:Math.floor,o=r(i*t.width),a=r(i*t.height);void 0===d&&(d=v(o,a));const s=n?v(o,a):d;s.width=o,s.height=a;return s.getContext("2d").drawImage(t,0,0,o,a),s}return t}return t}function x(t){return Ue(t.width)&&Ue(t.height)}function _(t,e){return t.generateMipmaps&&e&&t.minFilter!==at&&t.minFilter!==lt}function b(e){t.generateMipmap(e)}function w(n,r,i,o,a=!1){if(!1===s)return r;if(null!==n&&void 0!==t[n])return t[n];let u=r;return r===t.RED&&(i===t.FLOAT&&(u=t.R32F),i===t.HALF_FLOAT&&(u=t.R16F),i===t.UNSIGNED_BYTE&&(u=t.R8)),r===t.RG&&(i===t.FLOAT&&(u=t.RG32F),i===t.HALF_FLOAT&&(u=t.RG16F),i===t.UNSIGNED_BYTE&&(u=t.RG8)),r===t.RGBA&&(i===t.FLOAT&&(u=t.RGBA32F),i===t.HALF_FLOAT&&(u=t.RGBA16F),i===t.UNSIGNED_BYTE&&(u=o===xe&&!1===a?t.SRGB8_ALPHA8:t.RGBA8),i===t.UNSIGNED_SHORT_4_4_4_4&&(u=t.RGBA4),i===t.UNSIGNED_SHORT_5_5_5_1&&(u=t.RGB5_A1)),u!==t.R16F&&u!==t.R32F&&u!==t.RG16F&&u!==t.RG32F&&u!==t.RGBA16F&&u!==t.RGBA32F||e.get("EXT_color_buffer_float"),u}function M(t,e,n){return!0===_(t,n)||t.isFramebufferTexture&&t.minFilter!==at&&t.minFilter!==lt?Math.log2(Math.max(e.width,e.height))+1:void 0!==t.mipmaps&&t.mipmaps.length>0?t.mipmaps.length:t.isCompressedTexture&&Array.isArray(t.image)?e.mipmaps.length:1}function S(e){return e===at||e===st||e===ut?t.NEAREST:t.LINEAR}function T(t){const e=t.target;e.removeEventListener("dispose",T),function(t){const e=r.get(t);if(void 0===e.__webglInit)return;const n=t.source,i=m.get(n);if(i){const r=i[e.__cacheKey];r.usedTimes--,0===r.usedTimes&&A(t),0===Object.keys(i).length&&m.delete(n)}r.remove(t)}(e),e.isVideoTexture&&f.delete(e)}function E(e){const n=e.target;n.removeEventListener("dispose",E),function(e){const n=e.texture,i=r.get(e),o=r.get(n);void 0!==o.__webglTexture&&(t.deleteTexture(o.__webglTexture),a.memory.textures--);e.depthTexture&&e.depthTexture.dispose();if(e.isWebGLCubeRenderTarget)for(let e=0;e<6;e++)t.deleteFramebuffer(i.__webglFramebuffer[e]),i.__webglDepthbuffer&&t.deleteRenderbuffer(i.__webglDepthbuffer[e]);else{if(t.deleteFramebuffer(i.__webglFramebuffer),i.__webglDepthbuffer&&t.deleteRenderbuffer(i.__webglDepthbuffer),i.__webglMultisampledFramebuffer&&t.deleteFramebuffer(i.__webglMultisampledFramebuffer),i.__webglColorRenderbuffer)for(let e=0;e<i.__webglColorRenderbuffer.length;e++)i.__webglColorRenderbuffer[e]&&t.deleteRenderbuffer(i.__webglColorRenderbuffer[e]);i.__webglDepthRenderbuffer&&t.deleteRenderbuffer(i.__webglDepthRenderbuffer)}if(e.isWebGLMultipleRenderTargets)for(let e=0,i=n.length;e<i;e++){const i=r.get(n[e]);i.__webglTexture&&(t.deleteTexture(i.__webglTexture),a.memory.textures--),r.remove(n[e])}r.remove(n),r.remove(e)}(n)}function A(e){const n=r.get(e);t.deleteTexture(n.__webglTexture);const i=e.source;delete m.get(i)[n.__cacheKey],a.memory.textures--}let P=0;function C(e,i){const o=r.get(e);if(e.isVideoTexture&&function(t){const e=a.render.frame;f.get(t)!==e&&(f.set(t,e),t.update())}(e),!1===e.isRenderTargetTexture&&e.version>0&&o.__version!==e.version){const t=e.image;if(null===t);else if(!1!==t.complete)return void R(o,e,i)}n.bindTexture(t.TEXTURE_2D,o.__webglTexture,t.TEXTURE0+i)}const L={[rt]:t.REPEAT,[it]:t.CLAMP_TO_EDGE,[ot]:t.MIRRORED_REPEAT},I={[at]:t.NEAREST,[st]:t.NEAREST_MIPMAP_NEAREST,[ut]:t.NEAREST_MIPMAP_LINEAR,[lt]:t.LINEAR,[ct]:t.LINEAR_MIPMAP_NEAREST,[ht]:t.LINEAR_MIPMAP_LINEAR};function O(n,o,a){if(a?(t.texParameteri(n,t.TEXTURE_WRAP_S,L[o.wrapS]),t.texParameteri(n,t.TEXTURE_WRAP_T,L[o.wrapT]),n!==t.TEXTURE_3D&&n!==t.TEXTURE_2D_ARRAY||t.texParameteri(n,t.TEXTURE_WRAP_R,L[o.wrapR]),t.texParameteri(n,t.TEXTURE_MAG_FILTER,I[o.magFilter]),t.texParameteri(n,t.TEXTURE_MIN_FILTER,I[o.minFilter])):(t.texParameteri(n,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(n,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),n!==t.TEXTURE_3D&&n!==t.TEXTURE_2D_ARRAY||t.texParameteri(n,t.TEXTURE_WRAP_R,t.CLAMP_TO_EDGE),o.wrapS!==it||o.wrapT,t.texParameteri(n,t.TEXTURE_MAG_FILTER,S(o.magFilter)),t.texParameteri(n,t.TEXTURE_MIN_FILTER,S(o.minFilter)),o.minFilter!==at&&o.minFilter),!0===e.has("EXT_texture_filter_anisotropic")){const a=e.get("EXT_texture_filter_anisotropic");if(o.magFilter===at)return;if(o.minFilter!==ut&&o.minFilter!==ht)return;if(o.type===yt&&!1===e.has("OES_texture_float_linear"))return;if(!1===s&&o.type===xt&&!1===e.has("OES_texture_half_float_linear"))return;(o.anisotropy>1||r.get(o).__currentAnisotropy)&&(t.texParameterf(n,a.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(o.anisotropy,i.getMaxAnisotropy())),r.get(o).__currentAnisotropy=o.anisotropy)}}function N(e,n){let r=!1;void 0===e.__webglInit&&(e.__webglInit=!0,n.addEventListener("dispose",T));const i=n.source;let o=m.get(i);void 0===o&&(o={},m.set(i,o));const s=function(t){const e=[];return e.push(t.wrapS),e.push(t.wrapT),e.push(t.wrapR||0),e.push(t.magFilter),e.push(t.minFilter),e.push(t.anisotropy),e.push(t.internalFormat),e.push(t.format),e.push(t.type),e.push(t.generateMipmaps),e.push(t.premultiplyAlpha),e.push(t.flipY),e.push(t.unpackAlignment),e.push(t.encoding),e.join()}(n);if(s!==e.__cacheKey){void 0===o[s]&&(o[s]={texture:t.createTexture(),usedTimes:0},a.memory.textures++,r=!0),o[s].usedTimes++;const i=o[e.__cacheKey];void 0!==i&&(o[e.__cacheKey].usedTimes--,0===i.usedTimes&&A(n)),e.__cacheKey=s,e.__webglTexture=o[s].texture}return r}function R(e,i,a){let u=t.TEXTURE_2D;(i.isDataArrayTexture||i.isCompressedArrayTexture)&&(u=t.TEXTURE_2D_ARRAY),i.isData3DTexture&&(u=t.TEXTURE_3D);const c=N(e,i),h=i.source;n.bindTexture(u,e.__webglTexture,t.TEXTURE0+a);const p=r.get(h);if(h.version!==p.__version||!0===c){n.activeTexture(t.TEXTURE0+a),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,i.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,i.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE);const e=function(t){return!s&&(t.wrapS!==it||t.wrapT!==it||t.minFilter!==at&&t.minFilter!==lt)}(i)&&!1===x(i.image);let r=y(i.image,e,!1,l);r=z(i,r);const f=x(r)||s,d=o.convert(i.format,i.encoding);let m,g=o.convert(i.type),v=w(i.internalFormat,d,g,i.encoding,i.isVideoTexture);O(u,i,f);const S=i.mipmaps,T=s&&!0!==i.isVideoTexture,E=void 0===p.__version||!0===c,A=M(i,r,f);if(i.isDepthTexture)v=t.DEPTH_COMPONENT,s?v=i.type===yt?t.DEPTH_COMPONENT32F:i.type===vt?t.DEPTH_COMPONENT24:i.type===wt?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT16:i.type,i.format===At&&v===t.DEPTH_COMPONENT&&i.type!==mt&&i.type!==vt&&(i.type=vt,g=o.convert(i.type)),i.format===Pt&&v===t.DEPTH_COMPONENT&&(v=t.DEPTH_STENCIL,i.type!==wt&&(i.type=wt,g=o.convert(i.type))),E&&(T?n.texStorage2D(t.TEXTURE_2D,1,v,r.width,r.height):n.texImage2D(t.TEXTURE_2D,0,v,r.width,r.height,0,d,g,null));else if(i.isDataTexture)if(S.length>0&&f){T&&E&&n.texStorage2D(t.TEXTURE_2D,A,v,S[0].width,S[0].height);for(let e=0,r=S.length;e<r;e++)m=S[e],T?n.texSubImage2D(t.TEXTURE_2D,e,0,0,m.width,m.height,d,g,m.data):n.texImage2D(t.TEXTURE_2D,e,v,m.width,m.height,0,d,g,m.data);i.generateMipmaps=!1}else T?(E&&n.texStorage2D(t.TEXTURE_2D,A,v,r.width,r.height),n.texSubImage2D(t.TEXTURE_2D,0,0,0,r.width,r.height,d,g,r.data)):n.texImage2D(t.TEXTURE_2D,0,v,r.width,r.height,0,d,g,r.data);else if(i.isCompressedTexture)if(i.isCompressedArrayTexture){T&&E&&n.texStorage3D(t.TEXTURE_2D_ARRAY,A,v,S[0].width,S[0].height,r.depth);for(let e=0,o=S.length;e<o;e++)m=S[e],i.format!==St?null!==d&&(T?n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,e,0,0,0,m.width,m.height,r.depth,d,m.data,0,0):n.compressedTexImage3D(t.TEXTURE_2D_ARRAY,e,v,m.width,m.height,r.depth,0,m.data,0,0)):T?n.texSubImage3D(t.TEXTURE_2D_ARRAY,e,0,0,0,m.width,m.height,r.depth,d,g,m.data):n.texImage3D(t.TEXTURE_2D_ARRAY,e,v,m.width,m.height,r.depth,0,d,g,m.data)}else{T&&E&&n.texStorage2D(t.TEXTURE_2D,A,v,S[0].width,S[0].height);for(let e=0,r=S.length;e<r;e++)m=S[e],i.format!==St?null!==d&&(T?n.compressedTexSubImage2D(t.TEXTURE_2D,e,0,0,m.width,m.height,d,m.data):n.compressedTexImage2D(t.TEXTURE_2D,e,v,m.width,m.height,0,m.data)):T?n.texSubImage2D(t.TEXTURE_2D,e,0,0,m.width,m.height,d,g,m.data):n.texImage2D(t.TEXTURE_2D,e,v,m.width,m.height,0,d,g,m.data)}else if(i.isDataArrayTexture)T?(E&&n.texStorage3D(t.TEXTURE_2D_ARRAY,A,v,r.width,r.height,r.depth),n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,0,r.width,r.height,r.depth,d,g,r.data)):n.texImage3D(t.TEXTURE_2D_ARRAY,0,v,r.width,r.height,r.depth,0,d,g,r.data);else if(i.isData3DTexture)T?(E&&n.texStorage3D(t.TEXTURE_3D,A,v,r.width,r.height,r.depth),n.texSubImage3D(t.TEXTURE_3D,0,0,0,0,r.width,r.height,r.depth,d,g,r.data)):n.texImage3D(t.TEXTURE_3D,0,v,r.width,r.height,r.depth,0,d,g,r.data);else if(i.isFramebufferTexture){if(E)if(T)n.texStorage2D(t.TEXTURE_2D,A,v,r.width,r.height);else{let e=r.width,i=r.height;for(let r=0;r<A;r++)n.texImage2D(t.TEXTURE_2D,r,v,e,i,0,d,g,null),e>>=1,i>>=1}}else if(S.length>0&&f){T&&E&&n.texStorage2D(t.TEXTURE_2D,A,v,S[0].width,S[0].height);for(let e=0,r=S.length;e<r;e++)m=S[e],T?n.texSubImage2D(t.TEXTURE_2D,e,0,0,d,g,m):n.texImage2D(t.TEXTURE_2D,e,v,d,g,m);i.generateMipmaps=!1}else T?(E&&n.texStorage2D(t.TEXTURE_2D,A,v,r.width,r.height),n.texSubImage2D(t.TEXTURE_2D,0,0,0,d,g,r)):n.texImage2D(t.TEXTURE_2D,0,v,d,g,r);_(i,f)&&b(u),p.__version=h.version,i.onUpdate&&i.onUpdate(i)}e.__version=i.version}function D(e,i,a,s,u){const l=o.convert(a.format,a.encoding),c=o.convert(a.type),p=w(a.internalFormat,l,c,a.encoding);r.get(i).__hasExternalTextures||(u===t.TEXTURE_3D||u===t.TEXTURE_2D_ARRAY?n.texImage3D(u,0,p,i.width,i.height,i.depth,0,l,c,null):n.texImage2D(u,0,p,i.width,i.height,0,l,c,null)),n.bindFramebuffer(t.FRAMEBUFFER,e),U(i)?h.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,s,u,r.get(a).__webglTexture,0,B(i)):(u===t.TEXTURE_2D||u>=t.TEXTURE_CUBE_MAP_POSITIVE_X&&u<=t.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&t.framebufferTexture2D(t.FRAMEBUFFER,s,u,r.get(a).__webglTexture,0),n.bindFramebuffer(t.FRAMEBUFFER,null)}function k(e,n,r){if(t.bindRenderbuffer(t.RENDERBUFFER,e),n.depthBuffer&&!n.stencilBuffer){let i=t.DEPTH_COMPONENT16;if(r||U(n)){const e=n.depthTexture;e&&e.isDepthTexture&&(e.type===yt?i=t.DEPTH_COMPONENT32F:e.type===vt&&(i=t.DEPTH_COMPONENT24));const r=B(n);U(n)?h.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,r,i,n.width,n.height):t.renderbufferStorageMultisample(t.RENDERBUFFER,r,i,n.width,n.height)}else t.renderbufferStorage(t.RENDERBUFFER,i,n.width,n.height);t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e)}else if(n.depthBuffer&&n.stencilBuffer){const i=B(n);r&&!1===U(n)?t.renderbufferStorageMultisample(t.RENDERBUFFER,i,t.DEPTH24_STENCIL8,n.width,n.height):U(n)?h.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,i,t.DEPTH24_STENCIL8,n.width,n.height):t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,n.width,n.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,e)}else{const e=!0===n.isWebGLMultipleRenderTargets?n.texture:[n.texture];for(let i=0;i<e.length;i++){const a=e[i],s=o.convert(a.format,a.encoding),u=o.convert(a.type),l=w(a.internalFormat,s,u,a.encoding),c=B(n);r&&!1===U(n)?t.renderbufferStorageMultisample(t.RENDERBUFFER,c,l,n.width,n.height):U(n)?h.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,c,l,n.width,n.height):t.renderbufferStorage(t.RENDERBUFFER,l,n.width,n.height)}}t.bindRenderbuffer(t.RENDERBUFFER,null)}function F(e){const i=r.get(e),o=!0===e.isWebGLCubeRenderTarget;if(e.depthTexture&&!i.__autoAllocateDepthBuffer){if(o)throw new Error("target.depthTexture not supported in Cube render targets");!function(e,i){if(i&&i.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(t.FRAMEBUFFER,e),!i.depthTexture||!i.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(i.depthTexture).__webglTexture&&i.depthTexture.image.width===i.width&&i.depthTexture.image.height===i.height||(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),C(i.depthTexture,0);const o=r.get(i.depthTexture).__webglTexture,a=B(i);if(i.depthTexture.format===At)U(i)?h.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,o,0,a):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,o,0);else{if(i.depthTexture.format!==Pt)throw new Error("Unknown depthTexture format");U(i)?h.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,o,0,a):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,o,0)}}(i.__webglFramebuffer,e)}else if(o){i.__webglDepthbuffer=[];for(let r=0;r<6;r++)n.bindFramebuffer(t.FRAMEBUFFER,i.__webglFramebuffer[r]),i.__webglDepthbuffer[r]=t.createRenderbuffer(),k(i.__webglDepthbuffer[r],e,!1)}else n.bindFramebuffer(t.FRAMEBUFFER,i.__webglFramebuffer),i.__webglDepthbuffer=t.createRenderbuffer(),k(i.__webglDepthbuffer,e,!1);n.bindFramebuffer(t.FRAMEBUFFER,null)}function B(t){return Math.min(c,t.samples)}function U(t){const n=r.get(t);return s&&t.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==n.__useRenderToTexture}function z(t,n){const r=t.encoding,i=t.format;t.type;return!0===t.isCompressedTexture||!0===t.isVideoTexture||t.format===Ce||r!==ye&&r===xe&&!1===s&&(!0===e.has("EXT_sRGB")&&i===St?(t.format=Ce,t.minFilter=lt,t.generateMipmaps=!1):n=pn.sRGBToLinear(n)),n}this.allocateTextureUnit=function(){const t=P;return P+=1,t},this.resetTextureUnits=function(){P=0},this.setTexture2D=C,this.setTexture2DArray=function(e,i){const o=r.get(e);e.version>0&&o.__version!==e.version?R(o,e,i):n.bindTexture(t.TEXTURE_2D_ARRAY,o.__webglTexture,t.TEXTURE0+i)},this.setTexture3D=function(e,i){const o=r.get(e);e.version>0&&o.__version!==e.version?R(o,e,i):n.bindTexture(t.TEXTURE_3D,o.__webglTexture,t.TEXTURE0+i)},this.setTextureCube=function(e,i){const a=r.get(e);e.version>0&&a.__version!==e.version?function(e,i,a){if(6!==i.image.length)return;const l=N(e,i),c=i.source;n.bindTexture(t.TEXTURE_CUBE_MAP,e.__webglTexture,t.TEXTURE0+a);const h=r.get(c);if(c.version!==h.__version||!0===l){n.activeTexture(t.TEXTURE0+a),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,i.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,i.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE);const e=i.isCompressedTexture||i.image[0].isCompressedTexture,r=i.image[0]&&i.image[0].isDataTexture,p=[];for(let t=0;t<6;t++)p[t]=e||r?r?i.image[t].image:i.image[t]:y(i.image[t],!1,!0,u),p[t]=z(i,p[t]);const f=p[0],d=x(f)||s,m=o.convert(i.format,i.encoding),g=o.convert(i.type),v=w(i.internalFormat,m,g,i.encoding),S=s&&!0!==i.isVideoTexture,T=void 0===h.__version||!0===l;let E,A=M(i,f,d);if(O(t.TEXTURE_CUBE_MAP,i,d),e){S&&T&&n.texStorage2D(t.TEXTURE_CUBE_MAP,A,v,f.width,f.height);for(let e=0;e<6;e++){E=p[e].mipmaps;for(let r=0;r<E.length;r++){const o=E[r];i.format!==St?null!==m&&(S?n.compressedTexSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,r,0,0,o.width,o.height,m,o.data):n.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,r,v,o.width,o.height,0,o.data)):S?n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,r,0,0,o.width,o.height,m,g,o.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,r,v,o.width,o.height,0,m,g,o.data)}}}else{E=i.mipmaps,S&&T&&(E.length>0&&A++,n.texStorage2D(t.TEXTURE_CUBE_MAP,A,v,p[0].width,p[0].height));for(let e=0;e<6;e++)if(r){S?n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,0,0,p[e].width,p[e].height,m,g,p[e].data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,v,p[e].width,p[e].height,0,m,g,p[e].data);for(let r=0;r<E.length;r++){const i=E[r].image[e].image;S?n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,r+1,0,0,i.width,i.height,m,g,i.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,r+1,v,i.width,i.height,0,m,g,i.data)}}else{S?n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,0,0,m,g,p[e]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,v,m,g,p[e]);for(let r=0;r<E.length;r++){const i=E[r];S?n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,r+1,0,0,m,g,i.image[e]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,r+1,v,m,g,i.image[e])}}}_(i,d)&&b(t.TEXTURE_CUBE_MAP),h.__version=c.version,i.onUpdate&&i.onUpdate(i)}e.__version=i.version}(a,e,i):n.bindTexture(t.TEXTURE_CUBE_MAP,a.__webglTexture,t.TEXTURE0+i)},this.rebindTextures=function(e,n,i){const o=r.get(e);void 0!==n&&D(o.__webglFramebuffer,e,e.texture,t.COLOR_ATTACHMENT0,t.TEXTURE_2D),void 0!==i&&F(e)},this.setupRenderTarget=function(e){const u=e.texture,l=r.get(e),c=r.get(u);e.addEventListener("dispose",E),!0!==e.isWebGLMultipleRenderTargets&&(void 0===c.__webglTexture&&(c.__webglTexture=t.createTexture()),c.__version=u.version,a.memory.textures++);const h=!0===e.isWebGLCubeRenderTarget,p=!0===e.isWebGLMultipleRenderTargets,f=x(e)||s;if(h){l.__webglFramebuffer=[];for(let e=0;e<6;e++)l.__webglFramebuffer[e]=t.createFramebuffer()}else{if(l.__webglFramebuffer=t.createFramebuffer(),p&&i.drawBuffers){const n=e.texture;for(let e=0,i=n.length;e<i;e++){const i=r.get(n[e]);void 0===i.__webglTexture&&(i.__webglTexture=t.createTexture(),a.memory.textures++)}}if(s&&e.samples>0&&!1===U(e)){const r=p?u:[u];l.__webglMultisampledFramebuffer=t.createFramebuffer(),l.__webglColorRenderbuffer=[],n.bindFramebuffer(t.FRAMEBUFFER,l.__webglMultisampledFramebuffer);for(let n=0;n<r.length;n++){const i=r[n];l.__webglColorRenderbuffer[n]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,l.__webglColorRenderbuffer[n]);const a=o.convert(i.format,i.encoding),s=o.convert(i.type),u=w(i.internalFormat,a,s,i.encoding,!0===e.isXRRenderTarget),c=B(e);t.renderbufferStorageMultisample(t.RENDERBUFFER,c,u,e.width,e.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+n,t.RENDERBUFFER,l.__webglColorRenderbuffer[n])}t.bindRenderbuffer(t.RENDERBUFFER,null),e.depthBuffer&&(l.__webglDepthRenderbuffer=t.createRenderbuffer(),k(l.__webglDepthRenderbuffer,e,!0)),n.bindFramebuffer(t.FRAMEBUFFER,null)}}if(h){n.bindTexture(t.TEXTURE_CUBE_MAP,c.__webglTexture),O(t.TEXTURE_CUBE_MAP,u,f);for(let n=0;n<6;n++)D(l.__webglFramebuffer[n],e,u,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+n);_(u,f)&&b(t.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(p){const i=e.texture;for(let o=0,a=i.length;o<a;o++){const a=i[o],s=r.get(a);n.bindTexture(t.TEXTURE_2D,s.__webglTexture),O(t.TEXTURE_2D,a,f),D(l.__webglFramebuffer,e,a,t.COLOR_ATTACHMENT0+o,t.TEXTURE_2D),_(a,f)&&b(t.TEXTURE_2D)}n.unbindTexture()}else{let r=t.TEXTURE_2D;(e.isWebGL3DRenderTarget||e.isWebGLArrayRenderTarget)&&s&&(r=e.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY),n.bindTexture(r,c.__webglTexture),O(r,u,f),D(l.__webglFramebuffer,e,u,t.COLOR_ATTACHMENT0,r),_(u,f)&&b(r),n.unbindTexture()}e.depthBuffer&&F(e)},this.updateRenderTargetMipmap=function(e){const i=x(e)||s,o=!0===e.isWebGLMultipleRenderTargets?e.texture:[e.texture];for(let a=0,s=o.length;a<s;a++){const s=o[a];if(_(s,i)){const i=e.isWebGLCubeRenderTarget?t.TEXTURE_CUBE_MAP:t.TEXTURE_2D,o=r.get(s).__webglTexture;n.bindTexture(i,o),b(i),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function(e){if(s&&e.samples>0&&!1===U(e)){const i=e.isWebGLMultipleRenderTargets?e.texture:[e.texture],o=e.width,a=e.height;let s=t.COLOR_BUFFER_BIT;const u=[],l=e.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,c=r.get(e),h=!0===e.isWebGLMultipleRenderTargets;if(h)for(let e=0;e<i.length;e++)n.bindFramebuffer(t.FRAMEBUFFER,c.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.RENDERBUFFER,null),n.bindFramebuffer(t.FRAMEBUFFER,c.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.TEXTURE_2D,null,0);n.bindFramebuffer(t.READ_FRAMEBUFFER,c.__webglMultisampledFramebuffer),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,c.__webglFramebuffer);for(let n=0;n<i.length;n++){u.push(t.COLOR_ATTACHMENT0+n),e.depthBuffer&&u.push(l);const f=void 0!==c.__ignoreDepthValues&&c.__ignoreDepthValues;if(!1===f&&(e.depthBuffer&&(s|=t.DEPTH_BUFFER_BIT),e.stencilBuffer&&(s|=t.STENCIL_BUFFER_BIT)),h&&t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,c.__webglColorRenderbuffer[n]),!0===f&&(t.invalidateFramebuffer(t.READ_FRAMEBUFFER,[l]),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,[l])),h){const e=r.get(i[n]).__webglTexture;t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0)}t.blitFramebuffer(0,0,o,a,0,0,o,a,s,t.NEAREST),p&&t.invalidateFramebuffer(t.READ_FRAMEBUFFER,u)}if(n.bindFramebuffer(t.READ_FRAMEBUFFER,null),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),h)for(let e=0;e<i.length;e++){n.bindFramebuffer(t.FRAMEBUFFER,c.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.RENDERBUFFER,c.__webglColorRenderbuffer[e]);const o=r.get(i[e]).__webglTexture;n.bindFramebuffer(t.FRAMEBUFFER,c.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.TEXTURE_2D,o,0)}n.bindFramebuffer(t.DRAW_FRAMEBUFFER,c.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=F,this.setupFrameBufferTexture=D,this.useMultisampledRTT=U}function us(t,e,n){const r=n.isWebGL2;return{convert:function(n,i=null){let o;if(n===pt)return t.UNSIGNED_BYTE;if(n===_t)return t.UNSIGNED_SHORT_4_4_4_4;if(n===bt)return t.UNSIGNED_SHORT_5_5_5_1;if(n===ft)return t.BYTE;if(n===dt)return t.SHORT;if(n===mt)return t.UNSIGNED_SHORT;if(n===gt)return t.INT;if(n===vt)return t.UNSIGNED_INT;if(n===yt)return t.FLOAT;if(n===xt)return r?t.HALF_FLOAT:(o=e.get("OES_texture_half_float"),null!==o?o.HALF_FLOAT_OES:null);if(n===Mt)return t.ALPHA;if(n===St)return t.RGBA;if(n===Tt)return t.LUMINANCE;if(n===Et)return t.LUMINANCE_ALPHA;if(n===At)return t.DEPTH_COMPONENT;if(n===Pt)return t.DEPTH_STENCIL;if(n===Ce)return o=e.get("EXT_sRGB"),null!==o?o.SRGB_ALPHA_EXT:null;if(n===Ct)return t.RED;if(n===Lt)return t.RED_INTEGER;if(n===It)return t.RG;if(n===Ot)return t.RG_INTEGER;if(n===Nt)return t.RGBA_INTEGER;if(n===Rt||n===Dt||n===kt||n===Ft)if(i===xe){if(o=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===o)return null;if(n===Rt)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===Dt)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===kt)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===Ft)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(o=e.get("WEBGL_compressed_texture_s3tc"),null===o)return null;if(n===Rt)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===Dt)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===kt)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===Ft)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(n===Bt||n===Ut||n===zt||n===Vt){if(o=e.get("WEBGL_compressed_texture_pvrtc"),null===o)return null;if(n===Bt)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===Ut)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===zt)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===Vt)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(n===Gt)return o=e.get("WEBGL_compressed_texture_etc1"),null!==o?o.COMPRESSED_RGB_ETC1_WEBGL:null;if(n===jt||n===Wt){if(o=e.get("WEBGL_compressed_texture_etc"),null===o)return null;if(n===jt)return i===xe?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(n===Wt)return i===xe?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC}if(n===Ht||n===Xt||n===Yt||n===qt||n===Zt||n===Jt||n===Kt||n===Qt||n===$t||n===te||n===ee||n===ne||n===re||n===ie){if(o=e.get("WEBGL_compressed_texture_astc"),null===o)return null;if(n===Ht)return i===xe?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===Xt)return i===xe?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===Yt)return i===xe?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===qt)return i===xe?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===Zt)return i===xe?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===Jt)return i===xe?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===Kt)return i===xe?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===Qt)return i===xe?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===$t)return i===xe?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===te)return i===xe?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===ee)return i===xe?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===ne)return i===xe?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===re)return i===xe?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===ie)return i===xe?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}if(n===oe){if(o=e.get("EXT_texture_compression_bptc"),null===o)return null;if(n===oe)return i===xe?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT}if(n===ae||n===se||n===ue||n===le){if(o=e.get("EXT_texture_compression_rgtc"),null===o)return null;if(n===oe)return o.COMPRESSED_RED_RGTC1_EXT;if(n===se)return o.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===ue)return o.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===le)return o.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return n===wt?r?t.UNSIGNED_INT_24_8:(o=e.get("WEBGL_depth_texture"),null!==o?o.UNSIGNED_INT_24_8_WEBGL:null):void 0!==t[n]?t[n]:null}}}class ls extends Mi{constructor(t=[]){super(),this.isArrayCamera=!0,this.cameras=t}}class cs extends xr{constructor(){super(),this.isGroup=!0,this.type="Group"}}const hs={type:"move"};class ps{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new cs,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new cs,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new $e,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new $e),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new cs,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new $e,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new $e),this._grip}dispatchEvent(t){return null!==this._targetRay&&this._targetRay.dispatchEvent(t),null!==this._grip&&this._grip.dispatchEvent(t),null!==this._hand&&this._hand.dispatchEvent(t),this}connect(t){if(t&&t.hand){const e=this._hand;if(e)for(const n of t.hand.values())this._getHandJoint(e,n)}return this.dispatchEvent({type:"connected",data:t}),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(t,e,n){let r=null,i=null,o=null;const a=this._targetRay,s=this._grip,u=this._hand;if(t&&"visible-blurred"!==e.session.visibilityState){if(u&&t.hand){o=!0;for(const r of t.hand.values()){const t=e.getJointPose(r,n),i=this._getHandJoint(u,r);null!==t&&(i.matrix.fromArray(t.transform.matrix),i.matrix.decompose(i.position,i.rotation,i.scale),i.jointRadius=t.radius),i.visible=null!==t}const r=u.joints["index-finger-tip"],i=u.joints["thumb-tip"],a=r.position.distanceTo(i.position),s=.02,l=.005;u.inputState.pinching&&a>s+l?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!u.inputState.pinching&&a<=s-l&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else null!==s&&t.gripSpace&&(i=e.getPose(t.gripSpace,n),null!==i&&(s.matrix.fromArray(i.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),i.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(i.linearVelocity)):s.hasLinearVelocity=!1,i.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(i.angularVelocity)):s.hasAngularVelocity=!1));null!==a&&(r=e.getPose(t.targetRaySpace,n),null===r&&null!==i&&(r=i),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(hs)))}return null!==a&&(a.visible=null!==r),null!==s&&(s.visible=null!==i),null!==u&&(u.visible=null!==o),this}_getHandJoint(t,e){if(void 0===t.joints[e.jointName]){const n=new cs;n.matrixAutoUpdate=!1,n.visible=!1,t.joints[e.jointName]=n,t.add(n)}return t.joints[e.jointName]}}class fs extends gn{constructor(t,e,n,r,i,o,a,s,u,l){if((l=void 0!==l?l:At)!==At&&l!==Pt)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&l===At&&(n=vt),void 0===n&&l===Pt&&(n=wt),super(null,r,i,o,a,s,l,n,u),this.isDepthTexture=!0,this.image={width:t,height:e},this.magFilter=void 0!==a?a:at,this.minFilter=void 0!==s?s:at,this.flipY=!1,this.generateMipmaps=!1}}class ds extends Le{constructor(t,e){super();const n=this;let r=null,i=1,o=null,a="local-floor",s=1,u=null,l=null,c=null,h=null,p=null,f=null;const d=e.getContextAttributes();let m=null,g=null;const v=[],y=[],x=new Set,_=new Map,b=new Mi;b.layers.enable(1),b.viewport=new vn;const w=new Mi;w.layers.enable(2),w.viewport=new vn;const M=[b,w],S=new ls;S.layers.enable(1),S.layers.enable(2);let T=null,E=null;function A(t){const e=y.indexOf(t.inputSource);if(-1===e)return;const n=v[e];void 0!==n&&n.dispatchEvent({type:t.type,data:t.inputSource})}function P(){r.removeEventListener("select",A),r.removeEventListener("selectstart",A),r.removeEventListener("selectend",A),r.removeEventListener("squeeze",A),r.removeEventListener("squeezestart",A),r.removeEventListener("squeezeend",A),r.removeEventListener("end",P),r.removeEventListener("inputsourceschange",C);for(let t=0;t<v.length;t++){const e=y[t];null!==e&&(y[t]=null,v[t].disconnect(e))}T=null,E=null,t.setRenderTarget(m),p=null,h=null,c=null,r=null,g=null,R.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function C(t){for(let e=0;e<t.removed.length;e++){const n=t.removed[e],r=y.indexOf(n);r>=0&&(y[r]=null,v[r].disconnect(n))}for(let e=0;e<t.added.length;e++){const n=t.added[e];let r=y.indexOf(n);if(-1===r){for(let t=0;t<v.length;t++){if(t>=y.length){y.push(n),r=t;break}if(null===y[t]){y[t]=n,r=t;break}}if(-1===r)break}const i=v[r];i&&i.connect(n)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(t){let e=v[t];return void 0===e&&(e=new ps,v[t]=e),e.getTargetRaySpace()},this.getControllerGrip=function(t){let e=v[t];return void 0===e&&(e=new ps,v[t]=e),e.getGripSpace()},this.getHand=function(t){let e=v[t];return void 0===e&&(e=new ps,v[t]=e),e.getHandSpace()},this.setFramebufferScaleFactor=function(t){i=t,n.isPresenting},this.setReferenceSpaceType=function(t){a=t,n.isPresenting},this.getReferenceSpace=function(){return u||o},this.setReferenceSpace=function(t){u=t},this.getBaseLayer=function(){return null!==h?h:p},this.getBinding=function(){return c},this.getFrame=function(){return f},this.getSession=function(){return r},this.setSession=async function(l){if(r=l,null!==r){if(m=t.getRenderTarget(),r.addEventListener("select",A),r.addEventListener("selectstart",A),r.addEventListener("selectend",A),r.addEventListener("squeeze",A),r.addEventListener("squeezestart",A),r.addEventListener("squeezeend",A),r.addEventListener("end",P),r.addEventListener("inputsourceschange",C),!0!==d.xrCompatible&&await e.makeXRCompatible(),void 0===r.renderState.layers||!1===t.capabilities.isWebGL2){const n={antialias:void 0!==r.renderState.layers||d.antialias,alpha:d.alpha,depth:d.depth,stencil:d.stencil,framebufferScaleFactor:i};p=new XRWebGLLayer(r,e,n),r.updateRenderState({baseLayer:p}),g=new yn(p.framebufferWidth,p.framebufferHeight,{format:St,type:pt,encoding:t.outputEncoding,stencilBuffer:d.stencil})}else{let n=null,o=null,a=null;d.depth&&(a=d.stencil?e.DEPTH24_STENCIL8:e.DEPTH_COMPONENT24,n=d.stencil?Pt:At,o=d.stencil?wt:vt);const s={colorFormat:e.RGBA8,depthFormat:a,scaleFactor:i};c=new XRWebGLBinding(r,e),h=c.createProjectionLayer(s),r.updateRenderState({layers:[h]}),g=new yn(h.textureWidth,h.textureHeight,{format:St,type:pt,depthTexture:new fs(h.textureWidth,h.textureHeight,o,void 0,void 0,void 0,void 0,void 0,void 0,n),stencilBuffer:d.stencil,encoding:t.outputEncoding,samples:d.antialias?4:0});t.properties.get(g).__ignoreDepthValues=h.ignoreDepthValues}g.isXRRenderTarget=!0,this.setFoveation(s),u=null,o=await r.requestReferenceSpace(a),R.setContext(r),R.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}};const L=new $e,I=new $e;function O(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.copy(t.matrixWorld).invert()}this.updateCamera=function(t){if(null===r)return;S.near=w.near=b.near=t.near,S.far=w.far=b.far=t.far,T===S.near&&E===S.far||(r.updateRenderState({depthNear:S.near,depthFar:S.far}),T=S.near,E=S.far);const e=t.parent,n=S.cameras;O(S,e);for(let t=0;t<n.length;t++)O(n[t],e);S.matrixWorld.decompose(S.position,S.quaternion,S.scale),t.matrix.copy(S.matrix),t.matrix.decompose(t.position,t.quaternion,t.scale);const i=t.children;for(let t=0,e=i.length;t<e;t++)i[t].updateMatrixWorld(!0);2===n.length?function(t,e,n){L.setFromMatrixPosition(e.matrixWorld),I.setFromMatrixPosition(n.matrixWorld);const r=L.distanceTo(I),i=e.projectionMatrix.elements,o=n.projectionMatrix.elements,a=i[14]/(i[10]-1),s=i[14]/(i[10]+1),u=(i[9]+1)/i[5],l=(i[9]-1)/i[5],c=(i[8]-1)/i[0],h=(o[8]+1)/o[0],p=a*c,f=a*h,d=r/(-c+h),m=d*-c;e.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(m),t.translateZ(d),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.copy(t.matrixWorld).invert();const g=a+d,v=s+d,y=p-m,x=f+(r-m),_=u*s/v*g,b=l*s/v*g;t.projectionMatrix.makePerspective(y,x,_,b,g,v)}(S,b,w):S.projectionMatrix.copy(b.projectionMatrix)},this.getCamera=function(){return S},this.getFoveation=function(){if(null!==h||null!==p)return s},this.setFoveation=function(t){s=t,null!==h&&(h.fixedFoveation=t),null!==p&&void 0!==p.fixedFoveation&&(p.fixedFoveation=t)},this.getPlanes=function(){return x};let N=null;const R=new Di;R.setAnimationLoop((function(e,r){if(l=r.getViewerPose(u||o),f=r,null!==l){const e=l.views;null!==p&&(t.setRenderTargetFramebuffer(g,p.framebuffer),t.setRenderTarget(g));let n=!1;e.length!==S.cameras.length&&(S.cameras.length=0,n=!0);for(let r=0;r<e.length;r++){const i=e[r];let o=null;if(null!==p)o=p.getViewport(i);else{const e=c.getViewSubImage(h,i);o=e.viewport,0===r&&(t.setRenderTargetTextures(g,e.colorTexture,h.ignoreDepthValues?void 0:e.depthStencilTexture),t.setRenderTarget(g))}let a=M[r];void 0===a&&(a=new Mi,a.layers.enable(r),a.viewport=new vn,M[r]=a),a.matrix.fromArray(i.transform.matrix),a.projectionMatrix.fromArray(i.projectionMatrix),a.viewport.set(o.x,o.y,o.width,o.height),0===r&&S.matrix.copy(a.matrix),!0===n&&S.cameras.push(a)}}for(let t=0;t<v.length;t++){const e=y[t],n=v[t];null!==e&&void 0!==n&&n.update(e,r,u||o)}if(N&&N(e,r),r.detectedPlanes){n.dispatchEvent({type:"planesdetected",data:r.detectedPlanes});let t=null;for(const e of x)r.detectedPlanes.has(e)||(null===t&&(t=[]),t.push(e));if(null!==t)for(const e of t)x.delete(e),_.delete(e),n.dispatchEvent({type:"planeremoved",data:e});for(const t of r.detectedPlanes)if(x.has(t)){const e=_.get(t);t.lastChangedTime>e&&(_.set(t,t.lastChangedTime),n.dispatchEvent({type:"planechanged",data:t}))}else x.add(t),_.set(t,r.lastChangedTime),n.dispatchEvent({type:"planeadded",data:t})}f=null})),this.setAnimationLoop=function(t){N=t},this.dispose=function(){}}}function ms(t,e){function n(n,r){n.opacity.value=r.opacity,r.color&&n.diffuse.value.copy(r.color),r.emissive&&n.emissive.value.copy(r.emissive).multiplyScalar(r.emissiveIntensity),r.map&&(n.map.value=r.map),r.alphaMap&&(n.alphaMap.value=r.alphaMap),r.bumpMap&&(n.bumpMap.value=r.bumpMap,n.bumpScale.value=r.bumpScale,r.side===c&&(n.bumpScale.value*=-1)),r.displacementMap&&(n.displacementMap.value=r.displacementMap,n.displacementScale.value=r.displacementScale,n.displacementBias.value=r.displacementBias),r.emissiveMap&&(n.emissiveMap.value=r.emissiveMap),r.normalMap&&(n.normalMap.value=r.normalMap,n.normalScale.value.copy(r.normalScale),r.side===c&&n.normalScale.value.negate()),r.specularMap&&(n.specularMap.value=r.specularMap),r.alphaTest>0&&(n.alphaTest.value=r.alphaTest);const i=e.get(r).envMap;if(i&&(n.envMap.value=i,n.flipEnvMap.value=i.isCubeTexture&&!1===i.isRenderTargetTexture?-1:1,n.reflectivity.value=r.reflectivity,n.ior.value=r.ior,n.refractionRatio.value=r.refractionRatio),r.lightMap){n.lightMap.value=r.lightMap;const e=!0===t.useLegacyLights?Math.PI:1;n.lightMapIntensity.value=r.lightMapIntensity*e}let o,a;r.aoMap&&(n.aoMap.value=r.aoMap,n.aoMapIntensity.value=r.aoMapIntensity),r.map?o=r.map:r.specularMap?o=r.specularMap:r.displacementMap?o=r.displacementMap:r.normalMap?o=r.normalMap:r.bumpMap?o=r.bumpMap:r.roughnessMap?o=r.roughnessMap:r.metalnessMap?o=r.metalnessMap:r.alphaMap?o=r.alphaMap:r.emissiveMap?o=r.emissiveMap:r.clearcoatMap?o=r.clearcoatMap:r.clearcoatNormalMap?o=r.clearcoatNormalMap:r.clearcoatRoughnessMap?o=r.clearcoatRoughnessMap:r.iridescenceMap?o=r.iridescenceMap:r.iridescenceThicknessMap?o=r.iridescenceThicknessMap:r.specularIntensityMap?o=r.specularIntensityMap:r.specularColorMap?o=r.specularColorMap:r.transmissionMap?o=r.transmissionMap:r.thicknessMap?o=r.thicknessMap:r.sheenColorMap?o=r.sheenColorMap:r.sheenRoughnessMap&&(o=r.sheenRoughnessMap),void 0!==o&&(o.isWebGLRenderTarget&&(o=o.texture),!0===o.matrixAutoUpdate&&o.updateMatrix(),n.uvTransform.value.copy(o.matrix)),r.aoMap?a=r.aoMap:r.lightMap&&(a=r.lightMap),void 0!==a&&(a.isWebGLRenderTarget&&(a=a.texture),!0===a.matrixAutoUpdate&&a.updateMatrix(),n.uv2Transform.value.copy(a.matrix))}return{refreshFogUniforms:function(e,n){n.color.getRGB(e.fogColor.value,xi(t)),n.isFog?(e.fogNear.value=n.near,e.fogFar.value=n.far):n.isFogExp2&&(e.fogDensity.value=n.density)},refreshMaterialUniforms:function(t,r,i,o,a){r.isMeshBasicMaterial||r.isMeshLambertMaterial?n(t,r):r.isMeshToonMaterial?(n(t,r),function(t,e){e.gradientMap&&(t.gradientMap.value=e.gradientMap)}(t,r)):r.isMeshPhongMaterial?(n(t,r),function(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4)}(t,r)):r.isMeshStandardMaterial?(n(t,r),function(t,n){t.roughness.value=n.roughness,t.metalness.value=n.metalness,n.roughnessMap&&(t.roughnessMap.value=n.roughnessMap);n.metalnessMap&&(t.metalnessMap.value=n.metalnessMap);const r=e.get(n).envMap;r&&(t.envMapIntensity.value=n.envMapIntensity)}(t,r),r.isMeshPhysicalMaterial&&function(t,e,n){t.ior.value=e.ior,e.sheen>0&&(t.sheenColor.value.copy(e.sheenColor).multiplyScalar(e.sheen),t.sheenRoughness.value=e.sheenRoughness,e.sheenColorMap&&(t.sheenColorMap.value=e.sheenColorMap),e.sheenRoughnessMap&&(t.sheenRoughnessMap.value=e.sheenRoughnessMap));e.clearcoat>0&&(t.clearcoat.value=e.clearcoat,t.clearcoatRoughness.value=e.clearcoatRoughness,e.clearcoatMap&&(t.clearcoatMap.value=e.clearcoatMap),e.clearcoatRoughnessMap&&(t.clearcoatRoughnessMap.value=e.clearcoatRoughnessMap),e.clearcoatNormalMap&&(t.clearcoatNormalScale.value.copy(e.clearcoatNormalScale),t.clearcoatNormalMap.value=e.clearcoatNormalMap,e.side===c&&t.clearcoatNormalScale.value.negate()));e.iridescence>0&&(t.iridescence.value=e.iridescence,t.iridescenceIOR.value=e.iridescenceIOR,t.iridescenceThicknessMinimum.value=e.iridescenceThicknessRange[0],t.iridescenceThicknessMaximum.value=e.iridescenceThicknessRange[1],e.iridescenceMap&&(t.iridescenceMap.value=e.iridescenceMap),e.iridescenceThicknessMap&&(t.iridescenceThicknessMap.value=e.iridescenceThicknessMap));e.transmission>0&&(t.transmission.value=e.transmission,t.transmissionSamplerMap.value=n.texture,t.transmissionSamplerSize.value.set(n.width,n.height),e.transmissionMap&&(t.transmissionMap.value=e.transmissionMap),t.thickness.value=e.thickness,e.thicknessMap&&(t.thicknessMap.value=e.thicknessMap),t.attenuationDistance.value=e.attenuationDistance,t.attenuationColor.value.copy(e.attenuationColor));t.specularIntensity.value=e.specularIntensity,t.specularColor.value.copy(e.specularColor),e.specularIntensityMap&&(t.specularIntensityMap.value=e.specularIntensityMap);e.specularColorMap&&(t.specularColorMap.value=e.specularColorMap)}(t,r,a)):r.isMeshMatcapMaterial?(n(t,r),function(t,e){e.matcap&&(t.matcap.value=e.matcap)}(t,r)):r.isMeshDepthMaterial?n(t,r):r.isMeshDistanceMaterial?(n(t,r),function(t,e){t.referencePosition.value.copy(e.referencePosition),t.nearDistance.value=e.nearDistance,t.farDistance.value=e.farDistance}(t,r)):r.isMeshNormalMaterial?n(t,r):r.isLineBasicMaterial?(function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity}(t,r),r.isLineDashedMaterial&&function(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}(t,r)):r.isPointsMaterial?function(t,e,n,r){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.size.value=e.size*n,t.scale.value=.5*r,e.map&&(t.map.value=e.map);e.alphaMap&&(t.alphaMap.value=e.alphaMap);e.alphaTest>0&&(t.alphaTest.value=e.alphaTest);let i;e.map?i=e.map:e.alphaMap&&(i=e.alphaMap);void 0!==i&&(!0===i.matrixAutoUpdate&&i.updateMatrix(),t.uvTransform.value.copy(i.matrix))}(t,r,i,o):r.isSpriteMaterial?function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.rotation.value=e.rotation,e.map&&(t.map.value=e.map);e.alphaMap&&(t.alphaMap.value=e.alphaMap);e.alphaTest>0&&(t.alphaTest.value=e.alphaTest);let n;e.map?n=e.map:e.alphaMap&&(n=e.alphaMap);void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),t.uvTransform.value.copy(n.matrix))}(t,r):r.isShadowMaterial?(t.color.value.copy(r.color),t.opacity.value=r.opacity):r.isShaderMaterial&&(r.uniformsNeedUpdate=!1)}}}function gs(t,e,n,r){let i={},o={},a=[];const s=n.isWebGL2?t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS):0;function u(t,e,n){const r=t.value;if(void 0===n[e]){if("number"==typeof r)n[e]=r;else{const t=Array.isArray(r)?r:[r],i=[];for(let e=0;e<t.length;e++)i.push(t[e].clone());n[e]=i}return!0}if("number"==typeof r){if(n[e]!==r)return n[e]=r,!0}else{const t=Array.isArray(n[e])?n[e]:[n[e]],i=Array.isArray(r)?r:[r];for(let e=0;e<t.length;e++){const n=t[e];if(!1===n.equals(i[e]))return n.copy(i[e]),!0}}return!1}function l(t){const e={boundary:0,storage:0};return"number"==typeof t?(e.boundary=4,e.storage=4):t.isVector2?(e.boundary=8,e.storage=8):t.isVector3||t.isColor?(e.boundary=16,e.storage=12):t.isVector4?(e.boundary=16,e.storage=16):t.isMatrix3?(e.boundary=48,e.storage=48):t.isMatrix4?(e.boundary=64,e.storage=64):t.isTexture,e}function c(e){const n=e.target;n.removeEventListener("dispose",c);const r=a.indexOf(n.__bindingPointIndex);a.splice(r,1),t.deleteBuffer(i[n.id]),delete i[n.id],delete o[n.id]}return{bind:function(t,e){const n=e.program;r.uniformBlockBinding(t,n)},update:function(n,h){let p=i[n.id];void 0===p&&(!function(t){const e=t.uniforms;let n=0;const r=16;let i=0;for(let t=0,o=e.length;t<o;t++){const o=e[t],a={boundary:0,storage:0},s=Array.isArray(o.value)?o.value:[o.value];for(let t=0,e=s.length;t<e;t++){const e=l(s[t]);a.boundary+=e.boundary,a.storage+=e.storage}if(o.__data=new Float32Array(a.storage/Float32Array.BYTES_PER_ELEMENT),o.__offset=n,t>0){i=n%r;0!==i&&r-i-a.boundary<0&&(n+=r-i,o.__offset=n)}n+=a.storage}i=n%r,i>0&&(n+=r-i);t.__size=n,t.__cache={}}(n),p=function(e){const n=function(){for(let t=0;t<s;t++)if(-1===a.indexOf(t))return a.push(t),t;return 0}();e.__bindingPointIndex=n;const r=t.createBuffer(),i=e.__size,o=e.usage;return t.bindBuffer(t.UNIFORM_BUFFER,r),t.bufferData(t.UNIFORM_BUFFER,i,o),t.bindBuffer(t.UNIFORM_BUFFER,null),t.bindBufferBase(t.UNIFORM_BUFFER,n,r),r}(n),i[n.id]=p,n.addEventListener("dispose",c));const f=h.program;r.updateUBOMapping(n,f);const d=e.render.frame;o[n.id]!==d&&(!function(e){const n=i[e.id],r=e.uniforms,o=e.__cache;t.bindBuffer(t.UNIFORM_BUFFER,n);for(let e=0,n=r.length;e<n;e++){const n=r[e];if(!0===u(n,e,o)){const e=n.__offset,r=Array.isArray(n.value)?n.value:[n.value];let i=0;for(let o=0;o<r.length;o++){const a=r[o],s=l(a);"number"==typeof a?(n.__data[0]=a,t.bufferSubData(t.UNIFORM_BUFFER,e+i,n.__data)):a.isMatrix3?(n.__data[0]=a.elements[0],n.__data[1]=a.elements[1],n.__data[2]=a.elements[2],n.__data[3]=a.elements[0],n.__data[4]=a.elements[3],n.__data[5]=a.elements[4],n.__data[6]=a.elements[5],n.__data[7]=a.elements[0],n.__data[8]=a.elements[6],n.__data[9]=a.elements[7],n.__data[10]=a.elements[8],n.__data[11]=a.elements[0]):(a.toArray(n.__data,i),i+=s.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(t.UNIFORM_BUFFER,e,n.__data)}}t.bindBuffer(t.UNIFORM_BUFFER,null)}(n),o[n.id]=d)},dispose:function(){for(const e in i)t.deleteBuffer(i[e]);a=[],i={},o={}}}}function vs(t={}){this.isWebGLRenderer=!0;const e=void 0!==t.canvas?t.canvas:function(){const t=Ke("canvas");return t.style.display="block",t}(),r=void 0!==t.context?t.context:null,i=void 0===t.depth||t.depth,o=void 0===t.stencil||t.stencil,a=void 0!==t.antialias&&t.antialias,s=void 0===t.premultipliedAlpha||t.premultipliedAlpha,u=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,p=void 0!==t.powerPreference?t.powerPreference:"default",f=void 0!==t.failIfMajorPerformanceCaveat&&t.failIfMajorPerformanceCaveat;let d;d=null!==r?r.getContextAttributes().alpha:void 0!==t.alpha&&t.alpha;let m=null,g=null;const v=[],y=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=ye,this.useLegacyLights=!0,this.toneMapping=H,this.toneMappingExposure=1;const x=this;let _=!1,b=0,w=0,M=null,S=-1,T=null;const E=new vn,A=new vn;let P=null,C=e.width,L=e.height,I=1,O=null,N=null;const R=new vn(0,0,C,L),D=new vn(0,0,C,L);let k=!1;const F=new Ri;let B=!1,U=!1,z=null;const V=new qn,G=new $e,j={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function W(){return null===M?I:1}let X,Y,q,Z,J,K,Q,$,tt,et,nt,rt,it,ot,at,st,ut,lt,ct,ft,dt,mt,gt,vt,_t=r;function bt(t,n){for(let r=0;r<t.length;r++){const i=t[r],o=e.getContext(i,n);if(null!==o)return o}return null}try{const t={alpha:!0,depth:i,stencil:o,antialias:a,premultipliedAlpha:s,preserveDrawingBuffer:u,powerPreference:p,failIfMajorPerformanceCaveat:f};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${n}`),e.addEventListener("webglcontextlost",Tt,!1),e.addEventListener("webglcontextrestored",Et,!1),e.addEventListener("webglcontextcreationerror",At,!1),null===_t){const e=["webgl2","webgl","experimental-webgl"];if(!0===x.isWebGL1Renderer&&e.shift(),_t=bt(e,t),null===_t)throw bt(e)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===_t.getShaderPrecisionFormat&&(_t.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(t){throw t}function wt(){X=new ho(_t),Y=new Hi(_t,X,t),X.init(Y),mt=new us(_t,X,Y),q=new as(_t,X,Y),Z=new mo(_t),J=new Wa,K=new ss(_t,X,q,J,Y,mt,Z),Q=new Yi(x),$=new co(x),tt=new ki(_t,Y),gt=new ji(_t,X,tt,Y),et=new po(_t,tt,Z,gt),nt=new xo(_t,et,tt,Z),ct=new yo(_t,Y,K),st=new Xi(J),rt=new ja(x,Q,$,X,Y,gt,st),it=new ms(x,J),ot=new qa,at=new ts(X,Y),lt=new Gi(x,Q,$,q,nt,d,s),ut=new os(x,nt,Y),vt=new gs(_t,Z,Y,q),ft=new Wi(_t,X,Z,Y),dt=new fo(_t,X,Z,Y),Z.programs=rt.programs,x.capabilities=Y,x.extensions=X,x.properties=J,x.renderLists=ot,x.shadowMap=ut,x.state=q,x.info=Z}wt();const Mt=new ds(x,_t);function Tt(t){t.preventDefault(),_=!0}function Et(){_=!1;const t=Z.autoReset,e=ut.enabled,n=ut.autoUpdate,r=ut.needsUpdate,i=ut.type;wt(),Z.autoReset=t,ut.enabled=e,ut.autoUpdate=n,ut.needsUpdate=r,ut.type=i}function At(t){}function Pt(t){const e=t.target;e.removeEventListener("dispose",Pt),function(t){(function(t){const e=J.get(t).programs;void 0!==e&&(e.forEach((function(t){rt.releaseProgram(t)})),t.isShaderMaterial&&rt.releaseShaderCache(t))})(t),J.remove(t)}(e)}this.xr=Mt,this.getContext=function(){return _t},this.getContextAttributes=function(){return _t.getContextAttributes()},this.forceContextLoss=function(){const t=X.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){const t=X.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return I},this.setPixelRatio=function(t){void 0!==t&&(I=t,this.setSize(C,L,!1))},this.getSize=function(t){return t.set(C,L)},this.setSize=function(t,n,r=!0){Mt.isPresenting||(C=t,L=n,e.width=Math.floor(t*I),e.height=Math.floor(n*I),!0===r&&(e.style.width=t+"px",e.style.height=n+"px"),this.setViewport(0,0,t,n))},this.getDrawingBufferSize=function(t){return t.set(C*I,L*I).floor()},this.setDrawingBufferSize=function(t,n,r){C=t,L=n,I=r,e.width=Math.floor(t*r),e.height=Math.floor(n*r),this.setViewport(0,0,t,n)},this.getCurrentViewport=function(t){return t.copy(E)},this.getViewport=function(t){return t.copy(R)},this.setViewport=function(t,e,n,r){t.isVector4?R.set(t.x,t.y,t.z,t.w):R.set(t,e,n,r),q.viewport(E.copy(R).multiplyScalar(I).floor())},this.getScissor=function(t){return t.copy(D)},this.setScissor=function(t,e,n,r){t.isVector4?D.set(t.x,t.y,t.z,t.w):D.set(t,e,n,r),q.scissor(A.copy(D).multiplyScalar(I).floor())},this.getScissorTest=function(){return k},this.setScissorTest=function(t){q.setScissorTest(k=t)},this.setOpaqueSort=function(t){O=t},this.setTransparentSort=function(t){N=t},this.getClearColor=function(t){return t.copy(lt.getClearColor())},this.setClearColor=function(){lt.setClearColor.apply(lt,arguments)},this.getClearAlpha=function(){return lt.getClearAlpha()},this.setClearAlpha=function(){lt.setClearAlpha.apply(lt,arguments)},this.clear=function(t=!0,e=!0,n=!0){let r=0;t&&(r|=_t.COLOR_BUFFER_BIT),e&&(r|=_t.DEPTH_BUFFER_BIT),n&&(r|=_t.STENCIL_BUFFER_BIT),_t.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",Tt,!1),e.removeEventListener("webglcontextrestored",Et,!1),e.removeEventListener("webglcontextcreationerror",At,!1),ot.dispose(),at.dispose(),J.dispose(),Q.dispose(),$.dispose(),nt.dispose(),gt.dispose(),vt.dispose(),rt.dispose(),Mt.dispose(),Mt.removeEventListener("sessionstart",Lt),Mt.removeEventListener("sessionend",It),z&&(z.dispose(),z=null),Ot.stop()},this.renderBufferDirect=function(t,e,n,r,i,o){null===e&&(e=j);const a=i.isMesh&&i.matrixWorld.determinant()<0,s=function(t,e,n,r,i){!0!==e.isScene&&(e=j);K.resetTextureUnits();const o=e.fog,a=r.isMeshStandardMaterial?e.environment:null,s=null===M?x.outputEncoding:!0===M.isXRRenderTarget?M.texture.encoding:ye,u=(r.isMeshStandardMaterial?$:Q).get(r.envMap||a),l=!0===r.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,c=!!r.normalMap&&!!n.attributes.tangent,h=!!n.morphAttributes.position,p=!!n.morphAttributes.normal,f=!!n.morphAttributes.color,d=r.toneMapped?x.toneMapping:H,m=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,v=void 0!==m?m.length:0,y=J.get(r),_=g.state.lights;if(!0===B&&(!0===U||t!==T)){const e=t===T&&r.id===S;st.setState(r,t,e)}let b=!1;r.version===y.__version?y.needsLights&&y.lightsStateVersion!==_.state.version||y.outputEncoding!==s||i.isInstancedMesh&&!1===y.instancing?b=!0:i.isInstancedMesh||!0!==y.instancing?i.isSkinnedMesh&&!1===y.skinning?b=!0:i.isSkinnedMesh||!0!==y.skinning?y.envMap!==u||!0===r.fog&&y.fog!==o?b=!0:void 0===y.numClippingPlanes||y.numClippingPlanes===st.numPlanes&&y.numIntersection===st.numIntersection?(y.vertexAlphas!==l||y.vertexTangents!==c||y.morphTargets!==h||y.morphNormals!==p||y.morphColors!==f||y.toneMapping!==d||!0===Y.isWebGL2&&y.morphTargetsCount!==v)&&(b=!0):b=!0:b=!0:b=!0:(b=!0,y.__version=r.version);let w=y.currentProgram;!0===b&&(w=Ft(r,e,i));let E=!1,A=!1,P=!1;const C=w.getUniforms(),O=y.uniforms;q.useProgram(w.program)&&(E=!0,A=!0,P=!0);r.id!==S&&(S=r.id,A=!0);if(E||T!==t){if(C.setValue(_t,"projectionMatrix",t.projectionMatrix),Y.logarithmicDepthBuffer&&C.setValue(_t,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),T!==t&&(T=t,A=!0,P=!0),r.isShaderMaterial||r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshStandardMaterial||r.envMap){const e=C.map.cameraPosition;void 0!==e&&e.setValue(_t,G.setFromMatrixPosition(t.matrixWorld))}(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial)&&C.setValue(_t,"isOrthographic",!0===t.isOrthographicCamera),(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial||r.isShadowMaterial||i.isSkinnedMesh)&&C.setValue(_t,"viewMatrix",t.matrixWorldInverse)}if(i.isSkinnedMesh){C.setOptional(_t,i,"bindMatrix"),C.setOptional(_t,i,"bindMatrixInverse");const t=i.skeleton;t&&Y.floatVertexTextures&&(null===t.boneTexture&&t.computeBoneTexture(),C.setValue(_t,"boneTexture",t.boneTexture,K),C.setValue(_t,"boneTextureSize",t.boneTextureSize))}const N=n.morphAttributes;(void 0!==N.position||void 0!==N.normal||void 0!==N.color&&!0===Y.isWebGL2)&&ct.update(i,n,w);(A||y.receiveShadow!==i.receiveShadow)&&(y.receiveShadow=i.receiveShadow,C.setValue(_t,"receiveShadow",i.receiveShadow));r.isMeshGouraudMaterial&&null!==r.envMap&&(O.envMap.value=u,O.flipEnvMap.value=u.isCubeTexture&&!1===u.isRenderTargetTexture?-1:1);A&&(C.setValue(_t,"toneMappingExposure",x.toneMappingExposure),y.needsLights&&(D=P,(R=O).ambientLightColor.needsUpdate=D,R.lightProbe.needsUpdate=D,R.directionalLights.needsUpdate=D,R.directionalLightShadows.needsUpdate=D,R.pointLights.needsUpdate=D,R.pointLightShadows.needsUpdate=D,R.spotLights.needsUpdate=D,R.spotLightShadows.needsUpdate=D,R.rectAreaLights.needsUpdate=D,R.hemisphereLights.needsUpdate=D),o&&!0===r.fog&&it.refreshFogUniforms(O,o),it.refreshMaterialUniforms(O,r,I,L,z),Ma.upload(_t,y.uniformsList,O,K));var R,D;r.isShaderMaterial&&!0===r.uniformsNeedUpdate&&(Ma.upload(_t,y.uniformsList,O,K),r.uniformsNeedUpdate=!1);r.isSpriteMaterial&&C.setValue(_t,"center",i.center);if(C.setValue(_t,"modelViewMatrix",i.modelViewMatrix),C.setValue(_t,"normalMatrix",i.normalMatrix),C.setValue(_t,"modelMatrix",i.matrixWorld),r.isShaderMaterial||r.isRawShaderMaterial){const t=r.uniformsGroups;for(let e=0,n=t.length;e<n;e++)if(Y.isWebGL2){const n=t[e];vt.update(n,w),vt.bind(n,w)}}return w}(t,e,n,r,i);q.setMaterial(r,a);let u=n.index,l=1;!0===r.wireframe&&(u=et.getWireframeAttribute(n),l=2);const c=n.drawRange,h=n.attributes.position;let p=c.start*l,f=(c.start+c.count)*l;null!==o&&(p=Math.max(p,o.start*l),f=Math.min(f,(o.start+o.count)*l)),null!==u?(p=Math.max(p,0),f=Math.min(f,u.count)):null!=h&&(p=Math.max(p,0),f=Math.min(f,h.count));const d=f-p;if(d<0||d===1/0)return;let m;gt.setup(i,r,s,n,u);let v=ft;if(null!==u&&(m=tt.get(u),v=dt,v.setIndex(m)),i.isMesh)!0===r.wireframe?(q.setLineWidth(r.wireframeLinewidth*W()),v.setMode(_t.LINES)):v.setMode(_t.TRIANGLES);else if(i.isLine){let t=r.linewidth;void 0===t&&(t=1),q.setLineWidth(t*W()),i.isLineSegments?v.setMode(_t.LINES):i.isLineLoop?v.setMode(_t.LINE_LOOP):v.setMode(_t.LINE_STRIP)}else i.isPoints?v.setMode(_t.POINTS):i.isSprite&&v.setMode(_t.TRIANGLES);if(i.isInstancedMesh)v.renderInstances(p,d,i.count);else if(n.isInstancedBufferGeometry){const t=void 0!==n._maxInstanceCount?n._maxInstanceCount:1/0,e=Math.min(n.instanceCount,t);v.renderInstances(p,d,e)}else v.render(p,d)},this.compile=function(t,e){function n(t,e,n){!0===t.transparent&&t.side===h&&!1===t.forceSinglePass?(t.side=c,t.needsUpdate=!0,Ft(t,e,n),t.side=l,t.needsUpdate=!0,Ft(t,e,n),t.side=h):Ft(t,e,n)}g=at.get(t),g.init(),y.push(g),t.traverseVisible((function(t){t.isLight&&t.layers.test(e.layers)&&(g.pushLight(t),t.castShadow&&g.pushShadow(t))})),g.setupLights(x.useLegacyLights),t.traverse((function(e){const r=e.material;if(r)if(Array.isArray(r))for(let i=0;i<r.length;i++){n(r[i],t,e)}else n(r,t,e)})),y.pop(),g=null};let Ct=null;function Lt(){Ot.stop()}function It(){Ot.start()}const Ot=new Di;function Nt(t,e,n,r){if(!1===t.visible)return;if(t.layers.test(e.layers))if(t.isGroup)n=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(e);else if(t.isLight)g.pushLight(t),t.castShadow&&g.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||F.intersectsSprite(t)){r&&G.setFromMatrixPosition(t.matrixWorld).applyMatrix4(V);const e=nt.update(t),i=t.material;i.visible&&m.push(t,e,i,n,G.z,null)}}else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.frame!==Z.render.frame&&(t.skeleton.update(),t.skeleton.frame=Z.render.frame),!t.frustumCulled||F.intersectsObject(t))){r&&G.setFromMatrixPosition(t.matrixWorld).applyMatrix4(V);const e=nt.update(t),i=t.material;if(Array.isArray(i)){const r=e.groups;for(let o=0,a=r.length;o<a;o++){const a=r[o],s=i[a.materialIndex];s&&s.visible&&m.push(t,e,s,n,G.z,a)}}else i.visible&&m.push(t,e,i,n,G.z,null)}const i=t.children;for(let t=0,o=i.length;t<o;t++)Nt(i[t],e,n,r)}function Rt(t,e,n,r){const i=t.opaque,o=t.transmissive,s=t.transparent;g.setupLightsView(n),!0===B&&st.setGlobalState(x.clippingPlanes,n),o.length>0&&function(t,e,n){const r=Y.isWebGL2;null===z&&(z=new yn(1024,1024,{generateMipmaps:!0,type:X.has("EXT_color_buffer_half_float")?xt:pt,minFilter:ht,samples:r&&!0===a?4:0}));const i=x.getRenderTarget();x.setRenderTarget(z),x.clear();const o=x.toneMapping;x.toneMapping=H,Dt(t,e,n),x.toneMapping=o,K.updateMultisampleRenderTarget(z),K.updateRenderTargetMipmap(z),x.setRenderTarget(i)}(i,e,n),r&&q.viewport(E.copy(r)),i.length>0&&Dt(i,e,n),o.length>0&&Dt(o,e,n),s.length>0&&Dt(s,e,n),q.buffers.depth.setTest(!0),q.buffers.depth.setMask(!0),q.buffers.color.setMask(!0),q.setPolygonOffset(!1)}function Dt(t,e,n){const r=!0===e.isScene?e.overrideMaterial:null;for(let i=0,o=t.length;i<o;i++){const o=t[i],a=o.object,s=o.geometry,u=null===r?o.material:r,l=o.group;a.layers.test(n.layers)&&kt(a,e,n,s,u,l)}}function kt(t,e,n,r,i,o){t.onBeforeRender(x,e,n,r,i,o),t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),i.onBeforeRender(x,e,n,r,t,o),!0===i.transparent&&i.side===h&&!1===i.forceSinglePass?(i.side=c,i.needsUpdate=!0,x.renderBufferDirect(n,e,r,i,t,o),i.side=l,i.needsUpdate=!0,x.renderBufferDirect(n,e,r,i,t,o),i.side=h):x.renderBufferDirect(n,e,r,i,t,o),t.onAfterRender(x,e,n,r,i,o)}function Ft(t,e,n){!0!==e.isScene&&(e=j);const r=J.get(t),i=g.state.lights,o=g.state.shadowsArray,a=i.state.version,s=rt.getParameters(t,i.state,o,e,n),u=rt.getProgramCacheKey(s);let l=r.programs;r.environment=t.isMeshStandardMaterial?e.environment:null,r.fog=e.fog,r.envMap=(t.isMeshStandardMaterial?$:Q).get(t.envMap||r.environment),void 0===l&&(t.addEventListener("dispose",Pt),l=new Map,r.programs=l);let c=l.get(u);if(void 0!==c){if(r.currentProgram===c&&r.lightsStateVersion===a)return Bt(t,s),c}else s.uniforms=rt.getUniforms(t),t.onBuild(n,s,x),t.onBeforeCompile(s,x),c=rt.acquireProgram(s,u),l.set(u,c),r.uniforms=s.uniforms;const h=r.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(h.clippingPlanes=st.uniform),Bt(t,s),r.needsLights=function(t){return t.isMeshLambertMaterial||t.isMeshToonMaterial||t.isMeshPhongMaterial||t.isMeshStandardMaterial||t.isShadowMaterial||t.isShaderMaterial&&!0===t.lights}(t),r.lightsStateVersion=a,r.needsLights&&(h.ambientLightColor.value=i.state.ambient,h.lightProbe.value=i.state.probe,h.directionalLights.value=i.state.directional,h.directionalLightShadows.value=i.state.directionalShadow,h.spotLights.value=i.state.spot,h.spotLightShadows.value=i.state.spotShadow,h.rectAreaLights.value=i.state.rectArea,h.ltc_1.value=i.state.rectAreaLTC1,h.ltc_2.value=i.state.rectAreaLTC2,h.pointLights.value=i.state.point,h.pointLightShadows.value=i.state.pointShadow,h.hemisphereLights.value=i.state.hemi,h.directionalShadowMap.value=i.state.directionalShadowMap,h.directionalShadowMatrix.value=i.state.directionalShadowMatrix,h.spotShadowMap.value=i.state.spotShadowMap,h.spotLightMatrix.value=i.state.spotLightMatrix,h.spotLightMap.value=i.state.spotLightMap,h.pointShadowMap.value=i.state.pointShadowMap,h.pointShadowMatrix.value=i.state.pointShadowMatrix);const p=c.getUniforms(),f=Ma.seqWithValue(p.seq,h);return r.currentProgram=c,r.uniformsList=f,c}function Bt(t,e){const n=J.get(t);n.outputEncoding=e.outputEncoding,n.instancing=e.instancing,n.skinning=e.skinning,n.morphTargets=e.morphTargets,n.morphNormals=e.morphNormals,n.morphColors=e.morphColors,n.morphTargetsCount=e.morphTargetsCount,n.numClippingPlanes=e.numClippingPlanes,n.numIntersection=e.numClipIntersection,n.vertexAlphas=e.vertexAlphas,n.vertexTangents=e.vertexTangents,n.toneMapping=e.toneMapping}Ot.setAnimationLoop((function(t){Ct&&Ct(t)})),"undefined"!=typeof self&&Ot.setContext(self),this.setAnimationLoop=function(t){Ct=t,Mt.setAnimationLoop(t),null===t?Ot.stop():Ot.start()},Mt.addEventListener("sessionstart",Lt),Mt.addEventListener("sessionend",It),this.render=function(t,e){if(void 0!==e&&!0!==e.isCamera)return;if(!0===_)return;!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),null===e.parent&&!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),!0===Mt.enabled&&!0===Mt.isPresenting&&(!0===Mt.cameraAutoUpdate&&Mt.updateCamera(e),e=Mt.getCamera()),!0===t.isScene&&t.onBeforeRender(x,t,e,M),g=at.get(t,y.length),g.init(),y.push(g),V.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),F.setFromProjectionMatrix(V),U=this.localClippingEnabled,B=st.init(this.clippingPlanes,U),m=ot.get(t,v.length),m.init(),v.push(m),Nt(t,e,0,x.sortObjects),m.finish(),!0===x.sortObjects&&m.sort(O,N),!0===B&&st.beginShadows();const n=g.state.shadowsArray;if(ut.render(n,t,e),!0===B&&st.endShadows(),!0===this.info.autoReset&&this.info.reset(),lt.render(m,t),g.setupLights(x.useLegacyLights),e.isArrayCamera){const n=e.cameras;for(let e=0,r=n.length;e<r;e++){const r=n[e];Rt(m,t,r,r.viewport)}}else Rt(m,t,e);null!==M&&(K.updateMultisampleRenderTarget(M),K.updateRenderTargetMipmap(M)),!0===t.isScene&&t.onAfterRender(x,t,e),gt.resetDefaultState(),S=-1,T=null,y.pop(),g=y.length>0?y[y.length-1]:null,v.pop(),m=v.length>0?v[v.length-1]:null},this.getActiveCubeFace=function(){return b},this.getActiveMipmapLevel=function(){return w},this.getRenderTarget=function(){return M},this.setRenderTargetTextures=function(t,e,n){J.get(t.texture).__webglTexture=e,J.get(t.depthTexture).__webglTexture=n;const r=J.get(t);r.__hasExternalTextures=!0,r.__hasExternalTextures&&(r.__autoAllocateDepthBuffer=void 0===n,r.__autoAllocateDepthBuffer||!0===X.has("WEBGL_multisampled_render_to_texture")&&(r.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(t,e){const n=J.get(t);n.__webglFramebuffer=e,n.__useDefaultFramebuffer=void 0===e},this.setRenderTarget=function(t,e=0,n=0){M=t,b=e,w=n;let r=!0,i=null,o=!1,a=!1;if(t){const n=J.get(t);void 0!==n.__useDefaultFramebuffer?(q.bindFramebuffer(_t.FRAMEBUFFER,null),r=!1):void 0===n.__webglFramebuffer?K.setupRenderTarget(t):n.__hasExternalTextures&&K.rebindTextures(t,J.get(t.texture).__webglTexture,J.get(t.depthTexture).__webglTexture);const s=t.texture;(s.isData3DTexture||s.isDataArrayTexture||s.isCompressedArrayTexture)&&(a=!0);const u=J.get(t).__webglFramebuffer;t.isWebGLCubeRenderTarget?(i=u[e],o=!0):i=Y.isWebGL2&&t.samples>0&&!1===K.useMultisampledRTT(t)?J.get(t).__webglMultisampledFramebuffer:u,E.copy(t.viewport),A.copy(t.scissor),P=t.scissorTest}else E.copy(R).multiplyScalar(I).floor(),A.copy(D).multiplyScalar(I).floor(),P=k;if(q.bindFramebuffer(_t.FRAMEBUFFER,i)&&Y.drawBuffers&&r&&q.drawBuffers(t,i),q.viewport(E),q.scissor(A),q.setScissorTest(P),o){const r=J.get(t.texture);_t.framebufferTexture2D(_t.FRAMEBUFFER,_t.COLOR_ATTACHMENT0,_t.TEXTURE_CUBE_MAP_POSITIVE_X+e,r.__webglTexture,n)}else if(a){const r=J.get(t.texture),i=e||0;_t.framebufferTextureLayer(_t.FRAMEBUFFER,_t.COLOR_ATTACHMENT0,r.__webglTexture,n||0,i)}S=-1},this.readRenderTargetPixels=function(t,e,n,r,i,o,a){if(!t||!t.isWebGLRenderTarget)return;let s=J.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==a&&(s=s[a]),s){q.bindFramebuffer(_t.FRAMEBUFFER,s);try{const a=t.texture,s=a.format,u=a.type;if(s!==St&&mt.convert(s)!==_t.getParameter(_t.IMPLEMENTATION_COLOR_READ_FORMAT))return;const l=u===xt&&(X.has("EXT_color_buffer_half_float")||Y.isWebGL2&&X.has("EXT_color_buffer_float"));if(!(u===pt||mt.convert(u)===_t.getParameter(_t.IMPLEMENTATION_COLOR_READ_TYPE)||u===yt&&(Y.isWebGL2||X.has("OES_texture_float")||X.has("WEBGL_color_buffer_float"))||l))return;e>=0&&e<=t.width-r&&n>=0&&n<=t.height-i&&_t.readPixels(e,n,r,i,mt.convert(s),mt.convert(u),o)}finally{const t=null!==M?J.get(M).__webglFramebuffer:null;q.bindFramebuffer(_t.FRAMEBUFFER,t)}}},this.copyFramebufferToTexture=function(t,e,n=0){const r=Math.pow(2,-n),i=Math.floor(e.image.width*r),o=Math.floor(e.image.height*r);K.setTexture2D(e,0),_t.copyTexSubImage2D(_t.TEXTURE_2D,n,0,0,t.x,t.y,i,o),q.unbindTexture()},this.copyTextureToTexture=function(t,e,n,r=0){const i=e.image.width,o=e.image.height,a=mt.convert(n.format),s=mt.convert(n.type);K.setTexture2D(n,0),_t.pixelStorei(_t.UNPACK_FLIP_Y_WEBGL,n.flipY),_t.pixelStorei(_t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlpha),_t.pixelStorei(_t.UNPACK_ALIGNMENT,n.unpackAlignment),e.isDataTexture?_t.texSubImage2D(_t.TEXTURE_2D,r,t.x,t.y,i,o,a,s,e.image.data):e.isCompressedTexture?_t.compressedTexSubImage2D(_t.TEXTURE_2D,r,t.x,t.y,e.mipmaps[0].width,e.mipmaps[0].height,a,e.mipmaps[0].data):_t.texSubImage2D(_t.TEXTURE_2D,r,t.x,t.y,a,s,e.image),0===r&&n.generateMipmaps&&_t.generateMipmap(_t.TEXTURE_2D),q.unbindTexture()},this.copyTextureToTexture3D=function(t,e,n,r,i=0){if(x.isWebGL1Renderer)return;const o=t.max.x-t.min.x+1,a=t.max.y-t.min.y+1,s=t.max.z-t.min.z+1,u=mt.convert(r.format),l=mt.convert(r.type);let c;if(r.isData3DTexture)K.setTexture3D(r,0),c=_t.TEXTURE_3D;else{if(!r.isDataArrayTexture)return;K.setTexture2DArray(r,0),c=_t.TEXTURE_2D_ARRAY}_t.pixelStorei(_t.UNPACK_FLIP_Y_WEBGL,r.flipY),_t.pixelStorei(_t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.premultiplyAlpha),_t.pixelStorei(_t.UNPACK_ALIGNMENT,r.unpackAlignment);const h=_t.getParameter(_t.UNPACK_ROW_LENGTH),p=_t.getParameter(_t.UNPACK_IMAGE_HEIGHT),f=_t.getParameter(_t.UNPACK_SKIP_PIXELS),d=_t.getParameter(_t.UNPACK_SKIP_ROWS),m=_t.getParameter(_t.UNPACK_SKIP_IMAGES),g=n.isCompressedTexture?n.mipmaps[0]:n.image;_t.pixelStorei(_t.UNPACK_ROW_LENGTH,g.width),_t.pixelStorei(_t.UNPACK_IMAGE_HEIGHT,g.height),_t.pixelStorei(_t.UNPACK_SKIP_PIXELS,t.min.x),_t.pixelStorei(_t.UNPACK_SKIP_ROWS,t.min.y),_t.pixelStorei(_t.UNPACK_SKIP_IMAGES,t.min.z),n.isDataTexture||n.isData3DTexture?_t.texSubImage3D(c,i,e.x,e.y,e.z,o,a,s,u,l,g.data):n.isCompressedArrayTexture?_t.compressedTexSubImage3D(c,i,e.x,e.y,e.z,o,a,s,u,g.data):_t.texSubImage3D(c,i,e.x,e.y,e.z,o,a,s,u,l,g),_t.pixelStorei(_t.UNPACK_ROW_LENGTH,h),_t.pixelStorei(_t.UNPACK_IMAGE_HEIGHT,p),_t.pixelStorei(_t.UNPACK_SKIP_PIXELS,f),_t.pixelStorei(_t.UNPACK_SKIP_ROWS,d),_t.pixelStorei(_t.UNPACK_SKIP_IMAGES,m),0===i&&r.generateMipmaps&&_t.generateMipmap(c),q.unbindTexture()},this.initTexture=function(t){t.isCubeTexture?K.setTextureCube(t,0):t.isData3DTexture?K.setTexture3D(t,0):t.isDataArrayTexture||t.isCompressedArrayTexture?K.setTexture2DArray(t,0):K.setTexture2D(t,0),q.unbindTexture()},this.resetState=function(){b=0,w=0,M=null,q.reset(),gt.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Object.defineProperties(vs.prototype,{physicallyCorrectLights:{get:function(){return!this.useLegacyLights},set:function(t){this.useLegacyLights=!t}}});class ys extends vs{}ys.prototype.isWebGL1Renderer=!0;class xs{constructor(t,e=25e-5){this.isFogExp2=!0,this.name="",this.color=new Fr(t),this.density=e}clone(){return new xs(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}class _s{constructor(t,e=1,n=1e3){this.isFog=!0,this.name="",this.color=new Fr(t),this.near=e,this.far=n}clone(){return new _s(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}class bs extends xr{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,e){return super.copy(t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),this.backgroundBlurriness=t.backgroundBlurriness,this.backgroundIntensity=t.backgroundIntensity,null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const e=super.toJSON(t);return null!==this.fog&&(e.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(e.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(e.object.backgroundIntensity=this.backgroundIntensity),e}get autoUpdate(){return this.matrixWorldAutoUpdate}set autoUpdate(t){this.matrixWorldAutoUpdate=t}}class ws{constructor(t,e){this.isInterleavedBuffer=!0,this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.usage=Ae,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=De()}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this}copyAt(t,e,n){t*=this.stride,n*=e.stride;for(let r=0,i=this.stride;r<i;r++)this.array[t+r]=e.array[n+r];return this}set(t,e=0){return this.array.set(t,e),this}clone(t){void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=De()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const e=new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(e,this.stride);return n.setUsage(this.usage),n}onUpload(t){return this.onUploadCallback=t,this}toJSON(t){return void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=De()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Ms=new $e;class Ss{constructor(t,e,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=t,this.itemSize=e,this.offset=n,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(t){this.data.needsUpdate=t}applyMatrix4(t){for(let e=0,n=this.data.count;e<n;e++)Ms.fromBufferAttribute(this,e),Ms.applyMatrix4(t),this.setXYZ(e,Ms.x,Ms.y,Ms.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)Ms.fromBufferAttribute(this,e),Ms.applyNormalMatrix(t),this.setXYZ(e,Ms.x,Ms.y,Ms.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)Ms.fromBufferAttribute(this,e),Ms.transformDirection(t),this.setXYZ(e,Ms.x,Ms.y,Ms.z);return this}setX(t,e){return this.normalized&&(e=je(e,this.array)),this.data.array[t*this.data.stride+this.offset]=e,this}setY(t,e){return this.normalized&&(e=je(e,this.array)),this.data.array[t*this.data.stride+this.offset+1]=e,this}setZ(t,e){return this.normalized&&(e=je(e,this.array)),this.data.array[t*this.data.stride+this.offset+2]=e,this}setW(t,e){return this.normalized&&(e=je(e,this.array)),this.data.array[t*this.data.stride+this.offset+3]=e,this}getX(t){let e=this.data.array[t*this.data.stride+this.offset];return this.normalized&&(e=Ge(e,this.array)),e}getY(t){let e=this.data.array[t*this.data.stride+this.offset+1];return this.normalized&&(e=Ge(e,this.array)),e}getZ(t){let e=this.data.array[t*this.data.stride+this.offset+2];return this.normalized&&(e=Ge(e,this.array)),e}getW(t){let e=this.data.array[t*this.data.stride+this.offset+3];return this.normalized&&(e=Ge(e,this.array)),e}setXY(t,e,n){return t=t*this.data.stride+this.offset,this.normalized&&(e=je(e,this.array),n=je(n,this.array)),this.data.array[t+0]=e,this.data.array[t+1]=n,this}setXYZ(t,e,n,r){return t=t*this.data.stride+this.offset,this.normalized&&(e=je(e,this.array),n=je(n,this.array),r=je(r,this.array)),this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this}setXYZW(t,e,n,r,i){return t=t*this.data.stride+this.offset,this.normalized&&(e=je(e,this.array),n=je(n,this.array),r=je(r,this.array),i=je(i,this.array)),this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this.data.array[t+3]=i,this}clone(t){if(void 0===t){const t=[];for(let e=0;e<this.count;e++){const n=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[n+e])}return new Gr(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new Ss(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(t){if(void 0===t){const t=[];for(let e=0;e<this.count;e++){const n=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[n+e])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class Ts extends Or{constructor(t){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Fr(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this.fog=t.fog,this}}let Es;const As=new $e,Ps=new $e,Cs=new $e,Ls=new He,Is=new He,Os=new qn,Ns=new $e,Rs=new $e,Ds=new $e,ks=new He,Fs=new He,Bs=new He;class Us extends xr{constructor(t){if(super(),this.isSprite=!0,this.type="Sprite",void 0===Es){Es=new $r;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),e=new ws(t,5);Es.setIndex([0,1,2,0,2,3]),Es.setAttribute("position",new Ss(e,3,0,!1)),Es.setAttribute("uv",new Ss(e,2,3,!1))}this.geometry=Es,this.material=void 0!==t?t:new Ts,this.center=new He(.5,.5)}raycast(t,e){t.camera,Ps.setFromMatrixScale(this.matrixWorld),Os.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),Cs.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Ps.multiplyScalar(-Cs.z);const n=this.material.rotation;let r,i;0!==n&&(i=Math.cos(n),r=Math.sin(n));const o=this.center;zs(Ns.set(-.5,-.5,0),Cs,o,Ps,r,i),zs(Rs.set(.5,-.5,0),Cs,o,Ps,r,i),zs(Ds.set(.5,.5,0),Cs,o,Ps,r,i),ks.set(0,0),Fs.set(1,0),Bs.set(1,1);let a=t.ray.intersectTriangle(Ns,Rs,Ds,!1,As);if(null===a&&(zs(Rs.set(-.5,.5,0),Cs,o,Ps,r,i),Fs.set(0,1),a=t.ray.intersectTriangle(Ns,Ds,Rs,!1,As),null===a))return;const s=t.ray.origin.distanceTo(As);s<t.near||s>t.far||e.push({distance:s,point:As.clone(),uv:Lr.getUV(As,Ns,Rs,Ds,ks,Fs,Bs,new He),face:null,object:this})}copy(t,e){return super.copy(t,e),void 0!==t.center&&this.center.copy(t.center),this.material=t.material,this}}function zs(t,e,n,r,i,o){Ls.subVectors(t,n).addScalar(.5).multiply(r),void 0!==i?(Is.x=o*Ls.x-i*Ls.y,Is.y=i*Ls.x+o*Ls.y):Is.copy(Ls),t.copy(e),t.x+=Is.x,t.y+=Is.y,t.applyMatrix4(Os)}const Vs=new $e,Gs=new $e;class js extends xr{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(t){super.copy(t,!1);const e=t.levels;for(let t=0,n=e.length;t<n;t++){const n=e[t];this.addLevel(n.object.clone(),n.distance,n.hysteresis)}return this.autoUpdate=t.autoUpdate,this}addLevel(t,e=0,n=0){e=Math.abs(e);const r=this.levels;let i;for(i=0;i<r.length&&!(e<r[i].distance);i++);return r.splice(i,0,{distance:e,hysteresis:n,object:t}),this.add(t),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(t){const e=this.levels;if(e.length>0){let n,r;for(n=1,r=e.length;n<r;n++){let r=e[n].distance;if(e[n].object.visible&&(r-=r*e[n].hysteresis),t<r)break}return e[n-1].object}return null}raycast(t,e){if(this.levels.length>0){Vs.setFromMatrixPosition(this.matrixWorld);const n=t.ray.origin.distanceTo(Vs);this.getObjectForDistance(n).raycast(t,e)}}update(t){const e=this.levels;if(e.length>1){Vs.setFromMatrixPosition(t.matrixWorld),Gs.setFromMatrixPosition(this.matrixWorld);const n=Vs.distanceTo(Gs)/t.zoom;let r,i;for(e[0].object.visible=!0,r=1,i=e.length;r<i;r++){let t=e[r].distance;if(e[r].object.visible&&(t-=t*e[r].hysteresis),!(n>=t))break;e[r-1].object.visible=!1,e[r].object.visible=!0}for(this._currentLevel=r-1;r<i;r++)e[r].object.visible=!1}}toJSON(t){const e=super.toJSON(t);!1===this.autoUpdate&&(e.object.autoUpdate=!1),e.object.levels=[];const n=this.levels;for(let t=0,r=n.length;t<r;t++){const r=n[t];e.object.levels.push({object:r.object.uuid,distance:r.distance,hysteresis:r.hysteresis})}return e}}const Ws=new $e,Hs=new vn,Xs=new vn,Ys=new $e,qs=new qn;class Zs extends di{constructor(t,e){super(t,e),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new qn,this.bindMatrixInverse=new qn}copy(t,e){return super.copy(t,e),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,this}bind(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.copy(e).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const t=new vn,e=this.geometry.attributes.skinWeight;for(let n=0,r=e.count;n<r;n++){t.fromBufferAttribute(e,n);const r=1/t.manhattanLength();r!==1/0?t.multiplyScalar(r):t.set(1,0,0,0),e.setXYZW(n,t.x,t.y,t.z,t.w)}}updateMatrixWorld(t){super.updateMatrixWorld(t),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode&&this.bindMatrixInverse.copy(this.bindMatrix).invert()}boneTransform(t,e){const n=this.skeleton,r=this.geometry;Hs.fromBufferAttribute(r.attributes.skinIndex,t),Xs.fromBufferAttribute(r.attributes.skinWeight,t),Ws.copy(e).applyMatrix4(this.bindMatrix),e.set(0,0,0);for(let t=0;t<4;t++){const r=Xs.getComponent(t);if(0!==r){const i=Hs.getComponent(t);qs.multiplyMatrices(n.bones[i].matrixWorld,n.boneInverses[i]),e.addScaledVector(Ys.copy(Ws).applyMatrix4(qs),r)}}return e.applyMatrix4(this.bindMatrixInverse)}}class Js extends xr{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Ks extends gn{constructor(t=null,e=1,n=1,r,i,o,a,s,u=at,l=at,c,h){super(null,o,a,s,u,l,r,i,c,h),this.isDataTexture=!0,this.image={data:t,width:e,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const Qs=new qn,$s=new qn;class tu{constructor(t=[],e=[]){this.uuid=De(),this.bones=t.slice(0),this.boneInverses=e,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const t=this.bones,e=this.boneInverses;if(this.boneMatrices=new Float32Array(16*t.length),0===e.length)this.calculateInverses();else if(t.length!==e.length){this.boneInverses=[];for(let t=0,e=this.bones.length;t<e;t++)this.boneInverses.push(new qn)}}calculateInverses(){this.boneInverses.length=0;for(let t=0,e=this.bones.length;t<e;t++){const e=new qn;this.bones[t]&&e.copy(this.bones[t].matrixWorld).invert(),this.boneInverses.push(e)}}pose(){for(let t=0,e=this.bones.length;t<e;t++){const e=this.bones[t];e&&e.matrixWorld.copy(this.boneInverses[t]).invert()}for(let t=0,e=this.bones.length;t<e;t++){const e=this.bones[t];e&&(e.parent&&e.parent.isBone?(e.matrix.copy(e.parent.matrixWorld).invert(),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))}}update(){const t=this.bones,e=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let r=0,i=t.length;r<i;r++){const i=t[r]?t[r].matrixWorld:$s;Qs.multiplyMatrices(i,e[r]),Qs.toArray(n,16*r)}null!==r&&(r.needsUpdate=!0)}clone(){return new tu(this.bones,this.boneInverses)}computeBoneTexture(){let t=Math.sqrt(4*this.bones.length);t=ze(t),t=Math.max(t,4);const e=new Float32Array(t*t*4);e.set(this.boneMatrices);const n=new Ks(e,t,t,St,yt);return n.needsUpdate=!0,this.boneMatrices=e,this.boneTexture=n,this.boneTextureSize=t,this}getBoneByName(t){for(let e=0,n=this.bones.length;e<n;e++){const n=this.bones[e];if(n.name===t)return n}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(t,e){this.uuid=t.uuid;for(let n=0,r=t.bones.length;n<r;n++){let r=e[t.bones[n]];void 0===r&&(r=new Js),this.bones.push(r),this.boneInverses.push((new qn).fromArray(t.boneInverses[n]))}return this.init(),this}toJSON(){const t={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};t.uuid=this.uuid;const e=this.bones,n=this.boneInverses;for(let r=0,i=e.length;r<i;r++){const i=e[r];t.bones.push(i.uuid);const o=n[r];t.boneInverses.push(o.toArray())}return t}}class eu extends Gr{constructor(t,e,n,r=1){super(t,e,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}toJSON(){const t=super.toJSON();return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}const nu=new qn,ru=new qn,iu=[],ou=new qn,au=new di;class su extends di{constructor(t,e,n){super(t,e),this.isInstancedMesh=!0,this.instanceMatrix=new eu(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1;for(let t=0;t<n;t++)this.setMatrixAt(t,ou)}copy(t,e){return super.copy(t,e),this.instanceMatrix.copy(t.instanceMatrix),null!==t.instanceColor&&(this.instanceColor=t.instanceColor.clone()),this.count=t.count,this}getColorAt(t,e){e.fromArray(this.instanceColor.array,3*t)}getMatrixAt(t,e){e.fromArray(this.instanceMatrix.array,16*t)}raycast(t,e){const n=this.matrixWorld,r=this.count;if(au.geometry=this.geometry,au.material=this.material,void 0!==au.material)for(let i=0;i<r;i++){this.getMatrixAt(i,nu),ru.multiplyMatrices(n,nu),au.matrixWorld=ru,au.raycast(t,iu);for(let t=0,n=iu.length;t<n;t++){const n=iu[t];n.instanceId=i,n.object=this,e.push(n)}iu.length=0}}setColorAt(t,e){null===this.instanceColor&&(this.instanceColor=new eu(new Float32Array(3*this.instanceMatrix.count),3)),e.toArray(this.instanceColor.array,3*t)}setMatrixAt(t,e){e.toArray(this.instanceMatrix.array,16*t)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class uu extends Or{constructor(t){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Fr(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.fog=t.fog,this}}const lu=new $e,cu=new $e,hu=new qn,pu=new Yn,fu=new Un;class du extends xr{constructor(t=new $r,e=new uu){super(),this.isLine=!0,this.type="Line",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),this.material=t.material,this.geometry=t.geometry,this}computeLineDistances(){const t=this.geometry;if(null===t.index){const e=t.attributes.position,n=[0];for(let t=1,r=e.count;t<r;t++)lu.fromBufferAttribute(e,t-1),cu.fromBufferAttribute(e,t),n[t]=n[t-1],n[t]+=lu.distanceTo(cu);t.setAttribute("lineDistance",new Hr(n,1))}return this}raycast(t,e){const n=this.geometry,r=this.matrixWorld,i=t.params.Line.threshold,o=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),fu.copy(n.boundingSphere),fu.applyMatrix4(r),fu.radius+=i,!1===t.ray.intersectsSphere(fu))return;hu.copy(r).invert(),pu.copy(t.ray).applyMatrix4(hu);const a=i/((this.scale.x+this.scale.y+this.scale.z)/3),s=a*a,u=new $e,l=new $e,c=new $e,h=new $e,p=this.isLineSegments?2:1,f=n.index,d=n.attributes.position;if(null!==f){for(let n=Math.max(0,o.start),r=Math.min(f.count,o.start+o.count)-1;n<r;n+=p){const r=f.getX(n),i=f.getX(n+1);u.fromBufferAttribute(d,r),l.fromBufferAttribute(d,i);if(pu.distanceSqToSegment(u,l,h,c)>s)continue;h.applyMatrix4(this.matrixWorld);const o=t.ray.origin.distanceTo(h);o<t.near||o>t.far||e.push({distance:o,point:c.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}else{for(let n=Math.max(0,o.start),r=Math.min(d.count,o.start+o.count)-1;n<r;n+=p){u.fromBufferAttribute(d,n),l.fromBufferAttribute(d,n+1);if(pu.distanceSqToSegment(u,l,h,c)>s)continue;h.applyMatrix4(this.matrixWorld);const r=t.ray.origin.distanceTo(h);r<t.near||r>t.far||e.push({distance:r,point:c.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){const n=t[e[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,e=n.length;t<e;t++){const e=n[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[e]=t}}}}}const mu=new $e,gu=new $e;class vu extends du{constructor(t,e){super(t,e),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const t=this.geometry;if(null===t.index){const e=t.attributes.position,n=[];for(let t=0,r=e.count;t<r;t+=2)mu.fromBufferAttribute(e,t),gu.fromBufferAttribute(e,t+1),n[t]=0===t?0:n[t-1],n[t+1]=n[t]+mu.distanceTo(gu);t.setAttribute("lineDistance",new Hr(n,1))}return this}}class yu extends du{constructor(t,e){super(t,e),this.isLineLoop=!0,this.type="LineLoop"}}class xu extends Or{constructor(t){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Fr(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.fog=t.fog,this}}const _u=new qn,bu=new Yn,wu=new Un,Mu=new $e;class Su extends xr{constructor(t=new $r,e=new xu){super(),this.isPoints=!0,this.type="Points",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),this.material=t.material,this.geometry=t.geometry,this}raycast(t,e){const n=this.geometry,r=this.matrixWorld,i=t.params.Points.threshold,o=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),wu.copy(n.boundingSphere),wu.applyMatrix4(r),wu.radius+=i,!1===t.ray.intersectsSphere(wu))return;_u.copy(r).invert(),bu.copy(t.ray).applyMatrix4(_u);const a=i/((this.scale.x+this.scale.y+this.scale.z)/3),s=a*a,u=n.index,l=n.attributes.position;if(null!==u){for(let n=Math.max(0,o.start),i=Math.min(u.count,o.start+o.count);n<i;n++){const i=u.getX(n);Mu.fromBufferAttribute(l,i),Tu(Mu,i,s,r,t,e,this)}}else{for(let n=Math.max(0,o.start),i=Math.min(l.count,o.start+o.count);n<i;n++)Mu.fromBufferAttribute(l,n),Tu(Mu,n,s,r,t,e,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){const n=t[e[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,e=n.length;t<e;t++){const e=n[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[e]=t}}}}}function Tu(t,e,n,r,i,o,a){const s=bu.distanceSqToPoint(t);if(s<n){const n=new $e;bu.closestPointToPoint(t,n),n.applyMatrix4(r);const u=i.ray.origin.distanceTo(n);if(u<i.near||u>i.far)return;o.push({distance:u,distanceToRay:Math.sqrt(s),point:n,index:e,face:null,object:a})}}class Eu extends gn{constructor(t,e,n,r,i,o,a,s,u,l,c,h){super(null,o,a,s,u,l,r,i,c,h),this.isCompressedTexture=!0,this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}}class Au{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return null}getPointAt(t,e){const n=this.getUtoTmapping(t);return this.getPoint(n,e)}getPoints(t=5){const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return e}getSpacedPoints(t=5){const e=[];for(let n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e}getLength(){const t=this.getLengths();return t[t.length-1]}getLengths(t=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const e=[];let n,r=this.getPoint(0),i=0;e.push(0);for(let o=1;o<=t;o++)n=this.getPoint(o/t),i+=n.distanceTo(r),e.push(i),r=n;return this.cacheArcLengths=e,e}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(t,e){const n=this.getLengths();let r=0;const i=n.length;let o;o=e||t*n[i-1];let a,s=0,u=i-1;for(;s<=u;)if(r=Math.floor(s+(u-s)/2),a=n[r]-o,a<0)s=r+1;else{if(!(a>0)){u=r;break}u=r-1}if(r=u,n[r]===o)return r/(i-1);const l=n[r];return(r+(o-l)/(n[r+1]-l))/(i-1)}getTangent(t,e){const n=1e-4;let r=t-n,i=t+n;r<0&&(r=0),i>1&&(i=1);const o=this.getPoint(r),a=this.getPoint(i),s=e||(o.isVector2?new He:new $e);return s.copy(a).sub(o).normalize(),s}getTangentAt(t,e){const n=this.getUtoTmapping(t);return this.getTangent(n,e)}computeFrenetFrames(t,e){const n=new $e,r=[],i=[],o=[],a=new $e,s=new qn;for(let e=0;e<=t;e++){const n=e/t;r[e]=this.getTangentAt(n,new $e)}i[0]=new $e,o[0]=new $e;let u=Number.MAX_VALUE;const l=Math.abs(r[0].x),c=Math.abs(r[0].y),h=Math.abs(r[0].z);l<=u&&(u=l,n.set(1,0,0)),c<=u&&(u=c,n.set(0,1,0)),h<=u&&n.set(0,0,1),a.crossVectors(r[0],n).normalize(),i[0].crossVectors(r[0],a),o[0].crossVectors(r[0],i[0]);for(let e=1;e<=t;e++){if(i[e]=i[e-1].clone(),o[e]=o[e-1].clone(),a.crossVectors(r[e-1],r[e]),a.length()>Number.EPSILON){a.normalize();const t=Math.acos(ke(r[e-1].dot(r[e]),-1,1));i[e].applyMatrix4(s.makeRotationAxis(a,t))}o[e].crossVectors(r[e],i[e])}if(!0===e){let e=Math.acos(ke(i[0].dot(i[t]),-1,1));e/=t,r[0].dot(a.crossVectors(i[0],i[t]))>0&&(e=-e);for(let n=1;n<=t;n++)i[n].applyMatrix4(s.makeRotationAxis(r[n],e*n)),o[n].crossVectors(r[n],i[n])}return{tangents:r,normals:i,binormals:o}}clone(){return(new this.constructor).copy(this)}copy(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}toJSON(){const t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}fromJSON(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}class Pu extends Au{constructor(t=0,e=0,n=1,r=1,i=0,o=2*Math.PI,a=!1,s=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=t,this.aY=e,this.xRadius=n,this.yRadius=r,this.aStartAngle=i,this.aEndAngle=o,this.aClockwise=a,this.aRotation=s}getPoint(t,e){const n=e||new He,r=2*Math.PI;let i=this.aEndAngle-this.aStartAngle;const o=Math.abs(i)<Number.EPSILON;for(;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=o?0:r),!0!==this.aClockwise||o||(i===r?i=-r:i-=r);const a=this.aStartAngle+t*i;let s=this.aX+this.xRadius*Math.cos(a),u=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){const t=Math.cos(this.aRotation),e=Math.sin(this.aRotation),n=s-this.aX,r=u-this.aY;s=n*t-r*e+this.aX,u=n*e+r*t+this.aY}return n.set(s,u)}copy(t){return super.copy(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}toJSON(){const t=super.toJSON();return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t}fromJSON(t){return super.fromJSON(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}}class Cu extends Pu{constructor(t,e,n,r,i,o){super(t,e,n,n,r,i,o),this.isArcCurve=!0,this.type="ArcCurve"}}function Lu(){let t=0,e=0,n=0,r=0;function i(i,o,a,s){t=i,e=a,n=-3*i+3*o-2*a-s,r=2*i-2*o+a+s}return{initCatmullRom:function(t,e,n,r,o){i(e,n,o*(n-t),o*(r-e))},initNonuniformCatmullRom:function(t,e,n,r,o,a,s){let u=(e-t)/o-(n-t)/(o+a)+(n-e)/a,l=(n-e)/a-(r-e)/(a+s)+(r-n)/s;u*=a,l*=a,i(e,n,u,l)},calc:function(i){const o=i*i;return t+e*i+n*o+r*(o*i)}}}const Iu=new $e,Ou=new Lu,Nu=new Lu,Ru=new Lu;class Du extends Au{constructor(t=[],e=!1,n="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=t,this.closed=e,this.curveType=n,this.tension=r}getPoint(t,e=new $e){const n=e,r=this.points,i=r.length,o=(i-(this.closed?0:1))*t;let a,s,u=Math.floor(o),l=o-u;this.closed?u+=u>0?0:(Math.floor(Math.abs(u)/i)+1)*i:0===l&&u===i-1&&(u=i-2,l=1),this.closed||u>0?a=r[(u-1)%i]:(Iu.subVectors(r[0],r[1]).add(r[0]),a=Iu);const c=r[u%i],h=r[(u+1)%i];if(this.closed||u+2<i?s=r[(u+2)%i]:(Iu.subVectors(r[i-1],r[i-2]).add(r[i-1]),s=Iu),"centripetal"===this.curveType||"chordal"===this.curveType){const t="chordal"===this.curveType?.5:.25;let e=Math.pow(a.distanceToSquared(c),t),n=Math.pow(c.distanceToSquared(h),t),r=Math.pow(h.distanceToSquared(s),t);n<1e-4&&(n=1),e<1e-4&&(e=n),r<1e-4&&(r=n),Ou.initNonuniformCatmullRom(a.x,c.x,h.x,s.x,e,n,r),Nu.initNonuniformCatmullRom(a.y,c.y,h.y,s.y,e,n,r),Ru.initNonuniformCatmullRom(a.z,c.z,h.z,s.z,e,n,r)}else"catmullrom"===this.curveType&&(Ou.initCatmullRom(a.x,c.x,h.x,s.x,this.tension),Nu.initCatmullRom(a.y,c.y,h.y,s.y,this.tension),Ru.initCatmullRom(a.z,c.z,h.z,s.z,this.tension));return n.set(Ou.calc(l),Nu.calc(l),Ru.calc(l)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push(n.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++){const n=this.points[e];t.points.push(n.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push((new $e).fromArray(n))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}}function ku(t,e,n,r,i){const o=.5*(r-e),a=.5*(i-n),s=t*t;return(2*n-2*r+o+a)*(t*s)+(-3*n+3*r-2*o-a)*s+o*t+n}function Fu(t,e,n,r){return function(t,e){const n=1-t;return n*n*e}(t,e)+function(t,e){return 2*(1-t)*t*e}(t,n)+function(t,e){return t*t*e}(t,r)}function Bu(t,e,n,r,i){return function(t,e){const n=1-t;return n*n*n*e}(t,e)+function(t,e){const n=1-t;return 3*n*n*t*e}(t,n)+function(t,e){return 3*(1-t)*t*t*e}(t,r)+function(t,e){return t*t*t*e}(t,i)}class Uu extends Au{constructor(t=new He,e=new He,n=new He,r=new He){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=t,this.v1=e,this.v2=n,this.v3=r}getPoint(t,e=new He){const n=e,r=this.v0,i=this.v1,o=this.v2,a=this.v3;return n.set(Bu(t,r.x,i.x,o.x,a.x),Bu(t,r.y,i.y,o.y,a.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}class zu extends Au{constructor(t=new $e,e=new $e,n=new $e,r=new $e){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=t,this.v1=e,this.v2=n,this.v3=r}getPoint(t,e=new $e){const n=e,r=this.v0,i=this.v1,o=this.v2,a=this.v3;return n.set(Bu(t,r.x,i.x,o.x,a.x),Bu(t,r.y,i.y,o.y,a.y),Bu(t,r.z,i.z,o.z,a.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}class Vu extends Au{constructor(t=new He,e=new He){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=t,this.v2=e}getPoint(t,e=new He){const n=e;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t,e=new He){return e.subVectors(this.v2,this.v1).normalize()}getTangentAt(t,e){return this.getTangent(t,e)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class Gu extends Au{constructor(t=new $e,e=new $e){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=t,this.v2=e}getPoint(t,e=new $e){const n=e;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t,e=new $e){return e.subVectors(this.v2,this.v1).normalize()}getTangentAt(t,e){return this.getTangent(t,e)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class ju extends Au{constructor(t=new He,e=new He,n=new He){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=t,this.v1=e,this.v2=n}getPoint(t,e=new He){const n=e,r=this.v0,i=this.v1,o=this.v2;return n.set(Fu(t,r.x,i.x,o.x),Fu(t,r.y,i.y,o.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class Wu extends Au{constructor(t=new $e,e=new $e,n=new $e){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=t,this.v1=e,this.v2=n}getPoint(t,e=new $e){const n=e,r=this.v0,i=this.v1,o=this.v2;return n.set(Fu(t,r.x,i.x,o.x),Fu(t,r.y,i.y,o.y),Fu(t,r.z,i.z,o.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class Hu extends Au{constructor(t=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=t}getPoint(t,e=new He){const n=e,r=this.points,i=(r.length-1)*t,o=Math.floor(i),a=i-o,s=r[0===o?o:o-1],u=r[o],l=r[o>r.length-2?r.length-1:o+1],c=r[o>r.length-3?r.length-1:o+2];return n.set(ku(a,s.x,u.x,l.x,c.x),ku(a,s.y,u.y,l.y,c.y)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push(n.clone())}return this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++){const n=this.points[e];t.points.push(n.toArray())}return t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push((new He).fromArray(n))}return this}}var Xu=Object.freeze({__proto__:null,ArcCurve:Cu,CatmullRomCurve3:Du,CubicBezierCurve:Uu,CubicBezierCurve3:zu,EllipseCurve:Pu,LineCurve:Vu,LineCurve3:Gu,QuadraticBezierCurve:ju,QuadraticBezierCurve3:Wu,SplineCurve:Hu});class Yu extends Au{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(t){this.curves.push(t)}closePath(){const t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new Vu(e,t))}getPoint(t,e){const n=t*this.getLength(),r=this.getCurveLengths();let i=0;for(;i<r.length;){if(r[i]>=n){const t=r[i]-n,o=this.curves[i],a=o.getLength(),s=0===a?0:1-t/a;return o.getPointAt(s,e)}i++}return null}getLength(){const t=this.getCurveLengths();return t[t.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const t=[];let e=0;for(let n=0,r=this.curves.length;n<r;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t}getSpacedPoints(t=40){const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e}getPoints(t=12){const e=[];let n;for(let r=0,i=this.curves;r<i.length;r++){const o=i[r],a=o.isEllipseCurve?2*t:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?t*o.points.length:t,s=o.getPoints(a);for(let t=0;t<s.length;t++){const r=s[t];n&&n.equals(r)||(e.push(r),n=r)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e}copy(t){super.copy(t),this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){const n=t.curves[e];this.curves.push(n.clone())}return this.autoClose=t.autoClose,this}toJSON(){const t=super.toJSON();t.autoClose=this.autoClose,t.curves=[];for(let e=0,n=this.curves.length;e<n;e++){const n=this.curves[e];t.curves.push(n.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.autoClose=t.autoClose,this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){const n=t.curves[e];this.curves.push((new Xu[n.type]).fromJSON(n))}return this}}class qu extends Yu{constructor(t){super(),this.type="Path",this.currentPoint=new He,t&&this.setFromPoints(t)}setFromPoints(t){this.moveTo(t[0].x,t[0].y);for(let e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y);return this}moveTo(t,e){return this.currentPoint.set(t,e),this}lineTo(t,e){const n=new Vu(this.currentPoint.clone(),new He(t,e));return this.curves.push(n),this.currentPoint.set(t,e),this}quadraticCurveTo(t,e,n,r){const i=new ju(this.currentPoint.clone(),new He(t,e),new He(n,r));return this.curves.push(i),this.currentPoint.set(n,r),this}bezierCurveTo(t,e,n,r,i,o){const a=new Uu(this.currentPoint.clone(),new He(t,e),new He(n,r),new He(i,o));return this.curves.push(a),this.currentPoint.set(i,o),this}splineThru(t){const e=[this.currentPoint.clone()].concat(t),n=new Hu(e);return this.curves.push(n),this.currentPoint.copy(t[t.length-1]),this}arc(t,e,n,r,i,o){const a=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(t+a,e+s,n,r,i,o),this}absarc(t,e,n,r,i,o){return this.absellipse(t,e,n,n,r,i,o),this}ellipse(t,e,n,r,i,o,a,s){const u=this.currentPoint.x,l=this.currentPoint.y;return this.absellipse(t+u,e+l,n,r,i,o,a,s),this}absellipse(t,e,n,r,i,o,a,s){const u=new Pu(t,e,n,r,i,o,a,s);if(this.curves.length>0){const t=u.getPoint(0);t.equals(this.currentPoint)||this.lineTo(t.x,t.y)}this.curves.push(u);const l=u.getPoint(1);return this.currentPoint.copy(l),this}copy(t){return super.copy(t),this.currentPoint.copy(t.currentPoint),this}toJSON(){const t=super.toJSON();return t.currentPoint=this.currentPoint.toArray(),t}fromJSON(t){return super.fromJSON(t),this.currentPoint.fromArray(t.currentPoint),this}}class Zu extends $r{constructor(t=[new He(0,-.5),new He(.5,0),new He(0,.5)],e=12,n=0,r=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:r},e=Math.floor(e),r=ke(r,0,2*Math.PI);const i=[],o=[],a=[],s=[],u=[],l=1/e,c=new $e,h=new He,p=new $e,f=new $e,d=new $e;let m=0,g=0;for(let e=0;e<=t.length-1;e++)switch(e){case 0:m=t[e+1].x-t[e].x,g=t[e+1].y-t[e].y,p.x=1*g,p.y=-m,p.z=0*g,d.copy(p),p.normalize(),s.push(p.x,p.y,p.z);break;case t.length-1:s.push(d.x,d.y,d.z);break;default:m=t[e+1].x-t[e].x,g=t[e+1].y-t[e].y,p.x=1*g,p.y=-m,p.z=0*g,f.copy(p),p.x+=d.x,p.y+=d.y,p.z+=d.z,p.normalize(),s.push(p.x,p.y,p.z),d.copy(f)}for(let i=0;i<=e;i++){const p=n+i*l*r,f=Math.sin(p),d=Math.cos(p);for(let n=0;n<=t.length-1;n++){c.x=t[n].x*f,c.y=t[n].y,c.z=t[n].x*d,o.push(c.x,c.y,c.z),h.x=i/e,h.y=n/(t.length-1),a.push(h.x,h.y);const r=s[3*n+0]*f,l=s[3*n+1],p=s[3*n+0]*d;u.push(r,l,p)}}for(let n=0;n<e;n++)for(let e=0;e<t.length-1;e++){const r=e+n*t.length,o=r,a=r+t.length,s=r+t.length+1,u=r+1;i.push(o,a,u),i.push(s,u,a)}this.setIndex(i),this.setAttribute("position",new Hr(o,3)),this.setAttribute("uv",new Hr(a,2)),this.setAttribute("normal",new Hr(u,3))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new Zu(t.points,t.segments,t.phiStart,t.phiLength)}}class Ju extends Zu{constructor(t=1,e=1,n=4,r=8){const i=new qu;i.absarc(0,-e/2,t,1.5*Math.PI,0),i.absarc(0,e/2,t,0,.5*Math.PI),super(i.getPoints(n),r),this.type="CapsuleGeometry",this.parameters={radius:t,height:e,capSegments:n,radialSegments:r}}static fromJSON(t){return new Ju(t.radius,t.length,t.capSegments,t.radialSegments)}}class Ku extends $r{constructor(t=1,e=32,n=0,r=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:r},e=Math.max(3,e);const i=[],o=[],a=[],s=[],u=new $e,l=new He;o.push(0,0,0),a.push(0,0,1),s.push(.5,.5);for(let i=0,c=3;i<=e;i++,c+=3){const h=n+i/e*r;u.x=t*Math.cos(h),u.y=t*Math.sin(h),o.push(u.x,u.y,u.z),a.push(0,0,1),l.x=(o[c]/t+1)/2,l.y=(o[c+1]/t+1)/2,s.push(l.x,l.y)}for(let t=1;t<=e;t++)i.push(t,t+1,0);this.setIndex(i),this.setAttribute("position",new Hr(o,3)),this.setAttribute("normal",new Hr(a,3)),this.setAttribute("uv",new Hr(s,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new Ku(t.radius,t.segments,t.thetaStart,t.thetaLength)}}class Qu extends $r{constructor(t=1,e=1,n=1,r=32,i=1,o=!1,a=0,s=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s};const u=this;r=Math.floor(r),i=Math.floor(i);const l=[],c=[],h=[],p=[];let f=0;const d=[],m=n/2;let g=0;function v(n){const i=f,o=new He,d=new $e;let v=0;const y=!0===n?t:e,x=!0===n?1:-1;for(let t=1;t<=r;t++)c.push(0,m*x,0),h.push(0,x,0),p.push(.5,.5),f++;const _=f;for(let t=0;t<=r;t++){const e=t/r*s+a,n=Math.cos(e),i=Math.sin(e);d.x=y*i,d.y=m*x,d.z=y*n,c.push(d.x,d.y,d.z),h.push(0,x,0),o.x=.5*n+.5,o.y=.5*i*x+.5,p.push(o.x,o.y),f++}for(let t=0;t<r;t++){const e=i+t,r=_+t;!0===n?l.push(r,r+1,e):l.push(r+1,r,e),v+=3}u.addGroup(g,v,!0===n?1:2),g+=v}!function(){const o=new $e,v=new $e;let y=0;const x=(e-t)/n;for(let u=0;u<=i;u++){const l=[],g=u/i,y=g*(e-t)+t;for(let t=0;t<=r;t++){const e=t/r,i=e*s+a,u=Math.sin(i),d=Math.cos(i);v.x=y*u,v.y=-g*n+m,v.z=y*d,c.push(v.x,v.y,v.z),o.set(u,x,d).normalize(),h.push(o.x,o.y,o.z),p.push(e,1-g),l.push(f++)}d.push(l)}for(let t=0;t<r;t++)for(let e=0;e<i;e++){const n=d[e][t],r=d[e+1][t],i=d[e+1][t+1],o=d[e][t+1];l.push(n,r,o),l.push(r,i,o),y+=6}u.addGroup(g,y,0),g+=y}(),!1===o&&(t>0&&v(!0),e>0&&v(!1)),this.setIndex(l),this.setAttribute("position",new Hr(c,3)),this.setAttribute("normal",new Hr(h,3)),this.setAttribute("uv",new Hr(p,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new Qu(t.radiusTop,t.radiusBottom,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}}class $u extends Qu{constructor(t=1,e=1,n=32,r=1,i=!1,o=0,a=2*Math.PI){super(0,t,e,n,r,i,o,a),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:a}}static fromJSON(t){return new $u(t.radius,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}}class tl extends $r{constructor(t=[],e=[],n=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:r};const i=[],o=[];function a(t,e,n,r){const i=r+1,o=[];for(let r=0;r<=i;r++){o[r]=[];const a=t.clone().lerp(n,r/i),s=e.clone().lerp(n,r/i),u=i-r;for(let t=0;t<=u;t++)o[r][t]=0===t&&r===i?a:a.clone().lerp(s,t/u)}for(let t=0;t<i;t++)for(let e=0;e<2*(i-t)-1;e++){const n=Math.floor(e/2);e%2==0?(s(o[t][n+1]),s(o[t+1][n]),s(o[t][n])):(s(o[t][n+1]),s(o[t+1][n+1]),s(o[t+1][n]))}}function s(t){i.push(t.x,t.y,t.z)}function u(e,n){const r=3*e;n.x=t[r+0],n.y=t[r+1],n.z=t[r+2]}function l(t,e,n,r){r<0&&1===t.x&&(o[e]=t.x-1),0===n.x&&0===n.z&&(o[e]=r/2/Math.PI+.5)}function c(t){return Math.atan2(t.z,-t.x)}!function(t){const n=new $e,r=new $e,i=new $e;for(let o=0;o<e.length;o+=3)u(e[o+0],n),u(e[o+1],r),u(e[o+2],i),a(n,r,i,t)}(r),function(t){const e=new $e;for(let n=0;n<i.length;n+=3)e.x=i[n+0],e.y=i[n+1],e.z=i[n+2],e.normalize().multiplyScalar(t),i[n+0]=e.x,i[n+1]=e.y,i[n+2]=e.z}(n),function(){const t=new $e;for(let n=0;n<i.length;n+=3){t.x=i[n+0],t.y=i[n+1],t.z=i[n+2];const r=c(t)/2/Math.PI+.5,a=(e=t,Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))/Math.PI+.5);o.push(r,1-a)}var e;(function(){const t=new $e,e=new $e,n=new $e,r=new $e,a=new He,s=new He,u=new He;for(let h=0,p=0;h<i.length;h+=9,p+=6){t.set(i[h+0],i[h+1],i[h+2]),e.set(i[h+3],i[h+4],i[h+5]),n.set(i[h+6],i[h+7],i[h+8]),a.set(o[p+0],o[p+1]),s.set(o[p+2],o[p+3]),u.set(o[p+4],o[p+5]),r.copy(t).add(e).add(n).divideScalar(3);const f=c(r);l(a,p+0,t,f),l(s,p+2,e,f),l(u,p+4,n,f)}})(),function(){for(let t=0;t<o.length;t+=6){const e=o[t+0],n=o[t+2],r=o[t+4],i=Math.max(e,n,r),a=Math.min(e,n,r);i>.9&&a<.1&&(e<.2&&(o[t+0]+=1),n<.2&&(o[t+2]+=1),r<.2&&(o[t+4]+=1))}}()}(),this.setAttribute("position",new Hr(i,3)),this.setAttribute("normal",new Hr(i.slice(),3)),this.setAttribute("uv",new Hr(o,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new tl(t.vertices,t.indices,t.radius,t.details)}}class el extends tl{constructor(t=1,e=0){const n=(1+Math.sqrt(5))/2,r=1/n;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new el(t.radius,t.detail)}}const nl=new $e,rl=new $e,il=new $e,ol=new Lr;class al extends $r{constructor(t=null,e=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:t,thresholdAngle:e},null!==t){const n=4,r=Math.pow(10,n),i=Math.cos(Ne*e),o=t.getIndex(),a=t.getAttribute("position"),s=o?o.count:a.count,u=[0,0,0],l=["a","b","c"],c=new Array(3),h={},p=[];for(let t=0;t<s;t+=3){o?(u[0]=o.getX(t),u[1]=o.getX(t+1),u[2]=o.getX(t+2)):(u[0]=t,u[1]=t+1,u[2]=t+2);const{a:e,b:n,c:s}=ol;if(e.fromBufferAttribute(a,u[0]),n.fromBufferAttribute(a,u[1]),s.fromBufferAttribute(a,u[2]),ol.getNormal(il),c[0]=`${Math.round(e.x*r)},${Math.round(e.y*r)},${Math.round(e.z*r)}`,c[1]=`${Math.round(n.x*r)},${Math.round(n.y*r)},${Math.round(n.z*r)}`,c[2]=`${Math.round(s.x*r)},${Math.round(s.y*r)},${Math.round(s.z*r)}`,c[0]!==c[1]&&c[1]!==c[2]&&c[2]!==c[0])for(let t=0;t<3;t++){const e=(t+1)%3,n=c[t],r=c[e],o=ol[l[t]],a=ol[l[e]],s=`${n}_${r}`,f=`${r}_${n}`;f in h&&h[f]?(il.dot(h[f].normal)<=i&&(p.push(o.x,o.y,o.z),p.push(a.x,a.y,a.z)),h[f]=null):s in h||(h[s]={index0:u[t],index1:u[e],normal:il.clone()})}}for(const t in h)if(h[t]){const{index0:e,index1:n}=h[t];nl.fromBufferAttribute(a,e),rl.fromBufferAttribute(a,n),p.push(nl.x,nl.y,nl.z),p.push(rl.x,rl.y,rl.z)}this.setAttribute("position",new Hr(p,3))}}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}}class sl extends qu{constructor(t){super(t),this.uuid=De(),this.type="Shape",this.holes=[]}getPointsHoles(t){const e=[];for(let n=0,r=this.holes.length;n<r;n++)e[n]=this.holes[n].getPoints(t);return e}extractPoints(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}}copy(t){super.copy(t),this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){const n=t.holes[e];this.holes.push(n.clone())}return this}toJSON(){const t=super.toJSON();t.uuid=this.uuid,t.holes=[];for(let e=0,n=this.holes.length;e<n;e++){const n=this.holes[e];t.holes.push(n.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.uuid=t.uuid,this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){const n=t.holes[e];this.holes.push((new qu).fromJSON(n))}return this}}const ul=function(t,e,n=2){const r=e&&e.length,i=r?e[0]*n:t.length;let o=ll(t,0,i,n,!0);const a=[];if(!o||o.next===o.prev)return a;let s,u,l,c,h,p,f;if(r&&(o=function(t,e,n,r){const i=[];let o,a,s,u,l;for(o=0,a=e.length;o<a;o++)s=e[o]*r,u=o<a-1?e[o+1]*r:t.length,l=ll(t,s,u,r,!1),l===l.next&&(l.steiner=!0),i.push(_l(l));for(i.sort(gl),o=0;o<i.length;o++)n=vl(i[o],n);return n}(t,e,o,n)),t.length>80*n){s=l=t[0],u=c=t[1];for(let e=n;e<i;e+=n)h=t[e],p=t[e+1],h<s&&(s=h),p<u&&(u=p),h>l&&(l=h),p>c&&(c=p);f=Math.max(l-s,c-u),f=0!==f?32767/f:0}return hl(o,a,n,s,u,f,0),a};function ll(t,e,n,r,i){let o,a;if(i===function(t,e,n,r){let i=0;for(let o=e,a=n-r;o<n;o+=r)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}(t,e,n,r)>0)for(o=e;o<n;o+=r)a=Ll(o,t[o],t[o+1],a);else for(o=n-r;o>=e;o-=r)a=Ll(o,t[o],t[o+1],a);return a&&Sl(a,a.next)&&(Il(a),a=a.next),a}function cl(t,e){if(!t)return t;e||(e=t);let n,r=t;do{if(n=!1,r.steiner||!Sl(r,r.next)&&0!==Ml(r.prev,r,r.next))r=r.next;else{if(Il(r),r=e=r.prev,r===r.next)break;n=!0}}while(n||r!==e);return e}function hl(t,e,n,r,i,o,a){if(!t)return;!a&&o&&function(t,e,n,r){let i=t;do{0===i.z&&(i.z=xl(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){let e,n,r,i,o,a,s,u,l=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,r=n,s=0,e=0;e<l&&(s++,r=r.nextZ,r);e++);for(u=l;s>0||u>0&&r;)0!==s&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,u--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,l*=2}while(a>1)}(i)}(t,r,i,o);let s,u,l=t;for(;t.prev!==t.next;)if(s=t.prev,u=t.next,o?fl(t,r,i,o):pl(t))e.push(s.i/n|0),e.push(t.i/n|0),e.push(u.i/n|0),Il(t),t=u.next,l=u.next;else if((t=u)===l){a?1===a?hl(t=dl(cl(t),e,n),e,n,r,i,o,2):2===a&&ml(t,e,n,r,i,o):hl(cl(t),e,n,r,i,o,1);break}}function pl(t){const e=t.prev,n=t,r=t.next;if(Ml(e,n,r)>=0)return!1;const i=e.x,o=n.x,a=r.x,s=e.y,u=n.y,l=r.y,c=i<o?i<a?i:a:o<a?o:a,h=s<u?s<l?s:l:u<l?u:l,p=i>o?i>a?i:a:o>a?o:a,f=s>u?s>l?s:l:u>l?u:l;let d=r.next;for(;d!==e;){if(d.x>=c&&d.x<=p&&d.y>=h&&d.y<=f&&bl(i,s,o,u,a,l,d.x,d.y)&&Ml(d.prev,d,d.next)>=0)return!1;d=d.next}return!0}function fl(t,e,n,r){const i=t.prev,o=t,a=t.next;if(Ml(i,o,a)>=0)return!1;const s=i.x,u=o.x,l=a.x,c=i.y,h=o.y,p=a.y,f=s<u?s<l?s:l:u<l?u:l,d=c<h?c<p?c:p:h<p?h:p,m=s>u?s>l?s:l:u>l?u:l,g=c>h?c>p?c:p:h>p?h:p,v=xl(f,d,e,n,r),y=xl(m,g,e,n,r);let x=t.prevZ,_=t.nextZ;for(;x&&x.z>=v&&_&&_.z<=y;){if(x.x>=f&&x.x<=m&&x.y>=d&&x.y<=g&&x!==i&&x!==a&&bl(s,c,u,h,l,p,x.x,x.y)&&Ml(x.prev,x,x.next)>=0)return!1;if(x=x.prevZ,_.x>=f&&_.x<=m&&_.y>=d&&_.y<=g&&_!==i&&_!==a&&bl(s,c,u,h,l,p,_.x,_.y)&&Ml(_.prev,_,_.next)>=0)return!1;_=_.nextZ}for(;x&&x.z>=v;){if(x.x>=f&&x.x<=m&&x.y>=d&&x.y<=g&&x!==i&&x!==a&&bl(s,c,u,h,l,p,x.x,x.y)&&Ml(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;_&&_.z<=y;){if(_.x>=f&&_.x<=m&&_.y>=d&&_.y<=g&&_!==i&&_!==a&&bl(s,c,u,h,l,p,_.x,_.y)&&Ml(_.prev,_,_.next)>=0)return!1;_=_.nextZ}return!0}function dl(t,e,n){let r=t;do{const i=r.prev,o=r.next.next;!Sl(i,o)&&Tl(i,r,r.next,o)&&Pl(i,o)&&Pl(o,i)&&(e.push(i.i/n|0),e.push(r.i/n|0),e.push(o.i/n|0),Il(r),Il(r.next),r=t=o),r=r.next}while(r!==t);return cl(r)}function ml(t,e,n,r,i,o){let a=t;do{let t=a.next.next;for(;t!==a.prev;){if(a.i!==t.i&&wl(a,t)){let s=Cl(a,t);return a=cl(a,a.next),s=cl(s,s.next),hl(a,e,n,r,i,o,0),void hl(s,e,n,r,i,o,0)}t=t.next}a=a.next}while(a!==t)}function gl(t,e){return t.x-e.x}function vl(t,e){const n=function(t,e){let n,r=e,i=-1/0;const o=t.x,a=t.y;do{if(a<=r.y&&a>=r.next.y&&r.next.y!==r.y){const t=r.x+(a-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(t<=o&&t>i&&(i=t,n=r.x<r.next.x?r:r.next,t===o))return n}r=r.next}while(r!==e);if(!n)return null;const s=n,u=n.x,l=n.y;let c,h=1/0;r=n;do{o>=r.x&&r.x>=u&&o!==r.x&&bl(a<l?o:i,a,u,l,a<l?i:o,a,r.x,r.y)&&(c=Math.abs(a-r.y)/(o-r.x),Pl(r,t)&&(c<h||c===h&&(r.x>n.x||r.x===n.x&&yl(n,r)))&&(n=r,h=c)),r=r.next}while(r!==s);return n}(t,e);if(!n)return e;const r=Cl(n,t);return cl(r,r.next),cl(n,n.next)}function yl(t,e){return Ml(t.prev,t,e.prev)<0&&Ml(e.next,t,t.next)<0}function xl(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function _l(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function bl(t,e,n,r,i,o,a,s){return(i-a)*(e-s)>=(t-a)*(o-s)&&(t-a)*(r-s)>=(n-a)*(e-s)&&(n-a)*(o-s)>=(i-a)*(r-s)}function wl(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Tl(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(Pl(t,e)&&Pl(e,t)&&function(t,e){let n=t,r=!1;const i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(Ml(t.prev,t,e.prev)||Ml(t,e.prev,e))||Sl(t,e)&&Ml(t.prev,t,t.next)>0&&Ml(e.prev,e,e.next)>0)}function Ml(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Sl(t,e){return t.x===e.x&&t.y===e.y}function Tl(t,e,n,r){const i=Al(Ml(t,e,n)),o=Al(Ml(t,e,r)),a=Al(Ml(n,r,t)),s=Al(Ml(n,r,e));return i!==o&&a!==s||(!(0!==i||!El(t,n,e))||(!(0!==o||!El(t,r,e))||(!(0!==a||!El(n,t,r))||!(0!==s||!El(n,e,r)))))}function El(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Al(t){return t>0?1:t<0?-1:0}function Pl(t,e){return Ml(t.prev,t,t.next)<0?Ml(t,e,t.next)>=0&&Ml(t,t.prev,e)>=0:Ml(t,e,t.prev)<0||Ml(t,t.next,e)<0}function Cl(t,e){const n=new Ol(t.i,t.x,t.y),r=new Ol(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function Ll(t,e,n,r){const i=new Ol(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function Il(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Ol(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}class Nl{static area(t){const e=t.length;let n=0;for(let r=e-1,i=0;i<e;r=i++)n+=t[r].x*t[i].y-t[i].x*t[r].y;return.5*n}static isClockWise(t){return Nl.area(t)<0}static triangulateShape(t,e){const n=[],r=[],i=[];Rl(t),Dl(n,t);let o=t.length;e.forEach(Rl);for(let t=0;t<e.length;t++)r.push(o),o+=e[t].length,Dl(n,e[t]);const a=ul(n,r);for(let t=0;t<a.length;t+=3)i.push(a.slice(t,t+3));return i}}function Rl(t){const e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function Dl(t,e){for(let n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}class kl extends $r{constructor(t=new sl([new He(.5,.5),new He(-.5,.5),new He(-.5,-.5),new He(.5,-.5)]),e={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];const n=this,r=[],i=[];for(let e=0,n=t.length;e<n;e++){o(t[e])}function o(t){const o=[],a=void 0!==e.curveSegments?e.curveSegments:12,s=void 0!==e.steps?e.steps:1,u=void 0!==e.depth?e.depth:1;let l=void 0===e.bevelEnabled||e.bevelEnabled,c=void 0!==e.bevelThickness?e.bevelThickness:.2,h=void 0!==e.bevelSize?e.bevelSize:c-.1,p=void 0!==e.bevelOffset?e.bevelOffset:0,f=void 0!==e.bevelSegments?e.bevelSegments:3;const d=e.extrudePath,m=void 0!==e.UVGenerator?e.UVGenerator:Fl;let g,v,y,x,_,b=!1;d&&(g=d.getSpacedPoints(s),b=!0,l=!1,v=d.computeFrenetFrames(s,!1),y=new $e,x=new $e,_=new $e),l||(f=0,c=0,h=0,p=0);const w=t.extractPoints(a);let M=w.shape;const S=w.holes;if(!Nl.isClockWise(M)){M=M.reverse();for(let t=0,e=S.length;t<e;t++){const e=S[t];Nl.isClockWise(e)&&(S[t]=e.reverse())}}const T=Nl.triangulateShape(M,S),E=M;for(let t=0,e=S.length;t<e;t++){const e=S[t];M=M.concat(e)}function A(t,e,n){return t.clone().addScaledVector(e,n)}const P=M.length,C=T.length;function L(t,e,n){let r,i,o;const a=t.x-e.x,s=t.y-e.y,u=n.x-t.x,l=n.y-t.y,c=a*a+s*s,h=a*l-s*u;if(Math.abs(h)>Number.EPSILON){const h=Math.sqrt(c),p=Math.sqrt(u*u+l*l),f=e.x-s/h,d=e.y+a/h,m=((n.x-l/p-f)*l-(n.y+u/p-d)*u)/(a*l-s*u);r=f+a*m-t.x,i=d+s*m-t.y;const g=r*r+i*i;if(g<=2)return new He(r,i);o=Math.sqrt(g/2)}else{let t=!1;a>Number.EPSILON?u>Number.EPSILON&&(t=!0):a<-Number.EPSILON?u<-Number.EPSILON&&(t=!0):Math.sign(s)===Math.sign(l)&&(t=!0),t?(r=-s,i=a,o=Math.sqrt(c)):(r=a,i=s,o=Math.sqrt(c/2))}return new He(r/o,i/o)}const I=[];for(let t=0,e=E.length,n=e-1,r=t+1;t<e;t++,n++,r++)n===e&&(n=0),r===e&&(r=0),I[t]=L(E[t],E[n],E[r]);const O=[];let N,R=I.concat();for(let t=0,e=S.length;t<e;t++){const e=S[t];N=[];for(let t=0,n=e.length,r=n-1,i=t+1;t<n;t++,r++,i++)r===n&&(r=0),i===n&&(i=0),N[t]=L(e[t],e[r],e[i]);O.push(N),R=R.concat(N)}for(let t=0;t<f;t++){const e=t/f,n=c*Math.cos(e*Math.PI/2),r=h*Math.sin(e*Math.PI/2)+p;for(let t=0,e=E.length;t<e;t++){const e=A(E[t],I[t],r);F(e.x,e.y,-n)}for(let t=0,e=S.length;t<e;t++){const e=S[t];N=O[t];for(let t=0,i=e.length;t<i;t++){const i=A(e[t],N[t],r);F(i.x,i.y,-n)}}}const D=h+p;for(let t=0;t<P;t++){const e=l?A(M[t],R[t],D):M[t];b?(x.copy(v.normals[0]).multiplyScalar(e.x),y.copy(v.binormals[0]).multiplyScalar(e.y),_.copy(g[0]).add(x).add(y),F(_.x,_.y,_.z)):F(e.x,e.y,0)}for(let t=1;t<=s;t++)for(let e=0;e<P;e++){const n=l?A(M[e],R[e],D):M[e];b?(x.copy(v.normals[t]).multiplyScalar(n.x),y.copy(v.binormals[t]).multiplyScalar(n.y),_.copy(g[t]).add(x).add(y),F(_.x,_.y,_.z)):F(n.x,n.y,u/s*t)}for(let t=f-1;t>=0;t--){const e=t/f,n=c*Math.cos(e*Math.PI/2),r=h*Math.sin(e*Math.PI/2)+p;for(let t=0,e=E.length;t<e;t++){const e=A(E[t],I[t],r);F(e.x,e.y,u+n)}for(let t=0,e=S.length;t<e;t++){const e=S[t];N=O[t];for(let t=0,i=e.length;t<i;t++){const i=A(e[t],N[t],r);b?F(i.x,i.y+g[s-1].y,g[s-1].x+n):F(i.x,i.y,u+n)}}}function k(t,e){let n=t.length;for(;--n>=0;){const r=n;let i=n-1;i<0&&(i=t.length-1);for(let t=0,n=s+2*f;t<n;t++){const n=P*t,o=P*(t+1);U(e+r+n,e+i+n,e+i+o,e+r+o)}}}function F(t,e,n){o.push(t),o.push(e),o.push(n)}function B(t,e,i){z(t),z(e),z(i);const o=r.length/3,a=m.generateTopUV(n,r,o-3,o-2,o-1);V(a[0]),V(a[1]),V(a[2])}function U(t,e,i,o){z(t),z(e),z(o),z(e),z(i),z(o);const a=r.length/3,s=m.generateSideWallUV(n,r,a-6,a-3,a-2,a-1);V(s[0]),V(s[1]),V(s[3]),V(s[1]),V(s[2]),V(s[3])}function z(t){r.push(o[3*t+0]),r.push(o[3*t+1]),r.push(o[3*t+2])}function V(t){i.push(t.x),i.push(t.y)}!function(){const t=r.length/3;if(l){let t=0,e=P*t;for(let t=0;t<C;t++){const n=T[t];B(n[2]+e,n[1]+e,n[0]+e)}t=s+2*f,e=P*t;for(let t=0;t<C;t++){const n=T[t];B(n[0]+e,n[1]+e,n[2]+e)}}else{for(let t=0;t<C;t++){const e=T[t];B(e[2],e[1],e[0])}for(let t=0;t<C;t++){const e=T[t];B(e[0]+P*s,e[1]+P*s,e[2]+P*s)}}n.addGroup(t,r.length/3-t,0)}(),function(){const t=r.length/3;let e=0;k(E,e),e+=E.length;for(let t=0,n=S.length;t<n;t++){const n=S[t];k(n,e),e+=n.length}n.addGroup(t,r.length/3-t,1)}()}this.setAttribute("position",new Hr(r,3)),this.setAttribute("uv",new Hr(i,2)),this.computeVertexNormals()}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}toJSON(){const t=super.toJSON();return function(t,e,n){if(n.shapes=[],Array.isArray(t))for(let e=0,r=t.length;e<r;e++){const r=t[e];n.shapes.push(r.uuid)}else n.shapes.push(t.uuid);n.options=Object.assign({},e),void 0!==e.extrudePath&&(n.options.extrudePath=e.extrudePath.toJSON());return n}(this.parameters.shapes,this.parameters.options,t)}static fromJSON(t,e){const n=[];for(let r=0,i=t.shapes.length;r<i;r++){const i=e[t.shapes[r]];n.push(i)}const r=t.options.extrudePath;return void 0!==r&&(t.options.extrudePath=(new Xu[r.type]).fromJSON(r)),new kl(n,t.options)}}const Fl={generateTopUV:function(t,e,n,r,i){const o=e[3*n],a=e[3*n+1],s=e[3*r],u=e[3*r+1],l=e[3*i],c=e[3*i+1];return[new He(o,a),new He(s,u),new He(l,c)]},generateSideWallUV:function(t,e,n,r,i,o){const a=e[3*n],s=e[3*n+1],u=e[3*n+2],l=e[3*r],c=e[3*r+1],h=e[3*r+2],p=e[3*i],f=e[3*i+1],d=e[3*i+2],m=e[3*o],g=e[3*o+1],v=e[3*o+2];return Math.abs(s-c)<Math.abs(a-l)?[new He(a,1-u),new He(l,1-h),new He(p,1-d),new He(m,1-v)]:[new He(s,1-u),new He(c,1-h),new He(f,1-d),new He(g,1-v)]}};class Bl extends tl{constructor(t=1,e=0){const n=(1+Math.sqrt(5))/2;super([-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new Bl(t.radius,t.detail)}}class Ul extends tl{constructor(t=1,e=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new Ul(t.radius,t.detail)}}class zl extends $r{constructor(t=.5,e=1,n=32,r=1,i=0,o=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:o},n=Math.max(3,n);const a=[],s=[],u=[],l=[];let c=t;const h=(e-t)/(r=Math.max(1,r)),p=new $e,f=new He;for(let t=0;t<=r;t++){for(let t=0;t<=n;t++){const r=i+t/n*o;p.x=c*Math.cos(r),p.y=c*Math.sin(r),s.push(p.x,p.y,p.z),u.push(0,0,1),f.x=(p.x/e+1)/2,f.y=(p.y/e+1)/2,l.push(f.x,f.y)}c+=h}for(let t=0;t<r;t++){const e=t*(n+1);for(let t=0;t<n;t++){const r=t+e,i=r,o=r+n+1,s=r+n+2,u=r+1;a.push(i,o,u),a.push(o,s,u)}}this.setIndex(a),this.setAttribute("position",new Hr(s,3)),this.setAttribute("normal",new Hr(u,3)),this.setAttribute("uv",new Hr(l,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new zl(t.innerRadius,t.outerRadius,t.thetaSegments,t.phiSegments,t.thetaStart,t.thetaLength)}}class Vl extends $r{constructor(t=new sl([new He(0,.5),new He(-.5,-.5),new He(.5,-.5)]),e=12){super(),this.type="ShapeGeometry",this.parameters={shapes:t,curveSegments:e};const n=[],r=[],i=[],o=[];let a=0,s=0;if(!1===Array.isArray(t))u(t);else for(let e=0;e<t.length;e++)u(t[e]),this.addGroup(a,s,e),a+=s,s=0;function u(t){const a=r.length/3,u=t.extractPoints(e);let l=u.shape;const c=u.holes;!1===Nl.isClockWise(l)&&(l=l.reverse());for(let t=0,e=c.length;t<e;t++){const e=c[t];!0===Nl.isClockWise(e)&&(c[t]=e.reverse())}const h=Nl.triangulateShape(l,c);for(let t=0,e=c.length;t<e;t++){const e=c[t];l=l.concat(e)}for(let t=0,e=l.length;t<e;t++){const e=l[t];r.push(e.x,e.y,0),i.push(0,0,1),o.push(e.x,e.y)}for(let t=0,e=h.length;t<e;t++){const e=h[t],r=e[0]+a,i=e[1]+a,o=e[2]+a;n.push(r,i,o),s+=3}}this.setIndex(n),this.setAttribute("position",new Hr(r,3)),this.setAttribute("normal",new Hr(i,3)),this.setAttribute("uv",new Hr(o,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}toJSON(){const t=super.toJSON();return function(t,e){if(e.shapes=[],Array.isArray(t))for(let n=0,r=t.length;n<r;n++){const r=t[n];e.shapes.push(r.uuid)}else e.shapes.push(t.uuid);return e}(this.parameters.shapes,t)}static fromJSON(t,e){const n=[];for(let r=0,i=t.shapes.length;r<i;r++){const i=e[t.shapes[r]];n.push(i)}return new Vl(n,t.curveSegments)}}class Gl extends $r{constructor(t=1,e=32,n=16,r=0,i=2*Math.PI,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:a},e=Math.max(3,Math.floor(e)),n=Math.max(2,Math.floor(n));const s=Math.min(o+a,Math.PI);let u=0;const l=[],c=new $e,h=new $e,p=[],f=[],d=[],m=[];for(let p=0;p<=n;p++){const g=[],v=p/n;let y=0;0==p&&0==o?y=.5/e:p==n&&s==Math.PI&&(y=-.5/e);for(let n=0;n<=e;n++){const s=n/e;c.x=-t*Math.cos(r+s*i)*Math.sin(o+v*a),c.y=t*Math.cos(o+v*a),c.z=t*Math.sin(r+s*i)*Math.sin(o+v*a),f.push(c.x,c.y,c.z),h.copy(c).normalize(),d.push(h.x,h.y,h.z),m.push(s+y,1-v),g.push(u++)}l.push(g)}for(let t=0;t<n;t++)for(let r=0;r<e;r++){const e=l[t][r+1],i=l[t][r],a=l[t+1][r],u=l[t+1][r+1];(0!==t||o>0)&&p.push(e,i,u),(t!==n-1||s<Math.PI)&&p.push(i,a,u)}this.setIndex(p),this.setAttribute("position",new Hr(f,3)),this.setAttribute("normal",new Hr(d,3)),this.setAttribute("uv",new Hr(m,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new Gl(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength)}}class jl extends tl{constructor(t=1,e=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new jl(t.radius,t.detail)}}class Wl extends $r{constructor(t=1,e=.4,n=12,r=48,i=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:r,arc:i},n=Math.floor(n),r=Math.floor(r);const o=[],a=[],s=[],u=[],l=new $e,c=new $e,h=new $e;for(let o=0;o<=n;o++)for(let p=0;p<=r;p++){const f=p/r*i,d=o/n*Math.PI*2;c.x=(t+e*Math.cos(d))*Math.cos(f),c.y=(t+e*Math.cos(d))*Math.sin(f),c.z=e*Math.sin(d),a.push(c.x,c.y,c.z),l.x=t*Math.cos(f),l.y=t*Math.sin(f),h.subVectors(c,l).normalize(),s.push(h.x,h.y,h.z),u.push(p/r),u.push(o/n)}for(let t=1;t<=n;t++)for(let e=1;e<=r;e++){const n=(r+1)*t+e-1,i=(r+1)*(t-1)+e-1,a=(r+1)*(t-1)+e,s=(r+1)*t+e;o.push(n,i,s),o.push(i,a,s)}this.setIndex(o),this.setAttribute("position",new Hr(a,3)),this.setAttribute("normal",new Hr(s,3)),this.setAttribute("uv",new Hr(u,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new Wl(t.radius,t.tube,t.radialSegments,t.tubularSegments,t.arc)}}class Hl extends $r{constructor(t=1,e=.4,n=64,r=8,i=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:r,p:i,q:o},n=Math.floor(n),r=Math.floor(r);const a=[],s=[],u=[],l=[],c=new $e,h=new $e,p=new $e,f=new $e,d=new $e,m=new $e,g=new $e;for(let a=0;a<=n;++a){const y=a/n*i*Math.PI*2;v(y,i,o,t,p),v(y+.01,i,o,t,f),m.subVectors(f,p),g.addVectors(f,p),d.crossVectors(m,g),g.crossVectors(d,m),d.normalize(),g.normalize();for(let t=0;t<=r;++t){const i=t/r*Math.PI*2,o=-e*Math.cos(i),f=e*Math.sin(i);c.x=p.x+(o*g.x+f*d.x),c.y=p.y+(o*g.y+f*d.y),c.z=p.z+(o*g.z+f*d.z),s.push(c.x,c.y,c.z),h.subVectors(c,p).normalize(),u.push(h.x,h.y,h.z),l.push(a/n),l.push(t/r)}}for(let t=1;t<=n;t++)for(let e=1;e<=r;e++){const n=(r+1)*(t-1)+(e-1),i=(r+1)*t+(e-1),o=(r+1)*t+e,s=(r+1)*(t-1)+e;a.push(n,i,s),a.push(i,o,s)}function v(t,e,n,r,i){const o=Math.cos(t),a=Math.sin(t),s=n/e*t,u=Math.cos(s);i.x=r*(2+u)*.5*o,i.y=r*(2+u)*a*.5,i.z=r*Math.sin(s)*.5}this.setIndex(a),this.setAttribute("position",new Hr(s,3)),this.setAttribute("normal",new Hr(u,3)),this.setAttribute("uv",new Hr(l,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new Hl(t.radius,t.tube,t.tubularSegments,t.radialSegments,t.p,t.q)}}class Xl extends $r{constructor(t=new Wu(new $e(-1,-1,0),new $e(-1,1,0),new $e(1,1,0)),e=64,n=1,r=8,i=!1){super(),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:r,closed:i};const o=t.computeFrenetFrames(e,i);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new $e,s=new $e,u=new He;let l=new $e;const c=[],h=[],p=[],f=[];function d(i){l=t.getPointAt(i/e,l);const u=o.normals[i],p=o.binormals[i];for(let t=0;t<=r;t++){const e=t/r*Math.PI*2,i=Math.sin(e),o=-Math.cos(e);s.x=o*u.x+i*p.x,s.y=o*u.y+i*p.y,s.z=o*u.z+i*p.z,s.normalize(),h.push(s.x,s.y,s.z),a.x=l.x+n*s.x,a.y=l.y+n*s.y,a.z=l.z+n*s.z,c.push(a.x,a.y,a.z)}}!function(){for(let t=0;t<e;t++)d(t);d(!1===i?e:0),function(){for(let t=0;t<=e;t++)for(let n=0;n<=r;n++)u.x=t/e,u.y=n/r,p.push(u.x,u.y)}(),function(){for(let t=1;t<=e;t++)for(let e=1;e<=r;e++){const n=(r+1)*(t-1)+(e-1),i=(r+1)*t+(e-1),o=(r+1)*t+e,a=(r+1)*(t-1)+e;f.push(n,i,a),f.push(i,o,a)}}()}(),this.setIndex(f),this.setAttribute("position",new Hr(c,3)),this.setAttribute("normal",new Hr(h,3)),this.setAttribute("uv",new Hr(p,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}toJSON(){const t=super.toJSON();return t.path=this.parameters.path.toJSON(),t}static fromJSON(t){return new Xl((new Xu[t.path.type]).fromJSON(t.path),t.tubularSegments,t.radius,t.radialSegments,t.closed)}}class Yl extends $r{constructor(t=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:t},null!==t){const e=[],n=new Set,r=new $e,i=new $e;if(null!==t.index){const o=t.attributes.position,a=t.index;let s=t.groups;0===s.length&&(s=[{start:0,count:a.count,materialIndex:0}]);for(let t=0,u=s.length;t<u;++t){const u=s[t],l=u.start;for(let t=l,s=l+u.count;t<s;t+=3)for(let s=0;s<3;s++){const u=a.getX(t+s),l=a.getX(t+(s+1)%3);r.fromBufferAttribute(o,u),i.fromBufferAttribute(o,l),!0===ql(r,i,n)&&(e.push(r.x,r.y,r.z),e.push(i.x,i.y,i.z))}}}else{const o=t.attributes.position;for(let t=0,a=o.count/3;t<a;t++)for(let a=0;a<3;a++){const s=3*t+a,u=3*t+(a+1)%3;r.fromBufferAttribute(o,s),i.fromBufferAttribute(o,u),!0===ql(r,i,n)&&(e.push(r.x,r.y,r.z),e.push(i.x,i.y,i.z))}}this.setAttribute("position",new Hr(e,3))}}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}}function ql(t,e,n){const r=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`,i=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`;return!0!==n.has(r)&&!0!==n.has(i)&&(n.add(r),n.add(i),!0)}var Zl=Object.freeze({__proto__:null,BoxGeometry:gi,CapsuleGeometry:Ju,CircleGeometry:Ku,ConeGeometry:$u,CylinderGeometry:Qu,DodecahedronGeometry:el,EdgesGeometry:al,ExtrudeGeometry:kl,IcosahedronGeometry:Bl,LatheGeometry:Zu,OctahedronGeometry:Ul,PlaneGeometry:Fi,PolyhedronGeometry:tl,RingGeometry:zl,ShapeGeometry:Vl,SphereGeometry:Gl,TetrahedronGeometry:jl,TorusGeometry:Wl,TorusKnotGeometry:Hl,TubeGeometry:Xl,WireframeGeometry:Yl});class Jl extends Or{constructor(t){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Fr(0),this.transparent=!0,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.fog=t.fog,this}}class Kl extends bi{constructor(t){super(t),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class Ql extends Or{constructor(t){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Fr(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Fr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=be,this.normalScale=new He(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}class $l extends Ql{constructor(t){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new He(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return ke(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Fr(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Fr(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Fr(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(t)}get sheen(){return this._sheen}set sheen(t){this._sheen>0!=t>0&&this.version++,this._sheen=t}get clearcoat(){return this._clearcoat}set clearcoat(t){this._clearcoat>0!=t>0&&this.version++,this._clearcoat=t}get iridescence(){return this._iridescence}set iridescence(t){this._iridescence>0!=t>0&&this.version++,this._iridescence=t}get transmission(){return this._transmission}set transmission(t){this._transmission>0!=t>0&&this.version++,this._transmission=t}copy(t){return super.copy(t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.ior=t.ior,this.iridescence=t.iridescence,this.iridescenceMap=t.iridescenceMap,this.iridescenceIOR=t.iridescenceIOR,this.iridescenceThicknessRange=[...t.iridescenceThicknessRange],this.iridescenceThicknessMap=t.iridescenceThicknessMap,this.sheen=t.sheen,this.sheenColor.copy(t.sheenColor),this.sheenColorMap=t.sheenColorMap,this.sheenRoughness=t.sheenRoughness,this.sheenRoughnessMap=t.sheenRoughnessMap,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this.thickness=t.thickness,this.thicknessMap=t.thicknessMap,this.attenuationDistance=t.attenuationDistance,this.attenuationColor.copy(t.attenuationColor),this.specularIntensity=t.specularIntensity,this.specularIntensityMap=t.specularIntensityMap,this.specularColor.copy(t.specularColor),this.specularColorMap=t.specularColorMap,this}}class tc extends Or{constructor(t){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Fr(16777215),this.specular=new Fr(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Fr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=be,this.normalScale=new He(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=G,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}class ec extends Or{constructor(t){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Fr(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Fr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=be,this.normalScale=new He(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}class nc extends Or{constructor(t){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=be,this.normalScale=new He(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.flatShading=t.flatShading,this}}class rc extends Or{constructor(t){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Fr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Fr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=be,this.normalScale=new He(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=G,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}class ic extends Or{constructor(t){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Fr(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=be,this.normalScale=new He(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.flatShading=t.flatShading,this.fog=t.fog,this}}class oc extends uu{constructor(t){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}copy(t){return super.copy(t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this}}function ac(t,e,n){return uc(t)?new t.constructor(t.subarray(e,void 0!==n?n:t.length)):t.slice(e,n)}function sc(t,e,n){return!t||!n&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)}function uc(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function lc(t){const e=t.length,n=new Array(e);for(let t=0;t!==e;++t)n[t]=t;return n.sort((function(e,n){return t[e]-t[n]})),n}function cc(t,e,n){const r=t.length,i=new t.constructor(r);for(let o=0,a=0;a!==r;++o){const r=n[o]*e;for(let n=0;n!==e;++n)i[a++]=t[r+n]}return i}function hc(t,e,n,r){let i=1,o=t[0];for(;void 0!==o&&void 0===o[r];)o=t[i++];if(void 0===o)return;let a=o[r];if(void 0!==a)if(Array.isArray(a))do{a=o[r],void 0!==a&&(e.push(o.time),n.push.apply(n,a)),o=t[i++]}while(void 0!==o);else if(void 0!==a.toArray)do{a=o[r],void 0!==a&&(e.push(o.time),a.toArray(n,n.length)),o=t[i++]}while(void 0!==o);else do{a=o[r],void 0!==a&&(e.push(o.time),n.push(a)),o=t[i++]}while(void 0!==o)}const pc={arraySlice:ac,convertArray:sc,isTypedArray:uc,getKeyframeOrder:lc,sortedArray:cc,flattenJSON:hc,subclip:function(t,e,n,r,i=30){const o=t.clone();o.name=e;const a=[];for(let t=0;t<o.tracks.length;++t){const e=o.tracks[t],s=e.getValueSize(),u=[],l=[];for(let t=0;t<e.times.length;++t){const o=e.times[t]*i;if(!(o<n||o>=r)){u.push(e.times[t]);for(let n=0;n<s;++n)l.push(e.values[t*s+n])}}0!==u.length&&(e.times=sc(u,e.times.constructor),e.values=sc(l,e.values.constructor),a.push(e))}o.tracks=a;let s=1/0;for(let t=0;t<o.tracks.length;++t)s>o.tracks[t].times[0]&&(s=o.tracks[t].times[0]);for(let t=0;t<o.tracks.length;++t)o.tracks[t].shift(-1*s);return o.resetDuration(),o},makeClipAdditive:function(t,e=0,n=t,r=30){r<=0&&(r=30);const i=n.tracks.length,o=e/r;for(let e=0;e<i;++e){const r=n.tracks[e],i=r.ValueTypeName;if("bool"===i||"string"===i)continue;const a=t.tracks.find((function(t){return t.name===r.name&&t.ValueTypeName===i}));if(void 0===a)continue;let s=0;const u=r.getValueSize();r.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(s=u/3);let l=0;const c=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(l=c/3);const h=r.times.length-1;let p;if(o<=r.times[0]){const t=s,e=u-s;p=ac(r.values,t,e)}else if(o>=r.times[h]){const t=h*u+s,e=t+u-s;p=ac(r.values,t,e)}else{const t=r.createInterpolant(),e=s,n=u-s;t.evaluate(o),p=ac(t.resultBuffer,e,n)}if("quaternion"===i){(new Qe).fromArray(p).normalize().conjugate().toArray(p)}const f=a.times.length;for(let t=0;t<f;++t){const e=t*c+l;if("quaternion"===i)Qe.multiplyQuaternionsFlat(a.values,e,p,0,a.values,e);else{const t=c-2*l;for(let n=0;n<t;++n)a.values[e+n]-=p[n]}}}return t.blendMode=ve,t}};class fc{constructor(t,e,n,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new e.constructor(n),this.sampleValues=e,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(t){const e=this.parameterPositions;let n=this._cachedIndex,r=e[n],i=e[n-1];t:{e:{let o;n:{r:if(!(t<r)){for(let o=n+2;;){if(void 0===r){if(t<i)break r;return n=e.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===o)break;if(i=r,r=e[++n],t<r)break e}o=e.length;break n}if(t>=i)break t;{const a=e[1];t<a&&(n=2,i=a);for(let o=n-2;;){if(void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(n===o)break;if(r=i,i=e[--n-1],t>=i)break e}o=n,n=0}}for(;n<o;){const r=n+o>>>1;t<e[r]?o=r:n=r+1}if(r=e[n],i=e[n-1],void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return n=e.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,t,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){const e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=t*r;for(let t=0;t!==r;++t)e[t]=n[i+t];return e}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class dc extends fc{constructor(t,e,n,r){super(t,e,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:fe,endingEnd:fe}}intervalChanged_(t,e,n){const r=this.parameterPositions;let i=t-2,o=t+1,a=r[i],s=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case de:i=t,a=2*e-n;break;case me:i=r.length-2,a=e+r[i]-r[i+1];break;default:i=t,a=n}if(void 0===s)switch(this.getSettings_().endingEnd){case de:o=t,s=2*n-e;break;case me:o=1,s=n+r[1]-r[0];break;default:o=t-1,s=e}const u=.5*(n-e),l=this.valueSize;this._weightPrev=u/(e-a),this._weightNext=u/(s-n),this._offsetPrev=i*l,this._offsetNext=o*l}interpolate_(t,e,n,r){const i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,u=s-a,l=this._offsetPrev,c=this._offsetNext,h=this._weightPrev,p=this._weightNext,f=(n-e)/(r-e),d=f*f,m=d*f,g=-h*m+2*h*d-h*f,v=(1+h)*m+(-1.5-2*h)*d+(-.5+h)*f+1,y=(-1-p)*m+(1.5+p)*d+.5*f,x=p*m-p*d;for(let t=0;t!==a;++t)i[t]=g*o[l+t]+v*o[u+t]+y*o[s+t]+x*o[c+t];return i}}class mc extends fc{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t,e,n,r){const i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,u=s-a,l=(n-e)/(r-e),c=1-l;for(let t=0;t!==a;++t)i[t]=o[u+t]*c+o[s+t]*l;return i}}class gc extends fc{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t){return this.copySampleValue_(t-1)}}class vc{constructor(t,e,n,r){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=sc(e,this.TimeBufferType),this.values=sc(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(t){const e=t.constructor;let n;if(e.toJSON!==this.toJSON)n=e.toJSON(t);else{n={name:t.name,times:sc(t.times,Array),values:sc(t.values,Array)};const e=t.getInterpolation();e!==t.DefaultInterpolation&&(n.interpolation=e)}return n.type=t.ValueTypeName,n}InterpolantFactoryMethodDiscrete(t){return new gc(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new mc(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new dc(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let e;switch(t){case ce:e=this.InterpolantFactoryMethodDiscrete;break;case he:e=this.InterpolantFactoryMethodLinear;break;case pe:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){const e="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(e);this.setInterpolation(this.DefaultInterpolation)}return this}return this.createInterpolant=e,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return ce;case this.InterpolantFactoryMethodLinear:return he;case this.InterpolantFactoryMethodSmooth:return pe}}getValueSize(){return this.values.length/this.times.length}shift(t){if(0!==t){const e=this.times;for(let n=0,r=e.length;n!==r;++n)e[n]+=t}return this}scale(t){if(1!==t){const e=this.times;for(let n=0,r=e.length;n!==r;++n)e[n]*=t}return this}trim(t,e){const n=this.times,r=n.length;let i=0,o=r-1;for(;i!==r&&n[i]<t;)++i;for(;-1!==o&&n[o]>e;)--o;if(++o,0!==i||o!==r){i>=o&&(o=Math.max(o,1),i=o-1);const t=this.getValueSize();this.times=ac(n,i,o),this.values=ac(this.values,i*t,o*t)}return this}validate(){let t=!0;const e=this.getValueSize();e-Math.floor(e)!=0&&(t=!1);const n=this.times,r=this.values,i=n.length;0===i&&(t=!1);let o=null;for(let e=0;e!==i;e++){const r=n[e];if("number"==typeof r&&isNaN(r)){t=!1;break}if(null!==o&&o>r){t=!1;break}o=r}if(void 0!==r&&uc(r))for(let e=0,n=r.length;e!==n;++e){const n=r[e];if(isNaN(n)){t=!1;break}}return t}optimize(){const t=ac(this.times),e=ac(this.values),n=this.getValueSize(),r=this.getInterpolation()===pe,i=t.length-1;let o=1;for(let a=1;a<i;++a){let i=!1;const s=t[a];if(s!==t[a+1]&&(1!==a||s!==t[0]))if(r)i=!0;else{const t=a*n,r=t-n,o=t+n;for(let a=0;a!==n;++a){const n=e[t+a];if(n!==e[r+a]||n!==e[o+a]){i=!0;break}}}if(i){if(a!==o){t[o]=t[a];const r=a*n,i=o*n;for(let t=0;t!==n;++t)e[i+t]=e[r+t]}++o}}if(i>0){t[o]=t[i];for(let t=i*n,r=o*n,a=0;a!==n;++a)e[r+a]=e[t+a];++o}return o!==t.length?(this.times=ac(t,0,o),this.values=ac(e,0,o*n)):(this.times=t,this.values=e),this}clone(){const t=ac(this.times,0),e=ac(this.values,0),n=new(0,this.constructor)(this.name,t,e);return n.createInterpolant=this.createInterpolant,n}}vc.prototype.TimeBufferType=Float32Array,vc.prototype.ValueBufferType=Float32Array,vc.prototype.DefaultInterpolation=he;class yc extends vc{}yc.prototype.ValueTypeName="bool",yc.prototype.ValueBufferType=Array,yc.prototype.DefaultInterpolation=ce,yc.prototype.InterpolantFactoryMethodLinear=void 0,yc.prototype.InterpolantFactoryMethodSmooth=void 0;class xc extends vc{}xc.prototype.ValueTypeName="color";class _c extends vc{}_c.prototype.ValueTypeName="number";class bc extends fc{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t,e,n,r){const i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=(n-e)/(r-e);let u=t*a;for(let t=u+a;u!==t;u+=4)Qe.slerpFlat(i,0,o,u-a,o,u,s);return i}}class wc extends vc{InterpolantFactoryMethodLinear(t){return new bc(this.times,this.values,this.getValueSize(),t)}}wc.prototype.ValueTypeName="quaternion",wc.prototype.DefaultInterpolation=he,wc.prototype.InterpolantFactoryMethodSmooth=void 0;class Mc extends vc{}Mc.prototype.ValueTypeName="string",Mc.prototype.ValueBufferType=Array,Mc.prototype.DefaultInterpolation=ce,Mc.prototype.InterpolantFactoryMethodLinear=void 0,Mc.prototype.InterpolantFactoryMethodSmooth=void 0;class Sc extends vc{}Sc.prototype.ValueTypeName="vector";class Tc{constructor(t,e=-1,n,r=2500){this.name=t,this.tracks=n,this.duration=e,this.blendMode=r,this.uuid=De(),this.duration<0&&this.resetDuration()}static parse(t){const e=[],n=t.tracks,r=1/(t.fps||1);for(let t=0,i=n.length;t!==i;++t)e.push(Ec(n[t]).scale(r));const i=new this(t.name,t.duration,e,t.blendMode);return i.uuid=t.uuid,i}static toJSON(t){const e=[],n=t.tracks,r={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid,blendMode:t.blendMode};for(let t=0,r=n.length;t!==r;++t)e.push(vc.toJSON(n[t]));return r}static CreateFromMorphTargetSequence(t,e,n,r){const i=e.length,o=[];for(let t=0;t<i;t++){let a=[],s=[];a.push((t+i-1)%i,t,(t+1)%i),s.push(0,1,0);const u=lc(a);a=cc(a,1,u),s=cc(s,1,u),r||0!==a[0]||(a.push(i),s.push(s[0])),o.push(new _c(".morphTargetInfluences["+e[t].name+"]",a,s).scale(1/n))}return new this(t,-1,o)}static findByName(t,e){let n=t;if(!Array.isArray(t)){const e=t;n=e.geometry&&e.geometry.animations||e.animations}for(let t=0;t<n.length;t++)if(n[t].name===e)return n[t];return null}static CreateClipsFromMorphTargetSequences(t,e,n){const r={},i=/^([\w-]*?)([\d]+)$/;for(let e=0,n=t.length;e<n;e++){const n=t[e],o=n.name.match(i);if(o&&o.length>1){const t=o[1];let e=r[t];e||(r[t]=e=[]),e.push(n)}}const o=[];for(const t in r)o.push(this.CreateFromMorphTargetSequence(t,r[t],e,n));return o}static parseAnimation(t,e){if(!t)return null;const n=function(t,e,n,r,i){if(0!==n.length){const o=[],a=[];hc(n,o,a,r),0!==o.length&&i.push(new t(e,o,a))}},r=[],i=t.name||"default",o=t.fps||30,a=t.blendMode;let s=t.length||-1;const u=t.hierarchy||[];for(let t=0;t<u.length;t++){const i=u[t].keys;if(i&&0!==i.length)if(i[0].morphTargets){const t={};let e;for(e=0;e<i.length;e++)if(i[e].morphTargets)for(let n=0;n<i[e].morphTargets.length;n++)t[i[e].morphTargets[n]]=-1;for(const n in t){const t=[],o=[];for(let r=0;r!==i[e].morphTargets.length;++r){const r=i[e];t.push(r.time),o.push(r.morphTarget===n?1:0)}r.push(new _c(".morphTargetInfluence["+n+"]",t,o))}s=t.length*o}else{const o=".bones["+e[t].name+"]";n(Sc,o+".position",i,"pos",r),n(wc,o+".quaternion",i,"rot",r),n(Sc,o+".scale",i,"scl",r)}}if(0===r.length)return null;return new this(i,s,r,a)}resetDuration(){let t=0;for(let e=0,n=this.tracks.length;e!==n;++e){const n=this.tracks[e];t=Math.max(t,n.times[n.times.length-1])}return this.duration=t,this}trim(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this}validate(){let t=!0;for(let e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t}optimize(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}clone(){const t=[];for(let e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new this.constructor(this.name,this.duration,t,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Ec(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return _c;case"vector":case"vector2":case"vector3":case"vector4":return Sc;case"color":return xc;case"quaternion":return wc;case"bool":case"boolean":return yc;case"string":return Mc}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(t.type);if(void 0===t.times){const e=[],n=[];hc(t.keys,e,n,"value"),t.times=e,t.values=n}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}const Ac={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};class Pc{constructor(t,e,n){const r=this;let i,o=!1,a=0,s=0;const u=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){s++,!1===o&&void 0!==r.onStart&&r.onStart(t,a,s),o=!0},this.itemEnd=function(t){a++,void 0!==r.onProgress&&r.onProgress(t,a,s),a===s&&(o=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(t){void 0!==r.onError&&r.onError(t)},this.resolveURL=function(t){return i?i(t):t},this.setURLModifier=function(t){return i=t,this},this.addHandler=function(t,e){return u.push(t,e),this},this.removeHandler=function(t){const e=u.indexOf(t);return-1!==e&&u.splice(e,2),this},this.getHandler=function(t){for(let e=0,n=u.length;e<n;e+=2){const n=u[e],r=u[e+1];if(n.global&&(n.lastIndex=0),n.test(t))return r}return null}}}const Cc=new Pc;class Lc{constructor(t){this.manager=void 0!==t?t:Cc,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,e){const n=this;return new Promise((function(r,i){n.load(t,r,e,i)}))}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}const Ic={};class Oc extends Error{constructor(t,e){super(t),this.response=e}}class Nc extends Lc{constructor(t){super(t)}load(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const i=Ac.get(t);if(void 0!==i)return this.manager.itemStart(t),setTimeout((()=>{e&&e(i),this.manager.itemEnd(t)}),0),i;if(void 0!==Ic[t])return void Ic[t].push({onLoad:e,onProgress:n,onError:r});Ic[t]=[],Ic[t].push({onLoad:e,onProgress:n,onError:r});const o=new Request(t,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,s=this.responseType;fetch(o).then((e=>{if(200===e.status||0===e.status){if(e.status,"undefined"==typeof ReadableStream||void 0===e.body||void 0===e.body.getReader)return e;const n=Ic[t],r=e.body.getReader(),i=e.headers.get("Content-Length")||e.headers.get("X-File-Size"),o=i?parseInt(i):0,a=0!==o;let s=0;const u=new ReadableStream({start(t){!function e(){r.read().then((({done:r,value:i})=>{if(r)t.close();else{s+=i.byteLength;const r=new ProgressEvent("progress",{lengthComputable:a,loaded:s,total:o});for(let t=0,e=n.length;t<e;t++){const e=n[t];e.onProgress&&e.onProgress(r)}t.enqueue(i),e()}}))}()}});return new Response(u)}throw new Oc(`fetch for "${e.url}" responded with ${e.status}: ${e.statusText}`,e)})).then((t=>{switch(s){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"document":return t.text().then((t=>(new DOMParser).parseFromString(t,a)));case"json":return t.json();default:if(void 0===a)return t.text();{const e=/charset="?([^;"\s]*)"?/i.exec(a),n=e&&e[1]?e[1].toLowerCase():void 0,r=new TextDecoder(n);return t.arrayBuffer().then((t=>r.decode(t)))}}})).then((e=>{Ac.add(t,e);const n=Ic[t];delete Ic[t];for(let t=0,r=n.length;t<r;t++){const r=n[t];r.onLoad&&r.onLoad(e)}})).catch((e=>{const n=Ic[t];if(void 0===n)throw this.manager.itemError(t),e;delete Ic[t];for(let t=0,r=n.length;t<r;t++){const r=n[t];r.onError&&r.onError(e)}this.manager.itemError(t)})).finally((()=>{this.manager.itemEnd(t)})),this.manager.itemStart(t)}setResponseType(t){return this.responseType=t,this}setMimeType(t){return this.mimeType=t,this}}class Rc extends Lc{constructor(t){super(t)}load(t,e,n,r){void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const i=this,o=Ac.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout((function(){e&&e(o),i.manager.itemEnd(t)}),0),o;const a=Ke("img");function s(){l(),Ac.add(t,this),e&&e(this),i.manager.itemEnd(t)}function u(e){l(),r&&r(e),i.manager.itemError(t),i.manager.itemEnd(t)}function l(){a.removeEventListener("load",s,!1),a.removeEventListener("error",u,!1)}return a.addEventListener("load",s,!1),a.addEventListener("error",u,!1),"data:"!==t.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),i.manager.itemStart(t),a.src=t,a}}class Dc extends xr{constructor(t,e=1){super(),this.isLight=!0,this.type="Light",this.color=new Fr(t),this.intensity=e}dispose(){}copy(t,e){return super.copy(t,e),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){const e=super.toJSON(t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}class kc extends Dc{constructor(t,e,n){super(t,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(xr.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Fr(e)}copy(t,e){return super.copy(t,e),this.groundColor.copy(t.groundColor),this}}const Fc=new qn,Bc=new $e,Uc=new $e;class zc{constructor(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new He(512,512),this.map=null,this.mapPass=null,this.matrix=new qn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Ri,this._frameExtents=new He(1,1),this._viewportCount=1,this._viewports=[new vn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){const e=this.camera,n=this.matrix;Bc.setFromMatrixPosition(t.matrixWorld),e.position.copy(Bc),Uc.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(Uc),e.updateMatrixWorld(),Fc.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Fc),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(Fc)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const t={};return 0!==this.bias&&(t.bias=this.bias),0!==this.normalBias&&(t.normalBias=this.normalBias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}class Vc extends zc{constructor(){super(new Mi(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(t){const e=this.camera,n=2*Re*t.angle*this.focus,r=this.mapSize.width/this.mapSize.height,i=t.distance||e.far;n===e.fov&&r===e.aspect&&i===e.far||(e.fov=n,e.aspect=r,e.far=i,e.updateProjectionMatrix()),super.updateMatrices(t)}copy(t){return super.copy(t),this.focus=t.focus,this}}class Gc extends Dc{constructor(t,e,n=0,r=Math.PI/3,i=0,o=2){super(t,e),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(xr.DEFAULT_UP),this.updateMatrix(),this.target=new xr,this.distance=n,this.angle=r,this.penumbra=i,this.decay=o,this.map=null,this.shadow=new Vc}get power(){return this.intensity*Math.PI}set power(t){this.intensity=t/Math.PI}dispose(){this.shadow.dispose()}copy(t,e){return super.copy(t,e),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}const jc=new qn,Wc=new $e,Hc=new $e;class Xc extends zc{constructor(){super(new Mi(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new He(4,2),this._viewportCount=6,this._viewports=[new vn(2,1,1,1),new vn(0,1,1,1),new vn(3,1,1,1),new vn(1,1,1,1),new vn(3,0,1,1),new vn(1,0,1,1)],this._cubeDirections=[new $e(1,0,0),new $e(-1,0,0),new $e(0,0,1),new $e(0,0,-1),new $e(0,1,0),new $e(0,-1,0)],this._cubeUps=[new $e(0,1,0),new $e(0,1,0),new $e(0,1,0),new $e(0,1,0),new $e(0,0,1),new $e(0,0,-1)]}updateMatrices(t,e=0){const n=this.camera,r=this.matrix,i=t.distance||n.far;i!==n.far&&(n.far=i,n.updateProjectionMatrix()),Wc.setFromMatrixPosition(t.matrixWorld),n.position.copy(Wc),Hc.copy(n.position),Hc.add(this._cubeDirections[e]),n.up.copy(this._cubeUps[e]),n.lookAt(Hc),n.updateMatrixWorld(),r.makeTranslation(-Wc.x,-Wc.y,-Wc.z),jc.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(jc)}}class Yc extends Dc{constructor(t,e,n=0,r=2){super(t,e),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new Xc}get power(){return 4*this.intensity*Math.PI}set power(t){this.intensity=t/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(t,e){return super.copy(t,e),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}class qc extends zc{constructor(){super(new qi(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Zc extends Dc{constructor(t,e){super(t,e),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(xr.DEFAULT_UP),this.updateMatrix(),this.target=new xr,this.shadow=new qc}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}class Jc extends Dc{constructor(t,e){super(t,e),this.isAmbientLight=!0,this.type="AmbientLight"}}class Kc extends Dc{constructor(t,e,n=10,r=10){super(t,e),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(t){this.intensity=t/(this.width*this.height*Math.PI)}copy(t){return super.copy(t),this.width=t.width,this.height=t.height,this}toJSON(t){const e=super.toJSON(t);return e.object.width=this.width,e.object.height=this.height,e}}class Qc{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let t=0;t<9;t++)this.coefficients.push(new $e)}set(t){for(let e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this}zero(){for(let t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this}getAt(t,e){const n=t.x,r=t.y,i=t.z,o=this.coefficients;return e.copy(o[0]).multiplyScalar(.282095),e.addScaledVector(o[1],.488603*r),e.addScaledVector(o[2],.488603*i),e.addScaledVector(o[3],.488603*n),e.addScaledVector(o[4],n*r*1.092548),e.addScaledVector(o[5],r*i*1.092548),e.addScaledVector(o[6],.315392*(3*i*i-1)),e.addScaledVector(o[7],n*i*1.092548),e.addScaledVector(o[8],.546274*(n*n-r*r)),e}getIrradianceAt(t,e){const n=t.x,r=t.y,i=t.z,o=this.coefficients;return e.copy(o[0]).multiplyScalar(.886227),e.addScaledVector(o[1],1.023328*r),e.addScaledVector(o[2],1.023328*i),e.addScaledVector(o[3],1.023328*n),e.addScaledVector(o[4],.858086*n*r),e.addScaledVector(o[5],.858086*r*i),e.addScaledVector(o[6],.743125*i*i-.247708),e.addScaledVector(o[7],.858086*n*i),e.addScaledVector(o[8],.429043*(n*n-r*r)),e}add(t){for(let e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this}addScaledSH(t,e){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(t.coefficients[n],e);return this}scale(t){for(let e=0;e<9;e++)this.coefficients[e].multiplyScalar(t);return this}lerp(t,e){for(let n=0;n<9;n++)this.coefficients[n].lerp(t.coefficients[n],e);return this}equals(t){for(let e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0}copy(t){return this.set(t.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(t,e=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(t,e+3*r);return this}toArray(t=[],e=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(t,e+3*r);return t}static getBasisAt(t,e){const n=t.x,r=t.y,i=t.z;e[0]=.282095,e[1]=.488603*r,e[2]=.488603*i,e[3]=.488603*n,e[4]=1.092548*n*r,e[5]=1.092548*r*i,e[6]=.315392*(3*i*i-1),e[7]=1.092548*n*i,e[8]=.546274*(n*n-r*r)}}class $c extends Dc{constructor(t=new Qc,e=1){super(void 0,e),this.isLightProbe=!0,this.sh=t}copy(t){return super.copy(t),this.sh.copy(t.sh),this}fromJSON(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this}toJSON(t){const e=super.toJSON(t);return e.object.sh=this.sh.toArray(),e}}class th extends Lc{constructor(t){super(t),this.textures={}}load(t,e,n,r){const i=this,o=new Nc(i.manager);o.setPath(i.path),o.setRequestHeader(i.requestHeader),o.setWithCredentials(i.withCredentials),o.load(t,(function(n){try{e(i.parse(JSON.parse(n)))}catch(e){r&&r(e),i.manager.itemError(t)}}),n,r)}parse(t){const e=this.textures;function n(t){return e[t],e[t]}const r=th.createMaterialFromType(t.type);if(void 0!==t.uuid&&(r.uuid=t.uuid),void 0!==t.name&&(r.name=t.name),void 0!==t.color&&void 0!==r.color&&r.color.setHex(t.color),void 0!==t.roughness&&(r.roughness=t.roughness),void 0!==t.metalness&&(r.metalness=t.metalness),void 0!==t.sheen&&(r.sheen=t.sheen),void 0!==t.sheenColor&&(r.sheenColor=(new Fr).setHex(t.sheenColor)),void 0!==t.sheenRoughness&&(r.sheenRoughness=t.sheenRoughness),void 0!==t.emissive&&void 0!==r.emissive&&r.emissive.setHex(t.emissive),void 0!==t.specular&&void 0!==r.specular&&r.specular.setHex(t.specular),void 0!==t.specularIntensity&&(r.specularIntensity=t.specularIntensity),void 0!==t.specularColor&&void 0!==r.specularColor&&r.specularColor.setHex(t.specularColor),void 0!==t.shininess&&(r.shininess=t.shininess),void 0!==t.clearcoat&&(r.clearcoat=t.clearcoat),void 0!==t.clearcoatRoughness&&(r.clearcoatRoughness=t.clearcoatRoughness),void 0!==t.iridescence&&(r.iridescence=t.iridescence),void 0!==t.iridescenceIOR&&(r.iridescenceIOR=t.iridescenceIOR),void 0!==t.iridescenceThicknessRange&&(r.iridescenceThicknessRange=t.iridescenceThicknessRange),void 0!==t.transmission&&(r.transmission=t.transmission),void 0!==t.thickness&&(r.thickness=t.thickness),void 0!==t.attenuationDistance&&(r.attenuationDistance=t.attenuationDistance),void 0!==t.attenuationColor&&void 0!==r.attenuationColor&&r.attenuationColor.setHex(t.attenuationColor),void 0!==t.fog&&(r.fog=t.fog),void 0!==t.flatShading&&(r.flatShading=t.flatShading),void 0!==t.blending&&(r.blending=t.blending),void 0!==t.combine&&(r.combine=t.combine),void 0!==t.side&&(r.side=t.side),void 0!==t.shadowSide&&(r.shadowSide=t.shadowSide),void 0!==t.opacity&&(r.opacity=t.opacity),void 0!==t.transparent&&(r.transparent=t.transparent),void 0!==t.alphaTest&&(r.alphaTest=t.alphaTest),void 0!==t.depthTest&&(r.depthTest=t.depthTest),void 0!==t.depthWrite&&(r.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(r.colorWrite=t.colorWrite),void 0!==t.stencilWrite&&(r.stencilWrite=t.stencilWrite),void 0!==t.stencilWriteMask&&(r.stencilWriteMask=t.stencilWriteMask),void 0!==t.stencilFunc&&(r.stencilFunc=t.stencilFunc),void 0!==t.stencilRef&&(r.stencilRef=t.stencilRef),void 0!==t.stencilFuncMask&&(r.stencilFuncMask=t.stencilFuncMask),void 0!==t.stencilFail&&(r.stencilFail=t.stencilFail),void 0!==t.stencilZFail&&(r.stencilZFail=t.stencilZFail),void 0!==t.stencilZPass&&(r.stencilZPass=t.stencilZPass),void 0!==t.wireframe&&(r.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(r.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(r.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(r.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(r.rotation=t.rotation),1!==t.linewidth&&(r.linewidth=t.linewidth),void 0!==t.dashSize&&(r.dashSize=t.dashSize),void 0!==t.gapSize&&(r.gapSize=t.gapSize),void 0!==t.scale&&(r.scale=t.scale),void 0!==t.polygonOffset&&(r.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(r.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(r.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.dithering&&(r.dithering=t.dithering),void 0!==t.alphaToCoverage&&(r.alphaToCoverage=t.alphaToCoverage),void 0!==t.premultipliedAlpha&&(r.premultipliedAlpha=t.premultipliedAlpha),void 0!==t.forceSinglePass&&(r.forceSinglePass=t.forceSinglePass),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.toneMapped&&(r.toneMapped=t.toneMapped),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.vertexColors&&("number"==typeof t.vertexColors?r.vertexColors=t.vertexColors>0:r.vertexColors=t.vertexColors),void 0!==t.uniforms)for(const e in t.uniforms){const i=t.uniforms[e];switch(r.uniforms[e]={},i.type){case"t":r.uniforms[e].value=n(i.value);break;case"c":r.uniforms[e].value=(new Fr).setHex(i.value);break;case"v2":r.uniforms[e].value=(new He).fromArray(i.value);break;case"v3":r.uniforms[e].value=(new $e).fromArray(i.value);break;case"v4":r.uniforms[e].value=(new vn).fromArray(i.value);break;case"m3":r.uniforms[e].value=(new Xe).fromArray(i.value);break;case"m4":r.uniforms[e].value=(new qn).fromArray(i.value);break;default:r.uniforms[e].value=i.value}}if(void 0!==t.defines&&(r.defines=t.defines),void 0!==t.vertexShader&&(r.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(r.fragmentShader=t.fragmentShader),void 0!==t.glslVersion&&(r.glslVersion=t.glslVersion),void 0!==t.extensions)for(const e in t.extensions)r.extensions[e]=t.extensions[e];if(void 0!==t.size&&(r.size=t.size),void 0!==t.sizeAttenuation&&(r.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(r.map=n(t.map)),void 0!==t.matcap&&(r.matcap=n(t.matcap)),void 0!==t.alphaMap&&(r.alphaMap=n(t.alphaMap)),void 0!==t.bumpMap&&(r.bumpMap=n(t.bumpMap)),void 0!==t.bumpScale&&(r.bumpScale=t.bumpScale),void 0!==t.normalMap&&(r.normalMap=n(t.normalMap)),void 0!==t.normalMapType&&(r.normalMapType=t.normalMapType),void 0!==t.normalScale){let e=t.normalScale;!1===Array.isArray(e)&&(e=[e,e]),r.normalScale=(new He).fromArray(e)}return void 0!==t.displacementMap&&(r.displacementMap=n(t.displacementMap)),void 0!==t.displacementScale&&(r.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(r.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(r.roughnessMap=n(t.roughnessMap)),void 0!==t.metalnessMap&&(r.metalnessMap=n(t.metalnessMap)),void 0!==t.emissiveMap&&(r.emissiveMap=n(t.emissiveMap)),void 0!==t.emissiveIntensity&&(r.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(r.specularMap=n(t.specularMap)),void 0!==t.specularIntensityMap&&(r.specularIntensityMap=n(t.specularIntensityMap)),void 0!==t.specularColorMap&&(r.specularColorMap=n(t.specularColorMap)),void 0!==t.envMap&&(r.envMap=n(t.envMap)),void 0!==t.envMapIntensity&&(r.envMapIntensity=t.envMapIntensity),void 0!==t.reflectivity&&(r.reflectivity=t.reflectivity),void 0!==t.refractionRatio&&(r.refractionRatio=t.refractionRatio),void 0!==t.lightMap&&(r.lightMap=n(t.lightMap)),void 0!==t.lightMapIntensity&&(r.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(r.aoMap=n(t.aoMap)),void 0!==t.aoMapIntensity&&(r.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(r.gradientMap=n(t.gradientMap)),void 0!==t.clearcoatMap&&(r.clearcoatMap=n(t.clearcoatMap)),void 0!==t.clearcoatRoughnessMap&&(r.clearcoatRoughnessMap=n(t.clearcoatRoughnessMap)),void 0!==t.clearcoatNormalMap&&(r.clearcoatNormalMap=n(t.clearcoatNormalMap)),void 0!==t.clearcoatNormalScale&&(r.clearcoatNormalScale=(new He).fromArray(t.clearcoatNormalScale)),void 0!==t.iridescenceMap&&(r.iridescenceMap=n(t.iridescenceMap)),void 0!==t.iridescenceThicknessMap&&(r.iridescenceThicknessMap=n(t.iridescenceThicknessMap)),void 0!==t.transmissionMap&&(r.transmissionMap=n(t.transmissionMap)),void 0!==t.thicknessMap&&(r.thicknessMap=n(t.thicknessMap)),void 0!==t.sheenColorMap&&(r.sheenColorMap=n(t.sheenColorMap)),void 0!==t.sheenRoughnessMap&&(r.sheenRoughnessMap=n(t.sheenRoughnessMap)),r}setTextures(t){return this.textures=t,this}static createMaterialFromType(t){return new{ShadowMaterial:Jl,SpriteMaterial:Ts,RawShaderMaterial:Kl,ShaderMaterial:bi,PointsMaterial:xu,MeshPhysicalMaterial:$l,MeshStandardMaterial:Ql,MeshPhongMaterial:tc,MeshToonMaterial:ec,MeshNormalMaterial:nc,MeshLambertMaterial:rc,MeshDepthMaterial:es,MeshDistanceMaterial:ns,MeshBasicMaterial:Ur,MeshMatcapMaterial:ic,LineDashedMaterial:oc,LineBasicMaterial:uu,Material:Or}[t]}}class eh{static decodeText(t){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);let e="";for(let n=0,r=t.length;n<r;n++)e+=String.fromCharCode(t[n]);try{return decodeURIComponent(escape(e))}catch(t){return e}}static extractUrlBase(t){const e=t.lastIndexOf("/");return-1===e?"./":t.slice(0,e+1)}static resolveURL(t,e){return"string"!=typeof t||""===t?"":(/^https?:\/\//i.test(e)&&/^\//.test(t)&&(e=e.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(t)||/^data:.*,.*$/i.test(t)||/^blob:.*$/i.test(t)?t:e+t)}}class nh extends $r{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(t){return super.copy(t),this.instanceCount=t.instanceCount,this}toJSON(){const t=super.toJSON();return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}class rh extends Lc{constructor(t){super(t)}load(t,e,n,r){const i=this,o=new Nc(i.manager);o.setPath(i.path),o.setRequestHeader(i.requestHeader),o.setWithCredentials(i.withCredentials),o.load(t,(function(n){try{e(i.parse(JSON.parse(n)))}catch(e){r&&r(e),i.manager.itemError(t)}}),n,r)}parse(t){const e={},n={};function r(t,r){if(void 0!==e[r])return e[r];const i=t.interleavedBuffers[r],o=function(t,e){if(void 0!==n[e])return n[e];const r=t.arrayBuffers,i=r[e],o=new Uint32Array(i).buffer;return n[e]=o,o}(t,i.buffer),a=Je(i.type,o),s=new ws(a,i.stride);return s.uuid=i.uuid,e[r]=s,s}const i=t.isInstancedBufferGeometry?new nh:new $r,o=t.data.index;if(void 0!==o){const t=Je(o.type,o.array);i.setIndex(new Gr(t,1))}const a=t.data.attributes;for(const e in a){const n=a[e];let o;if(n.isInterleavedBufferAttribute){const e=r(t.data,n.data);o=new Ss(e,n.itemSize,n.offset,n.normalized)}else{const t=Je(n.type,n.array);o=new(n.isInstancedBufferAttribute?eu:Gr)(t,n.itemSize,n.normalized)}void 0!==n.name&&(o.name=n.name),void 0!==n.usage&&o.setUsage(n.usage),void 0!==n.updateRange&&(o.updateRange.offset=n.updateRange.offset,o.updateRange.count=n.updateRange.count),i.setAttribute(e,o)}const s=t.data.morphAttributes;if(s)for(const e in s){const n=s[e],o=[];for(let e=0,i=n.length;e<i;e++){const i=n[e];let a;if(i.isInterleavedBufferAttribute){const e=r(t.data,i.data);a=new Ss(e,i.itemSize,i.offset,i.normalized)}else{const t=Je(i.type,i.array);a=new Gr(t,i.itemSize,i.normalized)}void 0!==i.name&&(a.name=i.name),o.push(a)}i.morphAttributes[e]=o}t.data.morphTargetsRelative&&(i.morphTargetsRelative=!0);const u=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==u)for(let t=0,e=u.length;t!==e;++t){const e=u[t];i.addGroup(e.start,e.count,e.materialIndex)}const l=t.data.boundingSphere;if(void 0!==l){const t=new $e;void 0!==l.center&&t.fromArray(l.center),i.boundingSphere=new Un(t,l.radius)}return t.name&&(i.name=t.name),t.userData&&(i.userData=t.userData),i}}const ih={UVMapping:K,CubeReflectionMapping:Q,CubeRefractionMapping:$,EquirectangularReflectionMapping:tt,EquirectangularRefractionMapping:et,CubeUVReflectionMapping:nt},oh={RepeatWrapping:rt,ClampToEdgeWrapping:it,MirroredRepeatWrapping:ot},ah={NearestFilter:at,NearestMipmapNearestFilter:st,NearestMipmapLinearFilter:ut,LinearFilter:lt,LinearMipmapNearestFilter:ct,LinearMipmapLinearFilter:ht};let sh;class uh{static getContext(){return void 0===sh&&(sh=new(window.AudioContext||window.webkitAudioContext)),sh}static setContext(t){sh=t}}const lh=new qn,ch=new qn,hh=new qn;class ph{constructor(t=!0){this.autoStart=t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=fh(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const e=fh();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}}function fh(){return("undefined"==typeof performance?Date:performance).now()}const dh=new $e,mh=new Qe,gh=new $e,vh=new $e;class yh extends xr{constructor(t){super(),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this}setMediaElementSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this}setMediaStreamSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this}setBuffer(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this}play(t=0){if(!0===this.isPlaying)return;if(!1===this.hasPlaybackControl)return;this._startedAt=this.context.currentTime+t;const e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),e.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,null!==this.source&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(t){return t||(t=[]),!0===this._connected?(this.disconnect(),this.filters=t.slice(),this.connect()):this.filters=t.slice(),this}setDetune(t){if(this.detune=t,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(t){return this.setFilters(t?[t]:[])}setPlaybackRate(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1!==this.hasPlaybackControl&&this.loop}setLoop(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this}setLoopStart(t){return this.loopStart=t,this}setLoopEnd(t){return this.loopEnd=t,this}getVolume(){return this.gain.gain.value}setVolume(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}}const xh=new $e,_h=new Qe,bh=new $e,wh=new $e;class Mh{constructor(t,e,n){let r,i,o;switch(this.binding=t,this.valueSize=n,e){case"quaternion":r=this._slerp,i=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":r=this._select,i=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:r=this._lerp,i=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=i,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(t,e){const n=this.buffer,r=this.valueSize,i=t*r+r;let o=this.cumulativeWeight;if(0===o){for(let t=0;t!==r;++t)n[i+t]=n[t];o=e}else{o+=e;const t=e/o;this._mixBufferRegion(n,i,0,t,r)}this.cumulativeWeight=o}accumulateAdditive(t){const e=this.buffer,n=this.valueSize,r=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(e,r,0,t,n),this.cumulativeWeightAdditive+=t}apply(t){const e=this.valueSize,n=this.buffer,r=t*e+e,i=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1){const t=e*this._origIndex;this._mixBufferRegion(n,r,t,1-i,e)}o>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*e,1,e);for(let t=e,i=e+e;t!==i;++t)if(n[t]!==n[t+e]){a.setValue(n,r);break}}saveOriginalState(){const t=this.binding,e=this.buffer,n=this.valueSize,r=n*this._origIndex;t.getValue(e,r);for(let t=n,i=r;t!==i;++t)e[t]=e[r+t%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const t=3*this.valueSize;this.binding.setValue(this.buffer,t)}_setAdditiveIdentityNumeric(){const t=this._addIndex*this.valueSize,e=t+this.valueSize;for(let n=t;n<e;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const t=this._origIndex*this.valueSize,e=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[e+n]=this.buffer[t+n]}_select(t,e,n,r,i){if(r>=.5)for(let r=0;r!==i;++r)t[e+r]=t[n+r]}_slerp(t,e,n,r){Qe.slerpFlat(t,e,t,e,t,n,r)}_slerpAdditive(t,e,n,r,i){const o=this._workIndex*i;Qe.multiplyQuaternionsFlat(t,o,t,e,t,n),Qe.slerpFlat(t,e,t,e,t,o,r)}_lerp(t,e,n,r,i){const o=1-r;for(let a=0;a!==i;++a){const i=e+a;t[i]=t[i]*o+t[n+a]*r}}_lerpAdditive(t,e,n,r,i){for(let o=0;o!==i;++o){const i=e+o;t[i]=t[i]+t[n+o]*r}}}const Sh="\\[\\]\\.:\\/",Th=new RegExp("["+Sh+"]","g"),Eh="[^"+Sh+"]",Ah="[^"+Sh.replace("\\.","")+"]",Ph=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",Eh)+/(WCOD+)?/.source.replace("WCOD",Ah)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Eh)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Eh)+"$"),Ch=["material","materials","bones","map"];class Lh{constructor(t,e,n){this.path=e,this.parsedPath=n||Lh.parseTrackName(e),this.node=Lh.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,e,n){return t&&t.isAnimationObjectGroup?new Lh.Composite(t,e,n):new Lh(t,e,n)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(Th,"")}static parseTrackName(t){const e=Ph.exec(t);if(null===e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){const t=n.nodeName.substring(r+1);-1!==Ch.indexOf(t)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=t)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n}static findNode(t,e){if(void 0===e||""===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){const n=t.skeleton.getBoneByName(e);if(void 0!==n)return n}if(t.children){const n=function(t){for(let r=0;r<t.length;r++){const i=t[r];if(i.name===e||i.uuid===e)return i;const o=n(i.children);if(o)return o}return null},r=n(t.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,e){t[e]=this.targetObject[this.propertyName]}_getValue_array(t,e){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)t[e++]=n[r]}_getValue_arrayElement(t,e){t[e]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,e){this.resolvedProperty.toArray(t,e)}_setValue_direct(t,e){this.targetObject[this.propertyName]=t[e]}_setValue_direct_setNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,e){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=t[e++]}_setValue_array_setNeedsUpdate(t,e){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,e){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,e){this.resolvedProperty[this.propertyIndex]=t[e]}_setValue_arrayElement_setNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,e){this.resolvedProperty.fromArray(t,e)}_setValue_fromArray_setNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,e){this.bind(),this.getValue(t,e)}_setValue_unbound(t,e){this.bind(),this.setValue(t,e)}bind(){let t=this.node;const e=this.parsedPath,n=e.objectName,r=e.propertyName;let i=e.propertyIndex;if(t||(t=Lh.findNode(this.rootNode,e.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return;if(n){let r=e.objectIndex;switch(n){case"materials":if(!t.material)return;if(!t.material.materials)return;t=t.material.materials;break;case"bones":if(!t.skeleton)return;t=t.skeleton.bones;for(let e=0;e<t.length;e++)if(t[e].name===r){r=e;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return;if(!t.material.map)return;t=t.material.map;break;default:if(void 0===t[n])return;t=t[n]}if(void 0!==r){if(void 0===t[r])return;t=t[r]}}const o=t[r];if(void 0===o){e.nodeName;return}let a=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?a=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(a=this.Versioning.MatrixWorldNeedsUpdate);let s=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!t.geometry)return;if(!t.geometry.morphAttributes)return;void 0!==t.morphTargetDictionary[i]&&(i=t.morphTargetDictionary[i])}s=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=i}else void 0!==o.fromArray&&void 0!==o.toArray?(s=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(s=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[s],this.setValue=this.SetterByBindingTypeAndVersioning[s][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Lh.Composite=class{constructor(t,e,n){const r=n||Lh.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,r)}getValue(t,e){this.bind();const n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(t,e)}setValue(t,e){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(t,e)}bind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()}unbind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}},Lh.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Lh.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Lh.prototype.GetterByBindingType=[Lh.prototype._getValue_direct,Lh.prototype._getValue_array,Lh.prototype._getValue_arrayElement,Lh.prototype._getValue_toArray],Lh.prototype.SetterByBindingTypeAndVersioning=[[Lh.prototype._setValue_direct,Lh.prototype._setValue_direct_setNeedsUpdate,Lh.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Lh.prototype._setValue_array,Lh.prototype._setValue_array_setNeedsUpdate,Lh.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Lh.prototype._setValue_arrayElement,Lh.prototype._setValue_arrayElement_setNeedsUpdate,Lh.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Lh.prototype._setValue_fromArray,Lh.prototype._setValue_fromArray_setNeedsUpdate,Lh.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Ih{constructor(t,e,n=null,r=e.blendMode){this._mixer=t,this._clip=e,this._localRoot=n,this.blendMode=r;const i=e.tracks,o=i.length,a=new Array(o),s={endingStart:fe,endingEnd:fe};for(let t=0;t!==o;++t){const e=i[t].createInterpolant(null);a[t]=e,e.settings=s}this._interpolantSettings=s,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(t){return this._startTime=t,this}setLoop(t,e){return this.loop=t,this.repetitions=e,this}setEffectiveWeight(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(t){return this._scheduleFading(t,0,1)}fadeOut(t){return this._scheduleFading(t,1,0)}crossFadeFrom(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){const n=this._clip.duration,r=t._clip.duration,i=r/n,o=n/r;t.warp(1,i,e),this.warp(o,1,e)}return this}crossFadeTo(t,e,n){return t.crossFadeFrom(this,e,n)}stopFading(){const t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}setEffectiveTimeScale(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(t){return this.timeScale=this._clip.duration/t,this.stopWarping()}syncWith(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()}halt(t){return this.warp(this._effectiveTimeScale,0,t)}warp(t,e,n){const r=this._mixer,i=r.time,o=this.timeScale;let a=this._timeScaleInterpolant;null===a&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);const s=a.parameterPositions,u=a.sampleValues;return s[0]=i,s[1]=i+n,u[0]=t/o,u[1]=e/o,this}stopWarping(){const t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(t,e,n,r){if(!this.enabled)return void this._updateWeight(t);const i=this._startTime;if(null!==i){const r=(t-i)*n;r<0||0===n?e=0:(this._startTime=null,e=n*r)}e*=this._updateTimeScale(t);const o=this._updateTime(e),a=this._updateWeight(t);if(a>0){const t=this._interpolants,e=this._propertyBindings;if(this.blendMode===ve)for(let n=0,r=t.length;n!==r;++n)t[n].evaluate(o),e[n].accumulateAdditive(a);else for(let n=0,i=t.length;n!==i;++n)t[n].evaluate(o),e[n].accumulate(r,a)}}_updateWeight(t){let e=0;if(this.enabled){e=this.weight;const n=this._weightInterpolant;if(null!==n){const r=n.evaluate(t)[0];e*=r,t>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=e,e}_updateTimeScale(t){let e=0;if(!this.paused){e=this.timeScale;const n=this._timeScaleInterpolant;if(null!==n){e*=n.evaluate(t)[0],t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}}return this._effectiveTimeScale=e,e}_updateTime(t){const e=this._clip.duration,n=this.loop;let r=this.time+t,i=this._loopCount;const o=2202===n;if(0===t)return-1===i?r:o&&1==(1&i)?e-r:r;if(2200===n){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(r>=e)r=e;else{if(!(r<0)){this.time=r;break t}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(-1===i&&(t>=0?(i=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),r>=e||r<0){const n=Math.floor(r/e);r-=e*n,i+=Math.abs(n);const a=this.repetitions-i;if(a<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=t>0?e:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===a){const e=t<0;this._setEndings(e,!e,o)}else this._setEndings(!1,!1,o);this._loopCount=i,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:n})}}else this.time=r;if(o&&1==(1&i))return e-r}return r}_setEndings(t,e,n){const r=this._interpolantSettings;n?(r.endingStart=de,r.endingEnd=de):(r.endingStart=t?this.zeroSlopeAtStart?de:fe:me,r.endingEnd=e?this.zeroSlopeAtEnd?de:fe:me)}_scheduleFading(t,e,n){const r=this._mixer,i=r.time;let o=this._weightInterpolant;null===o&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,s=o.sampleValues;return a[0]=i,s[0]=e,a[1]=i+t,s[1]=n,this}}const Oh=new Float32Array(1);class Nh{constructor(t){this.value=t}clone(){return new Nh(void 0===this.value.clone?this.value:this.value.clone())}}let Rh=0;function Dh(t,e){return t.distance-e.distance}function kh(t,e,n,r){if(t.layers.test(e.layers)&&t.raycast(e,n),!0===r){const r=t.children;for(let t=0,i=r.length;t<i;t++)kh(r[t],e,n,!0)}}const Fh=new He;const Bh=new $e,Uh=new $e;const zh=new $e;const Vh=new $e,Gh=new qn,jh=new qn;function Wh(t){const e=[];!0===t.isBone&&e.push(t);for(let n=0;n<t.children.length;n++)e.push.apply(e,Wh(t.children[n]));return e}const Hh=new $e,Xh=new Fr,Yh=new Fr;const qh=new $e,Zh=new $e,Jh=new $e;const Kh=new $e,Qh=new wi;function $h(t,e,n,r,i,o,a){Kh.set(i,o,a).unproject(r);const s=e[t];if(void 0!==s){const t=n.getAttribute("position");for(let e=0,n=s.length;e<n;e++)t.setXYZ(s[e],Kh.x,Kh.y,Kh.z)}}const tp=new bn;const ep=new $e;let np,rp;const ip=op();function op(){const t=new ArrayBuffer(4),e=new Float32Array(t),n=new Uint32Array(t),r=new Uint32Array(512),i=new Uint32Array(512);for(let t=0;t<256;++t){const e=t-127;e<-27?(r[t]=0,r[256|t]=32768,i[t]=24,i[256|t]=24):e<-14?(r[t]=1024>>-e-14,r[256|t]=1024>>-e-14|32768,i[t]=-e-1,i[256|t]=-e-1):e<=15?(r[t]=e+15<<10,r[256|t]=e+15<<10|32768,i[t]=13,i[256|t]=13):e<128?(r[t]=31744,r[256|t]=64512,i[t]=24,i[256|t]=24):(r[t]=31744,r[256|t]=64512,i[t]=13,i[256|t]=13)}const o=new Uint32Array(2048),a=new Uint32Array(64),s=new Uint32Array(64);for(let t=1;t<1024;++t){let e=t<<13,n=0;for(;0==(8388608&e);)e<<=1,n-=8388608;e&=-8388609,n+=947912704,o[t]=e|n}for(let t=1024;t<2048;++t)o[t]=939524096+(t-1024<<13);for(let t=1;t<31;++t)a[t]=t<<23;a[31]=1199570944,a[32]=2147483648;for(let t=33;t<63;++t)a[t]=2147483648+(t-32<<23);a[63]=3347054592;for(let t=1;t<64;++t)32!==t&&(s[t]=1024);return{floatView:e,uint32View:n,baseTable:r,shiftTable:i,mantissaTable:o,exponentTable:a,offsetTable:s}}const ap={toHalfFloat:function(t){Math.abs(t),t=ke(t,-65504,65504),ip.floatView[0]=t;const e=ip.uint32View[0],n=e>>23&511;return ip.baseTable[n]+((8388607&e)>>ip.shiftTable[n])},fromHalfFloat:function(t){const e=t>>10;return ip.uint32View[0]=ip.mantissaTable[ip.offsetTable[e]+(1023&t)]+ip.exponentTable[e],ip.floatView[0]}};"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:n}})),"undefined"!=typeof window&&(window.__THREE__||(window.__THREE__=n)),e.ACESFilmicToneMapping=Z,e.AddEquation=y,e.AddOperation=W,e.AdditiveAnimationBlendMode=ve,e.AdditiveBlending=d,e.AlphaFormat=Mt,e.AlwaysDepth=D,e.AlwaysStencilFunc=519,e.AmbientLight=Jc,e.AmbientLightProbe=class extends $c{constructor(t,e=1){super(void 0,e),this.isAmbientLightProbe=!0;const n=(new Fr).set(t);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}},e.AnimationClip=Tc,e.AnimationLoader=class extends Lc{constructor(t){super(t)}load(t,e,n,r){const i=this,o=new Nc(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(t,(function(n){try{e(i.parse(JSON.parse(n)))}catch(e){r&&r(e),i.manager.itemError(t)}}),n,r)}parse(t){const e=[];for(let n=0;n<t.length;n++){const r=Tc.parse(t[n]);e.push(r)}return e}},e.AnimationMixer=class extends Le{constructor(t){super(),this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(t,e){const n=t._localRoot||this._root,r=t._clip.tracks,i=r.length,o=t._propertyBindings,a=t._interpolants,s=n.uuid,u=this._bindingsByRootAndName;let l=u[s];void 0===l&&(l={},u[s]=l);for(let t=0;t!==i;++t){const i=r[t],u=i.name;let c=l[u];if(void 0!==c)++c.referenceCount,o[t]=c;else{if(c=o[t],void 0!==c){null===c._cacheIndex&&(++c.referenceCount,this._addInactiveBinding(c,s,u));continue}const r=e&&e._propertyBindings[t].binding.parsedPath;c=new Mh(Lh.create(n,u,r),i.ValueTypeName,i.getValueSize()),++c.referenceCount,this._addInactiveBinding(c,s,u),o[t]=c}a[t].resultBuffer=c.buffer}}_activateAction(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){const e=(t._localRoot||this._root).uuid,n=t._clip.uuid,r=this._actionsByClip[n];this._bindAction(t,r&&r.knownActions[0]),this._addInactiveAction(t,n,e)}const e=t._propertyBindings;for(let t=0,n=e.length;t!==n;++t){const n=e[t];0==n.useCount++&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(t)}}_deactivateAction(t){if(this._isActiveAction(t)){const e=t._propertyBindings;for(let t=0,n=e.length;t!==n;++t){const n=e[t];0==--n.useCount&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(t)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}}_isActiveAction(t){const e=t._cacheIndex;return null!==e&&e<this._nActiveActions}_addInactiveAction(t,e,n){const r=this._actions,i=this._actionsByClip;let o=i[e];if(void 0===o)o={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,i[e]=o;else{const e=o.knownActions;t._byClipCacheIndex=e.length,e.push(t)}t._cacheIndex=r.length,r.push(t),o.actionByRoot[n]=t}_removeInactiveAction(t){const e=this._actions,n=e[e.length-1],r=t._cacheIndex;n._cacheIndex=r,e[r]=n,e.pop(),t._cacheIndex=null;const i=t._clip.uuid,o=this._actionsByClip,a=o[i],s=a.knownActions,u=s[s.length-1],l=t._byClipCacheIndex;u._byClipCacheIndex=l,s[l]=u,s.pop(),t._byClipCacheIndex=null;delete a.actionByRoot[(t._localRoot||this._root).uuid],0===s.length&&delete o[i],this._removeInactiveBindingsForAction(t)}_removeInactiveBindingsForAction(t){const e=t._propertyBindings;for(let t=0,n=e.length;t!==n;++t){const n=e[t];0==--n.referenceCount&&this._removeInactiveBinding(n)}}_lendAction(t){const e=this._actions,n=t._cacheIndex,r=this._nActiveActions++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i}_takeBackAction(t){const e=this._actions,n=t._cacheIndex,r=--this._nActiveActions,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i}_addInactiveBinding(t,e,n){const r=this._bindingsByRootAndName,i=this._bindings;let o=r[e];void 0===o&&(o={},r[e]=o),o[n]=t,t._cacheIndex=i.length,i.push(t)}_removeInactiveBinding(t){const e=this._bindings,n=t.binding,r=n.rootNode.uuid,i=n.path,o=this._bindingsByRootAndName,a=o[r],s=e[e.length-1],u=t._cacheIndex;s._cacheIndex=u,e[u]=s,e.pop(),delete a[i],0===Object.keys(a).length&&delete o[r]}_lendBinding(t){const e=this._bindings,n=t._cacheIndex,r=this._nActiveBindings++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i}_takeBackBinding(t){const e=this._bindings,n=t._cacheIndex,r=--this._nActiveBindings,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i}_lendControlInterpolant(){const t=this._controlInterpolants,e=this._nActiveControlInterpolants++;let n=t[e];return void 0===n&&(n=new mc(new Float32Array(2),new Float32Array(2),1,Oh),n.__cacheIndex=e,t[e]=n),n}_takeBackControlInterpolant(t){const e=this._controlInterpolants,n=t.__cacheIndex,r=--this._nActiveControlInterpolants,i=e[r];t.__cacheIndex=r,e[r]=t,i.__cacheIndex=n,e[n]=i}clipAction(t,e,n){const r=e||this._root,i=r.uuid;let o="string"==typeof t?Tc.findByName(r,t):t;const a=null!==o?o.uuid:t,s=this._actionsByClip[a];let u=null;if(void 0===n&&(n=null!==o?o.blendMode:ge),void 0!==s){const t=s.actionByRoot[i];if(void 0!==t&&t.blendMode===n)return t;u=s.knownActions[0],null===o&&(o=u._clip)}if(null===o)return null;const l=new Ih(this,o,e,n);return this._bindAction(l,u),this._addInactiveAction(l,a,i),l}existingAction(t,e){const n=e||this._root,r=n.uuid,i="string"==typeof t?Tc.findByName(n,t):t,o=i?i.uuid:t,a=this._actionsByClip[o];return void 0!==a&&a.actionByRoot[r]||null}stopAllAction(){const t=this._actions;for(let e=this._nActiveActions-1;e>=0;--e)t[e].stop();return this}update(t){t*=this.timeScale;const e=this._actions,n=this._nActiveActions,r=this.time+=t,i=Math.sign(t),o=this._accuIndex^=1;for(let a=0;a!==n;++a){e[a]._update(r,t,i,o)}const a=this._bindings,s=this._nActiveBindings;for(let t=0;t!==s;++t)a[t].apply(o);return this}setTime(t){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(t)}getRoot(){return this._root}uncacheClip(t){const e=this._actions,n=t.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){const t=i.knownActions;for(let n=0,r=t.length;n!==r;++n){const r=t[n];this._deactivateAction(r);const i=r._cacheIndex,o=e[e.length-1];r._cacheIndex=null,r._byClipCacheIndex=null,o._cacheIndex=i,e[i]=o,e.pop(),this._removeInactiveBindingsForAction(r)}delete r[n]}}uncacheRoot(t){const e=t.uuid,n=this._actionsByClip;for(const t in n){const r=n[t].actionByRoot[e];void 0!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}const r=this._bindingsByRootAndName[e];if(void 0!==r)for(const t in r){const e=r[t];e.restoreOriginalState(),this._removeInactiveBinding(e)}}uncacheAction(t,e){const n=this.existingAction(t,e);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}},e.AnimationObjectGroup=class{constructor(){this.isAnimationObjectGroup=!0,this.uuid=De(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const t={};this._indicesByUUID=t;for(let e=0,n=arguments.length;e!==n;++e)t[arguments[e].uuid]=e;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const e=this;this.stats={objects:{get total(){return e._objects.length},get inUse(){return this.total-e.nCachedObjects_}},get bindingsPerObject(){return e._bindings.length}}}add(){const t=this._objects,e=this._indicesByUUID,n=this._paths,r=this._parsedPaths,i=this._bindings,o=i.length;let a,s=t.length,u=this.nCachedObjects_;for(let l=0,c=arguments.length;l!==c;++l){const c=arguments[l],h=c.uuid;let p=e[h];if(void 0===p){p=s++,e[h]=p,t.push(c);for(let t=0,e=o;t!==e;++t)i[t].push(new Lh(c,n[t],r[t]))}else if(p<u){a=t[p];const s=--u,l=t[s];e[l.uuid]=p,t[p]=l,e[h]=s,t[s]=c;for(let t=0,e=o;t!==e;++t){const e=i[t],o=e[s];let a=e[p];e[p]=o,void 0===a&&(a=new Lh(c,n[t],r[t])),e[s]=a}}else t[p]}this.nCachedObjects_=u}remove(){const t=this._objects,e=this._indicesByUUID,n=this._bindings,r=n.length;let i=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){const a=arguments[o],s=a.uuid,u=e[s];if(void 0!==u&&u>=i){const o=i++,l=t[o];e[l.uuid]=u,t[u]=l,e[s]=o,t[o]=a;for(let t=0,e=r;t!==e;++t){const e=n[t],r=e[o],i=e[u];e[u]=r,e[o]=i}}}this.nCachedObjects_=i}uncache(){const t=this._objects,e=this._indicesByUUID,n=this._bindings,r=n.length;let i=this.nCachedObjects_,o=t.length;for(let a=0,s=arguments.length;a!==s;++a){const s=arguments[a].uuid,u=e[s];if(void 0!==u)if(delete e[s],u<i){const a=--i,s=t[a],l=--o,c=t[l];e[s.uuid]=u,t[u]=s,e[c.uuid]=a,t[a]=c,t.pop();for(let t=0,e=r;t!==e;++t){const e=n[t],r=e[a],i=e[l];e[u]=r,e[a]=i,e.pop()}}else{const i=--o,a=t[i];i>0&&(e[a.uuid]=u),t[u]=a,t.pop();for(let t=0,e=r;t!==e;++t){const e=n[t];e[u]=e[i],e.pop()}}}this.nCachedObjects_=i}subscribe_(t,e){const n=this._bindingsIndicesByPath;let r=n[t];const i=this._bindings;if(void 0!==r)return i[r];const o=this._paths,a=this._parsedPaths,s=this._objects,u=s.length,l=this.nCachedObjects_,c=new Array(u);r=i.length,n[t]=r,o.push(t),a.push(e),i.push(c);for(let n=l,r=s.length;n!==r;++n){const r=s[n];c[n]=new Lh(r,t,e)}return c}unsubscribe_(t){const e=this._bindingsIndicesByPath,n=e[t];if(void 0!==n){const r=this._paths,i=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a];e[t[a]]=n,o[n]=s,o.pop(),i[n]=i[a],i.pop(),r[n]=r[a],r.pop()}}},e.AnimationUtils=pc,e.ArcCurve=Cu,e.ArrayCamera=ls,e.ArrowHelper=class extends xr{constructor(t=new $e(0,0,1),e=new $e(0,0,0),n=1,r=16776960,i=.2*n,o=.2*i){super(),this.type="ArrowHelper",void 0===np&&(np=new $r,np.setAttribute("position",new Hr([0,0,0,0,1,0],3)),rp=new Qu(0,.5,1,5,1),rp.translate(0,-.5,0)),this.position.copy(e),this.line=new du(np,new uu({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new di(rp,new Ur({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(n,i,o)}setDirection(t){if(t.y>.99999)this.quaternion.set(0,0,0,1);else if(t.y<-.99999)this.quaternion.set(1,0,0,0);else{ep.set(t.z,0,-t.x).normalize();const e=Math.acos(t.y);this.quaternion.setFromAxisAngle(ep,e)}}setLength(t,e=.2*t,n=.2*e){this.line.scale.set(1,Math.max(1e-4,t-e),1),this.line.updateMatrix(),this.cone.scale.set(n,e,n),this.cone.position.y=t,this.cone.updateMatrix()}setColor(t){this.line.material.color.set(t),this.cone.material.color.set(t)}copy(t){return super.copy(t,!1),this.line.copy(t.line),this.cone.copy(t.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}},e.Audio=yh,e.AudioAnalyser=class{constructor(t,e=2048){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=e,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let t=0;const e=this.getFrequencyData();for(let n=0;n<e.length;n++)t+=e[n];return t/e.length}},e.AudioContext=uh,e.AudioListener=class extends xr{constructor(){super(),this.type="AudioListener",this.context=uh.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new ph}getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(t){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}updateMatrixWorld(t){super.updateMatrixWorld(t);const e=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(dh,mh,gh),vh.set(0,0,-1).applyQuaternion(mh),e.positionX){const t=this.context.currentTime+this.timeDelta;e.positionX.linearRampToValueAtTime(dh.x,t),e.positionY.linearRampToValueAtTime(dh.y,t),e.positionZ.linearRampToValueAtTime(dh.z,t),e.forwardX.linearRampToValueAtTime(vh.x,t),e.forwardY.linearRampToValueAtTime(vh.y,t),e.forwardZ.linearRampToValueAtTime(vh.z,t),e.upX.linearRampToValueAtTime(n.x,t),e.upY.linearRampToValueAtTime(n.y,t),e.upZ.linearRampToValueAtTime(n.z,t)}else e.setPosition(dh.x,dh.y,dh.z),e.setOrientation(vh.x,vh.y,vh.z,n.x,n.y,n.z)}},e.AudioLoader=class extends Lc{constructor(t){super(t)}load(t,e,n,r){const i=this,o=new Nc(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(t,(function(n){try{const t=n.slice(0);uh.getContext().decodeAudioData(t,(function(t){e(t)}))}catch(e){r&&r(e),i.manager.itemError(t)}}),n,r)}},e.AxesHelper=class extends vu{constructor(t=1){const e=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t],n=new $r;n.setAttribute("position",new Hr(e,3)),n.setAttribute("color",new Hr([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));super(n,new uu({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(t,e,n){const r=new Fr,i=this.geometry.attributes.color.array;return r.set(t),r.toArray(i,0),r.toArray(i,3),r.set(e),r.toArray(i,6),r.toArray(i,9),r.set(n),r.toArray(i,12),r.toArray(i,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}},e.BackSide=c,e.BasicDepthPacking=3200,e.BasicShadowMap=0,e.Bone=Js,e.BooleanKeyframeTrack=yc,e.Box2=class{constructor(t=new He(1/0,1/0),e=new He(-1/0,-1/0)){this.isBox2=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=Fh.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(t){return this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return this.clampPoint(t,Fh).distanceTo(t)}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}},e.Box3=bn,e.Box3Helper=class extends vu{constructor(t,e=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new $r;r.setIndex(new Gr(n,1)),r.setAttribute("position",new Hr([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(r,new uu({color:e,toneMapped:!1})),this.box=t,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(t){const e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(t))}dispose(){this.geometry.dispose(),this.material.dispose()}},e.BoxBufferGeometry=class extends gi{constructor(t,e,n,r,i,o){super(t,e,n,r,i,o)}},e.BoxGeometry=gi,e.BoxHelper=class extends vu{constructor(t,e=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),i=new $r;i.setIndex(new Gr(n,1)),i.setAttribute("position",new Gr(r,3)),super(i,new uu({color:e,toneMapped:!1})),this.object=t,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(t){if(void 0!==this.object&&tp.setFromObject(this.object),tp.isEmpty())return;const e=tp.min,n=tp.max,r=this.geometry.attributes.position,i=r.array;i[0]=n.x,i[1]=n.y,i[2]=n.z,i[3]=e.x,i[4]=n.y,i[5]=n.z,i[6]=e.x,i[7]=e.y,i[8]=n.z,i[9]=n.x,i[10]=e.y,i[11]=n.z,i[12]=n.x,i[13]=n.y,i[14]=e.z,i[15]=e.x,i[16]=n.y,i[17]=e.z,i[18]=e.x,i[19]=e.y,i[20]=e.z,i[21]=n.x,i[22]=e.y,i[23]=e.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(t){return this.object=t,this.update(),this}copy(t,e){return super.copy(t,e),this.object=t.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}},e.BufferAttribute=Gr,e.BufferGeometry=$r,e.BufferGeometryLoader=rh,e.ByteType=ft,e.Cache=Ac,e.Camera=wi,e.CameraHelper=class extends vu{constructor(t){const e=new $r,n=new uu({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],i=[],o={};function a(t,e){s(t),s(e)}function s(t){r.push(0,0,0),i.push(0,0,0),void 0===o[t]&&(o[t]=[]),o[t].push(r.length/3-1)}a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4"),e.setAttribute("position",new Hr(r,3)),e.setAttribute("color",new Hr(i,3)),super(e,n),this.type="CameraHelper",this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const u=new Fr(16755200),l=new Fr(16711680),c=new Fr(43775),h=new Fr(16777215),p=new Fr(3355443);this.setColors(u,l,c,h,p)}setColors(t,e,n,r,i){const o=this.geometry.getAttribute("color");o.setXYZ(0,t.r,t.g,t.b),o.setXYZ(1,t.r,t.g,t.b),o.setXYZ(2,t.r,t.g,t.b),o.setXYZ(3,t.r,t.g,t.b),o.setXYZ(4,t.r,t.g,t.b),o.setXYZ(5,t.r,t.g,t.b),o.setXYZ(6,t.r,t.g,t.b),o.setXYZ(7,t.r,t.g,t.b),o.setXYZ(8,t.r,t.g,t.b),o.setXYZ(9,t.r,t.g,t.b),o.setXYZ(10,t.r,t.g,t.b),o.setXYZ(11,t.r,t.g,t.b),o.setXYZ(12,t.r,t.g,t.b),o.setXYZ(13,t.r,t.g,t.b),o.setXYZ(14,t.r,t.g,t.b),o.setXYZ(15,t.r,t.g,t.b),o.setXYZ(16,t.r,t.g,t.b),o.setXYZ(17,t.r,t.g,t.b),o.setXYZ(18,t.r,t.g,t.b),o.setXYZ(19,t.r,t.g,t.b),o.setXYZ(20,t.r,t.g,t.b),o.setXYZ(21,t.r,t.g,t.b),o.setXYZ(22,t.r,t.g,t.b),o.setXYZ(23,t.r,t.g,t.b),o.setXYZ(24,e.r,e.g,e.b),o.setXYZ(25,e.r,e.g,e.b),o.setXYZ(26,e.r,e.g,e.b),o.setXYZ(27,e.r,e.g,e.b),o.setXYZ(28,e.r,e.g,e.b),o.setXYZ(29,e.r,e.g,e.b),o.setXYZ(30,e.r,e.g,e.b),o.setXYZ(31,e.r,e.g,e.b),o.setXYZ(32,n.r,n.g,n.b),o.setXYZ(33,n.r,n.g,n.b),o.setXYZ(34,n.r,n.g,n.b),o.setXYZ(35,n.r,n.g,n.b),o.setXYZ(36,n.r,n.g,n.b),o.setXYZ(37,n.r,n.g,n.b),o.setXYZ(38,r.r,r.g,r.b),o.setXYZ(39,r.r,r.g,r.b),o.setXYZ(40,i.r,i.g,i.b),o.setXYZ(41,i.r,i.g,i.b),o.setXYZ(42,i.r,i.g,i.b),o.setXYZ(43,i.r,i.g,i.b),o.setXYZ(44,i.r,i.g,i.b),o.setXYZ(45,i.r,i.g,i.b),o.setXYZ(46,i.r,i.g,i.b),o.setXYZ(47,i.r,i.g,i.b),o.setXYZ(48,i.r,i.g,i.b),o.setXYZ(49,i.r,i.g,i.b),o.needsUpdate=!0}update(){const t=this.geometry,e=this.pointMap;Qh.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),$h("c",e,t,Qh,0,0,-1),$h("t",e,t,Qh,0,0,1),$h("n1",e,t,Qh,-1,-1,-1),$h("n2",e,t,Qh,1,-1,-1),$h("n3",e,t,Qh,-1,1,-1),$h("n4",e,t,Qh,1,1,-1),$h("f1",e,t,Qh,-1,-1,1),$h("f2",e,t,Qh,1,-1,1),$h("f3",e,t,Qh,-1,1,1),$h("f4",e,t,Qh,1,1,1),$h("u1",e,t,Qh,.7,1.1,-1),$h("u2",e,t,Qh,-.7,1.1,-1),$h("u3",e,t,Qh,0,2,-1),$h("cf1",e,t,Qh,-1,0,1),$h("cf2",e,t,Qh,1,0,1),$h("cf3",e,t,Qh,0,-1,1),$h("cf4",e,t,Qh,0,1,1),$h("cn1",e,t,Qh,-1,0,-1),$h("cn2",e,t,Qh,1,0,-1),$h("cn3",e,t,Qh,0,-1,-1),$h("cn4",e,t,Qh,0,1,-1),t.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}},e.CanvasTexture=class extends gn{constructor(t,e,n,r,i,o,a,s,u){super(t,e,n,r,i,o,a,s,u),this.isCanvasTexture=!0,this.needsUpdate=!0}},e.CapsuleBufferGeometry=class extends Ju{constructor(t,e,n,r){super(t,e,n,r)}},e.CapsuleGeometry=Ju,e.CatmullRomCurve3=Du,e.CineonToneMapping=q,e.CircleBufferGeometry=class extends Ku{constructor(t,e,n,r){super(t,e,n,r)}},e.CircleGeometry=Ku,e.ClampToEdgeWrapping=it,e.Clock=ph,e.Color=Fr,e.ColorKeyframeTrack=xc,e.ColorManagement=cn,e.CompressedArrayTexture=class extends Eu{constructor(t,e,n,r,i,o){super(t,e,n,i,o),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=it}},e.CompressedTexture=Eu,e.CompressedTextureLoader=class extends Lc{constructor(t){super(t)}load(t,e,n,r){const i=this,o=[],a=new Eu,s=new Nc(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(i.withCredentials);let u=0;function l(l){s.load(t[l],(function(t){const n=i.parse(t,!0);o[l]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},u+=1,6===u&&(1===n.mipmapCount&&(a.minFilter=lt),a.image=o,a.format=n.format,a.needsUpdate=!0,e&&e(a))}),n,r)}if(Array.isArray(t))for(let e=0,n=t.length;e<n;++e)l(e);else s.load(t,(function(t){const n=i.parse(t,!0);if(n.isCubemap){const t=n.mipmaps.length/n.mipmapCount;for(let e=0;e<t;e++){o[e]={mipmaps:[]};for(let t=0;t<n.mipmapCount;t++)o[e].mipmaps.push(n.mipmaps[e*n.mipmapCount+t]),o[e].format=n.format,o[e].width=n.width,o[e].height=n.height}a.image=o}else a.image.width=n.width,a.image.height=n.height,a.mipmaps=n.mipmaps;1===n.mipmapCount&&(a.minFilter=lt),a.format=n.format,a.needsUpdate=!0,e&&e(a)}),n,r);return a}},e.ConeBufferGeometry=class extends $u{constructor(t,e,n,r,i,o,a){super(t,e,n,r,i,o,a)}},e.ConeGeometry=$u,e.CubeCamera=Ti,e.CubeReflectionMapping=Q,e.CubeRefractionMapping=$,e.CubeTexture=Ei,e.CubeTextureLoader=class extends Lc{constructor(t){super(t)}load(t,e,n,r){const i=new Ei,o=new Rc(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function s(n){o.load(t[n],(function(t){i.images[n]=t,a++,6===a&&(i.needsUpdate=!0,e&&e(i))}),void 0,r)}for(let e=0;e<t.length;++e)s(e);return i}},e.CubeUVReflectionMapping=nt,e.CubicBezierCurve=Uu,e.CubicBezierCurve3=zu,e.CubicInterpolant=dc,e.CullFaceBack=i,e.CullFaceFront=o,e.CullFaceFrontBack=3,e.CullFaceNone=r,e.Curve=Au,e.CurvePath=Yu,e.CustomBlending=v,e.CustomToneMapping=J,e.CylinderBufferGeometry=class extends Qu{constructor(t,e,n,r,i,o,a,s){super(t,e,n,r,i,o,a,s)}},e.CylinderGeometry=Qu,e.Cylindrical=class{constructor(t=1,e=0,n=0){return this.radius=t,this.theta=e,this.y=n,this}set(t,e,n){return this.radius=t,this.theta=e,this.y=n,this}copy(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,e,n){return this.radius=Math.sqrt(t*t+n*n),this.theta=Math.atan2(t,n),this.y=e,this}clone(){return(new this.constructor).copy(this)}},e.Data3DTexture=_n,e.DataArrayTexture=xn,e.DataTexture=Ks,e.DataTextureLoader=class extends Lc{constructor(t){super(t)}load(t,e,n,r){const i=this,o=new Ks,a=new Nc(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(i.withCredentials),a.load(t,(function(t){const n=i.parse(t);n&&(void 0!==n.image?o.image=n.image:void 0!==n.data&&(o.image.width=n.width,o.image.height=n.height,o.image.data=n.data),o.wrapS=void 0!==n.wrapS?n.wrapS:it,o.wrapT=void 0!==n.wrapT?n.wrapT:it,o.magFilter=void 0!==n.magFilter?n.magFilter:lt,o.minFilter=void 0!==n.minFilter?n.minFilter:lt,o.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.encoding&&(o.encoding=n.encoding),void 0!==n.flipY&&(o.flipY=n.flipY),void 0!==n.format&&(o.format=n.format),void 0!==n.type&&(o.type=n.type),void 0!==n.mipmaps&&(o.mipmaps=n.mipmaps,o.minFilter=ht),1===n.mipmapCount&&(o.minFilter=lt),void 0!==n.generateMipmaps&&(o.generateMipmaps=n.generateMipmaps),o.needsUpdate=!0,e&&e(o,n))}),n,r),o}},e.DataUtils=ap,e.DecrementStencilOp=7683,e.DecrementWrapStencilOp=34056,e.DefaultLoadingManager=Cc,e.DepthFormat=At,e.DepthStencilFormat=Pt,e.DepthTexture=fs,e.DirectionalLight=Zc,e.DirectionalLightHelper=class extends xr{constructor(t,e,n){super(),this.light=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",void 0===e&&(e=1);let r=new $r;r.setAttribute("position",new Hr([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));const i=new uu({fog:!1,toneMapped:!1});this.lightPlane=new du(r,i),this.add(this.lightPlane),r=new $r,r.setAttribute("position",new Hr([0,0,0,0,0,1],3)),this.targetLine=new du(r,i),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),qh.setFromMatrixPosition(this.light.matrixWorld),Zh.setFromMatrixPosition(this.light.target.matrixWorld),Jh.subVectors(Zh,qh),this.lightPlane.lookAt(Zh),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Zh),this.targetLine.scale.z=Jh.length()}},e.DiscreteInterpolant=gc,e.DisplayP3ColorSpace=Te,e.DodecahedronBufferGeometry=class extends el{constructor(t,e){super(t,e)}},e.DodecahedronGeometry=el,e.DoubleSide=h,e.DstAlphaFactor=C,e.DstColorFactor=I,e.DynamicCopyUsage=35050,e.DynamicDrawUsage=35048,e.DynamicReadUsage=35049,e.EdgesGeometry=al,e.EllipseCurve=Pu,e.EqualDepth=B,e.EqualStencilFunc=514,e.EquirectangularReflectionMapping=tt,e.EquirectangularRefractionMapping=et,e.Euler=ir,e.EventDispatcher=Le,e.ExtrudeBufferGeometry=class extends kl{constructor(t,e){super(t,e)}},e.ExtrudeGeometry=kl,e.FileLoader=Nc,e.Float16BufferAttribute=class extends Gr{constructor(t,e,n){super(new Uint16Array(t),e,n),this.isFloat16BufferAttribute=!0}},e.Float32BufferAttribute=Hr,e.Float64BufferAttribute=class extends Gr{constructor(t,e,n){super(new Float64Array(t),e,n)}},e.FloatType=yt,e.Fog=_s,e.FogExp2=xs,e.FramebufferTexture=class extends gn{constructor(t,e,n){super({width:t,height:e}),this.isFramebufferTexture=!0,this.format=n,this.magFilter=at,this.minFilter=at,this.generateMipmaps=!1,this.needsUpdate=!0}},e.FrontSide=l,e.Frustum=Ri,e.GLBufferAttribute=class{constructor(t,e,n,r,i){this.isGLBufferAttribute=!0,this.name="",this.buffer=t,this.type=e,this.itemSize=n,this.elementSize=r,this.count=i,this.version=0}set needsUpdate(t){!0===t&&this.version++}setBuffer(t){return this.buffer=t,this}setType(t,e){return this.type=t,this.elementSize=e,this}setItemSize(t){return this.itemSize=t,this}setCount(t){return this.count=t,this}},e.GLSL1="100",e.GLSL3=Pe,e.GreaterDepth=z,e.GreaterEqualDepth=U,e.GreaterEqualStencilFunc=518,e.GreaterStencilFunc=516,e.GridHelper=class extends vu{constructor(t=10,e=10,n=4473924,r=8947848){n=new Fr(n),r=new Fr(r);const i=e/2,o=t/e,a=t/2,s=[],u=[];for(let t=0,l=0,c=-a;t<=e;t++,c+=o){s.push(-a,0,c,a,0,c),s.push(c,0,-a,c,0,a);const e=t===i?n:r;e.toArray(u,l),l+=3,e.toArray(u,l),l+=3,e.toArray(u,l),l+=3,e.toArray(u,l),l+=3}const l=new $r;l.setAttribute("position",new Hr(s,3)),l.setAttribute("color",new Hr(u,3));super(l,new uu({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}},e.Group=cs,e.HalfFloatType=xt,e.HemisphereLight=kc,e.HemisphereLightHelper=class extends xr{constructor(t,e,n){super(),this.light=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const r=new Ul(e);r.rotateY(.5*Math.PI),this.material=new Ur({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const i=r.getAttribute("position"),o=new Float32Array(3*i.count);r.setAttribute("color",new Gr(o,3)),this.add(new di(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const t=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const e=t.geometry.getAttribute("color");Xh.copy(this.light.color),Yh.copy(this.light.groundColor);for(let t=0,n=e.count;t<n;t++){const r=t<n/2?Xh:Yh;e.setXYZ(t,r.r,r.g,r.b)}e.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),t.lookAt(Hh.setFromMatrixPosition(this.light.matrixWorld).negate())}},e.HemisphereLightProbe=class extends $c{constructor(t,e,n=1){super(void 0,n),this.isHemisphereLightProbe=!0;const r=(new Fr).set(t),i=(new Fr).set(e),o=new $e(r.r,r.g,r.b),a=new $e(i.r,i.g,i.b),s=Math.sqrt(Math.PI),u=s*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(a).multiplyScalar(s),this.sh.coefficients[1].copy(o).sub(a).multiplyScalar(u)}},e.IcosahedronBufferGeometry=class extends Bl{constructor(t,e){super(t,e)}},e.IcosahedronGeometry=Bl,e.ImageBitmapLoader=class extends Lc{constructor(t){super(t),this.isImageBitmapLoader=!0,this.options={premultiplyAlpha:"none"}}setOptions(t){return this.options=t,this}load(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const i=this,o=Ac.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout((function(){e&&e(o),i.manager.itemEnd(t)}),0),o;const a={};a.credentials="anonymous"===this.crossOrigin?"same-origin":"include",a.headers=this.requestHeader,fetch(t,a).then((function(t){return t.blob()})).then((function(t){return createImageBitmap(t,Object.assign(i.options,{colorSpaceConversion:"none"}))})).then((function(n){Ac.add(t,n),e&&e(n),i.manager.itemEnd(t)})).catch((function(e){r&&r(e),i.manager.itemError(t),i.manager.itemEnd(t)})),i.manager.itemStart(t)}},e.ImageLoader=Rc,e.ImageUtils=pn,e.IncrementStencilOp=7682,e.IncrementWrapStencilOp=34055,e.InstancedBufferAttribute=eu,e.InstancedBufferGeometry=nh,e.InstancedInterleavedBuffer=class extends ws{constructor(t,e,n=1){super(t,e),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}clone(t){const e=super.clone(t);return e.meshPerAttribute=this.meshPerAttribute,e}toJSON(t){const e=super.toJSON(t);return e.isInstancedInterleavedBuffer=!0,e.meshPerAttribute=this.meshPerAttribute,e}},e.InstancedMesh=su,e.Int16BufferAttribute=class extends Gr{constructor(t,e,n){super(new Int16Array(t),e,n)}},e.Int32BufferAttribute=class extends Gr{constructor(t,e,n){super(new Int32Array(t),e,n)}},e.Int8BufferAttribute=class extends Gr{constructor(t,e,n){super(new Int8Array(t),e,n)}},e.IntType=gt,e.InterleavedBuffer=ws,e.InterleavedBufferAttribute=Ss,e.Interpolant=fc,e.InterpolateDiscrete=ce,e.InterpolateLinear=he,e.InterpolateSmooth=pe,e.InvertStencilOp=5386,e.KeepStencilOp=Ee,e.KeyframeTrack=vc,e.LOD=js,e.LatheBufferGeometry=class extends Zu{constructor(t,e,n,r){super(t,e,n,r)}},e.LatheGeometry=Zu,e.Layers=or,e.LessDepth=k,e.LessEqualDepth=F,e.LessEqualStencilFunc=515,e.LessStencilFunc=513,e.Light=Dc,e.LightProbe=$c,e.Line=du,e.Line3=class{constructor(t=new $e,e=new $e){this.start=t,this.end=e}set(t,e){return this.start.copy(t),this.end.copy(e),this}copy(t){return this.start.copy(t.start),this.end.copy(t.end),this}getCenter(t){return t.addVectors(this.start,this.end).multiplyScalar(.5)}delta(t){return t.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(t,e){return this.delta(e).multiplyScalar(t).add(this.start)}closestPointToPointParameter(t,e){Bh.subVectors(t,this.start),Uh.subVectors(this.end,this.start);const n=Uh.dot(Uh);let r=Uh.dot(Bh)/n;return e&&(r=ke(r,0,1)),r}closestPointToPoint(t,e,n){const r=this.closestPointToPointParameter(t,e);return this.delta(n).multiplyScalar(r).add(this.start)}applyMatrix4(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this}equals(t){return t.start.equals(this.start)&&t.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}},e.LineBasicMaterial=uu,e.LineCurve=Vu,e.LineCurve3=Gu,e.LineDashedMaterial=oc,e.LineLoop=yu,e.LineSegments=vu,e.LinearEncoding=ye,e.LinearFilter=lt,e.LinearInterpolant=mc,e.LinearMipMapLinearFilter=1008,e.LinearMipMapNearestFilter=1007,e.LinearMipmapLinearFilter=ht,e.LinearMipmapNearestFilter=ct,e.LinearSRGBColorSpace=Se,e.LinearToneMapping=X,e.Loader=Lc,e.LoaderUtils=eh,e.LoadingManager=Pc,e.LoopOnce=2200,e.LoopPingPong=2202,e.LoopRepeat=2201,e.LuminanceAlphaFormat=Et,e.LuminanceFormat=Tt,e.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},e.Material=Or,e.MaterialLoader=th,e.MathUtils=We,e.Matrix3=Xe,e.Matrix4=qn,e.MaxEquation=w,e.Mesh=di,e.MeshBasicMaterial=Ur,e.MeshDepthMaterial=es,e.MeshDistanceMaterial=ns,e.MeshLambertMaterial=rc,e.MeshMatcapMaterial=ic,e.MeshNormalMaterial=nc,e.MeshPhongMaterial=tc,e.MeshPhysicalMaterial=$l,e.MeshStandardMaterial=Ql,e.MeshToonMaterial=ec,e.MinEquation=b,e.MirroredRepeatWrapping=ot,e.MixOperation=j,e.MultiplyBlending=g,e.MultiplyOperation=G,e.NearestFilter=at,e.NearestMipMapLinearFilter=1005,e.NearestMipMapNearestFilter=1004,e.NearestMipmapLinearFilter=ut,e.NearestMipmapNearestFilter=st,e.NeverDepth=R,e.NeverStencilFunc=512,e.NoBlending=p,e.NoColorSpace="",e.NoToneMapping=H,e.NormalAnimationBlendMode=ge,e.NormalBlending=f,e.NotEqualDepth=V,e.NotEqualStencilFunc=517,e.NumberKeyframeTrack=_c,e.Object3D=xr,e.ObjectLoader=class extends Lc{constructor(t){super(t)}load(t,e,n,r){const i=this,o=""===this.path?eh.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||o;const a=new Nc(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(t,(function(n){let o=null;try{o=JSON.parse(n)}catch(t){return void(void 0!==r&&r(t))}const a=o.metadata;void 0!==a&&void 0!==a.type&&"geometry"!==a.type.toLowerCase()?i.parse(o,e):void 0!==r&&r(new Error("THREE.ObjectLoader: Can't load "+t))}),n,r)}async loadAsync(t,e){const n=""===this.path?eh.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||n;const r=new Nc(this.manager);r.setPath(this.path),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials);const i=await r.loadAsync(t,e),o=JSON.parse(i),a=o.metadata;if(void 0===a||void 0===a.type||"geometry"===a.type.toLowerCase())throw new Error("THREE.ObjectLoader: Can't load "+t);return await this.parseAsync(o)}parse(t,e){const n=this.parseAnimations(t.animations),r=this.parseShapes(t.shapes),i=this.parseGeometries(t.geometries,r),o=this.parseImages(t.images,(function(){void 0!==e&&e(u)})),a=this.parseTextures(t.textures,o),s=this.parseMaterials(t.materials,a),u=this.parseObject(t.object,i,s,a,n),l=this.parseSkeletons(t.skeletons,u);if(this.bindSkeletons(u,l),void 0!==e){let t=!1;for(const e in o)if(o[e].data instanceof HTMLImageElement){t=!0;break}!1===t&&e(u)}return u}async parseAsync(t){const e=this.parseAnimations(t.animations),n=this.parseShapes(t.shapes),r=this.parseGeometries(t.geometries,n),i=await this.parseImagesAsync(t.images),o=this.parseTextures(t.textures,i),a=this.parseMaterials(t.materials,o),s=this.parseObject(t.object,r,a,o,e),u=this.parseSkeletons(t.skeletons,s);return this.bindSkeletons(s,u),s}parseShapes(t){const e={};if(void 0!==t)for(let n=0,r=t.length;n<r;n++){const r=(new sl).fromJSON(t[n]);e[r.uuid]=r}return e}parseSkeletons(t,e){const n={},r={};if(e.traverse((function(t){t.isBone&&(r[t.uuid]=t)})),void 0!==t)for(let e=0,i=t.length;e<i;e++){const i=(new tu).fromJSON(t[e],r);n[i.uuid]=i}return n}parseGeometries(t,e){const n={};if(void 0!==t){const r=new rh;for(let i=0,o=t.length;i<o;i++){let o;const a=t[i];switch(a.type){case"BufferGeometry":case"InstancedBufferGeometry":o=r.parse(a);break;default:a.type in Zl&&(o=Zl[a.type].fromJSON(a,e))}o.uuid=a.uuid,void 0!==a.name&&(o.name=a.name),void 0!==a.userData&&(o.userData=a.userData),n[a.uuid]=o}}return n}parseMaterials(t,e){const n={},r={};if(void 0!==t){const i=new th;i.setTextures(e);for(let e=0,o=t.length;e<o;e++){const o=t[e];void 0===n[o.uuid]&&(n[o.uuid]=i.parse(o)),r[o.uuid]=n[o.uuid]}}return r}parseAnimations(t){const e={};if(void 0!==t)for(let n=0;n<t.length;n++){const r=t[n],i=Tc.parse(r);e[i.uuid]=i}return e}parseImages(t,e){const n=this,r={};let i;function o(t){if("string"==typeof t){const e=t;return function(t){return n.manager.itemStart(t),i.load(t,(function(){n.manager.itemEnd(t)}),void 0,(function(){n.manager.itemError(t),n.manager.itemEnd(t)}))}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(e)?e:n.resourcePath+e)}return t.data?{data:Je(t.type,t.data),width:t.width,height:t.height}:null}if(void 0!==t&&t.length>0){const n=new Pc(e);i=new Rc(n),i.setCrossOrigin(this.crossOrigin);for(let e=0,n=t.length;e<n;e++){const n=t[e],i=n.url;if(Array.isArray(i)){const t=[];for(let e=0,n=i.length;e<n;e++){const n=o(i[e]);null!==n&&(n instanceof HTMLImageElement?t.push(n):t.push(new Ks(n.data,n.width,n.height)))}r[n.uuid]=new fn(t)}else{const t=o(n.url);r[n.uuid]=new fn(t)}}}return r}async parseImagesAsync(t){const e=this,n={};let r;async function i(t){if("string"==typeof t){const n=t,i=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(n)?n:e.resourcePath+n;return await r.loadAsync(i)}return t.data?{data:Je(t.type,t.data),width:t.width,height:t.height}:null}if(void 0!==t&&t.length>0){r=new Rc(this.manager),r.setCrossOrigin(this.crossOrigin);for(let e=0,r=t.length;e<r;e++){const r=t[e],o=r.url;if(Array.isArray(o)){const t=[];for(let e=0,n=o.length;e<n;e++){const n=o[e],r=await i(n);null!==r&&(r instanceof HTMLImageElement?t.push(r):t.push(new Ks(r.data,r.width,r.height)))}n[r.uuid]=new fn(t)}else{const t=await i(r.url);n[r.uuid]=new fn(t)}}}return n}parseTextures(t,e){function n(t,e){return"number"==typeof t?t:e[t]}const r={};if(void 0!==t)for(let i=0,o=t.length;i<o;i++){const o=t[i];o.image,e[o.image];const a=e[o.image],s=a.data;let u;Array.isArray(s)?(u=new Ei,6===s.length&&(u.needsUpdate=!0)):(u=s&&s.data?new Ks:new gn,s&&(u.needsUpdate=!0)),u.source=a,u.uuid=o.uuid,void 0!==o.name&&(u.name=o.name),void 0!==o.mapping&&(u.mapping=n(o.mapping,ih)),void 0!==o.offset&&u.offset.fromArray(o.offset),void 0!==o.repeat&&u.repeat.fromArray(o.repeat),void 0!==o.center&&u.center.fromArray(o.center),void 0!==o.rotation&&(u.rotation=o.rotation),void 0!==o.wrap&&(u.wrapS=n(o.wrap[0],oh),u.wrapT=n(o.wrap[1],oh)),void 0!==o.format&&(u.format=o.format),void 0!==o.internalFormat&&(u.internalFormat=o.internalFormat),void 0!==o.type&&(u.type=o.type),void 0!==o.encoding&&(u.encoding=o.encoding),void 0!==o.minFilter&&(u.minFilter=n(o.minFilter,ah)),void 0!==o.magFilter&&(u.magFilter=n(o.magFilter,ah)),void 0!==o.anisotropy&&(u.anisotropy=o.anisotropy),void 0!==o.flipY&&(u.flipY=o.flipY),void 0!==o.generateMipmaps&&(u.generateMipmaps=o.generateMipmaps),void 0!==o.premultiplyAlpha&&(u.premultiplyAlpha=o.premultiplyAlpha),void 0!==o.unpackAlignment&&(u.unpackAlignment=o.unpackAlignment),void 0!==o.userData&&(u.userData=o.userData),r[o.uuid]=u}return r}parseObject(t,e,n,r,i){let o,a,s;function u(t){return e[t],e[t]}function l(t){if(void 0!==t){if(Array.isArray(t)){const e=[];for(let r=0,i=t.length;r<i;r++){const i=t[r];n[i],e.push(n[i])}return e}return n[t],n[t]}}function c(t){return r[t],r[t]}switch(t.type){case"Scene":o=new bs,void 0!==t.background&&(Number.isInteger(t.background)?o.background=new Fr(t.background):o.background=c(t.background)),void 0!==t.environment&&(o.environment=c(t.environment)),void 0!==t.fog&&("Fog"===t.fog.type?o.fog=new _s(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(o.fog=new xs(t.fog.color,t.fog.density))),void 0!==t.backgroundBlurriness&&(o.backgroundBlurriness=t.backgroundBlurriness),void 0!==t.backgroundIntensity&&(o.backgroundIntensity=t.backgroundIntensity);break;case"PerspectiveCamera":o=new Mi(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(o.focus=t.focus),void 0!==t.zoom&&(o.zoom=t.zoom),void 0!==t.filmGauge&&(o.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(o.filmOffset=t.filmOffset),void 0!==t.view&&(o.view=Object.assign({},t.view));break;case"OrthographicCamera":o=new qi(t.left,t.right,t.top,t.bottom,t.near,t.far),void 0!==t.zoom&&(o.zoom=t.zoom),void 0!==t.view&&(o.view=Object.assign({},t.view));break;case"AmbientLight":o=new Jc(t.color,t.intensity);break;case"DirectionalLight":o=new Zc(t.color,t.intensity);break;case"PointLight":o=new Yc(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":o=new Kc(t.color,t.intensity,t.width,t.height);break;case"SpotLight":o=new Gc(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":o=new kc(t.color,t.groundColor,t.intensity);break;case"LightProbe":o=(new $c).fromJSON(t);break;case"SkinnedMesh":a=u(t.geometry),s=l(t.material),o=new Zs(a,s),void 0!==t.bindMode&&(o.bindMode=t.bindMode),void 0!==t.bindMatrix&&o.bindMatrix.fromArray(t.bindMatrix),void 0!==t.skeleton&&(o.skeleton=t.skeleton);break;case"Mesh":a=u(t.geometry),s=l(t.material),o=new di(a,s);break;case"InstancedMesh":a=u(t.geometry),s=l(t.material);const e=t.count,n=t.instanceMatrix,r=t.instanceColor;o=new su(a,s,e),o.instanceMatrix=new eu(new Float32Array(n.array),16),void 0!==r&&(o.instanceColor=new eu(new Float32Array(r.array),r.itemSize));break;case"LOD":o=new js;break;case"Line":o=new du(u(t.geometry),l(t.material));break;case"LineLoop":o=new yu(u(t.geometry),l(t.material));break;case"LineSegments":o=new vu(u(t.geometry),l(t.material));break;case"PointCloud":case"Points":o=new Su(u(t.geometry),l(t.material));break;case"Sprite":o=new Us(l(t.material));break;case"Group":o=new cs;break;case"Bone":o=new Js;break;default:o=new xr}if(o.uuid=t.uuid,void 0!==t.name&&(o.name=t.name),void 0!==t.matrix?(o.matrix.fromArray(t.matrix),void 0!==t.matrixAutoUpdate&&(o.matrixAutoUpdate=t.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(void 0!==t.position&&o.position.fromArray(t.position),void 0!==t.rotation&&o.rotation.fromArray(t.rotation),void 0!==t.quaternion&&o.quaternion.fromArray(t.quaternion),void 0!==t.scale&&o.scale.fromArray(t.scale)),void 0!==t.castShadow&&(o.castShadow=t.castShadow),void 0!==t.receiveShadow&&(o.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(o.shadow.bias=t.shadow.bias),void 0!==t.shadow.normalBias&&(o.shadow.normalBias=t.shadow.normalBias),void 0!==t.shadow.radius&&(o.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&o.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(o.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(o.visible=t.visible),void 0!==t.frustumCulled&&(o.frustumCulled=t.frustumCulled),void 0!==t.renderOrder&&(o.renderOrder=t.renderOrder),void 0!==t.userData&&(o.userData=t.userData),void 0!==t.layers&&(o.layers.mask=t.layers),void 0!==t.children){const a=t.children;for(let t=0;t<a.length;t++)o.add(this.parseObject(a[t],e,n,r,i))}if(void 0!==t.animations){const e=t.animations;for(let t=0;t<e.length;t++){const n=e[t];o.animations.push(i[n])}}if("LOD"===t.type){void 0!==t.autoUpdate&&(o.autoUpdate=t.autoUpdate);const e=t.levels;for(let t=0;t<e.length;t++){const n=e[t],r=o.getObjectByProperty("uuid",n.object);void 0!==r&&o.addLevel(r,n.distance,n.hysteresis)}}return o}bindSkeletons(t,e){0!==Object.keys(e).length&&t.traverse((function(t){if(!0===t.isSkinnedMesh&&void 0!==t.skeleton){const n=e[t.skeleton];void 0===n||t.bind(n,t.bindMatrix)}}))}},e.ObjectSpaceNormalMap=we,e.OctahedronBufferGeometry=class extends Ul{constructor(t,e){super(t,e)}},e.OctahedronGeometry=Ul,e.OneFactor=S,e.OneMinusDstAlphaFactor=L,e.OneMinusDstColorFactor=O,e.OneMinusSrcAlphaFactor=P,e.OneMinusSrcColorFactor=E,e.OrthographicCamera=qi,e.PCFShadowMap=a,e.PCFSoftShadowMap=s,e.PMREMGenerator=io,e.Path=qu,e.PerspectiveCamera=Mi,e.Plane=Ii,e.PlaneBufferGeometry=class extends Fi{constructor(t,e,n,r){super(t,e,n,r)}},e.PlaneGeometry=Fi,e.PlaneHelper=class extends du{constructor(t,e=1,n=16776960){const r=n,i=new $r;i.setAttribute("position",new Hr([1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),i.computeBoundingSphere(),super(i,new uu({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=t,this.size=e;const o=new $r;o.setAttribute("position",new Hr([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),o.computeBoundingSphere(),this.add(new di(o,new Ur({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(t){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(t)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}},e.PointLight=Yc,e.PointLightHelper=class extends di{constructor(t,e,n){super(new Gl(e,4,2),new Ur({wireframe:!0,fog:!1,toneMapped:!1})),this.light=t,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}},e.Points=Su,e.PointsMaterial=xu,e.PolarGridHelper=class extends vu{constructor(t=10,e=16,n=8,r=64,i=4473924,o=8947848){i=new Fr(i),o=new Fr(o);const a=[],s=[];if(e>1)for(let n=0;n<e;n++){const r=n/e*(2*Math.PI),u=Math.sin(r)*t,l=Math.cos(r)*t;a.push(0,0,0),a.push(u,0,l);const c=1&n?i:o;s.push(c.r,c.g,c.b),s.push(c.r,c.g,c.b)}for(let e=0;e<n;e++){const u=1&e?i:o,l=t-t/n*e;for(let t=0;t<r;t++){let e=t/r*(2*Math.PI),n=Math.sin(e)*l,i=Math.cos(e)*l;a.push(n,0,i),s.push(u.r,u.g,u.b),e=(t+1)/r*(2*Math.PI),n=Math.sin(e)*l,i=Math.cos(e)*l,a.push(n,0,i),s.push(u.r,u.g,u.b)}}const u=new $r;u.setAttribute("position",new Hr(a,3)),u.setAttribute("color",new Hr(s,3));super(u,new uu({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}},e.PolyhedronBufferGeometry=class extends tl{constructor(t,e,n,r){super(t,e,n,r)}},e.PolyhedronGeometry=tl,e.PositionalAudio=class extends yh{constructor(t){super(t),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(t){return this.panner.refDistance=t,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(t){return this.panner.rolloffFactor=t,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(t){return this.panner.distanceModel=t,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(t){return this.panner.maxDistance=t,this}setDirectionalCone(t,e,n){return this.panner.coneInnerAngle=t,this.panner.coneOuterAngle=e,this.panner.coneOuterGain=n,this}updateMatrixWorld(t){if(super.updateMatrixWorld(t),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(xh,_h,bh),wh.set(0,0,1).applyQuaternion(_h);const e=this.panner;if(e.positionX){const t=this.context.currentTime+this.listener.timeDelta;e.positionX.linearRampToValueAtTime(xh.x,t),e.positionY.linearRampToValueAtTime(xh.y,t),e.positionZ.linearRampToValueAtTime(xh.z,t),e.orientationX.linearRampToValueAtTime(wh.x,t),e.orientationY.linearRampToValueAtTime(wh.y,t),e.orientationZ.linearRampToValueAtTime(wh.z,t)}else e.setPosition(xh.x,xh.y,xh.z),e.setOrientation(wh.x,wh.y,wh.z)}},e.PropertyBinding=Lh,e.PropertyMixer=Mh,e.QuadraticBezierCurve=ju,e.QuadraticBezierCurve3=Wu,e.Quaternion=Qe,e.QuaternionKeyframeTrack=wc,e.QuaternionLinearInterpolant=bc,e.RED_GREEN_RGTC2_Format=ue,e.RED_RGTC1_Format=ae,e.REVISION=n,e.RGBADepthPacking=_e,e.RGBAFormat=St,e.RGBAIntegerFormat=Nt,e.RGBA_ASTC_10x10_Format=ne,e.RGBA_ASTC_10x5_Format=$t,e.RGBA_ASTC_10x6_Format=te,e.RGBA_ASTC_10x8_Format=ee,e.RGBA_ASTC_12x10_Format=re,e.RGBA_ASTC_12x12_Format=ie,e.RGBA_ASTC_4x4_Format=Ht,e.RGBA_ASTC_5x4_Format=Xt,e.RGBA_ASTC_5x5_Format=Yt,e.RGBA_ASTC_6x5_Format=qt,e.RGBA_ASTC_6x6_Format=Zt,e.RGBA_ASTC_8x5_Format=Jt,e.RGBA_ASTC_8x6_Format=Kt,e.RGBA_ASTC_8x8_Format=Qt,e.RGBA_BPTC_Format=oe,e.RGBA_ETC2_EAC_Format=Wt,e.RGBA_PVRTC_2BPPV1_Format=Vt,e.RGBA_PVRTC_4BPPV1_Format=zt,e.RGBA_S3TC_DXT1_Format=Dt,e.RGBA_S3TC_DXT3_Format=kt,e.RGBA_S3TC_DXT5_Format=Ft,e.RGB_ETC1_Format=Gt,e.RGB_ETC2_Format=jt,e.RGB_PVRTC_2BPPV1_Format=Ut,e.RGB_PVRTC_4BPPV1_Format=Bt,e.RGB_S3TC_DXT1_Format=Rt,e.RGFormat=It,e.RGIntegerFormat=Ot,e.RawShaderMaterial=Kl,e.Ray=Yn,e.Raycaster=class{constructor(t,e,n=0,r=1/0){this.ray=new Yn(t,e),this.near=n,this.far=r,this.camera=null,this.layers=new or,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(t,e){this.ray.set(t,e)}setFromCamera(t,e){e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e.isOrthographicCamera&&(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e)}intersectObject(t,e=!0,n=[]){return kh(t,this,n,e),n.sort(Dh),n}intersectObjects(t,e=!0,n=[]){for(let r=0,i=t.length;r<i;r++)kh(t[r],this,n,e);return n.sort(Dh),n}},e.RectAreaLight=Kc,e.RedFormat=Ct,e.RedIntegerFormat=Lt,e.ReinhardToneMapping=Y,e.RepeatWrapping=rt,e.ReplaceStencilOp=7681,e.ReverseSubtractEquation=_,e.RingBufferGeometry=class extends zl{constructor(t,e,n,r,i,o){super(t,e,n,r,i,o)}},e.RingGeometry=zl,e.SIGNED_RED_GREEN_RGTC2_Format=le,e.SIGNED_RED_RGTC1_Format=se,e.SRGBColorSpace=Me,e.Scene=bs,e.ShaderChunk=Bi,e.ShaderLib=zi,e.ShaderMaterial=bi,e.ShadowMaterial=Jl,e.Shape=sl,e.ShapeBufferGeometry=class extends Vl{constructor(t,e){super(t,e)}},e.ShapeGeometry=Vl,e.ShapePath=class{constructor(){this.type="ShapePath",this.color=new Fr,this.subPaths=[],this.currentPath=null}moveTo(t,e){return this.currentPath=new qu,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e),this}lineTo(t,e){return this.currentPath.lineTo(t,e),this}quadraticCurveTo(t,e,n,r){return this.currentPath.quadraticCurveTo(t,e,n,r),this}bezierCurveTo(t,e,n,r,i,o){return this.currentPath.bezierCurveTo(t,e,n,r,i,o),this}splineThru(t){return this.currentPath.splineThru(t),this}toShapes(t){function e(t,e){const n=e.length;let r=!1;for(let i=n-1,o=0;o<n;i=o++){let n=e[i],a=e[o],s=a.x-n.x,u=a.y-n.y;if(Math.abs(u)>Number.EPSILON){if(u<0&&(n=e[o],s=-s,a=e[i],u=-u),t.y<n.y||t.y>a.y)continue;if(t.y===n.y){if(t.x===n.x)return!0}else{const e=u*(t.x-n.x)-s*(t.y-n.y);if(0===e)return!0;if(e<0)continue;r=!r}}else{if(t.y!==n.y)continue;if(a.x<=t.x&&t.x<=n.x||n.x<=t.x&&t.x<=a.x)return!0}}return r}const n=Nl.isClockWise,r=this.subPaths;if(0===r.length)return[];let i,o,a;const s=[];if(1===r.length)return o=r[0],a=new sl,a.curves=o.curves,s.push(a),s;let u=!n(r[0].getPoints());u=t?!u:u;const l=[],c=[];let h,p,f=[],d=0;c[d]=void 0,f[d]=[];for(let e=0,a=r.length;e<a;e++)o=r[e],h=o.getPoints(),i=n(h),i=t?!i:i,i?(!u&&c[d]&&d++,c[d]={s:new sl,p:h},c[d].s.curves=o.curves,u&&d++,f[d]=[]):f[d].push({h:o,p:h[0]});if(!c[0])return function(t){const e=[];for(let n=0,r=t.length;n<r;n++){const r=t[n],i=new sl;i.curves=r.curves,e.push(i)}return e}(r);if(c.length>1){let t=!1,n=0;for(let t=0,e=c.length;t<e;t++)l[t]=[];for(let r=0,i=c.length;r<i;r++){const i=f[r];for(let o=0;o<i.length;o++){const a=i[o];let s=!0;for(let i=0;i<c.length;i++)e(a.p,c[i].p)&&(r!==i&&n++,s?(s=!1,l[i].push(a)):t=!0);s&&l[r].push(a)}}n>0&&!1===t&&(f=l)}for(let t=0,e=c.length;t<e;t++){a=c[t].s,s.push(a),p=f[t];for(let t=0,e=p.length;t<e;t++)a.holes.push(p[t].h)}return s}},e.ShapeUtils=Nl,e.ShortType=dt,e.Skeleton=tu,e.SkeletonHelper=class extends vu{constructor(t){const e=Wh(t),n=new $r,r=[],i=[],o=new Fr(0,0,1),a=new Fr(0,1,0);for(let t=0;t<e.length;t++){const n=e[t];n.parent&&n.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(o.r,o.g,o.b),i.push(a.r,a.g,a.b))}n.setAttribute("position",new Hr(r,3)),n.setAttribute("color",new Hr(i,3));super(n,new uu({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(t){const e=this.bones,n=this.geometry,r=n.getAttribute("position");jh.copy(this.root.matrixWorld).invert();for(let t=0,n=0;t<e.length;t++){const i=e[t];i.parent&&i.parent.isBone&&(Gh.multiplyMatrices(jh,i.matrixWorld),Vh.setFromMatrixPosition(Gh),r.setXYZ(n,Vh.x,Vh.y,Vh.z),Gh.multiplyMatrices(jh,i.parent.matrixWorld),Vh.setFromMatrixPosition(Gh),r.setXYZ(n+1,Vh.x,Vh.y,Vh.z),n+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(t)}dispose(){this.geometry.dispose(),this.material.dispose()}},e.SkinnedMesh=Zs,e.Source=fn,e.Sphere=Un,e.SphereBufferGeometry=class extends Gl{constructor(t,e,n,r,i,o,a){super(t,e,n,r,i,o,a)}},e.SphereGeometry=Gl,e.Spherical=class{constructor(t=1,e=0,n=0){return this.radius=t,this.phi=e,this.theta=n,this}set(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this}makeSafe(){const t=1e-6;return this.phi=Math.max(t,Math.min(Math.PI-t,this.phi)),this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,e,n){return this.radius=Math.sqrt(t*t+e*e+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,n),this.phi=Math.acos(ke(e/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}},e.SphericalHarmonics3=Qc,e.SplineCurve=Hu,e.SpotLight=Gc,e.SpotLightHelper=class extends xr{constructor(t,e){super(),this.light=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e,this.type="SpotLightHelper";const n=new $r,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let t=0,e=1,n=32;t<n;t++,e++){const i=t/n*Math.PI*2,o=e/n*Math.PI*2;r.push(Math.cos(i),Math.sin(i),1,Math.cos(o),Math.sin(o),1)}n.setAttribute("position",new Hr(r,3));const i=new uu({fog:!1,toneMapped:!1});this.cone=new vu(n,i),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const t=this.light.distance?this.light.distance:1e3,e=t*Math.tan(this.light.angle);this.cone.scale.set(e,e,t),zh.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(zh),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}},e.Sprite=Us,e.SpriteMaterial=Ts,e.SrcAlphaFactor=A,e.SrcAlphaSaturateFactor=N,e.SrcColorFactor=T,e.StaticCopyUsage=35046,e.StaticDrawUsage=Ae,e.StaticReadUsage=35045,e.StereoCamera=class{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Mi,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Mi,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(t){const e=this._cache;if(e.focus!==t.focus||e.fov!==t.fov||e.aspect!==t.aspect*this.aspect||e.near!==t.near||e.far!==t.far||e.zoom!==t.zoom||e.eyeSep!==this.eyeSep){e.focus=t.focus,e.fov=t.fov,e.aspect=t.aspect*this.aspect,e.near=t.near,e.far=t.far,e.zoom=t.zoom,e.eyeSep=this.eyeSep,hh.copy(t.projectionMatrix);const n=e.eyeSep/2,r=n*e.near/e.focus,i=e.near*Math.tan(Ne*e.fov*.5)/e.zoom;let o,a;ch.elements[12]=-n,lh.elements[12]=n,o=-i*e.aspect+r,a=i*e.aspect+r,hh.elements[0]=2*e.near/(a-o),hh.elements[8]=(a+o)/(a-o),this.cameraL.projectionMatrix.copy(hh),o=-i*e.aspect-r,a=i*e.aspect-r,hh.elements[0]=2*e.near/(a-o),hh.elements[8]=(a+o)/(a-o),this.cameraR.projectionMatrix.copy(hh)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(ch),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(lh)}},e.StreamCopyUsage=35042,e.StreamDrawUsage=35040,e.StreamReadUsage=35041,e.StringKeyframeTrack=Mc,e.SubtractEquation=x,e.SubtractiveBlending=m,e.TOUCH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},e.TangentSpaceNormalMap=be,e.TetrahedronBufferGeometry=class extends jl{constructor(t,e){super(t,e)}},e.TetrahedronGeometry=jl,e.Texture=gn,e.TextureLoader=class extends Lc{constructor(t){super(t)}load(t,e,n,r){const i=new gn,o=new Rc(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(t,(function(t){i.image=t,i.needsUpdate=!0,void 0!==e&&e(i)}),n,r),i}},e.TorusBufferGeometry=class extends Wl{constructor(t,e,n,r,i){super(t,e,n,r,i)}},e.TorusGeometry=Wl,e.TorusKnotBufferGeometry=class extends Hl{constructor(t,e,n,r,i,o){super(t,e,n,r,i,o)}},e.TorusKnotGeometry=Hl,e.Triangle=Lr,e.TriangleFanDrawMode=2,e.TriangleStripDrawMode=1,e.TrianglesDrawMode=0,e.TubeBufferGeometry=class extends Xl{constructor(t,e,n,r,i){super(t,e,n,r,i)}},e.TubeGeometry=Xl,e.TwoPassDoubleSide=2,e.UVMapping=K,e.Uint16BufferAttribute=jr,e.Uint32BufferAttribute=Wr,e.Uint8BufferAttribute=class extends Gr{constructor(t,e,n){super(new Uint8Array(t),e,n)}},e.Uint8ClampedBufferAttribute=class extends Gr{constructor(t,e,n){super(new Uint8ClampedArray(t),e,n)}},e.Uniform=Nh,e.UniformsGroup=class extends Le{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:Rh++}),this.name="",this.usage=Ae,this.uniforms=[]}add(t){return this.uniforms.push(t),this}remove(t){const e=this.uniforms.indexOf(t);return-1!==e&&this.uniforms.splice(e,1),this}setName(t){return this.name=t,this}setUsage(t){return this.usage=t,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(t){this.name=t.name,this.usage=t.usage;const e=t.uniforms;this.uniforms.length=0;for(let t=0,n=e.length;t<n;t++)this.uniforms.push(e[t].clone());return this}clone(){return(new this.constructor).copy(this)}},e.UniformsLib=Ui,e.UniformsUtils=_i,e.UnsignedByteType=pt,e.UnsignedInt248Type=wt,e.UnsignedIntType=vt,e.UnsignedShort4444Type=_t,e.UnsignedShort5551Type=bt,e.UnsignedShortType=mt,e.VSMShadowMap=u,e.Vector2=He,e.Vector3=$e,e.Vector4=vn,e.VectorKeyframeTrack=Sc,e.VideoTexture=class extends gn{constructor(t,e,n,r,i,o,a,s,u){super(t,e,n,r,i,o,a,s,u),this.isVideoTexture=!0,this.minFilter=void 0!==o?o:lt,this.magFilter=void 0!==i?i:lt,this.generateMipmaps=!1;const l=this;"requestVideoFrameCallback"in t&&t.requestVideoFrameCallback((function e(){l.needsUpdate=!0,t.requestVideoFrameCallback(e)}))}clone(){return new this.constructor(this.image).copy(this)}update(){const t=this.image;!1==="requestVideoFrameCallback"in t&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}},e.WebGL1Renderer=ys,e.WebGL3DRenderTarget=class extends yn{constructor(t=1,e=1,n=1){super(t,e),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new _n(null,t,e,n),this.texture.isRenderTargetTexture=!0}},e.WebGLArrayRenderTarget=class extends yn{constructor(t=1,e=1,n=1){super(t,e),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new xn(null,t,e,n),this.texture.isRenderTargetTexture=!0}},e.WebGLCubeRenderTarget=Ai,e.WebGLMultipleRenderTargets=class extends yn{constructor(t=1,e=1,n=1,r={}){super(t,e,r),this.isWebGLMultipleRenderTargets=!0;const i=this.texture;this.texture=[];for(let t=0;t<n;t++)this.texture[t]=i.clone(),this.texture[t].isRenderTargetTexture=!0}setSize(t,e,n=1){if(this.width!==t||this.height!==e||this.depth!==n){this.width=t,this.height=e,this.depth=n;for(let r=0,i=this.texture.length;r<i;r++)this.texture[r].image.width=t,this.texture[r].image.height=e,this.texture[r].image.depth=n;this.dispose()}return this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e),this}copy(t){this.dispose(),this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,null!==t.depthTexture&&(this.depthTexture=t.depthTexture.clone()),this.texture.length=0;for(let e=0,n=t.texture.length;e<n;e++)this.texture[e]=t.texture[e].clone(),this.texture[e].isRenderTargetTexture=!0;return this}},e.WebGLRenderTarget=yn,e.WebGLRenderer=vs,e.WebGLUtils=us,e.WireframeGeometry=Yl,e.WrapAroundEnding=me,e.ZeroCurvatureEnding=fe,e.ZeroFactor=M,e.ZeroSlopeEnding=de,e.ZeroStencilOp=0,e._SRGBAFormat=Ce,e.sRGBEncoding=xe},37426:function(t){"use strict";t.exports={version:"1.5.0"}}}]);